/**
 * Jspreadsheet v9.0.13
 *
 * Website: https://jspreadsheet.com
 * Description: Create amazing web based spreadsheets.
 *
 * This software requires a license. Visit: https://jspreadsheet.com/v8
 */

if (! formula && typeof(require) === 'function') {
    var formula = require('@jspreadsheet/formula');
}

if (! jSuites && typeof(require) === 'function') {
    var jSuites = require('jsuites');
}

'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(E){var H=0;return function(){return H<E.length?{done:!1,value:E[H++]}:{done:!0}}};$jscomp.arrayIterator=function(E){return{next:$jscomp.arrayIteratorImpl(E)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(E,H,M){if(E==Array.prototype||E==Object.prototype)return E;E[H]=M.value;return E};$jscomp.getGlobal=function(E){E=["object"==typeof globalThis&&globalThis,E,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var H=0;H<E.length;++H){var M=E[H];if(M&&M.Math==Math)return M}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(E,H){var M=$jscomp.propertyToPolyfillSymbol[H];if(null==M)return E[H];M=E[M];return void 0!==M?M:E[H]};
$jscomp.polyfill=function(E,H,M,W){H&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(E,H,M,W):$jscomp.polyfillUnisolated(E,H,M,W))};$jscomp.polyfillUnisolated=function(E,H,M,W){M=$jscomp.global;E=E.split(".");for(W=0;W<E.length-1;W++){var S=E[W];if(!(S in M))return;M=M[S]}E=E[E.length-1];W=M[E];H=H(W);H!=W&&null!=H&&$jscomp.defineProperty(M,E,{configurable:!0,writable:!0,value:H})};
$jscomp.polyfillIsolated=function(E,H,M,W){var S=E.split(".");E=1===S.length;W=S[0];W=!E&&W in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var Z=0;Z<S.length-1;Z++){var ma=S[Z];if(!(ma in W))return;W=W[ma]}S=S[S.length-1];M=$jscomp.IS_SYMBOL_NATIVE&&"es6"===M?W[S]:null;H=H(M);null!=H&&(E?$jscomp.defineProperty($jscomp.polyfills,S,{configurable:!0,writable:!0,value:H}):H!==M&&($jscomp.propertyToPolyfillSymbol[S]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(S):$jscomp.POLYFILL_PREFIX+S,
S=$jscomp.propertyToPolyfillSymbol[S],$jscomp.defineProperty(W,S,{configurable:!0,writable:!0,value:H})))};$jscomp.initSymbol=function(){};$jscomp.initSymbolIterator=function(){};$jscomp.initSymbolAsyncIterator=function(){};$jscomp.iteratorPrototype=function(E){E={next:E};E[Symbol.iterator]=function(){return this};return E};
$jscomp.iteratorFromArray=function(E,H){E instanceof String&&(E+="");var M=0,W=!1,S={next:function(){if(!W&&M<E.length){var Z=M++;return{value:H(Z,E[Z]),done:!1}}W=!0;return{done:!0,value:void 0}}};S[Symbol.iterator]=function(){return S};return S};$jscomp.polyfill("Array.prototype.values",function(E){return E?E:function(){return $jscomp.iteratorFromArray(this,function(H,M){return M})}},"es8","es3");
var _$_b591=["use strict","{","}","","9.0.13","Base","https://jspreadsheet.com","Unlicensed","Jspreadsheet Pro\r\n"," edition ","\r\n","set","&","&lt;","g","<","&gt;",">","=","!",'"',"undefined","number","fullscreen","block","string","readonly","jss_hidden_index","div","right","10px","pointer","/v8",",","localhost",".","v8"," (Expired)","Licensed to: ","Premium","License required","A valid license is required","This version is not included on the scope of this license","Your license is expired","jspreadsheet",
"img","/jspreadsheet/","logo.png","none","status","edition","scope","data-x","data-y","get","px","jss_frozen","scroll","wheel","goto","jss_scroll","jss_hidden","hidden","jss_content_overflow","onresize","300px","Jspreadsheet Pro","text","autocomplete","dropdown","GET","json","Jspreadsheet Alert: secureFormulas is set to false.","setConfig","insertRow","deleteRow","insertColumn","deleteColumn","moveRow","moveColumn","setMerge","removeMerge","setStyle","resetStyle","setWidth","setHeight","setHeader",
"setComments","orderBy","setValue","setProperty","updateProperty","renameWorksheet","moveWorksheet","setDefinedNames","onundo","onredo","object","function","contextMenu","toolbar","onevent","Jspreadsheet: cursor not in the viewport","keydown","oneditionstart","oncreateeditor","jss_focus","jss_formula","oneditionend","data-mask","data-value","inputmode","0","style","jss_input","contentEditable","oninput","setRowId","onchangerowid","setBorder","resetBorders","updateCells","setFormula","updateData",
"onbeforesave","POST","Authorization","Bearer ","onbeforesend","disconected",": ","Sorry, something went wrong, refreshing your spreadsheet...","_top","onsave","persistence","?","?worksheet=","&worksheet=","add","remove","jss_cursor","selected","main","copying","onblur","onfocus","onselection"," ","'","'!",":","jss_border","cloning","jss_border_","15","jss_resize_corner","data-action","ontouchstart","moveLeft","0px","-6px","moveTop","moveRight","moveDown","-2000px","tr","jss_group_container","td",
"&nbsp;",".jss_group","jss_group","+","width","Jspreadsheet: This column is part of a merged cell.","jss_dragging","1px","jss_helper_col","Jspreadsheet: This row is part of a merged cell","Jspreadsheet: Please clear your search before perform this action","51px","jss_helper_row","No cell selected","Invalid merged properties","onmerge","colspan","rowspan","Column name","data-title","onchangeheader","jss_filters_icon","col","oncreatecolumn","setFooter","onchangefooter","setFooterValue","onchangefootervalue",
"resetFooter","setNestedHeaders","onchangenested","jss_nested","resetNestedHeaders","setNestedCell","onchangenestedcell","center","data-nested-x","data-nested-y","align","calendar","-","00:00:00",'""',"\t","oncopy","copy","color: initial","onbeforepaste","JSS: For better results, please allow pagination or tableOverflow.","onpaste","Export not allowed","\ufeff","text/csv;charset=utf-8;",".csv","a","download","onchangedefinednames","#REF!","Defined names are only available on the Premium edition.",
"#1a237e","#b71c1c","#880e4f","#1b5e20","#ff6f00","/","*","^","(","[","|",";","data-token","picker","jss_picker","click","active","focus","input","jss_object","contenteditable","blur","last",'<b class="','" data-token="','">',"</b>","data-single","true","b",")","]","var "," = {};"," = ",";\n","; return ","onbeforeformula","#LOOP","Reference loop detected","#SELF","Self Reference detected","#ERROR","Table does not exist or is not loaded yet","CHART(","#SPILL!","jss_number","$","Something went wrong",
"onafterchanges","checkbox","autonumber","radio","email","url","color","progressbar","rating","onformulachain","onbeforechange","onchange","oncreatecell","values","mergeCells","jss_wrap","title","jss_unlocked","onchangeproperty","jss_row","oncreaterow","Jspreadsheet: Invalid origin or destination","onmoverow","Jspreadsheet: Insert row is not enabled in the table configuration","onbeforeinsertrow","onbeforeinsertrow returned false","oninsertrow","Jspreadsheet: Delete row is not enabled in the table configuration",
"onbeforedeleterow","onbeforedeleterow returned false","meta","cells","comments","ondeleterow","Jspreadsheet: Invalid origin","Jspreadsheet: Invalid destination","onmovecolumn","Jspreadsheet: Insert column is not enabled in the table configuration","onbeforeinsertcolumn","onbeforeinsertcolumn returned false","col_","oninsertcolumn","Jspreadsheet: Delete column is not enabled in the table configuration","Jspreadsheet: it is not possible to delete the last column","onbeforedeletecolumn","onbeforedeletecolumn returned false",
"ondeletecolumn","; ","onchangestyle","No cell provided","onresetstyle","onbeforecomments","oncomments","setMeta","onchangemeta","resetMeta","onresetmeta","arrow-down","percent","numeric","onbeforesort","This action will destroy any existing merged cells. Are you sure?","onsort","arrow-up","jss_pagination","Jspreadsheet: No pagination defined","Jspreadsheet: pagination not defined","onbeforechangepage","onchangepage","No records found","jss_page","jss_page_selected","Showing page {0} of {1} entries",
"jss_content","selectstart","table","thead","tbody","tfoot","colgroup","50","jss_selectall","jss","cellpadding","cellspacing","unselectable","yes","jss_","jss_overflow","jss_locked","jss_corner","on","onselectstart","return false","X","Y","jss_content_pagination","Frozen columns cannot be greater than the number of available columns","rows","onchangereferences","jss_container","jss_toolbar","jss_helper","jss_loading","textarea","jss_textarea","-1","bottom","beforeinit","Sheet","Worksheet clash name: ",
". It is highly recommended to define a unique worksheetName on the initialization.","jss_worksheet","init","To improve the performance, use tableOverflow or pagination.","resize","touchstart","touchmove","touchend","onresizecolumn","onresizerow","label","jss_filters_active","Jspreadsheet: the filter is not enabled.","onopenfilter","Blanks","onbeforefilter","onfilter","gi","jss_filters_options","INPUT","Search","jss_filters_search","button","Ok","jss_filters_apply","jss_filters",'<input type="checkbox"> ',
"Add current selection to filter",'<input type="checkbox"> (',"Select all","select","jss_pagination_dropdown","option","Show","entries","jss_search","onbeforesearch","onsearch","jss_search_container","jss_contextmenu","cell","row","header","Mac","&#8984;","Ctrl","tabs","Rename this worksheet","Delete this worksheet","Are you sure?","line","nested","Rename this cell","Cut","content_cut"," + X","Copy","content_copy"," + C","Paste","content_paste"," + V","Insert a new column before","Insert a new column after",
"Delete selected columns","Rename this column","Create a new row","Order ascending","Order descending","Insert a new row before","Insert a new row after","Delete selected rows","Edit notes","Add notes","notes","Notes","Clear notes","Save as","save"," + S","About","info","with-toolbar","i","undo","redo","divisor","120px","Verdana","Arial","Courier New",'<span style="font-family:',"</span>","font-family","48px","format_size","x-small","small","medium","large","x-large",'<span style="font-size:',"font-size",
"format_align_left","format_align_center","format_align_right","format_align_justify",'<i class="material-icons">',"</i>","text-align","_","format_align_","format_bold","font-weight","bold","format_color_text","format_color_fill","background-color","extended","top","middle","vertical_align_top","vertical_align_center","vertical_align_bottom","vertical-align","web","Merge the selected cells","border_all","border_outer","border_inner","border_horizontal","border_vertical","border_left","border_top",
"border_right","border_bottom","border_clear","black","border-left: ","px solid ","border-left: ; ","border-right: ","border-right: ; ","border-top: ","border-top: ; ","border-bottom: ","border-bottom: ; ","material-icons","color_lens",'<div style="height: ','px; width: 50px; background-color: black;"></div>',"80px","1","fullscreen_exit","Toggle Fullscreen","search","search_off","Toggle Search","onbeforecreateworksheet","There is one existing worksheet with the same name.","createWorksheet","oncreateworksheet",
"deleteWorksheet","ondeleteworksheet","It was not possible to rename worksheet due conflict name","onrenameworksheet","onmoveworksheet","onopenworksheet","TABLE","Element is not a table","colgroup > col","data-celltype","readOnly","name","id",":scope > thead > tr",":scope > tr, :scope > tbody > tr","data-formula","class","styleBold","; font-weight:bold;","font-weight:bold;","tfoot tr","\r","\n","jss_ignore","THEAD","TBODY","TFOOT","selectall","header-group","jtabs-headers","filters","footer","jtoolbar",
"DIV","html","jss_nowrap","insertHTML","<br/>\n","Process","A","mailto:","_blank","onclick","jclose","col-resize","row-resize","move","DOM el not found","Cloud extension not loaded.","onload","jtabs","jss_dialog","decimal","data-locale","%","jss_percent","[Red]","red","jss_notes","145px","tag","jss_dropdown_tags","jss_dropdown","multiple","image","<div class='jss_dropdown_icon' style='background-color: ","'></div>","orange","<div class='jss_dropdown_tag' style='background-color: ","'>","</div>","timepicker",
"YYYY-MM-DD","square","100px","false","FALSE","disabled","TRUE","jss_progressbar","min","max","jss_rating"," stars","star","href","IMG","round","100%","jss_image","tabindex","jpanel","delete","jfile",'<img src="','" alt="">',"jss_richtext","jss_tags","40px","#NOTFOUND","<img src='","' class='round small' />","Jspreadsheet: worksheet not found "];
(function(E,H){typeof exports===_$_b591[97]&&typeof module!==_$_b591[21]?module.exports=H():typeof define===_$_b591[98]&&define.amd?define(H):E.jspreadsheet=E.jexcel=H()})(this,function(){_$_b591[0];var E=function(h,c){h=jSuites.translate(h);if(c&&c.length)for(var b=0;b<c.length;b++)h=h.replace(_$_b591[1]+b+_$_b591[2],c[b]);return h},H=function(h,c){Array.isArray(h)&&(h=h[0]);h=h.replace(new RegExp(/'/g),_$_b591[3]).toUpperCase();if(void 0===c)return window[h]?window[h]:null;window[h]=c},M=function(){var h=
{version:_$_b591[4],edition:_$_b591[5],host:_$_b591[6],license:_$_b591[7],print:function(){return[_$_b591[8]+this.edition+_$_b591[9]+this.version+_$_b591[10]+this.host+_$_b591[10]+this.license]}};return function(){return h}}(),W=function(h){var c=parseInt(h.y);if(h.id)var b=parseInt(h.id);else h.value&&(b=parseInt(h.value));0<b&&(this.rows[c].id=b,wa[_$_b591[11]].call(this,b))},S=function(h,c){var b=_$_b591[3],a=0;-1!==h.indexOf(_$_b591[12])&&(h=h.replace(new RegExp(_$_b591[13],_$_b591[14]),_$_b591[15]),
h=h.replace(new RegExp(_$_b591[16],_$_b591[14]),_$_b591[17]));for(var d=[_$_b591[18],_$_b591[19],_$_b591[17],_$_b591[15]],e=0;e<h.length;e++)h[e]==_$_b591[20]&&(a=0==a?1:0),1==a?b+=h[e]:(b+=h[e].toUpperCase(),1==c&&0<e&&h[e]==_$_b591[18]&&-1==d.indexOf(h[e-1])&&-1==d.indexOf(h[e+1])&&(b+=_$_b591[18]));return b},Z=function(h){return(_$_b591[3]+h).substr(0,1)===_$_b591[18]},ma=function(h){var c=this.options.columns;return c[h]&&c[h].name?c[h].name:h},O=function(h,c,b){var a;if(a=this.options.data[c]){var d=
0<=h?ma.call(this,h):h;typeof b===_$_b591[21]?b=typeof d===_$_b591[22]?a[h]:jSuites.path.call(a,_$_b591[3]+d):(typeof d===_$_b591[22]?a[h]=b:jSuites.path.call(a,_$_b591[3]+d,b),!Z(b)&&this.records[c][h]&&(this.records[c][h].v=b))}else b=null;return b},Q=function(h){return 0==this.config.editable||h&&0==h.options.editable?!1:(h=Ka.call(this))?7<=h?!0:!1:!0},La=function(h){var c=_$_b591[23];if(this.parent)var b=this.parent.config,a=this.parent.element,d=this;else b=this.config,a=this.element,d=u.current?
u.current:null;typeof h===_$_b591[21]&&(h=!a.classList.contains(c));h?(a.classList.add(c),b.fullscreen=!0):(a.classList.remove(c),b.fullscreen=!1);d&&(I.call(d,!0),ia.update.call(d.parent,d))},Ma=function(h){var c=this.loading;null===h&&(h=c.style.display==_$_b591[24]?!0:!1);c.style.display=h?_$_b591[24]:_$_b591[3];setTimeout(function(){c.style.display=_$_b591[3]},1E3)},Ia=function(h,c){if(typeof h===_$_b591[25]){var b=F.getCoordsFromColumnName(h);b=this.records[b[1]][b[0]];if(b.element)h=b.element;
else return typeof c===_$_b591[21]?b.readonly:b.readonly=c?!0:!1}b=_$_b591[26];h=h.classList;if(typeof c===_$_b591[21])return h.contains(b)?!0:!1;c?h.add(b):h.remove(b)},za=function(h){var c=_$_b591[27],b=this.table.classList;if(typeof h==_$_b591[21])return b.contains(c)?!1:!0;h?b.remove(c):b.add(c);I.call(this,!0)},Ka=function(h){if(void 0===h)return this.status;var c=document.createElement(_$_b591[28]);c.style.textAlign=_$_b591[29];c.style.fontSize=_$_b591[30];c.style.cursor=_$_b591[31];c.onclick=
function(){window.location.href=M().host+_$_b591[32]};var b=null,a=[],d=[74,50,48,50,48,33].join(_$_b591[3]);(function(g){b=1;try{if(g){var f=window.atob(g);f=f.split(_$_b591[33]);if(f[1]){f[1]=window.atob(f[1]);var k=f[0];g=d;var l=f[1],n=jSuites.sha512,q=_$_b591[3],p=_$_b591[3];128<g.length&&(g=n(g));for(var v=0;128>v;v++){var x=g[v]?g[v].charCodeAt(0):0;q+=String.fromCharCode(54^x);p+=String.fromCharCode(92^x)}var w=n(p+n(q+l));if(k!=w)b=3;else if(f[1]=JSON.parse(f[1]),f[1].date){var z=window.location.hostname||
_$_b591[34];k=!1;if(-1===z.indexOf(_$_b591[35]))for(var y=0;y<f[1].domain.length;y++)z===f[1].domain[y]&&(k=!0);else for(y=0;y<f[1].domain.length;y++)-1!==z.indexOf(f[1].domain[y])&&z.substr(z.indexOf(f[1].domain[y]))==f[1].domain[y]&&(k=!0);!1===k?b=4:f[1].scope&&0<=f[1].scope.indexOf(_$_b591[36])?(z=new Date,k=parseInt(z.getTime()/1E3),y=M(),f[1].date<k?(b=f[1].date+2592E3<k&&!f[1].plan||f[1].date+15552E3<k?6:7,y.license=f[1].name+_$_b591[37]):(b=8,y.license=_$_b591[38]+f[1].name,y.edition=3==f[1].plan||
6==f[1].plan||31==f[1].plan||33==f[1].plan?_$_b591[39]:_$_b591[5],a=f[1].scope)):b=5}else b=4}else b=2}}catch(C){}})(h);h=_$_b591[3];if(1==b)h=_$_b591[40];else if(2==b||3==b||4==b)h=_$_b591[41];else if(5==b)h=_$_b591[42];else if(6==b||7==b)h=_$_b591[43];c.appendChild(document.createTextNode(h));if(8>b)try{if(typeof sessionStorage!==_$_b591[21]&&!sessionStorage.getItem(_$_b591[44])){sessionStorage.setItem(_$_b591[44],!0);var e=document.createElement(_$_b591[45]);e.src=M().host+_$_b591[46]+_$_b591[47];
e.style.display=_$_b591[48];c.appendChild(e)}}catch(g){}Object.defineProperty(this,_$_b591[49],{value:b,writable:!1,configurable:!1,enumerable:!1,extensible:!1});Object.defineProperty(this,_$_b591[50],{value:M().edition===_$_b591[39]?1:0,writable:!1,configurable:!1,enumerable:!1,extensible:!1});Object.defineProperty(this,_$_b591[51],{get:function(){return a},configurable:!1,enumerable:!1,extensible:!1});return c},I=function(){var h=function(l){-1==this.indexOf(l)&&this.push(l)},c=function(l,n){if(!l||
!n)return!1;var q=l.length;if(q!=n.length)return!1;for(;q--;)if(l[q]!==n[q])return!1;return!0},b=function(l){var n=null,q,p,v=0,x={},w=!1;for(q=0;q<this.options.columns.length;q++)if(-1===l.indexOf(q)){if(pa.attached.call(this,q)){this.headers[q].parentNode.removeChild(this.headers[q]);this.colgroup[q].parentNode.removeChild(this.colgroup[q]);if(this.options.footers)for(p=0;p<this.options.footers.length;p++)this.footers.content[p][q].element&&this.footers.content[p][q].element.parentNode&&this.footers.content[p][q].element.parentNode.removeChild(this.footers.content[p][q].element);
w=!0}for(p=0;p<this.visibleRows.length;p++){var z=this.records[this.visibleRows[p]][q];z.element&&z.element.parentNode&&z.element.parentNode.removeChild(z.element)}}if(this.options.nestedHeaders)for(p=0;p<this.thead.children.length-1;p++)v+=this.thead.children[p].offsetHeight;for(q=0;q<l.length;q++){var y=l[q];var C=Da.create.call(this,y);if(n){if(!C.parentNode){this.headerContainer.insertBefore(C,this.headerContainer.children[n].nextSibling);this.colgroupContainer.insertBefore(this.colgroup[y],this.colgroupContainer.children[n].nextSibling);
if(this.options.footers)for(p=0;p<this.options.footers.length;p++)this.tfoot.children[p].insertBefore(ba.create.call(this,y,p),this.tfoot.children[p].children[n].nextSibling);v&&(C.style.top+=v);w=!0}for(p=0;p<this.visibleRows.length;p++)z=this.visibleRows[p],z=R[_$_b591[54]].call(this,y,z),z.parentNode||this.tbody.children[p].insertBefore(z,this.tbody.children[p].children[n].nextSibling)}else{if(!C.parentNode){this.headerContainer.insertBefore(C,this.headerContainer.children[1]);this.colgroupContainer.insertBefore(this.colgroup[y],
this.colgroupContainer.children[1]);if(this.options.footers)for(p=0;p<this.options.footers.length;p++)this.tfoot.children[p].insertBefore(ba.create.call(this,y,p),this.tfoot.children[p].children[1]);v&&(C.style.top+=v);w=!0}for(p=0;p<this.visibleRows.length;p++)z=this.visibleRows[p],z=R[_$_b591[54]].call(this,y,z),z.parentNode||this.tbody.children[p].insertBefore(z,this.tbody.children[p].children[1])}if(this.options.mergeCells)for(p=0;p<this.visibleRows.length;p++)z=this.visibleRows[p],n=F.getColumnNameFromCoords(y,
z),this.options.mergeCells[n]&&(this.records[z][y].merged||(x[n]=!1));n=Array.prototype.indexOf.call(this.headerContainer.children,C)}v=0;if(this.options.nestedHeaders)for(p=0;p<this.options.nestedHeaders.length;p++){n=null;y=[];z=xa.getColumns.call(this,p);for(q=0;q<l.length;q++)void 0!==z[l[q]]&&-1==y.indexOf(z[l[q]])&&y.push(z[l[q]]);for(q=0;q<this.options.nestedHeaders[p].length;q++)-1==y.indexOf(q)&&this.nested.content[p][q]&&this.nested.content[p][q].element.offsetHeight&&this.nested.content[p][q].element.remove();
for(q=z=0;q<y.length;q++)C=xa.create.call(this,y[q],p),C.parentNode||(n?this.thead.children[p].children[n]?this.thead.children[p].insertBefore(C,this.thead.children[p].children[n].nextSibling):this.thead.children[p].appendChild(C):this.thead.children[p].insertBefore(C,this.thead.children[p].children[1]),C.style.top=v+_$_b591[55],this.options.freezeColumns&&this.options.nestedHeaders[p][y[q]].frozen&&(C.style.left=z+(za.call(this)?50:0)+_$_b591[55],C.classList.add(_$_b591[56]))),z+=C.offsetWidth,n=
Array.prototype.indexOf.call(this.thead.children[p].children,C);v+=this.thead.children[p].offsetHeight}1==w&&(this.table.style.left=g.width.call(this,l[this.options.freezeColumns||0])+_$_b591[55]);qa.batch.call(this,x);this.visibleCols=l},a=function(l){var n=[],q=null,p,v=!1;for(p=0;p<this.tbody.children.length;p++)n.push(this.tbody.children[p]);for(p=0;p<n.length;p++){var x=parseInt(n[p].getAttribute(_$_b591[53]));-1===l.indexOf(x)&&(n[p].parentNode.removeChild(n[p]),v=!0)}for(p=0;p<l.length;p++)n=
ca.create.call(this,l[p]),n.parentNode||(q?this.tbody.insertBefore(n,q.nextSibling):this.tbody.insertBefore(n,this.tbody.firstChild),v=!0),q=n;v&&(this.table.style.top=g.height.call(this,l[0])+_$_b591[55],this.visibleCols=null);this.visibleRows=l},d=function(){var l=[],n=0,q=null;if(I.limited.call(this)){var p=q=0;p=this.content.scrollLeft;var v=p+this.content.offsetWidth;q=this.options.columns;var x=null,w=this.options.freezeColumns||0,z=0;w&&(p+=na.getWidth.call(this,!0));for(n=0;n<q.length;n++)x=
pa.isVisible.call(this,n)?parseInt(q[n].width):0,(z+x>p&&z<=v||n<w)&&h.call(l,n),z+=x;for(n=0;n<l.length;n++)if(p=qa.getAffected.call(this.merged.cols,l[n]))for(q=0;q<p.length;q++)h.call(l,p[q]);for(n=0;n<l.length;n++)if(p=xa.getAffected.call(this,l[n]))for(q=0;q<p.length;q++)this.options.columns[p[q]]&&h.call(l,p[q]);l.sort(function(y,C){return y-C})}else for(q=this.options.columns,n=0;n<q.length;n++)l.push(n);c(l,this.visibleCols)||b.call(this,l)},e=function(){var l=[],n=null,q=0,p=0;q=null;var v=
0;if(I.limited.call(this)&&!this.options.pagination){var x=0,w=0,z=0,y=0;if(n=this.options.frozenRows)for(p=0;p<n;p++)l.push(p);n=this.results?this.results:this.rows;x=this.content.scrollTop;w=x+this.content.offsetHeight;for(p=0;p<n.length;p++)q=this.results?n[p]:p,y=ca.height.call(this,q),z+y>x&&z<w&&l.push(q),z+=y}else for(n=this.results?this.results:this.rows,this.options.pagination?(q=parseInt(this.options.pagination)*this.pageNumber,v=q+parseInt(this.options.pagination),v>n.length&&(v=n.length)):
(q=0,v=n.length),p=q;p<v;p++)q=this.results?n[p]:p,l.push(q);if(this.options.mergeCells){for(p=0;p<l.length;p++)if(this.merged.rows[l[p]]&&(v=qa.getAffected.call(this.merged.rows,l[p])))for(q=0;q<v.length;q++)-1===l.indexOf(v[q])&&l.push(v[q]);l.sort(function(C,r){return C-r})}c(l,this.visibleRows)||a.call(this,l)},g=function(l,n){n&&(this.visibleCols=this.visibleRows=null);g.calculate.call(this);g.update.call(this);if(!0!==l){var q=this;this.content.addEventListener(_$_b591[57],function(){g.ignore||
g.update.call(q)});this.content.addEventListener(_$_b591[58],function(p){if(I.limited.call(q)&&!q.options.pagination){var v=Math.abs(p.deltaX),x=Math.abs(p.deltaY);p.shiftKey||v>x?0>p.deltaX||0>p.deltaY?g.left.call(q):g.right.call(q):0>p.deltaY?g.up.call(q):g.down.call(q);p.preventDefault()}})}};g.calculate=function(){if(I.limited.call(this)){var l=na.getWidth.call(this);this.width=g.width.call(this)+(l?l:1);this.height=g.height.call(this);this.scrollX.style.width=this.width+100+_$_b591[55];this.scrollY.style.height=
this.height+100+_$_b591[55]}};g.update=function(){e.call(this);d.call(this);Ba.update.call(this);na.refresh.call(this);da.refresh.call(this)};g[_$_b591[59]]=function(l,n){null!==l&&(l=g.height.call(this,l),this.content.scrollTop=l);void 0!==n&&null!==n&&(n=g.width.call(this,n),this.content.scrollLeft=n)};g.x=0;g.y=0;g.up=function(l){if(l)this.content.scrollTop=0,g.y=null;else if(this.tbody.firstChild){l=g.y?g.y:g.y=this.tbody.firstChild.getAttribute(_$_b591[53]);for(var n,q=l;0<l;)if(l--,n=this.results?
this.results[l]:l,!this.rows[n]||!1!==this.rows[n].visible){q=n;break}l=q;n=ca.height.call(this,l);ca.attached.call(this,l)||(n+=this.content.scrollTop-this.table.offsetTop);this.content.scrollTop-=n;0<g.y&&g.y--}};g.down=function(l){if(l)this.content.scrollTop=this.content.scrollHeight;else if(this.tbody.firstChild){l=this.tbody.firstChild.getAttribute(_$_b591[53]);for(var n,q=l;l<this.rows.length-1;){n=this.results?this.results[l]:l;if(!this.rows[n]||!1!==this.rows[n].visible){q=n;break}l++}l=ca.height.call(this,
q);this.content.scrollTop+=l}g.y=null};g.left=function(l){var n=this.options.freezeColumns||0;if(l)this.content.scrollLeft=0,g.x=null;else{for(n=l=g.x?g.x:g.x=this.thead.lastChild.children[1+n].getAttribute(_$_b591[52]);0<l;)if(l--,pa.isVisible.call(this,l)){n=l;break}l=n;n=parseInt(this.options.columns[l].width);this.headers[l]&&this.headers[l].parentNode||(n+=this.content.scrollLeft-this.table.offsetLeft);this.content.scrollLeft-=n;0<g.x&&g.x--}};g.right=function(l){var n=this.options.freezeColumns||
0;this.content.scrollLeft=l?this.content.scrollWidth:this.content.scrollLeft+this.thead.lastChild.children[1+n].offsetWidth;g.x=null};var f=function(){g.y=null;for(var l,n=this.content.offsetHeight-this.thead.offsetHeight,q=0,p=0;p<this.tbody.children.length;p++)l=this.tbody.children[p].offsetHeight,n>l&&(q+=l,n-=l);return q},k=function(){g.x=null;for(var l,n=this.content.offsetWidth-na.getWidth.call(this),q=(this.options.freezeColumns||0)+1,p=0,v=0;v<this.thead.lastChild.children.length;v++)l=this.thead.lastChild.children[q].offsetWidth,
n>l&&(p+=l,n-=l);return p};g.pageUp=function(){this.content.scrollTop-=f.call(this)};g.pageDown=function(){this.content.scrollTop+=f.call(this)};g.pageLeft=function(){this.content.scrollLeft-=k.call(this)};g.pageRight=function(){this.content.scrollLeft+=k.call(this)};g.build=function(l){var n=document.createElement(_$_b591[28]);n.className=_$_b591[60]+l;return n};g.width=function(l,n){for(var q=this.options.columns,p=0,v=this.options.freezeColumns||0;v<this.options.columns.length;v++){if(l===v)return p;
pa.isVisible.call(this,v)&&(p+=parseInt(q[v].width));if(p>=n)return v}return n?v:p};g.height=function(l,n){for(var q=0,p=0,v=this.results?this.results:this.rows,x=0;x<v.length;x++){p=x;this.results&&(p=v[x]);if(l===p)return q;this.rows[p]&&!1!==this.rows[p].visible&&(q+=ca.height.call(this,p));if(q>=n)return p}return n?p:q};g.adjust=function(l,n,q){var p=this.records[n][l].element;if(p)if(0==q||2==q){n=0;var v=za.call(this)?50:0;this.options.freezeColumns&&(n=na.getWidth.call(this,!0));n=this.content.scrollLeft+
n;var x=this.content.scrollLeft+(this.content.offsetWidth-v);v=this.table.offsetLeft+p.offsetLeft-v;var w=p.offsetWidth;0==q?v+w<x&&l>this.options.freezeColumns-1&&v<n&&(p.offsetHeight?(q=this.content.scrollLeft+(v-n),g.setX.call(this,q)):g[_$_b591[59]].call(this,null,l)):l>this.options.freezeColumns-1&&(v>n?v+w>x&&(p.parentNode?(q=this.content.scrollLeft+(v+w-x+16),g.setX.call(this,q)):g[_$_b591[59]].call(this,null,l)):g[_$_b591[59]].call(this,null,l))}else l=this.content.scrollTop,x=l+this.content.offsetHeight-
this.thead.offsetHeight-16,v=this.table.offsetTop+p.offsetTop-this.thead.offsetHeight,w=p.offsetHeight,1==q?v+w<x&&(v+4<l?p.offsetHeight?4<l-v&&(q=this.content.scrollTop+(v-l),g.setY.call(this,q)):g[_$_b591[59]].call(this,n):p.offsetHeight||g[_$_b591[59]].call(this,n)):v>l?v+w>x&&(p.parentNode?(q=this.content.scrollTop+(v+w-x),g.setY.call(this,q)):g[_$_b591[59]].call(this,n)):p.offsetHeight||g[_$_b591[59]].call(this,n);else 0==q||2==q?g[_$_b591[59]].call(this,null,l):g[_$_b591[59]].call(this,n)};
g.setX=function(l){g.ignore=!0;this.content.scrollLeft=l;g.ignore=!1};g.setY=function(l){g.ignore=!0;this.content.scrollTop=l;g.ignore=!1};g.limited=function(){return 1==this.options.tableOverflow||1==this.parent.config.fullscreen};return g}(),Na=function(h,c,b,a){var d=c,e=null;if(this.results&&(c=this.results.indexOf(c),-1==c))return d;for(;0<c;){c--;var g=this.results?this.results[c]:c;if(!1!==this.rows[g].visible){var f=this.records[g][h].v===_$_b591[3]?!1:!0;null===e&&(e=f);if(this.records[g][h].element&&
this.records[g][h].element.classList.contains(_$_b591[61])){if(this.records[g][h].merged){d=g-this.records[g][h].merged[1];if(!b)break;f=!0}}else{if(b&&f!==e&&!a)break;if(b)d=this.records[g][h].merged?g-this.records[g][h].merged[1]:g;else return g}e=f}}return d},Oa=function(h,c,b,a){for(var d=this.options.columns,e=h,g,f=null;0<h;)if(h--,!1!==d[h].visible&&d[h].type!==_$_b591[62]){g=!1;this.records[c]&&(g=this.records[c][h].merged?this.records[c-this.records[c][h].merged[1]][h-this.records[c][h].merged[0]].v?
!0:!1:this.records[c][h].v?!0:!1);null===f&&(f=g);if(this.records[c]&&this.records[c][h].element&&this.records[c][h].element.classList.contains(_$_b591[61])){if(this.records[c][h].merged&&(e=h-this.records[c][h].merged[0],!b))break}else{if(b&&g!==f&&!a)break;if(b)e=h;else return h}f=g}return e},Ta=function(){var h=function(b,a,d,e){1==b||3==b?ca.attached.call(this,d)||(0<this.options.pagination?this.page(this.whichPage(d)):1==b?I.up.call(this,e):I.down.call(this,e)):R.attached.call(this,a,d)||(0==
b?I.left.call(this,e):I.right.call(this,e))},c=function(b){b.up=c.up;b.down=c.down;b.right=c.right;b.left=c.left;b.last=c.last;b.first=c.first};c.up=function(b,a,d){if(Array.isArray(this.selectedCell)){if(b)var e=parseInt(this.selectedCell[2]),g=parseInt(this.selectedCell[3]);else e=parseInt(this.selectedCell[0]),g=parseInt(this.selectedCell[1]);d=Na.call(this,e,g,a,d);d!=g&&(g=d,b?(b=this.selectedCell[0],d=this.selectedCell[1]):(b=e,d=g,e=b,g=d),h.call(this,1,e,g,a),fa[_$_b591[11]].call(this,b,d,
e,g),I.adjust.call(this,e,g,1))}};c.down=function(b,a,d){if(Array.isArray(this.selectedCell)){if(b)var e=parseInt(this.selectedCell[2]),g=parseInt(this.selectedCell[3]);else e=parseInt(this.selectedCell[0]),g=parseInt(this.selectedCell[1]);a:{var f=e,k=g,l=k,n=null;if(this.results){k=this.results.indexOf(k);if(-1==k){d=l;break a}var q=this.results.length-1}else q=this.rows.length-1;for(;k<q;){k++;var p=this.results?this.results[k]:k;if(!1!==this.rows[p].visible){var v=this.records[p][f].v===_$_b591[3]?
!1:!0;null===n&&(n=v);if(this.records[p][f].element&&this.records[p][f].element.classList.contains(_$_b591[61])){if(this.records[p][f].merged){if(!this.records[p][f].merged[1]&&(l=p,!a))break;v=!0}}else if(a&&v!==n&&!d){d=l;break a}else if(a)l=p;else{d=p;break a}n=v}}d=l}d!=g&&(g=d,b?(b=this.selectedCell[0],d=this.selectedCell[1]):(b=e,d=g,e=b,g=d),h.call(this,3,e,g,a),fa[_$_b591[11]].call(this,b,d,e,g),I.adjust.call(this,e,g,3))}};c.right=function(b,a,d){if(Array.isArray(this.selectedCell)){if(b)var e=
parseInt(this.selectedCell[2]),g=parseInt(this.selectedCell[3]);else e=parseInt(this.selectedCell[0]),g=parseInt(this.selectedCell[1]);a:{for(var f=e,k=g,l=this.options.columns,n=f,q,p=null;f<l.length-1;)if(f++,!1!==l[f].visible&&l[f].type!==_$_b591[62]){q=!1;this.records[k]&&(q=this.records[k][f].merged?this.records[k-this.records[k][f].merged[1]][f-this.records[k][f].merged[0]].v?!0:!1:this.records[k][f].v?!0:!1);null===p&&(p=q);if(this.records[k]&&this.records[k][f].element&&this.records[k][f].element.classList.contains(_$_b591[61])){if(this.records[k][f].merged&&
f==f+this.records[k][f].merged[0]&&(n=f,!a))break}else if(a&&q!==p&&!d){d=n;break a}else if(a)n=f;else{d=f;break a}p=q}d=n}d!=e&&(e=d,b?(b=this.selectedCell[0],d=this.selectedCell[1]):(b=e,d=g,e=b,g=d),h.call(this,2,e,g,a),fa[_$_b591[11]].call(this,b,d,e,g),I.adjust.call(this,e,g,2))}};c.left=function(b,a,d){if(Array.isArray(this.selectedCell)){if(b)var e=parseInt(this.selectedCell[2]),g=parseInt(this.selectedCell[3]);else e=parseInt(this.selectedCell[0]),g=parseInt(this.selectedCell[1]);d=Oa.call(this,
e,g,a,d);d!=e&&(e=d,b?(b=this.selectedCell[0],d=this.selectedCell[1]):(b=e,d=g,e=b,g=d),h.call(this,0,e,g,a),fa[_$_b591[11]].call(this,b,d,e,g),I.adjust.call(this,e,g,0))}};c.first=function(b,a){Array.isArray(this.selectedCell)&&(a?c.up.call(this,b,!0,!0):c.left.call(this,b,!0,!0))};c.last=function(b,a){Array.isArray(this.selectedCell)&&(a?c.down.call(this,b,!0,!0):c.right.call(this,b,!0,!0))};return c}(),Ua=function(){return function(h){h.save=Pa;h.fullscreen=La;h.setReadOnly=Ia;h.getReadOnly=Ia;
h.isReadOnly=Ia;h.setPlugins=function(c){ta.call(this.parent,c)};h.showIndex=function(){za.call(this,!0)};h.hideIndex=function(){za.call(this,!1)};h[_$_b591[59]]=I[_$_b591[59]];h.undo=function(){V.undo.call(h.parent)};h.redo=function(){V.redo.call(h.parent)};h.isEditable=function(){return Q.call(h.parent,h)};h.dispatch=function(){return G.apply(this.parent,arguments)};h.persistence=K;h.setViewport=function(c,b){this.options.tableOverflow=!0;c=parseInt(c);b=parseInt(b);this.content.classList.add(_$_b591[63]);
150<c&&(this.options.tableWidth=c+_$_b591[55],this.content.style.width=this.options.tableWidth);150<b&&!this.options.pagination&&(this.options.tableHeight=parseInt(b)+_$_b591[55],this.content.style.height=this.options.tableHeight);I.call(this,!0);ia.update.call(this.parent,this);G.call(this.parent,_$_b591[64],c,b)};h.helpers=F}}(),Ea=function(){var h={logo:null,url:null,persistence:!1,sequence:!0,data:null,json:null,rows:[],columns:[],cells:{},role:null,nestedHeaders:null,defaultColWidth:100,defaultRowHeight:0,
defaultColAlign:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],csv:null,csvFileName:_$_b591[44],csvHeaders:!0,csvDelimiter:_$_b591[33],columnSorting:!0,columnDrag:!0,columnResize:!0,rowResize:!0,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!0,selectionCopy:!0,mergeCells:{},search:!1,pagination:!1,paginationOptions:null,textOverflow:!1,
tableOverflow:!1,tableHeight:_$_b591[65],tableWidth:null,resize:null,comments:null,meta:null,style:{},freezeColumns:0,orderBy:null,worksheetId:_$_b591[3],worksheetName:null,worksheetState:null,filters:!1,footers:null,formify:null,applyMaskOnFooters:!1,pluginOptions:null,locked:!1,selectUnLockedCells:!0,selectLockedCells:!0,wrap:!1},c={application:_$_b591[66],cloud:null,root:null,definedNames:{},sorting:null,server:null,toolbar:null,editable:!0,allowExport:!0,includeHeadersOnDownload:!1,forceUpdateOnPaste:!1,
loadingSpin:!1,fullscreen:!1,secureFormulas:!0,parseFormulas:!0,debugFormulas:!1,editorFormulas:!0,autoIncrement:!0,autoCasting:!0,stripHTML:!1,tabs:!1,allowDeleteWorksheet:!0,allowRenameWorksheet:!0,allowMoveWorksheet:!0,moveDownOnEnter:!0,onevent:null,onclick:null,onload:null,onundo:null,onredo:null,onbeforesave:null,onsave:null,onbeforechange:null,onchange:null,onafterchanges:null,oncopy:null,onbeforepaste:null,onpaste:null,onbeforeinsertrow:null,oninsertrow:null,onbeforedeleterow:null,ondeleterow:null,
onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresize:null,onresizerow:null,onresizecolumn:null,onselection:null,onbeforecomments:null,oncomments:null,onbeforesort:null,onsort:null,onfocus:null,onblur:null,onmerge:null,onchangeheader:null,onchangefooter:null,onchangefootervalue:null,onchangenested:null,onchangenestedcell:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,
onbeforechangepage:null,onchangepage:null,onbeforecreateworksheet:null,oncreateworksheet:null,onrenameworksheet:null,ondeleteworksheet:null,onmoveworksheet:null,onopenworksheet:null,onchangerowid:null,onbeforesearch:null,onsearch:null,onbeforefilter:null,onfilter:null,onopenfilter:null,oncreatecell:null,oncreaterow:null,oncreatecolumn:null,onbeforeformula:null,onformulachain:null,onchangereferences:null,onbeforesend:null,onchangedefinednames:null,oninput:null,updateTable:null,contextMenu:null,parseTableFirstRowAsHeader:!1,
parseTableAutoCellType:!1,plugins:null,about:!0,license:null,worksheets:null,validations:null},b=function(e,g){g=JSON.parse(JSON.stringify(g));var f={},k;for(k in g)e&&e.hasOwnProperty(k)?f[k]=e[k]:f[k]=g[k];return f},a=function(e){e&&(typeof e==_$_b591[25]&&(e=JSON.parse(e)),this.options.data=e);this.options.json&&(this.options.data=this.options.json);this.options.data||(this.options.data=[]);e=this.options.columns.length;if(this.options.data&&typeof this.options.data[0]!==_$_b591[21]){var g=this.options.data[0].data&&
0<Object.keys(this.options.data[0].data).length?Object.keys(this.options.data[0].data):Object.keys(this.options.data[0]);g.length>e&&(e=g.length)}this.options.minDimensions[0]>e&&(e=this.options.minDimensions[0]);e||(e=8);for(var f=0;f<e;f++)this.options.columns[f]?this.options.columns[f].type||(this.options.columns[f].type=_$_b591[67]):this.options.columns[f]={type:_$_b591[67]},this.options.columns[f].type==_$_b591[68]&&(this.options.columns[f].type=_$_b591[69],this.options.columns[f].autocomplete=
!0),!this.options.columns[f].name&&g&&g[f]&&Number(g[f])!=g[f]&&(this.options.columns[f].name=g[f]),this.options.columns[f].width||(this.options.columns[f].width=parseInt(this.options.defaultColWidth)+_$_b591[55]),this.options.columns[f].type!=_$_b591[69]||this.options.columns[f].source||(this.options.columns[f].source=[]),this.options.columns[f].type==_$_b591[69]&&this.options.columns[f].url&&jSuites.ajax({url:this.options.columns[f].url,index:f,method:_$_b591[70],dataType:_$_b591[71],worksheet:this,
group:this.parent.name,success:function(k){this.worksheet.options.columns[this.index].source=k}})},d=function(e){e.getConfig=d[_$_b591[54]];e.setConfig=d[_$_b591[11]]};d.spreadsheet=function(e){this.config=b(e,c);1!=this.config.secureFormulas&&console.log(_$_b591[72])};d.worksheet=function(e){var g=this;g.options=b(e,h);g.options.csv?jSuites.ajax({url:g.options.csv,method:_$_b591[70],dataType:_$_b591[67],group:g.parent.name,success:function(f){f=F.parseCSV(f,g.options.csvDelimiter);if(1==g.options.csvHeaders&&
0<f.length)for(var k=f.shift(),l=0;l<k.length;l++)g.options.columns[l]||(g.options.columns[l]={type:_$_b591[67],width:g.options.defaultColWidth}),typeof g.options.columns[l].title===_$_b591[21]&&(g.options.columns[l].title=k[l]);a.call(g,f)}}):g.options.url?jSuites.ajax({url:g.options.url,method:_$_b591[70],dataType:_$_b591[71],group:g.parent.name,success:function(f){a.call(g,f)}}):a.call(g)};d[_$_b591[54]]=function(){return this.options};d[_$_b591[11]]=function(e){typeof e==_$_b591[25]&&(e=JSON.parse(e));
if(this.parent){g=Object.keys(e);for(f=0;f<g.length;f++)typeof h[g[f]]!==_$_b591[21]&&(this.options[g[f]]=e[g[f]]);this.content.style.resize=e.resize?e.resize:_$_b591[3];!0===e.filters?ha.show.call(this):!1===e.filters&&ha.hide.call(this);!0===e.search?ua.show.call(this):!1===e.search&&ua.hide.call(this);!0===e.toolbar?ia.show.call(this.parent):!1===e.toolbar&&ia.hide.call(this.parent);e.minDimensions&&e.minDimensions[0]&&(g=parseInt(e.minDimensions[0])-this.headers.length,0<g&&this.insertColumn(g),
g=parseInt(e.minDimensions[1])-this.rows.length,0<g&&this.insertRow(g));K.call(this,_$_b591[73],{data:JSON.stringify(e)})}else for(var g=Object.keys(e),f=0;f<g.length;f++)typeof c[g[f]]!==_$_b591[21]&&(this.config[g[f]]=e[g[f]])};return d}(),V=function(h){h=function(a){if(1!=this.ignoreHistory)if(this.historyCascade)this.history[this.historyIndex].cascade||(this.history[this.historyIndex].cascade=[]),this.history[this.historyIndex].cascade.push(a);else{var d=++this.historyIndex;this.history=this.history.slice(0,
d+1);this.history[d]=a}};var c=function(a){var d=a.worksheet;if(a.action==_$_b591[74])d.deleteRow(a.insertBefore?a.rowNumber:a.rowNumber+1,a.numOfRows);else if(a.action==_$_b591[75])d.insertRow(a.numOfRows,a.rowNumber,1,a.data),R.setAttributes.call(d,a.attributes);else if(a.action==_$_b591[76])d.deleteColumn(a.insertBefore?a.columnNumber:a.columnNumber+1,a.numOfColumns);else if(a.action==_$_b591[77])d.insertColumn(a.numOfColumns,a.columnNumber,1,a.properties,a.data,a.extra),R.setAttributes.call(d,
a.attributes);else if(a.action==_$_b591[78])d.moveRow(a.newValue,a.oldValue);else if(a.action==_$_b591[79])d.moveColumn(a.newValue,a.oldValue);else if(a.action==_$_b591[80])d.removeMerge(a.newValue,!0),d.setMerge(a.oldValue);else if(a.action==_$_b591[81])d.setMerge(a.oldValue);else if(a.action==_$_b591[82])d.setStyle(a.oldValue,null,null,1);else if(a.action==_$_b591[83])d.setStyle(a.oldValue);else if(a.action==_$_b591[84])d.setWidth(a.column,a.oldValue);else if(a.action==_$_b591[85])d.setHeight(a.row,
a.oldValue);else if(a.action==_$_b591[86])d.setHeader(a.column,a.oldValue);else if(a.action==_$_b591[87])d.setComments(a.oldValue);else if(a.action==_$_b591[88])d.orderBy(a.column,a.direction?0:1,a.oldValue,a.previousState);else if(a.action==_$_b591[89]||a.action==_$_b591[90]||a.action==_$_b591[91]){var e=[];for(var g=0;g<a.records.length;g++){var f={x:a.records[g].x,value:a.records[g].oldValue};void 0!==a.records[g].y&&(f.y=a.records[g].y);a.records[g].oldStyle&&(f.style=a.records[g].oldStyle);e.push(f)}d[a.action](e)}else if(a.action==
_$_b591[92])d.renameWorksheet(a.index,a.oldValue);else if(a.action==_$_b591[93])d.moveWorksheet(a.t,a.f);else if(a.action==_$_b591[94]){e=[];for(g=0;g<a.records.length;g++)e.push({index:a.records[g].index,value:a.records[g].oldValue});d.setDefinedNames(e)}G.call(this,_$_b591[95],d,a)};h.undo=function(){if(0<=this.historyIndex)var a=this.history[this.historyIndex--];if(a){this.ignoreHistory=!0;var d=a.worksheet;d.openWorksheet();c.call(this,a);if(a.cascade&&a.cascade.length)for(var e=0;e<a.cascade.length;e++)c.call(this,
a.cascade[e]);a.selection&&d.updateSelectionFromCoords(a.selection);this.ignoreHistory=!1}};var b=function(a){var d=a.worksheet;if(a.action==_$_b591[74])d.insertRow(a.numOfRows,a.rowNumber,a.insertBefore,a.data);else if(a.action==_$_b591[75])d.deleteRow(a.rowNumber,a.numOfRows);else if(a.action==_$_b591[76])d.insertColumn(a.numOfColumns,a.columnNumber,a.insertBefore,a.properties,a.data);else if(a.action==_$_b591[77])d.deleteColumn(a.columnNumber,a.numOfColumns);else if(a.action==_$_b591[78])d.moveRow(a.oldValue,
a.newValue);else if(a.action==_$_b591[79])d.moveColumn(a.oldValue,a.newValue);else if(a.action==_$_b591[80])d.setMerge(a.newValue);else if(a.action==_$_b591[81])d.removeMerge(a.newValue);else if(a.action==_$_b591[82])d.setStyle(a.newValue,null,null,1);else if(a.action==_$_b591[83])d.resetStyle(a.cells);else if(a.action==_$_b591[84])d.setWidth(a.column,a.newValue);else if(a.action==_$_b591[85])d.setHeight(a.row,a.newValue);else if(a.action==_$_b591[86])d.setHeader(a.column,a.newValue);else if(a.action==
_$_b591[87])d.setComments(a.newValue);else if(a.action==_$_b591[88])d.orderBy(a.column,a.direction,a.newValue);else if(a.action==_$_b591[89]||a.action==_$_b591[90]||a.action==_$_b591[91])d[a.action](a.records);else a.action==_$_b591[92]?d.renameWorksheet(a.index,a.newValue):a.action==_$_b591[93]?d.moveWorksheet(a.f,a.t):a.action==_$_b591[94]&&d.setDefinedNames(a.records);G.call(this,_$_b591[96],d,a)};h.redo=function(){if(this.historyIndex<this.history.length-1)var a=this.history[++this.historyIndex];
if(a){this.ignoreHistory=!0;var d=a.worksheet;d.openWorksheet();b.call(this,a);if(a.cascade&&a.cascade.length)for(var e=0;e<a.cascade.length;e++)b.call(this,a.cascade[e]);a.selection&&d.updateSelectionFromCoords(a.selection);this.ignoreHistory=!1}};h.reset=function(){this.historyIndex=-1;this.history=[]};return h}(),ta=function(){var h=function(c){var b=null;if(Array.isArray(c))b=c;else if(typeof c==_$_b591[97]){b=[];var a=Object.keys(c);for(var d=0;d<a.length;d++)b.push({name:a[d],plugin:c[a[d]],
options:{}})}if(b&&b.length)for(d=0;d<b.length;d++){if(b[d].name&&b[d].plugin){var e=b[d].name;var g=b[d].plugin;var f=b[d].options}typeof g===_$_b591[98]&&(this.plugins[e]=g.call(u,this,f,this.config),typeof g.license==_$_b591[98]&&u.license&&g.license(u.license))}};h.execute=function(c,b){if(this.plugins){var a=Object.keys(this.plugins);if(a.length)for(var d=0;d<a.length;d++)if(typeof this.plugins[a[d]][c]==_$_b591[98]){var e=this.plugins[a[d]][c].apply(this.plugins[a[d]],b);e&&(c==_$_b591[99]&&
(b[4]=e),c==_$_b591[100]&&(b[0]=e))}return b}};h.onevent=function(c){return function(){var b,a,d=this.plugins;if(d){var e=Object.keys(d);if(e.length)for(a=0;a<e.length;a++)if(typeof d[e[a]][c]==_$_b591[98]){var g=d[e[a]][c].apply(d[e[a]],arguments);typeof g!==_$_b591[21]&&(b=g)}}return b}}(_$_b591[101]);return h}(),ja=function(){var h=function(c){c.getEditor=h[_$_b591[54]];c.openEditor=h.open;c.closeEditor=h.close};h[_$_b591[54]]=function(c,b){c=Ja[_$_b591[54]].call(this,c,b);return[c.type&&typeof c.type==
_$_b591[97]?c.type:u.editors[c.type],c]};h.open=function(c,b,a){if(!Q.call(this.parent,this))return!1;if(1!=c.classList.contains(_$_b591[26])){var d=parseInt(c.getAttribute(_$_b591[52])),e=parseInt(c.getAttribute(_$_b591[53]));if(!0===this.options.locked){var g=F.getColumnNameFromCoords(d,e);if(!this.options.cells||!this.options.cells[g]||!1!==this.options.cells[g].locked)return!1}if(g=this.records[e][d].merged)d-=g[0],e-=g[1],c=this.records[e][d].element;if(!R.attached.call(this,d,e)){if(this.results&&
0<this.results.length)return console.error(_$_b591[102]),!1;var f=g=null;pa.attached.call(this,d)||(g=d);ca.attached.call(this,e)||(f=e);I[_$_b591[59]].call(this,f,g)}h.position.call(this,d,e);g=this.parent.input;if(113===a.keyCode||a.type!==_$_b591[103])g.selected=!0;g.innerText=_$_b591[3];G.call(this.parent,_$_b591[104],this,c,d,e);b=1==b?_$_b591[3]:O.call(this,d,e);f=h[_$_b591[54]].call(this,d,e);var k=!0;typeof f[0].openEditor==_$_b591[98]&&(!1===f[0].openEditor(c,b,d,e,this,f[1],a)?k=!1:G.call(this.parent,
_$_b591[105],this,c,d,e,g,f[1]));k&&(1==this.options.textOverflow&&(this.records[e][d].element.style.overflow=_$_b591[62],0<d&&(this.records[e][d-1].element.style.overflow=_$_b591[62])),this.edition=c,g.classList.add(_$_b591[106]),1==this.parent.config.editorFormulas&&Z(b)&&(g.classList.add(_$_b591[107]),oa.parse.call(this,g),c=document.createTextNode(_$_b591[3]),g.appendChild(c),jSuites.focus(g)))}};h.close=function(c,b){null===c&&(c=this.edition);this.parent.input.classList.contains(_$_b591[107])&&
oa.close.call(this,this.parent.input);var a,d=parseInt(c.getAttribute(_$_b591[52])),e=parseInt(c.getAttribute(_$_b591[53]));1==this.options.textOverflow&&(a=this.records[e][d+1])&&a.element&&a.element.innerText==_$_b591[3]&&(this.records[e][d].element.style.overflow=_$_b591[3]);a=h[_$_b591[54]].call(this,d,e);if(1==b){var g=null;typeof a[0].closeEditor==_$_b591[98]&&(a=a[0].closeEditor(c,!0,d,e,this,a[1]),void 0!==a&&(g=a));null!==g&&O.call(this,d,e)!=g&&this.setValue(c,g)}else a[0].closeEditor(c,
!1,d,e,this,a[1]);G.call(this.parent,_$_b591[108],this,c,d,e,g,b);a=this.parent.input;a.selected=!1;a.onblur&&(a.onblur=null);a.children[0]&&a.children[0].onblur&&(a.children[0].onblur=null);a.update&&(a.update=null);ja.build(this.parent);a.removeAttribute(_$_b591[109]);a.removeAttribute(_$_b591[110]);a.removeAttribute(_$_b591[111]);this.edition=a.mask=null;this.refreshBorders()};h.position=function(c,b){var a=null;if(a=this.records[b][c].element){var d=this.parent.element.getBoundingClientRect();
a=a.getBoundingClientRect();var e=this.parent.input;e.x=c;e.y=b;0==a.width&&0==a.height?e.style.opacity=_$_b591[112]:(e.setAttribute(_$_b591[113],_$_b591[3]),c=a.top-d.top+1,b=a.left-d.left+1,e.style.top=c+_$_b591[55],e.style.left=b+_$_b591[55],e.style.minWidth=a.width-1+_$_b591[55],e.style.minHeight=a.height-1+_$_b591[55],setTimeout(function(){e.focus()},0))}};h.build=function(c){c.input||(c.input=document.createElement(_$_b591[28]));c.input.className=_$_b591[114];c.input.setAttribute(_$_b591[115],
!0);c.input.innerText=_$_b591[3];c.input.oninput=function(b){u.current&&(1==u.current.parent.config.editorFormulas&&(Z(b.target.innerText)?(b.target.classList.add(_$_b591[107]),b.target.selected=!0):b.target.classList.contains(_$_b591[107])&&oa.close.call(u.current,this)),G.call(u.current.parent,_$_b591[116],u.current,b))};c.input.onclick=function(){this.selected=!0};return c.input};return h}(),G=function(h){var c;if(!this.ignoreEvents){if(typeof this.config.onevent==_$_b591[98]){var b=this.config.onevent.apply(this,
arguments);typeof b!==_$_b591[21]&&(c=b)}typeof this.config[h]==_$_b591[98]&&(b=this.config[h].apply(this,Array.prototype.slice.call(arguments,1)),typeof b!==_$_b591[21]&&(c=b));b=ta.onevent.apply(this,arguments);typeof b!==_$_b591[21]&&(c=b)}return c},wa=function(){var h=function(c){c.sequence=0;c.getNextSequence=h.next;c.getRowId=h.getId;c.setRowId=h.setId;c.getRowById=h.getRowById};h[_$_b591[54]]=function(){return this.sequence};h[_$_b591[11]]=function(c,b){if(c>this.sequence||b)this.sequence=
c};h.next=function(){return 1==this.options.sequence?++this.sequence:null};h.reset=function(){this.sequence=0};h.getId=function(c){if(this.rows[c]&&this.rows[c].id)return this.rows[c].id;var b=this.getPrimaryKey();if(!1!==b)return O.call(this,b,c)};h.setId=function(c,b){if(void 0!==b&&0<=parseInt(c)){var a={};a[c]=b}else a=c;c=Object.keys(a);if(c.length){for(var d=0;d<c.length;d++)b=a[c[d]],this.rows[c[d]].id=b,h[_$_b591[11]].call(this,b);K.call(this,_$_b591[117],[a]);G.call(this.parent,_$_b591[118],
this,a)}};h.getRowById=function(c,b){for(var a=0;a<this.rows.length;a++)if(h.getId.call(this,a)==c)return!0===b?this.rows[a]:this.options.data[a];return!1};return h}(),Pa=function(){var h=function(b){for(var a=[],d={},e=0;e<b.length;e++){var g=b[e].x,f=b[e].y,k=wa.getId.call(this,f);if(!k)if(d[f])k=d[f];else if(k=wa.next.call(this))d[f]=k;a[f]||(a[f]={id:k,row:f,data:{}});g=ma.call(this,g);a[f].data[g]=b[e].value}wa.setId.call(this,d);return a.filter(function(l){return null!=l})},c=function(b){var a=
b[0];if(0<=[_$_b591[119],_$_b591[120],_$_b591[117],_$_b591[121]].indexOf(a))return!1;var d={};a==_$_b591[89]||a==_$_b591[122]?(a=_$_b591[123],d[a]=h.call(this,b[1].data)):Array.isArray(b[1])&&1==b[1].length?d[a]=b[1][0]:d[a]=b[1];return d};return function(b,a,d,e){var g=this.parent,f=this,k=c.call(this,a);if(k)a=k;else if(!1===k)return!1;if(k=G.call(g,_$_b591[124],g,f,a))a=k;else if(!1===k)return!1;Ma.call(g,!0);jSuites.ajax({url:b,method:_$_b591[125],dataType:_$_b591[71],data:{data:JSON.stringify(a)},
queue:!0,beforeSend:function(l){d&&l.setRequestHeader(_$_b591[126],_$_b591[127]+d);G.call(g,_$_b591[128],f,l)},success:function(l){g.element.classList.contains(_$_b591[129])&&g.element.classList.remove(_$_b591[129]);l&&(l.message&&(l.name=g.config.application,jSuites.notification.isVisible()?console.log(l.name+_$_b591[130]+l.message):jSuites.notification(l)),l.success?typeof e===_$_b591[98]?e(l):l.data&&Array.isArray(l.data)&&R.updateAll.call(f,l.data):l.error&&(alert(_$_b591[131]),window.open(window.location.href,
_$_b591[132])));G.call(g,_$_b591[133],g,f,a,l)},error:function(){g.element.classList.add(_$_b591[129])}})}}(),K=function(){return function(){ta.execute.call(this.parent,_$_b591[134],[this,arguments[0],arguments[1]]);if(!this.parent.ignorePersistence){var h=null;if(this.parent.config.server){var c=this.parent.worksheets.indexOf(this);h=this.parent.config.server;h=-1==h.indexOf(_$_b591[135])?h+(_$_b591[136]+c):h+(_$_b591[137]+c)}else this.options.persistence&&(h=typeof this.options.persistence==_$_b591[25]?
this.options.persistence:this.options.url);h&&Pa.call(this,h,arguments)}}}(),Fa=function(h){if(this.selectedCell){var c=this.selectedCell[0],b=this.selectedCell[1];this.records&&this.records[b]&&this.records[b][c]&&this.records[b][c].element||(this.selectedCell=this.getHighlighted(),c=this.selectedCell[0],b=this.selectedCell[1]);var a=this.getHighlighted(),d=a[0],e=a[1],g=a[2];a=a[3];var f=h?_$_b591[138]:_$_b591[139];this.records[b]&&this.records[b][c]&&this.records[b][c].element&&(this.records[b][c].element.classList[f](_$_b591[140]),
this.cursor=h?this.records[b][c].element:null);for(h=d;h<=g;h++)if(this.headers[h])this.headers[h].classList[f](_$_b591[141]);for(;e<=a;e++)if(this.rows[e]&&this.rows[e].element)this.rows[e].element.classList[f](_$_b591[141])}},fa=function(){var h=function(c){c.resetSelection=h.reset;c.updateSelection=h.fromElements;c.updateSelectionFromCoords=h[_$_b591[11]];c.selectAll=h.all;c.isSelected=h.isSelected;c.getHighlighted=h.getHighlighted;c.getRange=h.getRange};h.getHighlighted=function(){var c=this.borders;
return(c=c.main)?[c.x1,c.y1,c.x2,c.y2]:null};h.isSelected=function(c,b,a){if(!a&&(a=this.getHighlighted(),!a))return!1;var d=a[0],e=a[1],g=a[2];a=a[3];g||(g=d);a||(a=e);return null==c?b>=e&&b<=a:null==b?c>=d&&c<=g:c>=d&&c<=g&&b>=e&&b<=a};h.reset=function(){if(this.selectedCell)c=1,this.edition&&ja.close.call(this,this.edition,!0),this.resetBorders(_$_b591[142],!0),this.resetBorders(_$_b591[143],!0),this.selectedCell=null,1==c&&G.call(this.parent,_$_b591[144],this);else var c=0;return c};h.refresh=
function(){this.selectedCell&&h[_$_b591[11]].call(this,this.selectedCell)};h.isValid=function(c,b,a,d){if(!this)return!1;Array.isArray(c)&&(d=c[3],a=c[2],b=c[1],c=c[0]);return!(c>=this.options.columns.length||b>=this.rows.length||a>=this.options.columns.length||d>=this.rows.length)};h[_$_b591[11]]=function(c,b,a,d,e,g,f){g||(g=_$_b591[142]);Array.isArray(c)&&(d=c[3],a=c[2],b=c[1],c=c[0]);null==a&&(a=c);null==d&&(d=b);if(!h.isValid.call(this,c,b,a,d))return!1;if(null!=c){if(parseInt(c)<parseInt(a))var k=
parseInt(c),l=parseInt(a);else k=parseInt(a),l=parseInt(c);if(parseInt(b)<parseInt(d))var n=parseInt(b),q=parseInt(d);else n=parseInt(d),q=parseInt(b);var p;var v={};if(this.options.mergeCells){for(var x=n;x<=q;x++)for(var w=k;w<=l;w++)if(p=this.records[x][w].merged)p=F.getColumnNameFromCoords(w-p[0],x-p[1]),v[p]=!0;x=Object.keys(v);if(x.length)for(w=0;w<x.length;w++)p=F.getCoordsFromColumnName(x[w]),v=this.options.mergeCells[x[w]],p[0]<k&&(k=p[0]),p[0]+v[0]-1>l&&(l=p[0]+v[0]-1),p[1]<n&&(n=p[1]),
p[1]+v[1]-1>q&&(q=p[1]+v[1]-1)}}g==_$_b591[142]&&(this.selectedCell?(Fa.call(this,!1),p=1):p=0,this.selectedCell=[c,b,a,d],this.records[d][a].element&&e&&(w=e.target.getAttribute(_$_b591[52]),v=e.target.getAttribute(_$_b591[53]),null!==w&&null!==v&&(I.adjust.call(this,a,d,3),I.adjust.call(this,a,d,2),I.adjust.call(this,a,d,1),I.adjust.call(this,a,d,0))),ja.position.call(this,c,b),0==p&&G.call(this.parent,_$_b591[145],this));da[_$_b591[11]].call(this,k,n,l,q,g,f);g==_$_b591[142]&&(G.call(this.parent,
_$_b591[146],this,k,n,l,q,e),ia.update.call(this.parent,this,this.selectedCell))};h.fromElements=function(c,b,a){var d=c.getAttribute(_$_b591[52]);c=c.getAttribute(_$_b591[53]);if(b){var e=b.getAttribute(_$_b591[52]);b=b.getAttribute(_$_b591[53])}else e=d,b=c;h[_$_b591[11]].call(this,d,c,e,b,a)};h.all=function(){h[_$_b591[11]].call(this,0,0,this.options.columns.length-1,this.records.length-1)};h.getRange=function(){var c=this.selectedCell;if(!c)return _$_b591[3];var b=F.getColumnNameFromCoords(c[0],
c[1]);c=F.getColumnNameFromCoords(c[2],c[3]);var a=this.options.worksheetName;a=-1!=a.indexOf(_$_b591[147])?_$_b591[148]+a+_$_b591[149]:a+_$_b591[19];return b==c?a+b:a+F.getRangeFromTokens(u.helpers.getTokensFromRange(b+_$_b591[150]+c))};return h}(),da=function(){var h=function(a){a.borders=[];a.setBorder=h[_$_b591[11]];a.getBorder=h[_$_b591[54]];a.resetBorders=h.reset;a.refreshBorders=h.refresh};h[_$_b591[54]]=function(a){return this.borders[a]};var c=function(a,d,e,g,f,k){if(!fa.isValid.call(this,
a,d,e,g))return!1;var l=!1,n=null,q=null,p=null,v=null,x=null,w=this.options.freezeColumns||0;f||(f=0);this.borders[f]?n=this.borders[f]:(n={},n.element=document.createElement(_$_b591[28]),n.element.classList.add(_$_b591[151]),f==_$_b591[143]||f==_$_b591[152]||f==_$_b591[142]?n.element.classList.add(_$_b591[153]+f):(k=k?k:jSuites.randomColor(!0),n.color=k,n.element.style.backgroundColor=k+_$_b591[154],n.element.style.borderColor=k),f==_$_b591[142]&&(w=function(C,r){n[C]=document.createElement(_$_b591[28]);
n[C].classList.add(_$_b591[155]);n[C].setAttribute(_$_b591[156],r);n.element.appendChild(n[C]);!1===_$_b591[157]in document.documentElement&&(n[C].style.display=_$_b591[48])},w(_$_b591[158],0),n.moveLeft.style.left=_$_b591[159],n.moveLeft.style.marginTop=_$_b591[160],n.moveLeft.style.marginLeft=_$_b591[160],w(_$_b591[161],1),n.moveTop.style.left=_$_b591[159],n.moveTop.style.marginTop=_$_b591[160],n.moveTop.style.marginLeft=_$_b591[160],w(_$_b591[162],2),n.moveRight.style.right=_$_b591[159],n.moveRight.style.marginTop=
_$_b591[160],n.moveRight.style.marginRight=_$_b591[160],w(_$_b591[163],3),n.moveDown.style.bottom=_$_b591[159],n.moveDown.style.marginLeft=_$_b591[160],n.moveDown.style.marginBottom=_$_b591[160]),this.content.appendChild(n.element));n.x1=a;n.y1=d;n.x2=e;n.y2=g;n.element.style.top=_$_b591[164];n.element.style.left=_$_b591[164];n.active=0;w=[];for(k=a;k<=e;k++)w.push(k);w=this.options.freezeColumns||0;k=this.visibleRows[0];var z=this.visibleRows[this.visibleRows.length-1],y=this.visibleCols[w];a>this.visibleCols[this.visibleCols.length-
1]||g<k||d>z||e<y&&a>=w||(q=this.headers[a]&&this.headers[a].parentNode?this.headers[a].offsetLeft:0,this.headers[e]&&this.headers[e].parentNode?(pa.isVisible.call(this,e)||(e=Oa.call(this,e,g)),p=this.headers[e].offsetLeft):(p=this.thead.lastChild.lastChild.getAttribute(_$_b591[52]),p=w&&e<p?this.thead.lastChild.children[this.options.freezeColumns].offsetLeft:this.thead.lastChild.lastChild.offsetLeft),p=p-q+parseInt(this.options.columns[e].width)-1,q+=this.table.offsetLeft,v=this.rows[d].element&&
this.rows[d].element.parentNode?this.rows[d].element.offsetTop:0,this.rows[g].element&&this.rows[g].element.parentNode?(!1===this.rows[g].visible&&(g=Na.call(this,e,g)),x=this.rows[g].element.offsetTop+this.rows[g].element.offsetHeight,n.element.style.borderBottomWidth=_$_b591[3]):(x=this.tbody.lastChild?this.tbody.lastChild.offsetTop+this.tbody.lastChild.offsetHeight:0,l=!0,n.element.style.borderBottomWidth=_$_b591[159]),x=x-v-1,v+=this.table.offsetTop,this.options.freezeColumns&&(n.element.style.borderLeftWidth=
_$_b591[3],n.element.style.borderRightWidth=_$_b591[3],d=na.getWidth.call(this),a=a<this.options.freezeColumns,e=e<this.options.freezeColumns,a&&e||(a&&!e?(e=this.content.scrollLeft+d,e>q+p&&(p+=e-(q+p),n.element.style.borderRightWidth=_$_b591[159])):(e=this.content.scrollLeft+d,e>q&&(e-=q,e>p?q=v=-2E3:(q=q+e+1,p-=e,n.element.style.borderLeftWidth=_$_b591[159]))))),n.element.style.top=v+_$_b591[55],n.element.style.left=q+_$_b591[55],n.element.style.width=p+_$_b591[55],n.element.style.height=x+_$_b591[55],
n.t=v,n.l=q,n.w=p,n.h=x,f==_$_b591[142]&&(n.moveLeft.style.top=n.h/2+_$_b591[55],n.moveRight.style.top=n.h/2+_$_b591[55],n.moveTop.style.left=n.w/2+_$_b591[55],n.moveDown.style.left=n.w/2+_$_b591[55]),n.active=1);f==_$_b591[142]&&(l?(this.corner.style.top=_$_b591[164],this.corner.style.left=_$_b591[164]):(this.corner.style.top=v+x-2+_$_b591[55],this.corner.style.left=q+p-2+_$_b591[55]));this.borders[f]=n},b=function(a,d){a.element.style.top=_$_b591[164];a.element.style.left=_$_b591[164];a.active=
0;d&&(a.x1=null,a.y1=null,a.x2=null,a.y2=null)};h[_$_b591[11]]=function(a,d,e,g,f,k){c.call(this,a,d,e,g,f,k);f==_$_b591[142]&&(Fa.call(this,!0),K.call(this,_$_b591[119],{x1:a,y1:d,x2:e,y2:g}))};h.reset=function(a,d){a&&a!=_$_b591[142]||(this.corner.style.top=_$_b591[164],this.corner.style.left=_$_b591[164],Fa.call(this,!1));if(a)this.borders[a]&&b(this.borders[a],d);else for(var e=Object.keys(this.borders),g=0;g<e.length;g++)b(this.borders[e[g]],d);a&&a!=_$_b591[142]||K.call(this,_$_b591[120])};
h.refresh=function(a){var d=this.borders;if(a)d[a]&&null!=d[a].x1&&c.call(this,d[a].x1,d[a].y1,d[a].x2,d[a].y2,a);else{a=Object.keys(d);for(var e=0;e<a.length;e++)d[a[e]]&&null!=d[a[e]].x1&&c.call(this,d[a[e]].x1,d[a[e]].y1,d[a[e]].x2,d[a[e]].y2,a[e])}this.edition&&(d=this.parent.input,ja.position.call(this,d.x,d.y))};h.destroy=function(a){var d;this&&(d=this.borders[a])&&(d.element.remove(),delete this.borders[a])};return h}(),Va=function(){var h=function(c){c.setGroup=h[_$_b591[11]];c.unsetGroup=
h.unset};h[_$_b591[11]]=function(c,b,a){0==c&&(a=document.createElement(_$_b591[165]),a.classList.add(_$_b591[166]),this.thead.insertBefore(a,this.thead.firstChild),c=document.createElement(_$_b591[167]),c.innerHTML=_$_b591[168],a.appendChild(c),c=document.createElement(_$_b591[167]),a.appendChild(c),b=this.headers[b])&&(b=b.querySelector(_$_b591[169]),b||(b=document.createElement(_$_b591[28]),b.classList.add(_$_b591[170]),b.innerText=_$_b591[171],c.appendChild(b)))};h.unset=function(c,b){};return h}(),
Aa=function(){var h={start:function(c){if(!Q.call(this.parent,this))return!1;if(null!==c.target.getAttribute(_$_b591[53])){var b=c.target.getAttribute(_$_b591[53]);h.event={y:parseInt(b),h:c.target.offsetHeight,p:c.pageY}}else null!==c.target.getAttribute(_$_b591[52])&&(b=c.target.getAttribute(_$_b591[52]),h.event={x:parseInt(b),w:c.target.offsetWidth,p:c.pageX})},end:function(c){var b=[];if(null!=h.event.y){var a=parseInt(this.rows[h.event.y].element.offsetHeight);var d=this.getSelectedRows(!0);
c=d.indexOf(parseInt(h.event.y));if(d.length&&-1<c)for(var e=0;e<d.length;e++)b.push(parseInt(this.rows[d[e]].element.offsetHeight));else d=[];-1==c?(d.push(h.event.y),b.push(h.event.h)):b[c]=h.event.h;this.setHeight(d,a,b)}else if(null!=h.event.x){a=parseInt(this.colgroup[h.event.x].getAttribute(_$_b591[172]));d=this.getSelectedColumns();c=d.indexOf(parseInt(h.event.x));if(d.length&&-1<c)for(e=0;e<d.length;e++)b.push(parseInt(this.options.columns[d[e]].width));else d=[];-1==c?(d.push(h.event.x),
b.push(h.event.w)):b[c]=h.event.w;this.setWidth(d,a,b)}h.event=null},update:function(c){null!=h.event.y?(c=c.pageY-h.event.p,0<h.event.h+c&&(this.rows[h.event.y].element.style.height=h.event.h+c+_$_b591[55],this.refreshBorders())):null!=h.event.x&&(c=c.pageX-h.event.p,0<h.event.w+c&&(this.colgroup[h.event.x].setAttribute(_$_b591[172],h.event.w+c),this.options.columns[h.event.x].width=h.event.w+c,0<this.options.freezeColumns&&na.getWidth.call(this),this.refreshBorders()))},cancel:function(){h.end.call(this)}};
return h}(),Qa=function(){var h={start:function(c){var b=this.parent.helper;c=parseInt(c.target.getAttribute(_$_b591[52]));if(this.merged.cols[c])console.error(_$_b591[173]);else{h.event={x:c,d:c};this.headers[c].classList.add(_$_b591[174]);for(var a=0;a<this.tbody.children.length;a++){var d=this.tbody.children[a].getAttribute(_$_b591[53]);this.records[d][c].element.classList.add(_$_b591[174])}a=this.parent.element.getBoundingClientRect();c=this.headers[c].getBoundingClientRect();d=this.content.getBoundingClientRect();
b.style.display=_$_b591[24];b.style.top=d.top-a.top+_$_b591[55];b.style.left=c.left-d.left+_$_b591[55];b.style.width=_$_b591[175];b.style.height=d.height+_$_b591[55];b.classList.add(_$_b591[176])}},end:function(){this.headers[h.event.x].classList.remove(_$_b591[174]);for(var c=0;c<this.tbody.children.length;c++){var b=this.tbody.children[c].getAttribute(_$_b591[53]);this.records[b][h.event.x].element.classList.remove(_$_b591[174])}null!=h.event.d&&h.event.x!=h.event.d&&(this.moveColumn(h.event.x,
h.event.d),this.refreshBorders());this.parent.helper.classList.remove(_$_b591[176]);this.parent.helper.style.display=_$_b591[3];h.event=null},cancel:function(){h.event.d=null;h.end.call(this)},update:function(c){var b=c.target.getAttribute(_$_b591[52]);if(null!=b)if(b=parseInt(b),this.merged.cols[b])console.error(_$_b591[173]);else{c=c.target.clientWidth/2>c.offsetX;h.event.d=c?h.event.x<b?parseInt(b)-1:parseInt(b):h.event.x>b?parseInt(b)+1:parseInt(b);b=this.headers[b].getBoundingClientRect();var a=
this.content.getBoundingClientRect();this.parent.helper.style.left=(c?b.left:b.right)-a.left+_$_b591[55]}}};return h}(),va=function(){var h={start:function(c){if(Q.call(this.parent,this)){this.resetSelection();var b=this.parent.helper;if(null!==c.target.getAttribute(_$_b591[53])){var a=parseInt(c.target.getAttribute(_$_b591[53]));this.merged.rows[a]?console.error(_$_b591[177]):this.results?console.error(_$_b591[178]):(h.event={y:a,d:a},this.rows[a].element.classList.add(_$_b591[174]),c=this.parent.element.getBoundingClientRect(),
a=this.rows[a].element.getBoundingClientRect(),b.style.display=_$_b591[24],b.style.top=a.top-c.top+_$_b591[55],b.style.left=_$_b591[179],b.style.width=this.content.offsetWidth-50+_$_b591[55],b.style.height=_$_b591[175],b.classList.add(_$_b591[180]))}else if(null!==c.target.getAttribute(_$_b591[52]))if(a=parseInt(c.target.getAttribute(_$_b591[52])),this.merged.cols[a])console.error(_$_b591[173]);else{h.event={x:a,d:a};this.headers[a].classList.add(_$_b591[174]);for(c=0;c<this.tbody.children.length;c++){var d=
this.tbody.children[c].getAttribute(_$_b591[53]);this.records[d][a].element.classList.add(_$_b591[174])}c=this.parent.element.getBoundingClientRect();a=this.headers[a].getBoundingClientRect();d=this.content.getBoundingClientRect();b.style.display=_$_b591[24];b.style.top=d.top-c.top+_$_b591[55];b.style.left=a.left-d.left+_$_b591[55];b.style.width=_$_b591[175];b.style.height=d.height+_$_b591[55];b.classList.add(_$_b591[176])}}else return!1},end:function(){if(null!=h.event.y)this.rows[h.event.y].element.classList.remove(_$_b591[174]),
null!=h.event.d&&h.event.y!=h.event.d&&(this.moveRow(h.event.y,h.event.d),this.updateSelectionFromCoords(0,h.event.d,this.options.columns.length-1,h.event.d)),this.parent.helper.classList.remove(_$_b591[180]);else if(null!=h.event.x){this.headers[h.event.x].classList.remove(_$_b591[174]);for(var c=0;c<this.tbody.children.length;c++){var b=this.tbody.children[c].getAttribute(_$_b591[53]);this.records[b][h.event.x].element.classList.remove(_$_b591[174])}null!=h.event.d&&h.event.x!=h.event.d&&(this.moveColumn(h.event.x,
h.event.d),this.refreshBorders());this.parent.helper.classList.remove(_$_b591[176])}this.parent.helper.style.display=_$_b591[3];h.event=null},cancel:function(){h.event.d=null;h.end.call(this)},update:function(c){if(null!=h.event.y){var b=c.target.getAttribute(_$_b591[53]);if(null!=b){var a=b=parseInt(b),d=c.target.clientHeight/2>c.offsetY;d?h.event.y<b&&(a=b-1):h.event.y>b&&(a=b+1);c=!1;this.merged.rows[a]&&(h.event.y>a?this.merged.rows[a-1]&&(c=!0):this.merged.rows[a+1]&&(c=!0));c||(h.event.d=a,
a=this.parent.element.getBoundingClientRect(),b=this.rows[b].element.getBoundingClientRect(),this.parent.helper.style.top=(d?b.top:b.bottom)-a.top+_$_b591[55])}}else d=c.target.getAttribute(_$_b591[52]),null!=d&&(a=d=parseInt(d),(b=c.target.clientWidth/2>c.offsetX)?h.event.x<d&&(a=d-1):h.event.x>d&&(a=d+1),c=!1,this.merged.cols[a]&&(h.event.x>a?this.merged.cols[a-1]&&(c=!0):this.merged.cols[a+1]&&(c=!0)),c||(h.event.d=a,a=this.headers[d].getBoundingClientRect(),d=this.content.getBoundingClientRect(),
this.parent.helper.style.left=(b?a.left:a.right)-d.left+_$_b591[55]))}};return h}(),qa=function(){var h=function(c){c.getMerge=h[_$_b591[54]];c.setMerge=h[_$_b591[11]];c.updateMerge=h.update;c.removeMerge=h.remove;c.destroyMerged=c.destroyMerge=h.destroy};h.isMerged=function(c,b){var a=F.getColumnNameFromCoords(c,b);if(a=this.merged.cells[a])if(i=this.options.mergeCells[a])m&&void 0!==m[a]||(i[1]>t&&(t=i[1]),m&&(m[a]=this.records[b][c].element&&!this.records[b][c].merged?!0:!1))};h.getAffected=function(c){if(void 0!==
this[c]){for(var b=c,a=this[c],d=[];this[b]==a;)d.push(b),b--;for(b=c+1;this[b]==a;)d.push(b),b++;d.sort(function(e,g){return e-g});return d}return!1};h[_$_b591[54]]=function(c){return c?this.options.mergeCells[c]:this.options.mergeCells};h[_$_b591[11]]=function(c,b,a){if(!Q.call(this.parent,this))return!1;this.options.mergeCells||(this.options.mergeCells={});var d,e=null,g={},f={},k={},l=!1;typeof c==_$_b591[25]?k[c]=[b,a]:typeof c==_$_b591[97]?k=c:((e=this.getHighlighted())?e=[F.getColumnNameFromCoords(e[0],
e[1]),e[2]-e[0]+1,e[3]-e[1]+1]:(jSuites.notification({message:E(_$_b591[181])}),e=!1),e&&(k[e[0]]=[e[1],e[2]]));b=Object.keys(k);if(b.length){for(a=0;a<b.length;a++){var n=b[a],q=k[b[a]][0],p=k[b[a]][1];q=parseInt(q);p=parseInt(p);if((!q||2>q)&&(!p||2>p))console.log(E(_$_b591[182])+_$_b591[150]+n);else if(this.options.mergeCells[n])f[n]=[q,p],g[n]=this.options.mergeCells[n],h.update.call(this,n,q,p);else{e=F.getCoordsFromColumnName(n);for(var v=e[1];v<e[1]+p;v++)for(var x=e[0];x<e[0]+q;x++)c=F.getColumnNameFromCoords(x,
v),(d=this.merged.cells[c])&&this.options.mergeCells[d]&&(g[d]=this.options.mergeCells[d],h.applyDestroy.call(this,d));f[n]=this.options.mergeCells[n]=[q,p];h.applyCreate.call(this,n);R.attached.call(this,e[0],e[1])||(l=e)}}Object.keys(f).length&&(l&&I[_$_b591[59]].call(this,e[1],e[0]),V.call(this.parent,{worksheet:this,action:_$_b591[80],newValue:f,oldValue:g}),K.call(this,_$_b591[80],[f]),h.build.call(this),fa.refresh.call(this),da.refresh.call(this),G.call(this.parent,_$_b591[183],this,f,g))}};
h.update=function(c,b,a){var d=this.options.mergeCells;if(d[c]){var e=d[c][1];if(b!==d[c][0]||e!==a)h.applyDestroy.call(this,c),b&&a&&(d[c]=[b,a],h.applyCreate.call(this,c));h.build.call(this)}};h.remove=function(c,b){if(!Q.call(this.parent,this))return!1;b={};var a={},d={};typeof c==_$_b591[25]?d[c]=!0:typeof c==_$_b591[97]&&(d=c);c=Object.keys(d);for(d=0;d<c.length;d++)this.options.mergeCells[c[d]]&&(b[c[d]]=this.options.mergeCells[c[d]],a[c[d]]=!0,h.applyDestroy.call(this,c[d],!0));h.build.call(this);
V.call(this.parent,{worksheet:this,action:_$_b591[81],newValue:a,oldValue:b});K.call(this,_$_b591[81],{data:a})};h.destroy=function(){h.remove.call(this,this.options.mergeCells,!0)};h.applyCreate=function(c,b){var a=this.options.mergeCells;if(a[c]){var d=a[c][0]||1,e=a[c][1]||1;c=F.getCoordsFromColumnName(c);if(!this.records[c[1]][c[0]].merged||1==b)if(a=R[_$_b591[54]].call(this,c[0],c[1])){a.classList.remove(_$_b591[61]);a.style.display=_$_b591[3];1<d?a.setAttribute(_$_b591[184],d):a.removeAttribute(_$_b591[184]);
1<e?a.setAttribute(_$_b591[185],e):a.removeAttribute(_$_b591[185]);1==this.options.textOverflow&&(a.style.overflow=_$_b591[62]);for(var g=0;g<e;g++)for(var f=0;f<d;f++){b=c[0]+f;var k=c[1]+g;if(a=this.records[k][b])if(a.merged=[f,g,a.v,d,e],0!=f||0!=g)a.element||R[_$_b591[54]].call(this,b,k),a.element.classList.add(_$_b591[61]),a.merged[3]=a.element.innerText,a.element.innerText=_$_b591[3],O.call(this,b,k,_$_b591[3])}}}};h.applyDestroy=function(c,b){var a=this.options.mergeCells;if(a[c]){var d=F.getCoordsFromColumnName(c),
e=d[0];d=d[1];var g=a[c][0],f=a[c][1];delete this.options.mergeCells[c];for(c=0;c<f;c++)for(var k=0;k<g;k++)if(a=this.records[d+c][e+k])a.element&&(0==k&&0==c?(a.element.removeAttribute(_$_b591[184]),a.element.removeAttribute(_$_b591[185])):(a.element.classList.remove(_$_b591[61]),1==b&&(O.call(this,e+k,d+c,a.merged[2]),a.element.innerHTML=a.merged[3]))),a.merged&&delete a.merged}};h.updateConfig=function(c,b,a,d){if(1==b)var e=[a];else{e=[];for(var g=a;g<a+d;g++)e.push(g)}var f=this.options.mergeCells,
k=Object.keys(f),l={};for(g=0;g<k.length;g++){a=F.getCoordsFromColumnName(k[g]);for(var n=a[c];n<a[c]+f[k[g]][c];n++)-1!==e.indexOf(n)&&(l[k[g]]||(l[k[g]]=[f[k[g]][0],f[k[g]][1]],1==b&&(l[k[g]][c]+=d)),0==b&&l[k[g]][c]--)}k=Object.keys(l);for(g=0;g<k.length;g++)h.update.call(this,k[g],l[k[g]][0],l[k[g]][1]);h.build.call(this)};h.build=function(){var c=this.options.mergeCells;this.merged={cols:[],rows:[],cells:[]};if(c)for(var b=Object.keys(c),a=0;a<b.length;a++){for(var d=F.getCoordsFromColumnName(b[a]),
e=parseInt(c[b[a]][0]),g=parseInt(c[b[a]][1]),f=0;f<e;f++)this.merged.cols[d[0]+f]=!0;for(var k=0;k<g;k++)this.merged.rows[d[1]+k]=!0;for(k=0;k<g;k++)for(f=0;f<e;f++){var l=F.getColumnNameFromCoords(d[0]+f,d[1]+k);this.merged.cells[l]=b[a]}}};h.batch=function(c){var b=Object.keys(c);if(b.length)for(var a=0;a<b.length;a++)!1===c[b[a]]&&h.applyCreate.call(this,b[a])};return h}(),Da=function(){var h=function(c){c.getHeader=h[_$_b591[54]];c.setHeader=h[_$_b591[11]];c.getHeaders=h.all};h[_$_b591[54]]=
function(c){var b;if(b=this.options.columns)return b[c].title||F.getColumnName(c)};h.all=function(c){for(var b=[],a=0;a<this.options.columns.length;a++)b.push(h[_$_b591[54]].call(this,a));return c?b:b.join(this.options.csvDelimiter)};h[_$_b591[11]]=function(c,b){if(!Q.call(this.parent,this))return!1;var a;if(a=this.options.columns[c]){var d=h[_$_b591[54]].call(this,c);if(!b&&(b=prompt(E(_$_b591[186]),d),!b))return!1;a.title=b;if(a=this.headers[c])a.innerHTML=b,a.setAttribute(_$_b591[187],b);V.call(this.parent,
{worksheet:this,action:_$_b591[86],column:c,oldValue:d,newValue:b});K.call(this,_$_b591[86],{column:c,title:b});G.call(this.parent,_$_b591[188],this,c,b,d)}};h.create=function(c){if(this.headers[c])return this.headers[c];var b=this.options.columns[c],a=b.width||this.options.defaultColWidth,d=b.title||F.getColumnName(c),e=document.createElement(_$_b591[167]);this.parent.config.stripHTML?e.innerText=d:e.innerHTML=d;e.setAttribute(_$_b591[52],c);b.align&&(e.style.textAlign=b.align);b.title&&e.setAttribute(_$_b591[187],
e.innerText);b.tooltip&&(e.title=b.tooltip);d=this.options.filters;!0===b.filter&&(d=!0);!1===b.filter&&(d=!1);!0===d&&e.classList.add(_$_b591[189]);!1===b.visible&&(a=_$_b591[112]);d=document.createElement(_$_b591[190]);d.setAttribute(_$_b591[172],a);b.type==_$_b591[62]&&(e.style.display=_$_b591[48],d.style.display=_$_b591[48]);this.headers[c]=e;this.colgroup[c]=d;G.call(this.parent,_$_b591[191],this,c,e,b);return e};return h}(),ba=function(){var h=function(b,a,d){var e=this.footers.content,g;e&&
e[a]&&e[a][b]&&(g=e[a][b].element)&&(void 0===d&&(e=this.options.footers,d=e[a]&&e[a][b]?e[a][b]:_$_b591[3]),Z(d)&&1==this.parent.config.parseFormulas&&(d=X.execute.call(this,d,b,null,!1)),this.options.applyMaskOnFooters&&(e=ja[_$_b591[54]].call(this,b),d=u.editors.general.parseValue(b,a,d,this,e[1],g)),d instanceof Element||d instanceof HTMLDocument?(g.innerHTML=_$_b591[3],g.appendChild(d)):1==this.parent.config.stripHTML?g.innerText=d:g.innerHTML=d)},c=function(b){b.getFooter=c[_$_b591[54]];b.setFooter=
c[_$_b591[11]];b.resetFooter=c.reset;b.refreshFooter=c.refresh;b.getFooterValue=c.value;b.setFooterValue=c.value};c[_$_b591[54]]=function(){return this.options.footers};c[_$_b591[11]]=function(b){if(b){var a=this.options.footers;this.options.footers=b}this.options.footers!=a&&(ba.build.call(this),c.render.call(this),K.call(this,_$_b591[192],{data:this.options.footers}),G.call(this.parent,_$_b591[193],this,this.options.footers,a))};c.refresh=function(){var b=this.options.footers;if(b&&b.length)for(var a=
0;a<b.length;a++)for(var d=0;d<b[a].length;d++)h.call(this,d,a,b[a][d])};c.value=function(b,a,d){if(void 0===d)return this.options.footers[a][b];h.call(this,b,a,d);K.call(this,_$_b591[194],{x:b,y:a,value:d});G.call(this.parent,_$_b591[195],this,b,a,d)};c.reset=function(){var b=this.options.footers;this.options.footers=null;this.footers.content=null;this.tfoot.innerHTML=_$_b591[3];K.call(this,_$_b591[196],{});G.call(this.parent,_$_b591[193],this,null,b)};c.create=function(b,a){var d=this.footers.content[a][b];
if(d&&d.element)return d.element;d=this.footers.content[a][b]={};var e=this.options.columns[b].align;d.element=document.createElement(_$_b591[167]);d.element.setAttribute(_$_b591[52],b);d.element.setAttribute(_$_b591[53],a);e&&(d.element.style.textAlign=e);h.call(this,b,a);this.options.columns[b].type==_$_b591[62]&&d.element.classList.add(_$_b591[61]);return d.element};c.build=function(){this.footers={element:this.tfoot,content:[]};if(this.options.footers){this.tfoot.innerHTML=_$_b591[3];for(var b=
0;b<this.options.footers.length;b++){if(!this.footers.content[b]){this.footers.content[b]=[];var a=document.createElement(_$_b591[165]),d=document.createElement(_$_b591[167]);d.innerHTML=_$_b591[168];a.appendChild(d);this.footers.element.appendChild(a)}for(a=0;a<this.options.columns.length;a++)this.options.footers[b][a]||(this.options.footers[b][a]=_$_b591[3]),this.footers.content[b][a]||(this.footers.content[b][a]={})}}};c.render=function(){for(var b=this.options.footers,a=0;a<b.length;a++)for(var d=
0;d<b[a].length;d++){var e=ba.create.call(this,d,a);this.tfoot.children[a].appendChild(e)}};c.adjust=function(b,a,d){var e=[],g=this.options.footers,f=this.footers.content;if(g)if(1==d){if(this.headers[b]&&this.headers[b].parentNode)var k=this.headers[b]==this.thead.lastChild.lastChild?!0:!1,l=!0;for(d=0;d<g.length;d++){for(var n=g[d].splice(b),q=b;q<b+a;q++)g[d][q]=_$_b591[3];g[d]=g[d].concat(n);n=f[d].splice(b);for(q=b;q<b+a;q++)f[d][q]={element:c.create.call(this,q,d)},l&&(1==k?this.tfoot.children[d].appendChild(f[d][q].element):
this.tfoot.children[d].insertBefore(f[d][q].element,this.tfoot.children[d].children[b].nextSibling));f[d]=f[d].concat(n)}}else for(d=0;d<g.length;d++){for(q=b;q<b+a;q++)(k=this.footers.content[d][q].element)&&k.parentNode&&k.parentNode.removeChild(k);f[d].splice(b,a);e[d]=g[d].splice(b,a)}return e};return c}(),xa=function(){var h=function(c){c.setNestedCell=h.cell;c.getNestedCell=h.cell;c.setNestedHeaders=h[_$_b591[11]];c.getNestedHeaders=h[_$_b591[54]];c.resetNestedHeaders=h.reset};h[_$_b591[54]]=
function(){return this.options.nestedHeaders};h[_$_b591[11]]=function(c){h.reset.call(this);this.options.nestedHeaders=c;h.build.call(this);h.render.call(this);da.refresh.call(this);K.call(this,_$_b591[197],{data:c});G.call(this.parent,_$_b591[198],this,c)};h.reset=function(){var c=[],b=this.thead.children;this.options.nestedHeaders=null;for(var a=0;a<b.length;a++)b[a].classList.contains(_$_b591[199])&&c.push(b[a]);if(c.length)for(;b=c.shift();)b.remove();this.nested=null;da.refresh.call(this);K.call(this,
_$_b591[200]);G.call(this.parent,_$_b591[198],this,[])};h.cell=function(c,b,a){if(a){if(!Q.call(this.parent,this))return!1;var d=this.options.nestedHeaders[b][c],e=this.nested.content[b][c].element;void 0!==a.title&&(e.innerText=a.title);void 0!==a.tooltip&&(e.title=a.tooltip);void 0!==a.colspan&&(d.colspan=a.colspan,e.setAttribute(_$_b591[184],a.colspan),e.style.display=0==d.colspan?_$_b591[48]:_$_b591[3]);K.call(this,_$_b591[201],{x:c,y:b,properties:a});G.call(this.parent,_$_b591[202],this,c,b,
a)}else return this.nested.content[b][c].element};h.range=function(c){c=this.options.nestedHeaders[c];for(var b=[],a=0,d=0;d<c.length;d++){var e=parseInt(c[d].colspan);b[d]=[a,a+e-1];a+=e}return b};h.getColumns=function(c){c=this.options.nestedHeaders[c];for(var b=[],a=0;a<c.length;a++)for(var d=c[a].colspan,e=0;e<d;e++)b.push(a);return b};h.getAffected=function(c){var b=[],a=this.options.nestedHeaders;if(a){var d,e,g;for(e=0;e<a.length;e++)if((d=h.getColumns.call(this,e))&&void 0!==d[c]){var f=h.range.call(this,
e);for(g=f[d[c]][0];g<=f[d[c]][1];g++)b.push(g)}}return b};h.create=function(c,b){if(this.nested.content[b][c])return this.nested.content[b][c].element;var a=this.options.nestedHeaders[b][c]||{},d=this.nested.content[b][c]={};a.colspan||(a.colspan=1);a.align||(a.align=_$_b591[203]);a.title||(a.title=_$_b591[3]);var e=document.createElement(_$_b591[167]);e.setAttribute(_$_b591[204],c);e.setAttribute(_$_b591[205],b);e.setAttribute(_$_b591[184],a.colspan);e.setAttribute(_$_b591[206],a.align);e.innerHTML=
a.title;a.tooltip&&(e.title=a.tooltip);return d.element=e};h.build=function(){this.nested||(this.nested={content:[]});var c,b,a=0;if(c=this.options.nestedHeaders){for(b=0;b<c.length;b++){this.nested.content[b]=[];var d=document.createElement(_$_b591[167]);d.innerHTML=_$_b591[168];var e=document.createElement(_$_b591[165]);e.classList.add(_$_b591[199]);e.appendChild(d);this.thead.insertBefore(e,this.thead.lastChild)}for(b=0;b<this.thead.children.length;b++)this.thead.children[b].firstChild.style.top=
a+_$_b591[55],a+=this.thead.children[b].offsetHeight}};h.adjust=function(c,b,a,d){var e=this.options.nestedHeaders;if(e)if(1==a)if(d&&d.nested)for(a=0;a<e.length;a++)for(var g=0;g<e[a].length;g++)h.cell.call(this,g,a,{colspan:d.nested[a][g]});else for(a=0;a<e.length;a++){if((g=h.getColumns.call(this,a))&&e[a][g]){g=g[c];var f=parseInt(e[a][g].colspan)+b;h.cell.call(this,g,a,{colspan:f})}}else{d=[];for(a=0;a<e.length;a++)if(f=h.getColumns.call(this,a)){d[a]=[];for(g=0;g<b;g++){var k=f[c+g];typeof d[a][k]==
_$_b591[21]&&(d[a][k]=e[a][k].colspan);e[a][k].colspan--}f=Object.keys(d[a]);for(g=0;g<f.length;g++)h.cell.call(this,f[g],a,{colspan:e[a][f[g]].colspan})}return d}};return h}(),ea=function(){var h=function(c,b){var a=function(q){var p;(p=this.results)?q=p.indexOf(q):p=this.rows;q--;for(var v=q;0<=v;v--)if(q=this.results?p[v]:v,this.rows[q]&&this.rows[q].element)return q;return 0},d=function(q){var p;(p=this.results)?q=p.indexOf(q):p=this.rows;q++;for(var v=q;v<p.length;v++)if(q=this.results?p[v]:
v,this.rows[q]&&this.rows[q].element)return q;return p[p.length-1]},e=function(q,p){for(;0<=q;q--)if(this.records[p][q].element&&!this.records[p][q].element.classList.contains(_$_b591[61]))return q;return 0},g=function(q,p){for(;q<this.options.columns.length;q++)if(this.records[p][q].element&&!this.records[p][q].element.classList.contains(_$_b591[61]))return q;return this.options.columns-1},f=this.getHighlighted(),k=f[0],l=f[1],n=f[2];f=f[3];c=parseInt(c);b=parseInt(b);null!=c&&null!=b&&(0<c-n?(g=
g.call(this,parseInt(n)+1,b),c=parseInt(c)):(g=parseInt(c),c=e.call(this,parseInt(k)-1,b)),0<b-f?(d=d.call(this,parseInt(f)),b=parseInt(b)):(d=parseInt(b),b=a.call(this,parseInt(l))),c-g<b-d?(g=parseInt(k),c=parseInt(n)):(d=parseInt(l),b=parseInt(f)),this.setBorder(g,d,c,b,_$_b591[152]))};h.execute=function(c){if(!Q.call(this.parent,this))return!1;var b=this.borders.cloning;if(c)if(b&&b.active){c=b.x1;var a=b.y1,d=b.x2,e=b.y2}else return!1;else if(d=this.getSelected(),d.length)c=d[0].x,a=parseInt(d[d.length-
1].y)+1,d=d[d.length-1].x,e=this.options.data.length-1;else return!1;var g=0,f,k=[],l=[],n=!1;var q=this.getHighlighted();var p=Ga[_$_b591[54]].call(this,q,!1,!1),v=this.getSelected();if(f=this.getStyle(v,!0)){var x=Object.keys(f);if(x.length)for(var w=0;w<x.length;w++)k.push(f[x[w]])}if(q[0]==c){f=a<q[1]?a-q[1]:1;var z=0}else z=c<q[0]?c-q[0]:1,f=0;x=0;c=parseInt(c);d=parseInt(d);a=parseInt(a);e=parseInt(e);for(var y=q[0]==c?1:0,C=f,r=z,A=a;A<=e;A++)if(!this.results||-1!=this.results.indexOf(A)){void 0==
p[g]&&(g=0);q=0;0==y?(z=r,f=C):z=r;for(w=c;w<=d;w++){if(!(0!=n||this.records[A][w].element&&this.records[A][w].element.classList.contains(_$_b591[26]))){if((!b||1!=b.active)&&O.call(this,w,A)){n=!0;continue}void 0==p[g][q]&&(q=0);var B=p[g][q];var D=void 0!==this.options.columns[w].autoIncrement?this.options.columns[w].autoIncrement?!0:!1:this.parent.config.autoIncrement;1==this.options.columns[w].shiftFormulas&&(D=!0);B&&D&&(this.options.columns[w].type==_$_b591[67]||this.options.columns[w].type==
_$_b591[22]?Z(B)?B=X.shiftFormula(B,z,f):B==Number(B)&&(B=Number(B)+f):this.options.columns[w].type==_$_b591[207]&&(D=new Date(B),D.setDate(D.getDate()+f),B=D.getFullYear()+_$_b591[208]+jSuites.two(parseInt(D.getMonth()+1))+_$_b591[208]+jSuites.two(D.getDate())+_$_b591[147]+_$_b591[209]));D={x:w,y:A,value:B};k&&null!=k[x]&&(D.style=k[x],x++,x>=k.length&&(x=0));l.push(D)}q++;0==y&&z++}g++;f++}l.length&&this.setValue(l);v[0].x<c&&(c=v[0].x);v[0].y<a&&(a=v[0].y);v[v.length-1].x>d&&(d=v[v.length-1].x);
v[v.length-1].y>e&&(e=v[v.length-1].y);this.resetBorders(_$_b591[152],!0);this.updateSelectionFromCoords(c,a,d,e)};h.end=function(c){ea.event=!1;ea.execute.call(this,!0);na.refresh.call(this)};h.cancel=function(c){ea.event=!1;this.resetBorders(_$_b591[152],!0)};return h}(),Ga=function(){var h=function(c){c.getData=h[_$_b591[54]];c.getJson=h[_$_b591[54]];c.setData=h[_$_b591[11]];c.loadData=h.load;c.getRowData=h.getRowData;c.setRowData=h.setRowData;c.getColumnData=h.getColumnData;c.setColumnData=h.setColumnData;
c.updateData=h.update;c.refresh=h.refresh;c.data=h[_$_b591[54]];c.download=h.download;c.copy=h.copy;c.paste=h.paste;c.cut=function(){return c.copy(!0)}};h[_$_b591[54]]=function(c,b,a,d){!0===c&&(c=this.getHighlighted());var e=c?!0:!1,g=[],f=this.options.columns.length,k=this.options.data.length;void 0===d&&(d=this.dataType&&typeof a==_$_b591[21]?1:0);for(var l=0;l<k;l++){var n=null;var q=d?{}:[];for(var p=0;p<f;p++){var v;if(!(v=!e)){v=c[1];var x=c[2],w=c[3];v=p>=c[0]&&p<=x&&l>=v&&l<=w?!0:!1}if(v&&
(!e||!this.results||-1!=this.results.indexOf(l))){v=O.call(this,p,l);if(b){if(e&&!1===this.rows[l].visible)continue;n=ka.processed.call(this,p,l);void 0!==n&&(v=n)}a&&v.match&&(v.match(a)||v.match(/\n/)||v.match(/"/))&&(v=v.replace(new RegExp(_$_b591[20],_$_b591[14]),_$_b591[210]),v=_$_b591[20]+v+_$_b591[20]);d?jSuites.path.call(q,_$_b591[3]+ma.call(this,p),v):q.push(v);n=!0}}n&&(a?g.push(q.join(a)):g.push(q))}return a?g.join(_$_b591[10])+_$_b591[10]:g};h.parse=function(){for(var c,b={},a=0,d,e=[],
g=this.options.data,f=0;f<g.length;f++)c=null,d=f,g[f].data&&(Array.isArray(g[f].data)||typeof g[f].data==_$_b591[97])&&(typeof g[f].id!==_$_b591[21]&&(c=parseInt(g[f].id)),typeof g[f].row!==_$_b591[21]&&(d=g[f].row),e[d]=g[f].data,g[f]=[]),d>a&&(a=d),c&&(b[d]=c);if(Object.keys(e).length)for(f=0;f<=a;f++)e[f]&&(g[f]=e[f]);a=this.getPrimaryKey();if(!1!==a)for(a=ma.call(this,a),f=0;f<g.length;f++)b[f]||!1===a||(c=parseInt(g[f][a]),0<c&&(b[f]=c));return b};h.type=function(){for(var c=this.dataType=0;c<
this.options.columns.length;c++)typeof this.options.columns[c].name!==_$_b591[21]&&(this.dataType=1)};h[_$_b591[11]]=function(c){c=h.standardize(c);var b={},a=[],d={};var e=Object.keys(c[0]).length-this.options.columns.length;0<e&&this.insertRow(e);var g=c.length-this.options.data.length;0<g&&this.insertRow(g);for(var f=0;f<this.options.data.length;f++){void 0===c[f]&&(c[f]={row:f,data:[]});for(var k=0;k<this.options.columns.length;k++)c[f].data[k]||(c[f].data[k]=_$_b591[3])}for(k=0;k<this.options.columns.length;k++){var l=
ma.call(this,k);d[l]=k}for(f=0;f<c.length;f++){g=c[f].row;l=Object.keys(c[f].data);for(k=0;k<l.length;k++)e=null,void 0!==d[l[k]]?e=d[l[k]]:-1<l[k]&&(e=parseInt(l[k])),null!==e&&a.push({x:e,y:g,value:c[f].data[l[k]]});c[f].id&&(b[g]=c[f].id)}wa.setId.call(this,b);ka[_$_b591[11]].call(this,a,null,!0)};h.build=function(){this.results=null;this.rows=[];this.records=[];this.sequence=0;h.type.call(this);if(this.options.data){var c=h.parse.call(this),b=this.options.data.length;this.options.minDimensions[1]>
b&&(b=this.options.minDimensions[1]);for(var a=0;a<b;a++){var d=c[a]?c[a]:null;ra.row.call(this,a,d)}}};h.load=function(c){this.resetBorders();this.resetSelection();this.tbody.innerText=_$_b591[3];this.options.data=c;h.build.call(this);I.call(this,!0,!0);aa.update.call(this)};h.refresh=function(c){if(typeof c!==_$_b591[21])for(var b=0;b<this.options.columns.length;b++){var a=this.records[c]&&this.records[c][b].element?this.records[c][b].element:null,d=ja[_$_b591[54]].call(this,b,c);typeof d[0].updateCell==
_$_b591[98]&&d[0].updateCell(a,O.call(this,b,c),b,c,this,d[1]);a&&R.applyOverflow.call(this,a,b,c)}else if(this.options.url){var e=this;1==this.parent.config.loadingSpin&&jSuites.loading.show();jSuites.ajax({url:this.options.url,method:_$_b591[70],dataType:_$_b591[71],success:function(g){e.setData(g);jSuites.loading.hide()}})}};h.getRowData=function(c,b){if(typeof this.options.data[c]===_$_b591[21])return!1;if(b){if(this.dataType){b={};for(var a=0;a<this.options.columns.length;a++){var d=_$_b591[3]+
ma.call(this,a),e=_$_b591[3]+ka.processed.call(this,a,c,!0);jSuites.path.call(b,d,e)}}else for(b=[],a=0;a<this.options.columns.length;a++)b.push(ka.processed.call(this,a,c,!0));return b}return JSON.parse(JSON.stringify(this.options.data[c]))};h.setRowData=function(c,b,a){for(var d=[],e=0;e<this.options.columns.length;e++)typeof b[e]===_$_b591[21]&&(b[e]=_$_b591[3]),d.push({x:e,y:c,value:b[e]});d.length&&this.setValue(d,null,a)};h.getColumnData=function(c,b){if(typeof this.options.columns[c]===_$_b591[21])return!1;
for(var a=[],d=0;d<this.options.data.length;d++){var e=b?ka.processed.call(this,c,d,!0):O.call(this,c,d);a.push(e)}return a};h.setColumnData=function(c,b,a){for(var d=[],e=0;e<this.rows.length;e++)typeof b[e]===_$_b591[21]&&(b[e]=_$_b591[3]),d.push({x:c,y:e,value:b[e]});d.length&&this.setValue(d,null,a)};h.copy=function(c){var b=this,a=this.getHighlighted(),d=function(){b.setBorder(a[0],a[1],a[2],a[3],_$_b591[143]);b.borders.copying.clear=1==c?!0:!1},e=h[_$_b591[54]].call(this,a,!0,_$_b591[211]),
g=G.call(this.parent,_$_b591[212],this,a,e);if(g)e=g;else if(!1===g)return!1;navigator.clipboard?navigator.clipboard.writeText(e).then(d):(this.parent.textarea.value=e,this.parent.textarea.select(),document.execCommand(_$_b591[213]),d());return e};h.paste=function(c,b,a){if(!Q.call(this.parent,this))return!1;var d=this,e=function(){d.borders.copying&&(d.resetBorders(_$_b591[143],!0),d.borders.copying.clear=!1)},g=null,f=this.options.style,k=null,l=null,n=[];if(this.borders.copying){var q=[this.borders.copying.x1,
this.borders.copying.y1,this.borders.copying.x2,this.borders.copying.y2];k=q[0];l=q[1];var p=jSuites.hash(a),v=jSuites.hash(h[_$_b591[54]].call(this,q,!0,_$_b591[211]));if(p!=v)e();else{var x=0,w=0;a=h[_$_b591[54]].call(this,q,!1,!1);for(p=q[1];p<=q[3];p++)if(!this.results||-1!=this.results.indexOf(p)){n[w]=[];x=0;for(v=q[0];v<=q[2];v++)g=F.getColumnNameFromCoords(v,p),n[w][x]=f&&f[g]?f[g]:_$_b591[214],x++;w++}}}c=parseInt(c);b=parseInt(b);if(a){Array.isArray(a)||(a=F.parseCSV(a,_$_b591[211]));if(p=
G.call(this.parent,_$_b591[215],this,a,c,b,n))a=p;else if(!1===p)return!1;100<a.length&&!this.options.pagination&&!I.limited.call(this)&&console.log(_$_b591[216]);if(g=this.getHighlighted()){x=[];w=[];var z=[];f=[];var y=0,C=0;for(p=g[1];p<=g[3];p++)if(!this.results||-1!=this.results.indexOf(p)){x=[];w=[];for(v=g[0];v<=g[2];v++)x.push(a[C][y]),n&&n[C]&&n[C][y]?w.push(n[C][y]):w.push(_$_b591[3]),y++,y>=a[0].length&&(y=0);z.push(x);f.push(w);C++;C>=a.length&&(C=0)}0==z.length%a.length&&0==z[0].length%
a[0].length&&(a=z,n=f)}f=null;g=[];if(this.borders.copying&&!0===this.borders.copying.clear){for(p=q[1];p<=q[3];p++)for(v=q[0];v<=q[2];v++)(!this.results||this.results&&0<=this.results.indexOf(p))&&g.push({x:v,y:p,value:_$_b591[3],style:_$_b591[3]});e()}p=c+a[0].length-this.options.columns.length;0<p&&this.insertColumn(p);p=b+a.length-this.rows.length;0<p&&this.insertRow(p);w=x=c;y=z=b;C=null;this.results&&(f=this.results.indexOf(b));for(p=0;p<a.length;p++)for(v=0;v<a[p].length;v++){null!==k&&null!==
l&&a[p][v][0]==_$_b591[18]&&(a[p][v]=X.shiftFormula(a[p][v],c-k,b-l));w=c+v;y=b+p;this.results&&(y=this.results[f+p]);var r={x:w,y,value:a[p][v]};n&&n[p]&&n[p][v]&&(r.style=n[p][v]);g.push(r);null===C&&fa.isSelected.call(this,w,y,q)&&(C=!0)}C&&e();g.length&&(ka[_$_b591[11]].call(this,g,null,this.parent.config.forceUpdateOnPaste?!0:!1),G.call(this.parent,_$_b591[217],this,g),this.updateSelectionFromCoords(x,z,w,y))}};h.download=function(c,b){if(this.parent.config.allowExport)if(u.render)u.render(this.parent);
else{void 0===b&&(b=!0);var a=_$_b591[3];if(1==c||1==this.parent.config.includeHeadersOnDownload)a+=this.getHeaders().replace(/\s+/gm,_$_b591[147])+_$_b591[10];a+=h[_$_b591[54]].call(this,null,b,this.options.csvDelimiter);b=new Blob([_$_b591[219]+a],{type:_$_b591[220]});window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(b,this.options.csvFileName+_$_b591[221]):(c=document.createElement(_$_b591[222]),b=URL.createObjectURL(b),c.href=b,c.setAttribute(_$_b591[223],this.options.csvFileName+
_$_b591[221]),document.body.appendChild(c),c.click(),c.parentNode.removeChild(c))}else console.error(_$_b591[218])};h.standardize=function(c){c||(c=[]);Array.isArray(c)||(c=[c]);void 0==c[0]||Array.isArray(c[0])||typeof c[0]==_$_b591[97]||(c=[c]);for(var b=0;b<c.length;b++){var a={};Array.isArray(c[b])||void 0==c[b].data?a.data=c[b]:a=c[b];a.row=void 0==c[b].row?b:c[b].row;c[b]=a}return c};return h}(),Wa=function(){var h=function(c){c.getLabel=h[_$_b591[54]];c.getLabelFromCoords=h[_$_b591[54]]};h[_$_b591[54]]=
function(c,b,a){if(typeof c==_$_b591[25]){c=F.getCoordsFromColumnName(c);var d=c[0];b=c[1]}else d=c;return this.getProcessed(d,b,a)};return h}(),Ha=function(){var h=function(c){c.getDefinedNames=h[_$_b591[54]];c.setDefinedNames=h[_$_b591[11]]};h[_$_b591[11]]=function(c){if(c.length){for(var b=this.parent.config.definedNames,a,d=[],e=0;e<c.length;e++){var g=c[e].index.toUpperCase();a=b[g]?b[g]:null;c[e].value?(c[e].value=S(c[e].value),this.parent.config.definedNames[g]=c[e].value):b[g]&&delete this.parent.config.definedNames[g];
d.push({index:g,value:c[e].value,oldValue:a})}V.call(this.parent,{worksheet:this,action:_$_b591[94],records:d});K.call(this,_$_b591[94],{data:d});G.call(this.parent,_$_b591[224],this,d)}};h[_$_b591[54]]=function(c){var b=this.parent.config.definedNames;return c?b[c]:b};h.updateAll=function(c,b){if(!this.parent.ignoreHistory){this.parent.historyCascade=!0;var a;if(a=this.parent.config.definedNames){var d=[],e=Object.keys(a);if(e.length){for(var g=0;g<e.length;g++){var f=X.update.call(this,a[e[g]],
c,b);f!==a[e[g]]&&(-1!==f.indexOf(_$_b591[225])&&(f=null),d.push({index:e[g],value:f}))}h[_$_b591[11]].call(this,d)}}this.parent.historyCascade=!1}};h.updateWorksheetName=function(c,b){if(!this.parent.ignoreHistory){this.parent.historyCascade=!0;var a;if(a=this.parent.config.definedNames){var d=[],e=Object.keys(a);if(e.length){for(var g=0;g<e.length;g++){var f=X.updateWorksheetName(a[e[g]],c,b);f!==a[e[g]]&&d.push({index:e[g],value:f})}h[_$_b591[11]].call(this,d)}}this.parent.historyCascade=!1}};
h.build=function(){var c=Object.keys(this.config.definedNames);if(c&&c.length)if(1!==this.edition)this.config.definedNames={},console.log(_$_b591[226]);else for(var b=0;b<c.length;b++){var a=(_$_b591[3]+c[b]).toUpperCase();this.config.definedNames[a]=S(this.config.definedNames[c[b]])}};return h}(),oa=function(){var h=[_$_b591[227],_$_b591[228],_$_b591[229],_$_b591[230],_$_b591[231]],c=[_$_b591[208],_$_b591[171],_$_b591[232],_$_b591[233],_$_b591[234],_$_b591[235],_$_b591[1],_$_b591[236],_$_b591[33],
_$_b591[237],_$_b591[18],_$_b591[15],_$_b591[17],_$_b591[238]],b=[],a=function(){if(0<b.length){for(var f,k=0;k<b.length;k++)f=-1===b[k].indexOf(_$_b591[19])?this:H(b[k].split(_$_b591[19])[0]),da.destroy.call(f,b[k]);b=[]}},d=function(f){a.call(this);for(var k=0,l=[],n,q,p,v=0;v<f.children.length;v++)if(n=f.children[v].getAttribute(_$_b591[239])){l[n]||(l[n]=h[k++],4<k&&(k=0));f.children[v].style.color=l[n];-1===n.indexOf(_$_b591[19])?(q=this,p=n):(q=n.split(_$_b591[19]),p=q[1],q=H(q[0]));if(0<=p.indexOf(_$_b591[150])){var x=
p.split(_$_b591[150]);p=F.getCoordsFromColumnName(x[0]);x=F.getCoordsFromColumnName(x[1])}else x=p=F.getCoordsFromColumnName(p);fa[_$_b591[11]].call(q,p[0],p[1],x[0],x[1],null,n,l[n]);b.push(n)}},e=function(f){this.worksheet&&(a.call(this.worksheet),typeof this.onchange==_$_b591[98]&&this.onchange.call(this,this.innerText,f),this.worksheet=null)},g=function(f,k){k&&typeof k!=_$_b591[98]||(k={type:_$_b591[240],onchange:k});k.type===_$_b591[240]?(f.classList.add(_$_b591[241]),f.addEventListener(_$_b591[242],
function(l){l=l.changedTouches&&l.changedTouches[0]?l.changedTouches[0].clientX:l.clientX;var n=this.getBoundingClientRect();24>n.width-(l-n.left)&&(g.current=f,f.classList.add(_$_b591[243]),f.classList.add(_$_b591[107]))})):(f.addEventListener(_$_b591[244],function(l){Z(f.innerText)&&(f.classList.add(_$_b591[107]),u.current&&setTimeout(function(){f.worksheet=u.current;g.parse.call(u.current,f);var n=document.createTextNode(_$_b591[3]);f.appendChild(n);jSuites.focus(f)}))}),f.addEventListener(_$_b591[245],
function(l){Z(f.innerText)?f.classList.add(_$_b591[107]):f.classList.contains(_$_b591[107])&&(f.classList.remove(_$_b591[107]),f.worksheet&&a.call(f.worksheet));l.preventDefault()}),f.addEventListener(_$_b591[103],function(l){27==l.which&&(f.innerText=_$_b591[3],e.call(f,!1))}));f.classList.add(_$_b591[246]);f.classList.add(_$_b591[245]);f.setAttribute(_$_b591[247],!0);f.addEventListener(_$_b591[248],function(l){e.call(f,!0)});f.val=function(l){if(void 0===l)return f.innerText;f.innerText=l};k.onchange&&
(f.onchange=k.onchange);k.onupdate&&(f.onupdate=k.onupdate)};g.current=null;g.parse=function(f){for(var k=_$_b591[3],l=_$_b591[3],n=window.getSelection(),q=document.createRange(),p=F.getCaretIndex.call(this.parent,f),v=X.tokenize(f.innerText.replace(/(\r\n|\n|\r)/gm,_$_b591[3])),x=0;x<v.length;x++)v[x]&&X.tokenIdentifier.test(v[x].trim())?(x==v.length-1&&(l=_$_b591[249]),k+=_$_b591[250]+l+_$_b591[251]+v[x].trim().replace(/\$/g,_$_b591[3])+_$_b591[252]+v[x]+_$_b591[253]):k+=v[x];f.innerHTML=k;k=null;
for(x=0;x<f.childNodes.length&&!(k=f.childNodes[x],l=k.tagName?k.innerText.length:k.length,0>=p-l);x++)p-=l;k&&(k.tagName?q.setStart(k.firstChild,p):(p>k.length&&(p=k.length),q.setStart(k,p)),n.removeAllRanges(),n.addRange(q));d.call(this,f)};g.close=function(f){a.call(this);f?f.classList.remove(_$_b591[107]):g.current&&(typeof g.current.onchange==_$_b591[98]&&g.current.onchange.call(g.current),g.current.classList.remove(_$_b591[243]),g.current.classList.remove(_$_b591[107]),g.current.worksheet=null,
g.current=null)};g.getName=function(f,k,l,n,q){f=F.getColumnNameFromCoords(f,k);l=F.getColumnNameFromCoords(l,n);q.ctrlKey&&(f=l);return f!==l?(q=f+_$_b591[150]+l,q=X.getTokensFromRange.call(this,q),X.getRangeFromTokens.call(this,q)):f};g.range=function(f,k,l,n,q){g.current.getAttribute(_$_b591[254])==_$_b591[255]&&(f=l,k=n);f=g.getName.call(this,f,k,l,n,q);k=document.createElement(_$_b591[256]);k.innerText=f;k.setAttribute(_$_b591[239],f);g.current.innerText=_$_b591[3];g.current.appendChild(k);d.call(this,
g.current);jSuites.focus(k);q.preventDefault()};g.update=function(f,k,l,n,q,p,v){p.getAttribute(_$_b591[254])==_$_b591[255]&&(f=l,k=n);var x=jSuites.getNode();if(x){var w=g.getName.call(this,f,k,l,n,q);this!==v&&(w=v.getWorksheetName()+_$_b591[19]+w);f=function(z){var y=document.createElement(_$_b591[256]);y.innerText=w;y.setAttribute(_$_b591[239],w);x.parentNode===p&&!1===z?x.parentNode.insertBefore(y,x.nextSibling):p.appendChild(y);x=y};if(x.getAttribute(_$_b591[239]))q.ctrlKey?(p.appendChild(document.createTextNode(_$_b591[33])),
f(!0)):(x.innerText=w,x.setAttribute(_$_b591[239],w));else{if(!x.innerText||x.innerText!==_$_b591[3]&&-1==c.indexOf(x.innerText.slice(-1))||x.nextElementSibling&&x.nextElementSibling.getAttribute(_$_b591[239]))return!1;f(!1)}jSuites.focus(x);d.call(this,p);q.preventDefault();typeof p.onupdate==_$_b591[98]&&p.onupdate.call(p,p.innerText);return!0}return!1};g.onkeydown=function(f){f.target.worksheet=this;if(f.ctrlKey){if(67==f.which||88==f.which)f=window.getSelection().toString().replace(/(\r\n|\n|\r)/gm,
_$_b591[3]),navigator.clipboard?navigator.clipboard.writeText(f):(this.parent.textarea.value=f,this.parent.textarea.select(),document.execCommand(_$_b591[213]))}else if(36==f.which){var k=window.getSelection(),l=document.createRange();l.setStart(f.target,0);k.removeAllRanges();k.addRange(l)}else 35==f.which?jSuites.focus(f.target):187==f.which?!f.target.innerText.replace(/(\r\n|\n|\r)/gm,_$_b591[3])&&f.target.getAttribute(_$_b591[109])&&f.target.removeAttribute(_$_b591[109]):13==f.which&&f.target.blur()};
g.palette=function(f){h=f};return g}(),X=function(){var h=new RegExp(/^(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]+)(:\$?[A-Z]+\$?[0-9]+)?$/i),c=function(f){f=S(f);for(var k=[_$_b591[208],_$_b591[171],_$_b591[232],_$_b591[233],_$_b591[234],_$_b591[12]],l=[_$_b591[235],_$_b591[257],_$_b591[1],_$_b591[2],_$_b591[236],_$_b591[258],_$_b591[33],_$_b591[237],_$_b591[18],_$_b591[15],_$_b591[17],_$_b591[238]],n=_$_b591[3],q=[],p=0,v=0;v<f.length;v++){if(f[v]==_$_b591[20]||f[v]==_$_b591[148])p=0==p?1:0;0==p&&(-1<
k.indexOf(f[v])||-1<l.indexOf(f[v]))?(n&&(q.push(n),n=_$_b591[3]),q.push(f[v])):n+=f[v]}n&&q.push(n);for(v=0;v<q.length;v++)0==p&&(q[v]=q[v].trim());return q},b=function(f){f.setFormula=b[_$_b591[11]];f.updateFormula=b.update;f.executeFormula=b.execute;f.resetArray=b.resetArray;f.formula=[]};b.run=function(f,k){var l=_$_b591[3],n=Object.keys(k);if(n.length){for(var q={},p=0;p<n.length;p++){var v=n[p].replace(/!/g,_$_b591[35]);0<v.indexOf(_$_b591[35])&&(v=v.split(_$_b591[35]),q[v[0]]=!0)}v=Object.keys(q);
for(p=0;p<v.length;p++)l+=_$_b591[259]+v[p]+_$_b591[260];for(p=0;p<n.length;p++)v=n[p].replace(/!/g,_$_b591[35]),null===k[n[p]]||jSuites.isNumeric(k[n[p]])||(q=k[n[p]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&q.length&&(k[n[p]]=d(q,k[n[p]])),l=0<v.indexOf(_$_b591[35])?l+(v+_$_b591[261]+k[n[p]]+_$_b591[262]):l+(_$_b591[259]+v+_$_b591[261]+k[n[p]]+_$_b591[262])}f=f.replace(/\$/g,_$_b591[3]);(q=f.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&
q.length&&(f=d(q,f));f=f.replace(/!/g,_$_b591[35]);f=(new Function(l+_$_b591[263]+f))();null===f&&(f=0);return f};b[_$_b591[11]]=function(){};var a=function(f){f=S(f,!0);return f.replace(/\$/g,_$_b591[3])},d=function(f,k){for(var l=0;l<f.length;l++){var n=b.getTokensFromRange.call(this,f[l]);k=k.replace(f[l],_$_b591[236]+n.join(_$_b591[33])+_$_b591[258])}return k},e=function(f,k,l){for(var n=this.config.definedNames,q=0;q<f.length;q++)f[q]&&n&&n[f[q]]&&(k=k.replace(f[q],n[f[q]]),l&&(l[f[q]]=n[f[q]]));
return a(k)};b.resetArray=function(f,k){var l;if(l=this.records[k][f].a){for(var n=0;n<l.length;n++)for(var q=0;q<l[n].length;q++)this.options.data[k+n][f+q]||(this.records[k+n][f+q].v=_$_b591[3],this.records[k+n][f+q].element&&(this.records[k+n][f+q].element.innerText=_$_b591[3]));this.records[k][f].a=null}};b.execute=function(f,k,l,n,q){if(1==this.parent.processing)return null!==k&&null!==l&&this.parent.queue.push([this,k,l]),_$_b591[3];if(typeof this.parent.config.onbeforeformula==_$_b591[98]){var p=
G.call(this.parent,_$_b591[264],this,f,k,l);if(!1===p)return f;p&&(f=p)}var v=[],x=function(D,J,L,T){if(void 0!=J&&void 0!=L){var N=F.getColumnNameFromCoords(J,L);J=T.getWorksheetName()+_$_b591[35]+N;v[J]||(v[J]=0);v[J]++;if(1<v[J])throw{error:_$_b591[265],message:_$_b591[266],reference:J};}else J=N=null;q||(D=a(D));var U=D,Y=U.match(/[A-Z_]+[A-Z0-9_\.]*/g);Y&&Y.length&&(U=e.call(T.parent,Y,U,w));(Y=U.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&Y.length&&(U=d.call(T,Y,
U));Y=[];U=c(U);for(var P=0;P<U.length;P++)U[P]&&h.test(U[P])&&Y.push(U[P]);if(Y){if(J&&-1<Y.indexOf(J.replace(_$_b591[35],_$_b591[19])))throw{error:_$_b591[267],message:_$_b591[268]};for(U=0;U<Y.length;U++){J=Y[U].split(_$_b591[19]);J[1]?(L=J[1],P=H(J[0]),J=T.getWorksheetName()+_$_b591[35]+N):(L=J[0],P=T,J=N);if(typeof P==_$_b591[21]||typeof P.formula==_$_b591[21])throw{error:_$_b591[269],message:_$_b591[270]};J&&(P.formula[L]||(P.formula[L]=[]),0>P.formula[L].indexOf(J)&&P.formula[L].push(J));if(!w[Y[U]]){L=
F.getCoordsFromColumnName(L);J=L[0];L=L[1];var sa=void 0!==P.records[L][J].v?P.records[L][J].v:O.call(P,J,L);w[Y[U]]||((_$_b591[3]+sa).substr(0,1)==_$_b591[18]?w[Y[U]]=x(sa,J,L,P):(sa===_$_b591[3]||null===sa||void 0===sa?sa=null:jSuites.isNumeric(sa)||(sa=_$_b591[20]+sa+_$_b591[20]),w[Y[U]]=sa))}}}return D.substr(1)},w={};try{f=x(f,k,l,this);if(f==_$_b591[3])return _$_b591[3];0==f.indexOf(_$_b591[271])&&(q=!0);var z=q?b.run(f,w):u.formula(f,w,k,l,this);if(!1!==n&&void 0!=k&&void 0!=l)if(z instanceof
Date)this.records[l][k].v=jSuites.calendar.dateToNum(z);else if(Array.isArray(z)){n=[];p=null;for(var y=0;y<z.length;y++)for(var C=0;C<z[y].length;C++){(0<C||0<y)&&this.options.data[l+y][k+C]!==_$_b591[3]&&(p=_$_b591[272]);var r=F.getColumnNameFromCoords(k+C,l+y);n.push(r)}if(!p){r=F.getColumnNameFromCoords(k,l);var A=Object.keys(this.formula);for(y=0;y<A.length;y++){var B=this.formula[A[y]].indexOf(r);if(0<=B)for(C=0;C<n.length;C++)B=this.formula[A[y]].indexOf(n[C]),-1==B&&this.formula[A[y]].push(n[C])}for(y=
0;y<z.length;y++)for(C=0;C<z[y].length;C++)this.records[l+y][k+C].v=z[y][C],this.records[l+y][k+C].element&&(this.records[l+y][k+C].element.innerText=z[y][C],jSuites.isNumeric(z[y][C])?this.records[l+y][k+C].element.classList.add(_$_b591[273]):this.records[l+y][k+C].element.classList.remove(_$_b591[273]));this.records[l][k].a=z;p=z[0][0];this.records[l][k].v=p}z=p}else this.records[l][k].v=z;return z}catch(D){return 1==this.parent.config.debugFormulas&&console.log(f,w,D),D&&D.error?D.error:_$_b591[269]}};
b.update=function(f,k,l,n){var q=null,p=null,v=function(C){l&&l[C]&&(C=_$_b591[225]);k[C]&&(C=k[C]);return C},x=function(C,r){r=r.split(_$_b591[274]);if(3===r.length){r=_$_b591[274];var A=_$_b591[274]}else r[0]===_$_b591[3]?(r=_$_b591[274],A=_$_b591[3]):(r=_$_b591[3],A=_$_b591[274]);return r+C.match(/[A-Z]+/g)+A+C.match(/[0-9]+/g)};f=S(f,!0);f=c(f);for(var w=0;w<f.length;w++)if(f[w]&&h.test(f[w])){if(-1==f[w].indexOf(_$_b591[19])){if(p=f[w],q=_$_b591[3],n)continue}else if(p=f[w].split(_$_b591[19]),
q=p[0],p=p[1],n&&n!=q)continue;var z=p;if(0<=p.indexOf(_$_b591[150])){p=b.getTokensFromRange.call(this,p);for(var y=0;y<p.length;y++)p[y]=v(p[y]);p=b.getRangeFromTokens.call(this,p);p!==_$_b591[225]&&-1!==z.indexOf(_$_b591[274])&&(z=z.split(_$_b591[150]),p=p.split(_$_b591[150]),p=x(p[0],z[0])+_$_b591[150]+x(p[1],z[1]))}else-1!==z.indexOf(_$_b591[274])?(p=v(p.replace(/\$/g,_$_b591[3])),p=x(p,z)):p=v(p);q&&(p=q+_$_b591[19]+p);f[w]=p}return f.join(_$_b591[3])};b.getChain=function(f){if(void 0===f)return[];
var k=[],l=[],n=[],q=function(x){if(0<=x.indexOf(_$_b591[35])){var w=x.split(_$_b591[35]),z=w.pop(),y=w.join(_$_b591[35]);w=H(y)}else w=this,y=w.getWorksheetName(),z=x;if(w.formula[z]&&!n[x]){var C=!1;n[x]=!0;for(x=0;x<w.formula[z].length;x++){var r=w.formula[z][x];-1==r.indexOf(_$_b591[35])&&(r=y+_$_b591[35]+r);if(!l[r]){var A=w.getValue(r);Z(A)?k.push([r,A,b.getTokens.call(w,A,y)]):(C=!0,w.formula[z][x]=null);q.call(w,r);l[r]=!0}}1==C&&(w.formula[z]=w.formula[z].filter(function(B){return null!=
B}))}},p=Object.keys(f);for(f=0;f<p.length;f++)q.call(this,p[f]);p=0;for(f=k.length-1;0<=f;f--){for(var v=0;v<f;v++)if(0<=k[v][2].indexOf(k[f][0])){k.splice(v,0,k.splice(f,1)[0]);f=k.length;break}p++;if(1E6<p){console.error(_$_b591[275]);break}}l=[];for(f=0;f<k.length;f++)l[k[f][0]]=k[f][1];return l};b.updateAll=function(f,k){var l,n,q=Object.keys(this.formula);var p=[];var v=[];for(l=0;l<q.length;l++){var x=q[l];var w=this.formula[x];if(k&&k[x])for(var z=0;z<w.length;z++)f[w[z]]&&(w[z]=f[w[z]]),
v[w[z]]=!0;else{var y=[];for(z=0;z<w.length;z++)k&&k[w[z]]||(f[w[z]]&&(w[z]=f[w[z]]),v[w[z]]=!0,y.push(w[z]));y.length&&(f[x]&&(x=f[x]),p[x]=y)}}this.formula=p;y=this.getWorksheetName();for(var C=0;C<u.spreadsheet.length;C++)for(var r=u.spreadsheet[C].worksheets,A=0;A<r.length;A++)if(r[A].getWorksheetName()!==y)for(q=Object.keys(r[A].formula),l=0;l<q.length;l++){p=[];w=r[A].formula[q[l]];for(z=0;z<w.length;z++)x=w[z].split(_$_b591[35]),x[0]==y&&x[1]?k&&k[x[1]]||(f[x[1]]&&(x[1]=f[x[1]]),p.push(x[0]+
_$_b591[35]+x[1])):p.push(w[z]);r[A].formula[q[l]]=p}q=[];x=Object.keys(v);for(z=0;z<x.length;z++)0<=x[z].indexOf(_$_b591[35])?(w=x[z].split(_$_b591[35]),p=H(w[0]),l=w[1],y=this.getWorksheetName(),w=w[0]):(p=this,l=x[z],y=null,w=this.getWorksheetName()),(n=p.getValue(l))&&Z(n)&&(p=b.update.call(p,n,f,k,y),p!=n&&(v[x[z]]=p,l=F.getCoordsFromColumnName(l),q[w]||(q[w]=[]),q[w].push({x:l[0],y:l[1],value:p,force:!0})));x=Object.keys(q);for(f=0;f<x.length;f++)p=H(x[f]),q[x[f]]=ka.applyValues.call(p,q[x[f]]),
ka.setValueChained.call(p,q[x[f]]),K.call(p,_$_b591[122],{data:q[x[f]]})};b.updateWorksheetName=function(f,k,l){for(var n=c(f),q=0;q<n.length;q++)f=n[q].split(_$_b591[19]),f[1]&&(f[0]=f[0].replace(new RegExp(_$_b591[148],_$_b591[14]),_$_b591[3]),f[0].toUpperCase()==k.toUpperCase()&&(f[0]=l,0<=f[0].indexOf(_$_b591[147])&&(f[0]=_$_b591[148]+f[0]+_$_b591[148]),n[q]=f.join(_$_b591[19])));return n.join(_$_b591[3])};b.updateWorksheetNames=function(f,k){for(var l,n,q=0;q<u.spreadsheet.length;q++)for(var p=
[],v=u.spreadsheet[q].worksheets,x=0;x<v.length;x++){for(var w=0;w<v[x].options.data.length;w++)for(var z=0;z<v[x].options.data[w].length;z++)(l=v[x].options.data[w][z])&&Z(l)&&(n=b.updateWorksheetName(l,f,k),n!=l&&p.push({x:z,y:w,value:n,force:!0}));p.length&&(p=ka.applyValues.call(v[x],p),K.call(v[x],_$_b591[122],{data:p}))}};var g=function(f,k,l){var n=_$_b591[3],q=_$_b591[3],p=f.split(_$_b591[274]);if(3===p.length)return f;2===p.length&&(p[0]?(l=0,q=_$_b591[274]):(k=0,n=_$_b591[274]),f=p.join(_$_b591[3]));
f=F.getCoordsFromColumnName(f);k=f[0]+k;f=f[1]+l;return f=0>k||0>f?_$_b591[225]:n+F.getColumnName(k)+q+(f+1)};b.shiftFormula=function(f,k,l){f=c(f,!0);for(var n,q,p=0;p<f.length;p++)h.test(f[p])&&(q=-1==f[p].indexOf(_$_b591[19])?[_$_b591[3],f[p]]:f[p].split(_$_b591[19]),-1==q[1].indexOf(_$_b591[150])?q[1]=g(q[1],k,l):(n=q[1].split(_$_b591[150]),q[1]=g(n[0],k,l)+_$_b591[150]+g(n[1],k,l)),f[p]=q[0]?q.join(_$_b591[19]):q[1]);return f.join(_$_b591[3])};b.getTokensFromRange=function(f){var k=this,l=_$_b591[3],
n=_$_b591[3];0<=f.indexOf(_$_b591[19])?n=_$_b591[19]:0<=f.indexOf(_$_b591[35])&&(n=_$_b591[35]);f=f.replace(/\$/g,_$_b591[3]);n&&(l=f.split(n),f=l.pop(),l=l.join(_$_b591[35]),k=H(l),l+=n);if(-1==f.indexOf(_$_b591[150]))return[l+f];n=[];f=f.split(_$_b591[150]);var q=F.getCoordsFromColumnName(f[0]),p=F.getCoordsFromColumnName(f[1]);if(q[0]<=p[0]){f=q[0];var v=p[0]}else f=p[0],v=q[0];if(null===q[1]&&null==p[1]){var x=0;q=0;k.options&&k.options.data&&(q=k.options.data.length-1)}else q[1]<=p[1]?(x=q[1],
q=p[1]):(x=p[1],q=q[1]);for(k=x;k<=q;k++)for(x=f;x<=v;x++)n.push(l+F.getColumnNameFromCoords(x,k));return n};b.getRangeFromTokens=function(f){f=f.filter(function(n){return n!=_$_b591[225]});for(var k=_$_b591[3],l=0;l<f.length;l++)0<=f[l].indexOf(_$_b591[19])?(k=f[l].split(_$_b591[19]),f[l]=k.pop(),k=k[0]+_$_b591[19]):0<=f[l].indexOf(_$_b591[35])&&(k=f[l].split(_$_b591[35]),f[l]=k.pop(),k=k.join(_$_b591[35])+_$_b591[35]);f.sort(function(n,q){n=F.getCoordsFromColumnName(n);q=F.getCoordsFromColumnName(q);
return n[1]>q[1]?1:n[1]<q[1]?-1:n[0]>q[0]?1:n[0]<q[0]?-1:0});return f.length?k+(f[0]+_$_b591[150]+f[f.length-1]):_$_b591[225]};b.getTokens=function(f,k){var l=a(f);f.replace(/!/g,_$_b591[35]);(f=l.match(/[A-Z_]+[A-Z0-9_\.]*/g))&&f.length&&(l=e.call(this.parent,f,l));(f=l.match(/('.*?'?|\w*\.)?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&f.length&&(l=d.call(this,f,l));if(f=l.match(/('.*?'?|\w*\.)?(\$?[A-Z]+\$?[0-9]+)(:\$?[A-Z]+\$?[0-9]+)?/g))for(l=0;l<f.length;l++)-1==f[l].indexOf(_$_b591[35])&&
k&&(f[l]=k+_$_b591[35]+f[l]);return f};b.tokenIdentifier=h;b.tokenize=c;return b}(),ka=function(){var h=function(c){c.name=ma;c.value=O;c.getValue=h[_$_b591[54]];c.getValueFromCoords=h.getFromCoords;c.setValue=h[_$_b591[11]];c.setValueFromCoords=h.setFromCoords;c.setCheckRadioValue=h.setCheckRadio;c.getProcessed=h.processed};h[_$_b591[54]]=function(c,b){var a=this;if(typeof c==_$_b591[97]){var d=c.x;c=c.y}else 0<=c.indexOf(_$_b591[35])&&(a=c.split(_$_b591[35]),c=a.pop(),a=H(a.join(_$_b591[35]))),
c=F.getCoordsFromColumnName(c),d=c[0],c=c[1];return h.getFromCoords.call(a,d,c,b)};h.getFromCoords=function(c,b,a){var d=null;null!=c&&null!=b&&(d=a?h.processed.call(this,c,b):O.call(this,c,b));return d};h[_$_b591[11]]=function(c,b,a){if(!Q.call(this.parent,this))return!1;var d=null,e=null,g=null,f=[];a=a?!0:!1;var k=function(q,p){var v=null;typeof q==_$_b591[25]?(g=F.getCoordsFromColumnName(q),d=g[0],e=g[1]):q.tagName?(d=q.getAttribute(_$_b591[52]),e=q.getAttribute(_$_b591[53])):q.element&&q.element.tagName?
(d=q.element.getAttribute(_$_b591[52]),e=q.element.getAttribute(_$_b591[53])):(d=q.x,e=q.y,void 0!==q.value&&(p=q.value),void 0!==q.style&&(v=q.style));q={x:d,y:e,value:p,force:a};null!==v&&(q.style=v);f.push(q)};if(c&&Array.isArray(c))for(var l=0;l<c.length;l++)k(c[l],b);else if(typeof c==_$_b591[97]&&void 0==c.x&&void 0==c.tagName)for(b=Object.keys(c),l=0;l<b.length;l++)k(b[l],c[b[l]]);else k(c,b);if(f.length){f=h.applyValues.call(this,f);this.parent.config.parseFormulas&&h.setValueChained.call(this,
f);this.refreshBorders();var n=this;setTimeout(function(){da.refresh.call(n)},250);if(f.length){V.call(this.parent,{worksheet:n,action:_$_b591[89],records:f,selection:this.selectedCell});c=this.getPrimaryKey();if(!1!==c)for(l=0;l<f.length;l++)f[l].x===c&&f[l].value&&W.call(this,f[l]);K.call(this,_$_b591[89],{data:f});aa.update.call(this,!0);G.call(this.parent,_$_b591[276],this,f)}}};h.setFromCoords=function(c,b,a,d){var e=[];e.push({x:c,y:b,value:a});h[_$_b591[11]].call(this,e,null,d)};h.setCheckRadio=
function(){for(var c=[],b=this.getSelected(),a=0;a<b.length;a++){var d=b[a].x,e=b[a].y;if(!this.options.columns[d].readOnly&&this.options.columns[d].type==_$_b591[277]){var g=O.call(this,d,e)?!1:!0;c.push({x:d,y:e,value:g})}}c.length&&h[_$_b591[11]].call(this,c)};h.applyValues=function(c){for(var b,a,d=this.options.style||{},e=[],g={},f=0;f<c.length;f++)if(b=c[f],a=this.updateCell(b.x,b.y,b.value,b.force),void 0!==a.value){if(void 0!==b.style){var k=F.getColumnNameFromCoords(b.x,b.y);a.style=g[k]=
b.style;a.oldStyle=d&&d[k]?d[k]:_$_b591[214]}e.push(a)}0<Object.keys(g).length&&Ra.update.call(this,g);return e};h.processed=function(c,b,a){var d=O.call(this,c,b);if(null===d)return null;var e=ja[_$_b591[54]].call(this,c,b),g=e[1];g.type!=_$_b591[62]&&g.type!=_$_b591[278]&&g.type!=_$_b591[279]&&g.type!=_$_b591[280]&&g.type!=_$_b591[281]&&0!=g.process&&(!0===a||g.type!=_$_b591[282]&&g.type!=_$_b591[283]&&g.type!=_$_b591[284])&&(g.type==_$_b591[277]?d=e[0][_$_b591[54]](g,d,a):this.records[b][c].element?
d=1==this.parent.config.stripHTML?this.records[b][c].element.innerText:this.records[b][c].element.innerHTML:((_$_b591[3]+d).substr(0,1)==_$_b591[18]&&(d=this.executeFormula(d,c,b,!1)),e[0]&&typeof e[0][_$_b591[54]]==_$_b591[98]&&(d=e[0][_$_b591[54]](g,d,a))));return d};h.setValueChained=function(c){for(var b,a=[],d,e=0;e<c.length;e++)b=c[e],d=F.getColumnNameFromCoords(b.x,b.y),a[d]=b.value;a=X.getChain.call(this,a);var g=[],f=Object.keys(a);for(e=0;e<f.length;e++)0<=f[e].indexOf(_$_b591[35])?(b=f[e].split(_$_b591[35]),
d=b.pop(),b=H(b.join(_$_b591[35]))):(d=f[e],b=this),d=F.getCoordsFromColumnName(d),c=R.update.call(b,d[0],d[1],a[f[e]],!0),c.w=b,c.value=c.v=b.records[d[1]][d[0]].v,c.cell=f[e],c.f=a[f[e]],g.push(c);g.length&&G.call(this.parent,_$_b591[285],this,g)};return h}(),R=function(){var h=function(c){c.getCell=h[_$_b591[54]];c.getCellFromCoords=h[_$_b591[54]];c.updateCell=h.update;c.updateCells=h.updateAll;c.getSelected=h.selected;c.isAttached=h.attached};h.attached=function(c,b){return this.records[b]&&this.records[b][c]&&
this.records[b][c].element&&this.records[b][c].element.parentNode&&this.records[b][c].element.parentNode.parentNode?!0:!1};h[_$_b591[54]]=function(c,b,a){typeof c==_$_b591[25]&&(b=F.getCoordsFromColumnName(c),c=b[0],b=b[1]);c=parseInt(c);b=parseInt(b);if(this.records[b]&&this.records[b][c]&&this.records[b][c].element)return this.records[b][c].element;var d=O.call(this,c,b);null===d&&(d=_$_b591[3]);return R.create.call(this,c,b,d,a)};h.getFromCoords=function(c,b,a){if(!c)return null;var d=[],e=c[0],
g=c[1],f=c[2];c=c[3];for(a&&(a=this.results?F.invert(this.results):null);g<=c;g++)for(var k=e;k<=f;k++)if(!a||a[g])b?d.push(F.getColumnNameFromCoords(k,g)):d.push(this.records[g][k]);return d};h.selected=function(c,b){return h.getFromCoords.call(this,this.getHighlighted(),c,b)};h.getSelectedColumns=function(){var c=[],b=this.getHighlighted();if(b)for(var a=b[0];a<=b[2];a++)c.push(a);return c};h.updateAll=function(c){for(var b=this.getPrimaryKey(),a=[],d=0;d<c.length;d++)void 0!==c[d].id?(W.call(this,
c[d]),a.push({id:c[d].id,y:c[d].y}),!1!==b&&h.update.call(this,b,c[d].y,c[d].id,!0)):a.push(h.update.call(this,c[d].x,c[d].y,c[d].value,c[d].force));K.call(this,_$_b591[121],[a])};h.update=function(c,b,a,d){var e=this.records[b];if(e=e&&e[c]?e[c]:null){e=e.element;var g={x:c,y:b};if(d||!e||1!=e.classList.contains(_$_b591[26])){if(d=G.call(this.parent,_$_b591[286],this,e,c,b,a))a=d;else if(!1===d)return g;d=ja[_$_b591[54]].call(this,c,b);if(typeof d[0].updateCell==_$_b591[98]){var f=d[0].updateCell(e,
a,c,b,this,d[1]);void 0!==f&&(a=f)}f=O.call(this,c,b);if(f!==a){var k=O.call(this,c,b,a);g.oldValue=f;g.value=k;e&&h.applyOverflow.call(this,e,c,b);d[1]&&typeof d[1].render==_$_b591[98]&&d[1].render(e,a,c,b,this,d[1]);G.call(this.parent,_$_b591[287],this,e,c,b,g.value,g.oldValue)}}}else return!1;return g};h.create=function(c,b,a,d){var e=document.createElement(_$_b591[167]);e.setAttribute(_$_b591[52],c);e.setAttribute(_$_b591[53],b);var g=ja[_$_b591[54]].call(this,c,b);g[0]&&typeof g[0].createCell==
_$_b591[98]&&(g=g[0].createCell(e,a,c,b,this,g[1]),void 0!==g&&(a=g));O.call(this,c,b,a);this.records[b][c]||ra.cell.call(this,c,b,a);this.records[b][c].element=e;!a&&this.records[b][c].v&&(e.innerText=this.records[b][c].v);h.applyProperties.call(this,e,c,b,d);h.applyOverflow.call(this,e,c,b);G.call(this.parent,_$_b591[288],this,e,c,b,a);return e};h.getAttributes=function(c,b,a){a[c]||(a[c]={});c==_$_b591[289]?a[c][b]=this.getValue(b):c==_$_b591[290]?this.merged.cells&&(b=this.merged.cells[b])&&(a[c][b]=
this.options.mergeCells[b]):this.options[c]&&this.options[c][b]&&(a[c][b]=this.options[c][b])};h.setAttributes=function(c){c&&c.style&&this.setStyle(c.style);c&&c.comments&&this.setComments(c.comments);c&&c.meta&&this.setMeta(c.meta);c&&c.cells&&this.setProperty(c.cells);c&&c.mergeCells&&this.setMerge(c.mergeCells);c&&c.values&&h.batch.call(this,c.values);c&&c.formulas&&h.batch.call(this,c.formulas,!0)};h.applyProperties=function(c,b,a,d){if(!d){var e=F.getColumnNameFromCoords(b,a),g=this.options.style;
d=this.options.comments;var f=this.options.cells,k=this.options.rows;if(g&&g[e]){var l=(l=c.getAttribute(_$_b591[113]))?l+(_$_b591[238]+g[e]):g[e];c.setAttribute(_$_b591[113],l)}this.options.columns[b]&&this.options.columns[b].wrap&&c.classList.add(_$_b591[291]);d&&d[e]&&c.setAttribute(_$_b591[292],d[e]);f&&f[e]&&(1==f[e].readOnly&&c.classList.add(_$_b591[26]),!1===f[e].locked&&!0===this.options.selectUnLockedCells&&c.classList.add(_$_b591[293]),1==f[e].wrap&&c.classList.add(_$_b591[291]));k&&k[a]&&
1==k[a].readOnly&&c.classList.add(_$_b591[26])}d=this.options.columns[b];c.style.textAlign||(l=null,f&&f[e]&&f[e].align?l=f[e].align:d.align&&(l=d.align),l&&(c.style.textAlign=l));!1===this.records[a][b].readonly||1!=this.records[a][b].readonly&&1!=d.readOnly&&1!=d.readonly||c.classList.add(_$_b591[26])};h.applyOverflow=function(c,b,a){1==this.options.textOverflow&&0<b&&(b==this.options.columns.length-1&&(c.style.overflow=_$_b591[62]),this.records[a][b-1]&&this.records[a][b-1].element&&(this.records[a][b-
1].element.style.overflow=this.options.data[a][b]==_$_b591[3]&&this.headers[b-1]&&this.headers[b-1].offsetWidth?_$_b591[3]:_$_b591[62]))};h.batch=function(c,b){var a=[],d=Object.keys(c);if(d.length)for(var e=0;e<d.length;e++){if(0<=d[e].indexOf(_$_b591[35])){var g=d[e].split(_$_b591[35]);var f=H(g[0]);var k=g[1];g=g[0]}else f=this,k=d[e],g=this.getWorksheetName();k=F.getCoordsFromColumnName(k);k=f.updateCell(k[0],k[1],c[d[e]],!0);a[g]||(a[g]=[]);a[g].push(k)}if(1==b&&(d=Object.keys(a),d.length))for(e=
0;e<d.length;e++)f=H(d[e]),K.call(f,_$_b591[122],a[d[e]])};return h}(),Ja=function(){var h=function(c){c.getColumnOptions=h[_$_b591[54]];c.setColumnOptions=h[_$_b591[11]];c.getCells=h.getCells;c.setCells=h.setCells;c.getProperties=h[_$_b591[54]];c.setProperties=h[_$_b591[11]];c.getProperty=h[_$_b591[54]];c.setProperty=h[_$_b591[11]];c.resetProperty=h[_$_b591[11]];c.updateProperty=h.update;c.getOptions=h[_$_b591[54]]};h.getCells=function(c){return c?this.options.cells[c]:this.options.cells};h.setCells=
function(c,b){if(!Q.call(this.parent,this))return!1;if(typeof c==_$_b591[25])this.options.cells[c]=b;else{b=Object.keys(c);for(var a=0;a<b.length;a++)this.options.cells[b[a]]=c[b[a]]}};h[_$_b591[54]]=function(c,b){var a=null;void 0!==b&&(b=F.getColumnNameFromCoords(c,b),this.options.cells&&this.options.cells[b]&&(a=this.options.cells[b]));null===a&&(a=this.options.columns[c]);if(!a)a={type:_$_b591[67]};else if(!a.type||typeof a.type==_$_b591[25]&&!u.editors[a.type])a.type=_$_b591[67];return a};h[_$_b591[11]]=
function(c,b,a){if(!Q.call(this.parent,this))return!1;this.edition&&this.closeEditor(this.edition,!1);var d=[];if(Array.isArray(c))d=c;else if(jSuites.isNumeric(c)&&jSuites.isNumeric(b))c={x:c,y:b},typeof a==_$_b591[97]&&(c.value=a),d.push(c);else if(typeof b===_$_b591[97])c={x:c,value:b},d.push(c);else if(typeof c==_$_b591[97]&&void 0===b)for(b=Object.keys(c),a=0;a<b.length;a++){var e=F.getCoordsFromColumnName(b[a]);d.push({x:e[0],y:e[1],value:c[b[a]]})}if(Array.isArray(d))for(a=0;a<d.length;a++){var g=
d[a];c=g.x;b=g.y;var f=h[_$_b591[54]].call(this,c,b);e=g.value;var k=u.editors[f.type],l=null;e&&e.type&&(l=u.editors[e.type]);if(typeof b===_$_b591[21])for(g.oldValue=f,parseInt(e.width)||(e.width=this.options.defaultColWidth||100),e.type&&u.editors[e.type]||(e.type=_$_b591[67]),this.options.columns[c]=e,e.width&&this.colgroup[c]&&this.colgroup[c].setAttribute(_$_b591[172],parseInt(e.width)),typeof e.title!==_$_b591[21]&&this.headers[c]&&(e.title?(this.headers[c].innerText=e.title,this.headers[c].setAttribute(_$_b591[187],
e.title)):(this.headers[c].innerText=F.getColumnName(c),this.headers[c].removeAttribute(_$_b591[187]))),e.tooltip&&this.headers[c]&&(this.headers[c].title=e.tooltip),b=0;b<this.records.length;b++)this.records[b][c].element&&(k&&typeof k.destroyCell==_$_b591[98]&&k.destroyCell(this.records[b][c].element,c,b),l&&typeof l.createCell==_$_b591[98]&&(R.applyProperties.call(this,this.records[b][c].element,c,b),l.createCell(this.records[b][c].element,O.call(this,c,b),c,b,this,e)));else if(f=F.getColumnNameFromCoords(c,
b),g.oldValue=this.options.cells&&this.options.cells[f]?this.options.cells[f]:_$_b591[3],e?(this.options.cells||(this.options.cells={}),this.options.cells[f]=e):(delete this.options.cells[f],e=h[_$_b591[54]].call(this,c,b),l=u.editors[e.type]),g=this.records[b][c].element)k&&typeof k.destroyCell==_$_b591[98]&&k.destroyCell(g,c,b,this),l&&typeof l.createCell==_$_b591[98]&&(k=O.call(this,c,b),R.applyProperties.call(this,g,c,b,this),e=l.createCell(g,k,c,b,this,e),void 0!==e&&O.call(this,c,b,e))}else return console.error(_$_b591[275]),
!1;this.refreshBorders();V.call(this.parent,{worksheet:this,action:_$_b591[90],records:d});K.call(this,_$_b591[90],{data:d});G.call(this.parent,_$_b591[294],this,d);return!0};h.update=function(c){var b=JSON.parse(JSON.stringify(c));if(Array.isArray(c))for(var a=0;a<c.length;a++){var d=c[a].x,e=c[a].y,g=c[a];var f=F.getColumnNameFromCoords(d,e);this.options.cells[f]||(this.options.cells[f]={});f=this.options.cells[f];g.oldValue=Object.assign({},f);for(var k=Object.keys(g.value),l=0;l<k.length;l++)f[k[l]]=
g.value[k[l]];g=ja[_$_b591[54]].call(this,d,e);typeof g[0].updateProperty==_$_b591[98]&&g[0].updateProperty(d,e,this,g[1])}V.call(this.parent,{worksheet:this,action:_$_b591[91],records:c});K.call(this,_$_b591[91],{data:b});G.call(this.parent,_$_b591[294],this,c)};return h}(),ca=function(){var h=function(b,a){Array.isArray(a)||(a=[a]);for(var d,e=b?_$_b591[3]:_$_b591[48],g=Object.keys(a),f=0;f<g.length;f++)if(d=this.rows[a[g[f]]])d.element&&(d.element.style.display=e),d.visible=b;I.call(this,!0);this.resetBorders()},
c=function(b){b.getRow=c[_$_b591[54]];b.moveRow=c.move;b.insertRow=c.add;b.deleteRow=c.del;b.getSelectedRows=c.selected;b.showRow=h.bind(b,!0);b.hideRow=h.bind(b,!1)};c.height=function(b){var a=0,d=this.rows,e=this.options.rows||{};d[b]&&!1!==d[b].visible&&(a=e[b]&&e[b].height?parseInt(e[b].height):d[b].element&&d[b].element.offsetHeight?d[b].element.offsetHeight:d[b].height?d[b].height:this.options.defaultRowHeight||24);return a};c[_$_b591[54]]=function(b){return this.rows[b]};c.attached=function(b){return this.rows[b]&&
this.rows[b].element&&this.rows[b].element.parentNode?!0:!1};c.selected=function(b){var a=[],d=this.getHighlighted();if(d)for(var e=d[1];e<=d[3];e++)this.rows[e]&&(b?a.push(e):a.push(this.rows[e].element));return a};c.create=function(b,a){if(this.rows[b]&&this.rows[b].element)return this.rows[b].element;this.rows[b]||ra.row.call(this,b);var d=document.createElement(_$_b591[165]);d.setAttribute(_$_b591[53],b);this.rows[b].element=d;var e=null;this.options.rows[b]&&!a&&(this.options.rows[b].style&&
d.setAttribute(_$_b591[113],this.options.rows[b].style),this.options.rows[b].height&&(d.style.height=parseInt(this.options.rows[b].height)+_$_b591[55]),this.options.rows[b].title&&(e=this.options.rows[b].title),0==this.options.rows[b].visible&&(this.rows[b].visible=!1),this.options.rows[b].id&&(this.rows[b].id=this.options.rows[b].id));0==this.rows[b].visible&&(d.style.display=_$_b591[48]);e||(e=parseInt(b+1));a=document.createElement(_$_b591[167]);a.innerHTML=e;a.setAttribute(_$_b591[53],b);a.className=
_$_b591[295];d.appendChild(a);G.call(this.parent,_$_b591[296],this,b,d);return d};c.move=function(b,a){if(!Q.call(this.parent,this))return!1;b=parseInt(b);a=parseInt(a);if(!this.rows[a]||!this.rows[b])return console.error(_$_b591[297]),!1;if(0<Object.keys(this.getMerge()).length){var d=null;this.merged.rows[b]?d=!0:this.merged.rows[a]&&(b>a?this.merged.rows[a-1]&&(d=!0):this.merged.rows[a+1]&&(d=!0));d&&this.destroyMerged()}this.resetBorders();ca.attached.call(this,a)?(d=ca.create.call(this,b),b>
a?this.tbody.insertBefore(d,this.rows[a].element):this.tbody.insertBefore(d,this.rows[a].element.nextSibling)):ca.attached.call(this,b)&&this.tbody.removeChild(this.rows[b].element);this.rows.splice(a,0,this.rows.splice(b,1)[0]);this.records.splice(a,0,this.records.splice(b,1)[0]);this.options.data.splice(a,0,this.options.data.splice(b,1)[0]);K.call(this,_$_b591[78],{f:b,t:a});V.call(this.parent,{worksheet:this,action:_$_b591[78],oldValue:b,newValue:a});aa.references.call(this);I.call(this,!0,!0);
aa.update.call(this);G.call(this.parent,_$_b591[298],this,b,a)};c.add=function(b,a,d,e,g){if(!Q.call(this.parent,this))return!1;if(!this.options.allowInsertRow)return console.error(_$_b591[299]),!1;var f=[];if(0<b)var k=parseInt(b);else k=1,Array.isArray(b)&&!e&&(Array.isArray(b[0])?e=b:(e=[],e.push(b)));e=Ga.standardize(e);d=d?!0:!1;b=this.options.data?this.options.data.length-1:0;if(void 0==a||a>b||0>a)a=b,d=!1;k||(k=1);if(!1===G.call(this.parent,_$_b591[300],this,a,k,d))return console.log(_$_b591[301]),
!1;da.reset.call(this);b=d?a:a+1;for(var l,n,q=0,p=[],v=[],x=this.rows.splice(b),w=this.options.data?this.options.data.splice(b):[],z=this.records.splice(b),y=b;y<k+b;y++){var C=e[q]&&e[q].id?e[q].id:wa.next.call(this);ra.row.call(this,y,C);n=this.dataType?{}:[];for(var r=0;r<this.options.columns.length;r++)l=ma.call(this,r),n[l]=_$_b591[3],e&&e[q]&&e[q].data&&(typeof e[q].data[l]!==_$_b591[21]?n[l]=e[q].data[l]:typeof e[q].data[r]!==_$_b591[21]&&(n[l]=e[q].data[r])),f.push({x:r,y,value:n[l],force:!0});
v.push({id:C,data:n});q++}this.rows=this.rows.concat(x);this.records=this.records.concat(z);Array.prototype.push.apply(this.options.data,w);for(y=b;y<k+b;y++)this.results&&(this.rows[y].results=!0),p.push(this.records[y]);this.merged.rows[b]&&qa.updateConfig.call(this,1,1,b-1,k);K.call(this,_$_b591[74],{numOfRows:k,rowNumber:a,insertBefore:d?1:0,data:v});this.results&&(this.results=ya.refresh.call(this));V.call(this.parent,{worksheet:this,action:_$_b591[74],rowNumber:a,numOfRows:k,insertBefore:d,
data:v});aa.references.call(this);g||fa[_$_b591[11]].call(this,0,b,this.options.columns.length-1,k+b-1);I.call(this,!0,!0);f.length&&ka.applyValues.call(this,f);aa.update.call(this);G.call(this.parent,_$_b591[302],this,a,k,p,d)};c.del=function(b,a){if(!Q.call(this.parent,this))return!1;if(!this.options.allowDeleteRow)return console.error(_$_b591[303]),!1;var d={},e=[];void 0==b&&(a=this.getSelectedRows(),a[0]?(b=parseInt(a[0].getAttribute(_$_b591[53])),a=a.length):(b=this.options.data.length-1,a=
1));var g=this.options.data.length-1;if(void 0==b||b>g||0>b)b=g;a||(a=1);b+a>=this.options.data.length&&(a=this.options.data.length-b,a>=this.options.data.length&&(a=this.options.data.length,this.resetSelection()));if(!1===G.call(this.parent,_$_b591[304],this,b,a))return console.log(_$_b591[305]),!1;if(-1<parseInt(b)&&0<parseInt(a)){da.reset.call(this);for(var f=b;f<b+a;f++)for(var k=0;k<this.options.columns.length;k++)g=F.getColumnNameFromCoords(k,f),R.getAttributes.call(this,_$_b591[306],g,d),R.getAttributes.call(this,
_$_b591[113],g,d),R.getAttributes.call(this,_$_b591[307],g,d),R.getAttributes.call(this,_$_b591[308],g,d),R.getAttributes.call(this,_$_b591[290],g,d),R.getAttributes.call(this,_$_b591[289],g,d),e[g]=!0;if(g=X.getChain.call(this,d.values))d.formulas=g;for(f=b;f<b+a;f++)ca.attached.call(this,f)&&this.rows[f].element.remove(),this.options.rows&&this.options.rows[f]&&(this.options.rows[f]=null);g=[];for(f=b;f<b+a;f++)g.push({id:this.getRowId(f),row:f,data:this.getRowData(f)});this.rows.splice(b,a);f=
this.records.splice(b,a);this.options.data.splice(b,a);qa.updateConfig.call(this,1,0,b,a);this.results&&(this.results=ya.refresh.call(this));K.call(this,_$_b591[75],{rowNumber:b,numOfRows:a,data:g});V.call(this.parent,{worksheet:this,action:_$_b591[75],rowNumber:b,numOfRows:a,insertBefore:1,data:g,attributes:d});aa.references.call(this,e);I.call(this,!0,!0);aa.update.call(this,!0);G.call(this.parent,_$_b591[309],this,b,a,f,g,d)}};return c}(),pa=function(){var h=function(b,a){Array.isArray(a)||(a=
[a]);for(var d,e,g=Object.keys(a),f=0;f<g.length;f++)if(d=a[g[f]],e=this.options.columns[d])this.colgroup[d]&&(this.colgroup[d].style.width=b?parseInt(e.width||this.options.defaultColWidth)+_$_b591[55]:_$_b591[159]),e.visible=b;I.call(this,!0);this.resetBorders()},c=function(b){b.getColumn=c[_$_b591[54]];b.getColumnIdByName=c.getByName;b.getPrimaryKey=c.getPrimaryKey;b.getSelectedColumns=c.selected;b.moveColumn=c.move;b.insertColumn=c.add;b.deleteColumn=c.del;b.showColumn=h.bind(b,!0);b.hideColumn=
h.bind(b,!1)};c[_$_b591[54]]=function(b){return this.options.columns[b]||!1};c.attached=function(b){return this.headers[b]&&this.headers[b].parentNode?!0:!1};c.getByName=function(b){for(var a=this.options.columns,d=0;d<a.length;d++)if(a[d].name==b)return d;return!1};c.getPrimaryKey=function(){for(var b=0;b<this.options.columns.length;b++)if(1==this.options.columns[b].primaryKey)return b;return!1};c.selected=function(){var b=[],a=this.getHighlighted();if(a)for(var d=a[0];d<=a[2];d++)b.push(d);return b};
c.move=function(b,a){if(!Q.call(this.parent,this))return!1;b=parseInt(b);a=parseInt(a);if(!this.options.columns[b])return console.error(_$_b591[310]),!1;if(!this.options.columns[a])return console.error(_$_b591[311]),!1;if(0<Object.keys(this.getMerge()).length){var d=null;this.merged.cols[b]?d=!0:this.merged.cols[a]&&(b>a?this.merged.cols[a-1]&&(d=!0):this.merged.cols[a+1]&&(d=!0));d&&this.destroyMerged()}da.reset.call(this);this.options.freezeColumns&&na.applyReset.call(this);if(pa.attached.call(this,
a)){Da.create.call(this,b);var e=(b>a?this.headers[a]:this.headers[a].nextSibling)||null;this.headerContainer.insertBefore(this.headers[b],e);e=(b>a?this.colgroup[a]:this.colgroup[a].nextSibling)||null;this.colgroupContainer.insertBefore(this.colgroup[b],e);for(var g=0;g<this.tbody.children.length;g++)d=this.tbody.children[g].getAttribute(_$_b591[53]),e=(b>a?this.records[d][a].element:this.records[d][a].element.nextSibling)||null,this.tbody.children[g].insertBefore(R[_$_b591[54]].call(this,b,d),e);
if(this.options.footers)for(g=0;g<this.tfoot.children.length;g++)e=(b>a?this.footers.content[g][a].element:this.footers.content[g][a].element.nextSibling)||null,this.tfoot.children[g].insertBefore(ba.create.call(this,b,g),e)}else if(pa.attached.call(this,b)){this.headerContainer.removeChild(this.headers[b]);this.colgroupContainer.removeChild(this.colgroup[b]);for(g=0;g<this.tbody.children.length;g++)d=parseInt(this.tbody.children[g].getAttribute(_$_b591[53])),this.tbody.children[g].removeChild(this.records[d][b].element);
if(this.options.footers)for(g=0;g<this.tfoot.children.length;g++)this.tfoot.children[g].removeChild(this.footers.content[g][b].element)}this.options.columns.splice(a,0,this.options.columns.splice(b,1)[0]);this.headers.splice(a,0,this.headers.splice(b,1)[0]);this.colgroup.splice(a,0,this.colgroup.splice(b,1)[0]);for(g=0;g<this.rows.length;g++)this.dataType||this.options.data[g].splice(a,0,this.options.data[g].splice(b,1)[0]),this.records[g].splice(a,0,this.records[g].splice(b,1)[0]);if(this.options.footers)for(g=
0;g<this.options.footers.length;g++)this.options.footers[g].splice(a,0,this.options.footers[g].splice(b,1)[0]),this.footers.content[g].splice(a,0,this.footers.content[g].splice(b,1)[0]);K.call(this,_$_b591[79],{f:b,t:a});V.call(this.parent,{worksheet:this,action:_$_b591[79],oldValue:b,newValue:a});aa.references.call(this);I.call(this,!0,!0);aa.update.call(this);G.call(this.parent,_$_b591[312],this,b,a)};c.add=function(b,a,d,e,g,f,k){if(!Q.call(this.parent,this))return!1;if(!this.options.allowInsertColumn)return console.error(_$_b591[313]),
!1;var l=[];if(0<b)var n=parseInt(b);else if(n=1,Array.isArray(b)&&!g)if(Array.isArray(b[0]))g=b;else{g=[];for(var q=0;q<b.length;q++)g[q]=[b[q]]}g||(g=[]);d=d?!0:!1;b=this.options.columns.length-1;if(void 0==a||a>b||0>a)a=b,d=!1;n||(n=1);if(!1===G.call(this.parent,_$_b591[314],this,a,n,d))return console.log(_$_b591[315]),!1;da.reset.call(this);this.options.freezeColumns&&na.applyReset.call(this);if(1==this.dataType)var p=parseInt((_$_b591[3]+Date.now()).substr(-8));e||(e=[]);for(q=0;q<n;q++)e[q]||
(e[q]={type:_$_b591[67],source:[],options:[],width:this.options.defaultColWidth}),1==this.dataType&&typeof e[q].name==_$_b591[21]&&(e[q].name=_$_b591[316]+(p+q));p=d?a:a+1;this.options.columns=F.injectArray(this.options.columns,p,e);q=this.headers.splice(p);var v=this.colgroup.splice(p);for(b=p;b<n+p;b++)Da.create.call(this,b);this.headers=this.headers.concat(q);this.colgroup=this.colgroup.concat(v);ba.adjust.call(this,p,n,1);xa.adjust.call(this,a,n,1,f);v=null;for(var x,w=0;w<this.options.data.length;w++){this.dataType||
(v=this.options.data[w].splice(p));x=this.records[w].splice(p);f=0;for(b=p;b<n+p;b++)q=g[w]&&g[w][f]?g[w][f]:_$_b591[3],O.call(this,b,w,q),l.push({x:b,y:w,value:q}),ra.cell.call(this,b,w),f++;this.dataType||(this.options.data[w]=this.options.data[w].concat(v));this.records[w]=this.records[w].concat(x)}this.merged.cols[p]&&qa.updateConfig.call(this,0,1,p-1,n);K.call(this,_$_b591[76],{numOfColumns:n,columnNumber:a,insertBefore:d?1:0,properties:e,data:g});V.call(this.parent,{worksheet:this,action:_$_b591[76],
columnNumber:a,numOfColumns:n,insertBefore:d,properties:e,data:g});aa.references.call(this);k||fa[_$_b591[11]].call(this,p,0,n+p-1,this.rows.length-1);I.call(this,!0,!0);l.length&&ka.applyValues.call(this,l);aa.update.call(this);G.call(this.parent,_$_b591[317],this,a,n,[],d)};c.del=function(b,a){if(!Q.call(this.parent,this))return!1;if(!this.options.allowDeleteColumn)return console.error(_$_b591[318]),!1;var d={},e=[];if(1<this.options.columns.length){void 0==b&&(a=this.getSelectedColumns(!0),a.length?
(b=parseInt(a[0]),a=parseInt(a.length)):(b=this.options.columns.length-1,a=1));var g=this.options.columns.length-1;if(void 0==b||b>g||0>b)b=g;a||(a=1);b+a>=this.options.columns.length&&(a=this.options.columns.length-b,a>=this.options.columns.length&&(a--,console.error(_$_b591[319])));if(!1===G.call(this.parent,_$_b591[320],this,b,a))return console.log(_$_b591[321]),!1;if(-1<parseInt(b)&&0<parseInt(a)){da.reset.call(this);g=null;var f=[],k=[],l=[];var n=0;for(var q=b;q<b+a;q++)pa.attached.call(this,
q)&&(this.colgroup[q].parentNode.removeChild(this.colgroup[q]),this.headers[q].parentNode.removeChild(this.headers[q])),l[n]=this.options.columns[q],n++;for(var p=0;p<this.options.data.length;p++)for(q=b;q<b+a;q++)n=F.getColumnNameFromCoords(q,p),R.getAttributes.call(this,_$_b591[306],n,d),R.getAttributes.call(this,_$_b591[113],n,d),R.getAttributes.call(this,_$_b591[307],n,d),R.getAttributes.call(this,_$_b591[308],n,d),R.getAttributes.call(this,_$_b591[290],n,d),R.getAttributes.call(this,_$_b591[289],
n,d),e[n]=!0,this.records[p][q].element&&0<=Array.prototype.indexOf.call(this.rows[p].element.children,this.records[p][q].element)&&this.records[p][q].element.parentNode.removeChild(this.records[p][q].element);if(q=X.getChain.call(this,d.values))d.formulas=q;this.options.columns.splice(b,a);this.headers.splice(b,a);this.colgroup.splice(b,a);for(p=0;p<this.options.data.length;p++)this.dataType||(k[p]=this.options.data[p].splice(b,a)),f[p]=this.records[p].splice(b,a);ba.adjust.call(this,b,a,0);(q=xa.adjust.call(this,
b,a,0))&&(g={nested:q});qa.updateConfig.call(this,0,0,b,a);K.call(this,_$_b591[77],{columnNumber:b,numOfColumns:a});V.call(this.parent,{worksheet:this,action:_$_b591[77],columnNumber:b,numOfColumns:a,insertBefore:1,data:k,properties:l,attributes:d,extra:g});aa.references.call(this,e);I.call(this,!0,!0);aa.update.call(this,!0);G.call(this.parent,_$_b591[322],this,b,a,f,l,d)}}};c.isVisible=function(b){var a=this.options.columns;return!1===a[b].visible||a[b].type===_$_b591[62]?!1:!0};return c}(),Ra=
function(){var h={},c={},b=function(d){if(typeof d==_$_b591[25]){var e=d;d=F.getCoordsFromColumnName(d);var g=d[0];d=d[1]}else g=d.x,d=d.y,e=F.getColumnNameFromCoords(g,d);if(this.records[d]&&this.records[d][g]&&this.records[d][g].element){c[e]=this.options.style[e];this.records[d][g].element.setAttribute(_$_b591[113],_$_b591[3]);if(this.options.cells&&this.options.cells[e]&&this.options.cells[e].align)var f=this.options.cells[e].align;else this.options.columns[g].align&&(f=this.options.columns[g].align);
f&&(this.records[d][g].element.style.textAlign=f)}this.options.style&&this.options.style[e]&&delete this.options.style[e]},a=function(d){d.getStyle=a[_$_b591[54]];d.setStyle=a[_$_b591[11]];d.resetStyle=a.reset};a[_$_b591[54]]=function(d){var e=this.options.style;if(!e)return!1;if(d){if(typeof d==_$_b591[25])return e[d];var g=[],f=Object.keys(d);if(0<f.length)for(var k=0;k<f.length;k++){if(typeof d[k]==_$_b591[25])var l=e&&e[d[k]]?e[d[k]]:_$_b591[3];else l=F.getColumnNameFromCoords(d[k].x,d[k].y),
l=e&&e[l]?e[l]:_$_b591[3];g.push(l)}return g}return this.options.style};a[_$_b591[11]]=function(d,e,g,f){if(!Q.call(this.parent,this))return!1;this.options.style||(this.options.style={});var k=this.options.style,l=null,n=[],q=[],p={};q=function(w,z,y){if(!p[w]&&(k[w]?n=k[w].split(_$_b591[238]):(k[w]=_$_b591[3],n=[]),p[w]={},n.length))for(var C=0;C<n.length;C++)n[C]&&n[C].trim()&&(l=n[C].split(_$_b591[150]),p[w][l[0].trim()]=l[1].trim());c[w]||(c[w]=[]);h[w]||(h[w]=[]);p[w][z]||(p[w][z]=_$_b591[3]);
c[w].push([z+_$_b591[150]+p[w][z]]);p[w][z]=p[w][z]&&p[w][z]==y&&!f?_$_b591[3]:y;h[w].push([z+_$_b591[150]+p[w][z]]);y=F.getCoordsFromColumnName(w);this.records[y[1]]&&this.records[y[1]][y[0]]&&this.records[y[1]][y[0]].element&&(this.records[y[1]][y[0]].element.style[z]=p[w][z]);p[w][z]||delete p[w][z]};h={};c={};if(e)if(typeof d==_$_b591[25])q.call(this,d,e,g);else{if(d&&d.length)for(var v=0;v<d.length;v++){var x=F.getColumnNameFromCoords(d[v].x,d[v].y);q.call(this,x,e,g)}}else for(g=Object.keys(d),
v=0;v<g.length;v++)if(x=d[g[v]])for(typeof x==_$_b591[25]&&(x=x.split(_$_b591[238])),e=0;e<x.length;e++)x[e]&&(typeof x[e]==_$_b591[25]&&(x[e]=x[e].split(_$_b591[150])),x[e][0].trim()&&q.call(this,g[v],x[e][0].trim(),x[e][1].trim()));n={};q=Object.keys(p);if(q.length){for(v=0;v<q.length;v++){n[q[v]]||(n[q[v]]=[]);d=Object.keys(p[q[v]]);for(e=0;e<d.length;e++)n[q[v]].push(d[e]+_$_b591[130]+p[q[v]][d[e]]);this.options.style[q[v]]=n[q[v]].join(_$_b591[323])}q=Object.keys(h);for(v=0;v<q.length;v++)h[q[v]]=
h[q[v]].join(_$_b591[238]);q=Object.keys(c);for(v=0;v<q.length;v++)c[q[v]]=c[q[v]].join(_$_b591[238]);this.refreshBorders();V.call(this.parent,{worksheet:this,action:_$_b591[82],oldValue:c,newValue:h});K.call(this,_$_b591[82],[h]);G.call(this.parent,_$_b591[324],this,h,c)}};a.reset=function(d){if(!Q.call(this.parent,this))return!1;if(d){c={};if(Array.isArray(d))for(var e=0;e<d.length;e++)b.call(this,d[e]);else b.call(this,d);this.refreshBorders();V.call(this.parent,{worksheet:this,action:_$_b591[83],
cells:d,oldValue:c});K.call(this,_$_b591[83],[d]);G.call(this.parent,_$_b591[326],this,d)}else console.error(_$_b591[325])};a.update=function(d){h={};c={};for(var e=Object.keys(d),g=0;g<e.length;g++){c[e[g]]=this.options.style[e[g]]||_$_b591[3];h[e[g]]=this.options.style[e[g]]=d[e[g]];var f=F.getCoordsFromColumnName(e[g]),k=f[0];f=f[1];if(this.records[f]&&this.records[f][k]&&this.records[f][k].element&&(this.records[f][k].element.setAttribute(_$_b591[113],d[e[g]]),!this.records[f][k].element.style.textAlign)){var l=
null;this.options.cells&&this.options.cells[e[g]]&&this.options.cells[e[g]].align?l=this.options.cells[e[g]].align:this.options.columns[k].align&&(l=this.options.columns[k].align);l&&(this.records[f][k].element.style.textAlign=l)}}K.call(this,_$_b591[83],[e]);K.call(this,_$_b591[82],[h]);G.call(this.parent,_$_b591[324],this,h,c)};return a}(),Xa=function(){var h=function(c){c.getComments=h[_$_b591[54]];c.setComments=h[_$_b591[11]]};h[_$_b591[54]]=function(c){return c&&typeof c==_$_b591[25]?this.options.comments&&
this.options.comments[c]?this.options.comments[c]:!1:this.options.comments};h[_$_b591[11]]=function(c,b){if(!Q.call(this.parent,this))return!1;if(typeof c==_$_b591[25]){var a={};a[c]=b}else a=c;if(b=G.call(this.parent,_$_b591[327],this,a))a=b;else if(!1===b)return!1;this.options.comments||(this.options.comments={});c={};var d=Object.keys(a);if(d.length){for(var e=0;e<d.length;e++){var g=F.getCoordsFromColumnName(d[e]);this.records[g[1]]&&this.records[g[1]][g[0]]&&(c[d[e]]=this.options.comments[d[e]]||
_$_b591[3],(b=a[d[e]])?this.options.comments[d[e]]=b:delete this.options.comments[d[e]],this.records[g[1]][g[0]].element&&(b?this.records[g[1]][g[0]].element.setAttribute(_$_b591[292],b):this.records[g[1]][g[0]].element.removeAttribute(_$_b591[292])))}V.call(this.parent,{worksheet:this,action:_$_b591[87],newValue:a,oldValue:c});K.call(this,_$_b591[87],[a]);G.call(this.parent,_$_b591[328],this,a,c)}};return h}(),Ya=function(){var h=function(c){c.getMeta=h[_$_b591[54]];c.setMeta=h[_$_b591[11]];c.resetMeta=
h.reset};h[_$_b591[54]]=function(c,b){if(c){if(this.options.meta[c])return b?this.options.meta[c][b]:this.options.meta[c]}else return this.options.meta};h[_$_b591[11]]=function(c,b,a){if(!Q.call(this.parent,this))return!1;this.options.meta||(this.options.meta={});if(typeof c==_$_b591[25]&&b){a||(a=_$_b591[3]);var d={};d[c]={};d[c][b]=a;c=d}b=Object.keys(c);if(b.length){a={};for(d=0;d<b.length;d++){this.options.meta[b[d]]||(this.options.meta[b[d]]={});a[b[d]]||(a[b[d]]={});for(var e=Object.keys(c[b[d]]),
g=0;g<e.length;g++)this.options.meta[b[d]][e[g]]=c[b[d]][e[g]],a[b[d]][e[g]]=c[b[d]][e[g]]}Object.keys(a).length&&(K.call(this,_$_b591[329],[a]),G.call(this.parent,_$_b591[330],this,a))}};h.reset=function(){this.options.meta={};K.call(this,_$_b591[331],{});G.call(this.parent,_$_b591[332],this,{})};return h}(),Za=function(){var h=function(c){c.orderBy=h.execute};h.handler=function(c,b){return function(a,d){a=a[1];d=d[1];return c?a===_$_b591[3]&&d!==_$_b591[3]?1:a!==_$_b591[3]&&d===_$_b591[3]?-1:a>
d?-1:a<d?1:0:a===_$_b591[3]&&d!==_$_b591[3]?1:a!==_$_b591[3]&&d===_$_b591[3]?-1:a>d?1:a<d?-1:0}};h.execute=function(c,b,a,d){if(0<=c){b=null==b?this.headers[c].classList.contains(_$_b591[333])?1:0:b?1:0;for(var e,g,f=[],k=0;k<this.options.data.length;k++)e=Ja[_$_b591[54]].call(this,c,k),g=this.records[k][c].v,g=e.type==_$_b591[278]||e.type==_$_b591[283]||e.type==_$_b591[284]||e.type==_$_b591[334]||e.type==_$_b591[22]||e.type==_$_b591[335]?Number(g):jSuites.isNumeric(g)?Number(g):g.toLowerCase(),f[k]=
[k,g];k=typeof this.parent.config.sorting===_$_b591[98]?this.parent.config.sorting(b,c):h.handler(b,c);f.sort(k);e=a?!0:!1;if(!a)for(a=[],k=0;k<f.length;k++)a[k]=f[k][0];if(k=G.call(this.parent,_$_b591[336],this,c,b,a))a=k;else if(!1===k)return!1;if(e)this.destroyMerged();else if(0<Object.keys(this.getMerge()).length)if(confirm(E(_$_b591[337])))this.destroyMerged();else return!1;if(a.length<f.length)for(k=0;k<f.length;k++)-1==a.indexOf(f[k][0])&&a.push(f[k][0]);f=[];for(k=0;k<a.length;k++)f[a[k]]=
k;Fa.call(this,!1);da.reset.call(this);K.call(this,_$_b591[88],{column:c,direction:b,order:a});V.call(this.parent,{worksheet:this,action:_$_b591[88],column:c,newValue:a,oldValue:f,direction:b,previousState:h.getState.call(this)});h.update.call(this,a);h.arrow.call(this,c,b,d);da.refresh.call(this);G.call(this.parent,_$_b591[338],this,c,b,a);return!0}};h.update=function(c){for(var b=[],a=0;a<c.length;a++)b[a]=this.options.data[c[a]];for(a=0;a<c.length;a++)this.options.data[a]=b[a];b=[];for(a=0;a<c.length;a++)b[a]=
this.records[c[a]];this.records=b;b=[];for(a=0;a<c.length;a++)b[a]=this.rows[c[a]];this.rows=b;aa.references.call(this);this.tbody.innerHTML=_$_b591[3];I.call(this,!0,!0);this.searchInput&&this.searchInput.value?ua.update.call(this,null):ha.update.call(this)};h.arrow=function(c,b,a){for(var d=0;d<this.headers.length;d++)this.headers[d].classList.remove(_$_b591[339]),this.headers[d].classList.remove(_$_b591[333]);void 0===a?this.headers[c].classList.add(b?_$_b591[339]:_$_b591[333]):Array.isArray(a)&&
this.headers[a[0]].classList.add(a[1]?_$_b591[339]:_$_b591[333])};h.getState=function(){for(var c=0;c<this.headers.length;c++){if(this.headers[c].classList.contains(_$_b591[339]))return[c,1];if(this.headers[c].classList.contains(_$_b591[333]))return[c,0]}return null};return h}(),Ba=function(){var h=function(c){c.whichPage=h.whichPage;c.quantityOfPages=h.quantityOfPages;c.page=h[_$_b591[11]];c.updatePagination=h.update};h.build=function(){this.pageNumber=0;var c=document.createElement(_$_b591[28]),
b=document.createElement(_$_b591[28]);this.pagination=document.createElement(_$_b591[28]);this.pagination.classList.add(_$_b591[340]);this.pagination.appendChild(c);this.pagination.appendChild(b);this.options.pagination||(this.pagination.style.display=_$_b591[48]);this.element.appendChild(this.pagination)};h.pageUp=function(){0<this.pageNumber&&(this.pageNumber--,h[_$_b591[11]].call(this,this.pageNumber))};h.pageDown=function(){this.pageNumber<h.quantityOfPages.call(this)-1&&(this.pageNumber++,h[_$_b591[11]].call(this,
this.pageNumber))};h.whichPage=function(c){if(0<this.options.pagination)return this.rows[c]?(this.results&&(c=this.results.indexOf(parseInt(c))),Math.ceil((parseInt(c)+1)/parseInt(this.options.pagination))-1):null;console.log(_$_b591[341]);return!1};h.quantityOfPages=function(){if(0<this.options.pagination)return Math.ceil((this.results?this.results.length:this.rows.length)/parseInt(this.options.pagination));console.log(_$_b591[341]);return!1};h[_$_b591[11]]=function(c,b){var a=this.pageNumber,d=
parseInt(this.options.pagination);if(d){if(null==c||-1==c)c=Math.ceil((this.results?this.results:this.rows).length/d)-1;if(!1===G.call(this.parent,_$_b591[343],this,c,a,d))return!1;this.pageNumber=c;I.update.call(this);ba.refresh.call(this);typeof b==_$_b591[98]&&b.call(this);G.call(this.parent,_$_b591[344],this,c,a,d)}else console.error(_$_b591[342])};h.update=function(){this.pagination.children[0].innerHTML=_$_b591[3];this.pagination.children[1].innerHTML=_$_b591[3];if(this.options.pagination){var c=
this.results?this.results.length:this.rows.length;if(c){c=Math.ceil(c/this.options.pagination);if(6>this.pageNumber)var b=1,a=10>c?c:10;else 5>c-this.pageNumber?(b=c-9,a=c,1>b&&(b=1)):(b=this.pageNumber-4,a=this.pageNumber+5);if(1<b){var d=document.createElement(_$_b591[28]);d.className=_$_b591[346];d.innerHTML=_$_b591[15];d.title=1;this.pagination.children[1].appendChild(d)}for(;b<=a;b++)d=document.createElement(_$_b591[28]),d.className=_$_b591[346],d.innerHTML=b,this.pagination.children[1].appendChild(d),
this.pageNumber==b-1&&d.classList.add(_$_b591[347]);a<c&&(d=document.createElement(_$_b591[28]),d.className=_$_b591[346],d.innerHTML=_$_b591[17],d.title=c,this.pagination.children[1].appendChild(d));this.pagination.children[0].innerHTML=E(_$_b591[348],[this.pageNumber+1,c])}else this.pagination.children[0].innerHTML=E(_$_b591[345]);this.options.tableOverflow&&(this.content.style.height=this.table.offsetHeight+16+_$_b591[55],this.table.style.top=0)}};return h}(),na=function(){var h=function(c){c.setFreezeColumns=
h[_$_b591[11]];c.resetFreezeColumns=h.reset};h.width=function(){if(this.options.freezeColumns){h.headers.call(this);for(var c=0;c<this.rows.length;c++)this.rows[c].element&&h.update.call(this,c)}};h.update=function(c){var b,a;if(a=this.options.freezeColumns){var d=za.call(this)?50:0;if(this.rows[c].element)for(var e=0;e<a;e++){if(b=this.records[c][e].element)b.classList.add(_$_b591[56]),b.style.left=d+_$_b591[55];!1!==this.options.columns[e].visible&&(d+=parseInt(this.options.columns[e].width))}}};
h.headers=function(){var c=za.call(this)?50:0,b;if(b=this.options.freezeColumns)for(var a=0;a<b;a++){if(this.headers[a]){this.headers[a].classList.add(_$_b591[56]);this.headers[a].style.left=c+_$_b591[55];if(this.options.footers)for(var d=0;d<this.options.footers.length;d++)this.footers.content[d][a].element.classList.add(_$_b591[56]),this.footers.content[d][a].element.style.left=c+_$_b591[55];!1!==this.options.columns[a].visible&&(c+=parseInt(this.options.columns[a].width))}}else h.reset.call(this)};
h.refresh=function(){if(0<this.options.freezeColumns){h.headers.call(this);for(var c=0;c<this.visibleRows.length;c++)h.update.call(this,this.visibleRows[c])}};h[_$_b591[11]]=function(c){h.reset.call(this);this.options.freezeColumns=c;h.width.call(this);I.limited.call(this)&&I.call(this)};h.reset=function(){h.applyReset.call(this);da.refresh.call(this);this.options.freezeColumns=0};h.applyReset=function(){for(var c,b=1;b<=this.options.freezeColumns;b++){if(c=this.thead.lastChild)c.children[b].classList.remove(_$_b591[56]),
c.children[b].style.left=_$_b591[3];for(var a=0;a<this.rows.length;a++)if(c=this.rows[a].element)c.children[b].classList.remove(_$_b591[56]),c.children[b].style.left=_$_b591[3];if(this.options.footers)for(a=0;a<this.options.footers.length;a++)this.tfoot.children[a].children[b].classList.remove(_$_b591[56]),this.tfoot.children[a].children[b].style.left=_$_b591[3]}};h.getWidth=function(c){c=c?0:za.call(this)?50:0;if(0<this.options.freezeColumns)for(var b=0;b<this.options.freezeColumns;b++)c+=parseInt(this.options.columns[b].width);
return c};return h}(),aa=function(){var h=function(a,d){if(this.options[a]){for(var e={},g=Object.keys(this.options[a]),f=0;f<g.length;f++)e[d&&void 0!=d[g[f]]?d[g[f]]:g[f]]=this.options[a][g[f]];this.options[a]=e}},c=function(){if(0<this.options.minSpareRows){for(var a=0,d=this.rows.length-1;0<=d;d--){for(var e=!1,g=0;g<this.options.columns.length;g++)O.call(this,g,d)&&(e=!0);if(e)break;else a++}0<this.options.minSpareRows-a&&this.insertRow(this.options.minSpareRows-a)}if(0<this.options.minSpareCols){a=
0;for(g=this.options.columns.length-1;0<=g;g--){e=!1;for(d=0;d<this.rows.length;d++)O.call(this,g,d)&&(e=!0);if(e)break;else a++}0<this.options.minSpareCols-a&&this.insertColumn(this.options.minSpareCols-a)}},b=function(){};b.build=function(){var a=this;this.content=document.createElement(_$_b591[28]);this.content.classList.add(_$_b591[349]);this.content.addEventListener(_$_b591[350],function(e){if(!a.edition)return e.preventDefault(),!1});this.table=document.createElement(_$_b591[351]);this.thead=
document.createElement(_$_b591[352]);this.tbody=document.createElement(_$_b591[353]);this.tfoot=document.createElement(_$_b591[354]);this.headers=[];this.colgroup=[];this.colgroupContainer=document.createElement(_$_b591[355]);var d=document.createElement(_$_b591[190]);d.setAttribute(_$_b591[172],_$_b591[356]);this.colgroupContainer.appendChild(d);this.headerContainer=document.createElement(_$_b591[165]);d=document.createElement(_$_b591[167]);d.classList.add(_$_b591[357]);this.headerContainer.appendChild(d);
this.thead.appendChild(this.headerContainer);this.table.classList.add(_$_b591[358]);this.table.setAttribute(_$_b591[359],_$_b591[112]);this.table.setAttribute(_$_b591[360],_$_b591[112]);this.table.setAttribute(_$_b591[361],_$_b591[362]);this.table.appendChild(this.colgroupContainer);this.table.appendChild(this.thead);this.table.appendChild(this.tbody);this.table.appendChild(this.tfoot);this.options.defaultColAlign&&this.table.classList.add(_$_b591[363]+this.options.defaultColAlign);this.options.textOverflow||
this.table.classList.add(_$_b591[364]);!1===this.options.selectLockedCells&&this.table.classList.add(_$_b591[365]);this.corner=document.createElement(_$_b591[28]);this.corner.className=_$_b591[366];this.corner.setAttribute(_$_b591[361],_$_b591[367]);this.corner.setAttribute(_$_b591[368],_$_b591[369]);0==this.options.selectionCopy&&(this.corner.style.display=_$_b591[48]);this.scrollX=I.build.call(a,_$_b591[370]);this.scrollY=I.build.call(a,_$_b591[371]);this.content.appendChild(this.scrollX);this.content.appendChild(this.scrollY);
this.content.appendChild(this.table);this.content.appendChild(this.corner);this.element.appendChild(this.content);1==this.options.tableOverflow&&(this.content.classList.add(_$_b591[63]),this.options.tableHeight||(this.options.tableHeight=document.body.offsetHeight-18),this.options.tableWidth||(this.options.tableWidth=document.body.offsetWidth-18),this.content.style.width=parseInt(this.options.tableWidth)+_$_b591[55],this.options.pagination?this.content.classList.add(_$_b591[372]):this.content.style.height=
parseInt(this.options.tableHeight)+_$_b591[55]);this.options.resize&&(this.content.style.resize=this.options.resize);this.options.freezeColumns>this.options.columns.length&&console.error(_$_b591[373]);ua.build.call(this);xa.build.call(this);Ba.build.call(this);Ga.build.call(this);qa.build.call(this);ba.build.call(this);ha.onload.call(this);c.call(this);I.call(this)};b.references=function(a){var d=[],e=[],g=null,f=null,k=null,l=null;for(g=0;g<this.options.columns.length;g++)if(f=this.headers[g])k=
f.getAttribute(_$_b591[52]),k!=g&&(f.setAttribute(_$_b591[52],g),f.getAttribute(_$_b591[187])||(f.innerHTML=F.getColumnName(g)));for(var n=0;n<this.rows.length;n++)f=this.rows[n],l=f.y,l!=n&&(f.y=n,d[l]=n,f.element&&(f.element.setAttribute(_$_b591[53],n),f.element.children[0].setAttribute(_$_b591[53],n),g=this.options.rows&&this.options.rows[l]&&this.options.rows[l].title?this.options.rows[l].title:n+1,f.element.children[0].innerHTML=g));var q=function(v,x){f=this.records[x][v];k=f.x;l=f.y;k!=v&&
(f.x=v,f.element&&f.element.setAttribute(_$_b591[52],v));l!=x&&(f.y=x,f.element&&f.element.setAttribute(_$_b591[53],x));if(k!=v||l!=x){var w=F.getColumnNameFromCoords(k,l);v=F.getColumnNameFromCoords(v,x);e[w]=v}};if(a){n=function(v,x){v&&v[x]&&delete v[x]};var p=Object.keys(a);for(g=0;g<p.length;g++)n(this,p[g]),n(this.options.meta,p[g]),n(this.options.cells,p[g]),n(this.options.style,p[g]),n(this.options.comments,p[g])}for(n=0;n<this.rows.length;n++)for(g=0;g<this.options.columns.length;g++)q.call(this,
g,n);h.call(this,_$_b591[374],d);h.call(this,_$_b591[306],e);h.call(this,_$_b591[307],e);h.call(this,_$_b591[113],e);h.call(this,_$_b591[308],e);h.call(this,_$_b591[290],e);this.options.mergeCells&&qa.build.call(this);X.updateAll.call(this,e,a);Ha.updateAll.call(this,e,a);G.call(this.parent,_$_b591[375],this,e,a);return e};b.update=function(a){a&&c.call(this);if(typeof this.parent.config.updateTable==_$_b591[98])for(var d=0;d<this.rows.length;d++)for(var e=0;e<this.options.columns.length;e++)a=this.records[d][e],
this.parent.config.updateTable.call(this,this,a.element,e,d,O.call(this,e,d),a.r?a.r:a.v);ba.refresh.call(this)};return b}(),ra=function(){var h={spreadsheet:function(c,b){var a={name:null,config:{},el:c,element:c,plugins:[],worksheets:[],history:[],historyIndex:-1,queue:[],ignoreEvents:!1,ignoreHistory:!1,ignorePersistence:!1};Ea.spreadsheet.call(a,b);a.config.license&&(u.license=a.config.license);c.spreadsheet=a;c.jspreadsheet=c.jexcel=a.worksheets;u.spreadsheet.push(a);a.name||(a.name=jSuites.guid());
h.bind(a.config.root?a.config.root:document);var d=a.config.tabs;typeof d!==_$_b591[97]&&(d={allowCreate:d?!0:!1,hideHeaders:d?!1:!0,allowChangePosition:a.config.allowMoveWorksheet?!0:!1});d.maxWidth||(d.maxWidth=c.offsetWidth-50+_$_b591[55]);d.animation=void 0==d.animation?!0:d.animation;d.onbeforecreate=function(){a.createWorksheet();return!1};d.onclick=function(g,f,k,l,n){0<=k&&a.openWorksheet(k,!0)};d.onchangeposition=function(g,f,k){a.updateWorksheet(f,k)};jSuites.tabs(c,d);c.classList.add(_$_b591[376]);
1==b.fullscreen&&c.classList.add(_$_b591[23]);var e=document.createElement(_$_b591[28]);a.toolbar=document.createElement(_$_b591[28]);a.toolbar.className=_$_b591[377];e.appendChild(a.toolbar);a.filter=ha.build.call(a);e.appendChild(a.filter);a.helper=document.createElement(_$_b591[28]);a.helper.className=_$_b591[378];e.appendChild(a.helper);a.loading=document.createElement(_$_b591[28]);a.loading.classList.add(_$_b591[379]);e.appendChild(a.loading);e.appendChild(ja.build(a));e.appendChild(Sa(a));a.textarea=
document.createElement(_$_b591[380]);a.textarea.className=_$_b591[381];a.textarea.tabIndex=_$_b591[382];e.appendChild(a.textarea);d.position===_$_b591[383]?c.insertBefore(e,c.children[0]):c.insertBefore(e,c.children[1]);c.appendChild(Ka.call(a,u.license));a.createWorksheet=la.createWorksheet;a.deleteWorksheet=la.deleteWorksheet;a.renameWorksheet=la.renameWorksheet;a.updateWorksheet=la.updateWorksheet;a.openWorksheet=la.openWorksheet;a.moveWorksheet=la.moveWorksheet;a.getWorksheet=la.getWorksheet;
a.getWorksheetActive=la.getWorksheetActive;a.getWorksheetInstance=la.getWorksheetInstance;a.getConfig=function(){var g=a.config;g.worksheets=[];for(var f=0;f<a.worksheets.length;f++)g.worksheets.push(a.worksheets[f].getConfig());return g};a.fullscreen=La;a.progress=Ma;a.dispatch=G;a.setHistory=V;a.resetHistory=V.reset;a.undo=V.undo;a.redo=V.redo;a.setToolbar=ia[_$_b591[11]];a.getToolbar=ia[_$_b591[54]];a.showToolbar=ia.show;a.hideToolbar=ia.hide;a.tools=e;Ha.build.call(a);b.plugins&&ta.call(a,b.plugins);
a.setPlugins=function(g){ta.call(a,g)};c=Object.keys(u.extensions);if(c.length)for(d=0;d<c.length;d++)if(typeof u.extensions[c[d]].oninit==_$_b591[98])u.extensions[c[d]].oninit(a,b);return a},worksheet:function(c,b){var a={};c.worksheets.push(a);a.parent=c;Ea(a);Ta(a);fa(a);da(a);ja(a);Ga(a);Va(a);qa(a);Ra(a);Wa(a);ka(a);X(a);R(a);ca(a);pa(a);Ya(a);Xa(a);Da(a);ba(a);xa(a);ua(a);ha(a);ia(a);wa(a);$a(a);ab(a);Ba(a);la(a);na(a);Ua(a);Za(a);Ha(a);Ja(a);Ea.worksheet.call(a,b);!u.license&&a.options.license&&
(u.license=a.options.license);c.element.jexcel=c.element.jexcel?c.worksheets:a;ta.execute.call(a.parent,_$_b591[384],[a]);a.onload=function(){this.options.worksheetName||(this.options.worksheetName=_$_b591[385]+la.nextName());var d=this.options.worksheetName;H(d)&&console.log(_$_b591[386]+d+_$_b591[387]);H(d,a);this.element=c.element.tabs.appendElement(this.options.worksheetName,function(e,g){a.options.worksheetState===_$_b591[62]&&(g.style.display=_$_b591[48])});this.element.classList.add(_$_b591[388]);
this.element.jexcel=this;aa.build.call(this);ta.execute.call(this.parent,_$_b591[389],[this]);this.options.data&&500<this.options.data.length&&!I.limited.call(this)&&!this.options.pagination&&console.error(_$_b591[390])};return a},row:function(c,b){this.rows[c]||(this.rows[c]={element:null,y:c});b&&(this.rows[c].id=b,wa[_$_b591[11]].call(this,b));this.options.rows&&this.options.rows[c]&&this.options.rows[c].height&&(this.rows[c].height=this.options.rows[c].height);this.records[c]||(this.records[c]=
[]);this.options.data[c]||(this.options.data[c]=this.dataType?{}:[]);for(b=0;b<this.options.columns.length;b++)h.cell.call(this,b,c)},cell:function(c,b,a){typeof a==_$_b591[21]&&(a=O.call(this,c,b),null===a||void 0===a)&&(a=_$_b591[3],O.call(this,c,b,a));this.records[b][c]||(this.records[b][c]={element:null,x:c,y:b,v:a})},bind:function(c){for(var b=Object.keys(Ca),a=0;a<b.length;a++)(b[a]==_$_b591[391]?window:c).addEventListener(b[a],Ca[b[a]],b[a]==_$_b591[392]||b[a]==_$_b591[393]||b[a]==_$_b591[394]?
{passive:!1}:{})},unbind:function(c){for(var b=Object.keys(Ca),a=0;a<b.length;a++)(b[a]==_$_b591[391]?window:c).removeEventListener(b[a],Ca[b[a]])}};return h}(),$a=function(){var h=function(c){c.getWidth=h[_$_b591[54]];c.setWidth=h[_$_b591[11]]};h[_$_b591[54]]=function(c){var b=this.options.columns;if(typeof c===_$_b591[21]){c=[];for(var a=0;a<b.length;a++)c.push(b[a].width)}else c=b[c].width;return c};h[_$_b591[11]]=function(c,b,a){if(!Q.call(this.parent,this))return!1;if(b){if(Array.isArray(c)){a||
(a=[]);for(var d=0;d<c.length;d++){a[d]||(a[d]=this.options.columns[c[d]].width);var e=Array.isArray(b)&&b[d]?b[d]:b;this.options.columns[c[d]].width=e;this.colgroup[c[d]]&&this.colgroup[c[d]].setAttribute(_$_b591[172],e)}}else a||(a=this.options.columns[c].width),this.options.columns[c].width=b,this.colgroup[c]&&this.colgroup[c].setAttribute(_$_b591[172],b);this.refreshBorders();V.call(this.parent,{worksheet:this,action:_$_b591[84],column:c,oldValue:a,newValue:b});K.call(this,_$_b591[84],{column:c,
width:b,oldWidth:a});G.call(this.parent,_$_b591[395],this,c,b,a);I.call(this,!0)}};return h}(),ab=function(){var h=function(b){b.getHeight=h[_$_b591[54]];b.setHeight=h[_$_b591[11]]};h[_$_b591[54]]=function(b){if(void 0===b){b=[];for(var a=0;a<this.rows.length;a++){var d=ca.height.call(this,a);d&&(b[a]=d)}}else b=ca.height.call(this,b);return b};var c=function(b,a){a=parseInt(a);var d=ca.height.call(this,b);this.rows[b].element.style.height=a+_$_b591[55];this.options.rows[b]||(this.options.rows[b]=
{});this.options.rows[b].height=a+_$_b591[55];this.rows[b].height=a;return d};h[_$_b591[11]]=function(b,a,d){if(!Q.call(this.parent,this))return!1;var e,g=typeof d==_$_b591[21]?!0:!1;if(a){if(Array.isArray(b))for(!0===g&&(d=[]),e=0;e<b.length;e++){var f=Array.isArray(a)&&a[e]?a[e]:a;c.call(this,b[e],f);1==g&&d.push(g)}else e=c.call(this,b,a),1==g&&(d=e);this.refreshBorders();V.call(this.parent,{worksheet:this,action:_$_b591[85],row:b,oldValue:d,newValue:a});K.call(this,_$_b591[85],{row:b,height:a,
oldHeight:d});G.call(this.parent,_$_b591[396],this,b,a,d);I.call(this,!0)}};return h}(),ha=function(){var h=function(f){var k=e[f];f=a[e[f]];if(!f.element){f.element=document.createElement(_$_b591[397]);f.element.innerHTML=f.value;var l=document.createElement(_$_b591[245]);l.type=_$_b591[277];l.value=k;l.o=f;f.element.insertBefore(l,f.element.firstChild)}f.element.firstChild.checked=f.selected;return f.element},c=null,b=null,a=[],d=0,e=null,g=function(f){f.setFilter=g[_$_b591[11]];f.getFilter=g[_$_b591[54]];
f.openFilter=g.open;f.closeFilter=g.close;f.resetFilters=g.reset;f.showFilter=g.show;f.hideFilter=g.hide};g.isVisible=function(){return b};g[_$_b591[11]]=function(f,k){var l=this.headers[f];f=this.options.columns[f];Array.isArray(k)&&0<k.length?(l&&l.classList.add(_$_b591[398]),f.filters=k):(l&&l.classList.remove(_$_b591[398]),f.filters=null);g.update.call(this)};g[_$_b591[54]]=function(f){if(f)return this.options.columns[f].filters||null;f={};for(var k=0;k<this.options.columns.length;k++)f[k]=this.options.columns[k].filters||
null;return f};g.open=function(f){c=parseInt(f);if(this.headers[c].classList.contains(_$_b591[189])){b=!0;var k=this.parent.element.getBoundingClientRect(),l=this.headers[c].getBoundingClientRect();f=l.left-k.left;var n=l.top-k.top+l.height;l=this.parent.filter;k=k.left+k.width;l.style.display=_$_b591[24];f+l.offsetWidth>k&&(f=k-(l.offsetWidth+18));l.style.top=n+_$_b591[55];l.style.left=f+_$_b591[55];l.children[0].focus();f=l.children[1].selectAll;l.children[1].textContent=_$_b591[3];l.children[1].appendChild(f);
f.children[0].checked=this.options.columns[c].filters?!1:!0;f=ua.execute.call(this,null,c);f=F.invert(f);l=[];for(k=0;k<this.rows.length;k++)if(f[k]){n=_$_b591[3]+O.call(this,c,k);var q=_$_b591[3]+ka.processed.call(this,c,k,!0);n.substr(0,1)==_$_b591[18]&&(n=q);l.push([n,q])}l.sort(function(p,v){return p[0]>v[0]?1:p[0]<v[0]?-1:0});a=[];for(k=0;k<l.length;k++)a[l[k][0]]={value:l[k][1],element:null};(f=G.call(this.parent,_$_b591[400],this,c,a))&&(a=f);void 0!==a[_$_b591[3]]&&(delete a[_$_b591[3]],a[_$_b591[3]]=
{value:_$_b591[235]+E(_$_b591[401])+_$_b591[257],element:null});g.search.call(this,_$_b591[3])}else console.log(_$_b591[399])};g.close=function(f){if(f){f=this.parent.filter.children[1];if(1==f.selectAll.firstChild.checked&&e.length==Object.keys(a).length)f=null;else{f=1==f.currentSelection.firstChild.checked?this.options.columns[c].filters||[]:[];for(var k=0;k<e.length;k++)a[e[k]].selected&&f.push(e[k])}g[_$_b591[11]].call(this,c,f)}this.parent.filter.style.display=_$_b591[3];this.parent.filter.children[0].value=
_$_b591[3];c=null;b=!1;a=null;d=0;e=null};g.reset=function(f){g.updateDOM.call(this,f,!1);ya.reset.call(this);g.update.call(this)};g.execute=function(f){for(var k=this.options.columns,l=[],n=0;n<this.options.data.length;n++){for(var q=!0,p=0;p<k.length;p++)if(k[p].filters&&f!==p){var v=_$_b591[3]+O.call(this,p,n),x=_$_b591[3]+this.getLabelFromCoords(p,n,!0);-1==k[p].filters.indexOf(v)&&-1==k[p].filters.indexOf(x)&&(q=!1)}q&&l.push(n)}return l};g.update=function(){ya.reset.call(this);this.resetSelection();
this.resetBorders();var f=ua.execute.call(this,null);if(typeof this.parent.config.onbeforefilter==_$_b591[98]){var k=g[_$_b591[54]].call(this),l=G.call(this.parent,_$_b591[402],this,k,f);if(l)f=l;else if(!1===l)return!1}this.pageNumber=0;f&&f.length<this.rows.length&&ya[_$_b591[11]].call(this,f);ba.refresh.call(this);I.call(this,!0);G.call(this.parent,_$_b591[403],this,k,f)};g.show=function(f){g.updateDOM.call(this,f,!0)};g.hide=function(f){g.updateDOM.call(this,f,!1,!0);g.update.call(this)};g.search=
function(f){for(var k=this.parent.filter.children[1];k.children[1];)k.removeChild(k.lastChild);k.currentSelection.firstChild.checked=!1;if(f){e=[];f=new RegExp(f,_$_b591[404]);for(var l=Object.keys(a),n=0;n<l.length;n++)a[l[n]]&&(_$_b591[3]+a[l[n]].value).match(f)?(e.push(l[n]),a[l[n]].selected=!0):a[l[n]].selected=!1;e.length&&this.options.columns[c].filters&&(k.firstChild.checked=!0,k.appendChild(k.currentSelection))}else{e=Object.keys(a);if(f=this.options.columns[c].filters)for(n=0;n<e.length;n++)a[e[n]].selected=
!1,0<=f.indexOf(e[n])&&(a[e[n]].selected=!0);else for(n=0;n<e.length;n++)a[e[n]].selected=!0;k.firstChild.checked=f?!1:!0}for(n=d=0;n<e.length;n++)200>n&&(f=d++,k.appendChild(h(f)))};g.build=function(){var f=document.createElement(_$_b591[28]);f.className=_$_b591[405];f.onclick=function(q){q.target.tagName==_$_b591[406]&&q.target.o&&(q.target.o.selected=q.target.checked);q=!0;for(var p=1;p<this.children.length;p++)this.children[p].children[0].checked||(q=!1);this.children[0].children[0].checked=q};
var k=document.createElement(_$_b591[245]);k.type=_$_b591[67];k.placeholder=E(_$_b591[407]);k.classList.add(_$_b591[408]);k.classList.add(_$_b591[246]);var l=document.createElement(_$_b591[245]);l.type=_$_b591[409];l.value=_$_b591[410];l.className=_$_b591[411];var n=document.createElement(_$_b591[28]);n.className=_$_b591[412];n.appendChild(k);n.appendChild(f);n.appendChild(l);f.currentSelection=document.createElement(_$_b591[397]);f.currentSelection.innerHTML=_$_b591[413]+E(_$_b591[414]);f.selectAll=
document.createElement(_$_b591[397]);f.selectAll.innerHTML=_$_b591[415]+E(_$_b591[416])+_$_b591[257];f.selectAll.onclick=function(){for(var q=this.children[0].checked,p=1;p<this.parentNode.children.length;p++)this.parentNode.children[p].children[0].checked=q;if(1==q)for(p=0;p<e.length;p++)a[e[p]].selected=!0;else for(q=Object.keys(a),p=0;p<q.length;p++)a[q[p]].selected=!1};jSuites.lazyLoading(f,{loadDown:function(q){for(q=0;d<e.length-1&&10>q;){var p=d++;f.appendChild(h(p));q++}}});return n};g.updateDOM=
function(f,k,l){var n=this.headers,q=function(p){1==k?n[p].classList.add(_$_b591[189]):(this.options.columns[p].filters=null,n[p].classList.remove(_$_b591[398]),1==l&&n[p].classList.remove(_$_b591[189]))};if(f)q.call(this,f);else for(f=0;f<n.length;f++)q.call(this,f)};g.onload=function(){var f,k=!1;if(f=this.options.columns)for(var l=0;l<f.length;l++)Array.isArray(f[l].filters)&&0<f[l].filters.length&&this.headers[l]&&(this.headers[l].classList.add(_$_b591[398]),k=!0);1==k&&g.update.call(this)};return g}(),
ya=function(){var h={};h[_$_b591[11]]=function(c){for(var b=0;b<c.length;b++)this.rows[c[b]].results=!0;this.results=c};h.reset=function(){for(var c=0;c<this.rows.length;c++)!0===this.rows[c].results&&delete this.rows[c].results;this.results=null};h.refresh=function(){for(var c=[],b=0;b<this.rows.length;b++)!0===this.rows[b].results&&c.push(b);return c};return h}(),ua=function(){var h=function(d){var e=document.createElement(_$_b591[28]);if(0<d.options.pagination&&d.options.paginationOptions&&0<d.options.paginationOptions.length){d.paginationDropdown=
document.createElement(_$_b591[417]);d.paginationDropdown.classList.add(_$_b591[418]);d.paginationDropdown.onchange=function(){d.options.pagination=parseInt(this.value);d.page(0)};for(var g=0;g<d.options.paginationOptions.length;g++){var f=document.createElement(_$_b591[419]);f.value=d.options.paginationOptions[g];f.innerHTML=d.options.paginationOptions[g];d.paginationDropdown.appendChild(f)}d.paginationDropdown.value=d.options.pagination;e.appendChild(document.createTextNode(E(_$_b591[420])));e.appendChild(d.paginationDropdown);
e.appendChild(document.createTextNode(E(_$_b591[421])))}return e},c=function(d){var e=document.createElement(_$_b591[28]);e.innerHTML=E(_$_b591[407])+_$_b591[130];d.searchInput=document.createElement(_$_b591[245]);d.searchInput.classList.add(_$_b591[422]);d.searchInput.classList.add(_$_b591[246]);e.appendChild(d.searchInput);return e},b=function(d,e){var g=this.merged.rows;if(g[e]){for(;0<e&&g[e-1];)e--;for(;g[e];)d.push(e++)}else d.push(e)},a=function(d){d.search=a.update;d.resetSearch=a.reset;d.updateSearch=
a.refresh;d.showSearch=a.show;d.hideSearch=a.hide};a.execute=function(d,e){null===d?d=this.searchInput.value||_$_b591[3]:d!==this.searchInput.value&&(this.searchInput.value=d);this.pageNumber=0;var g=[],f=null;e=ha.execute.call(this,e);if(d)try{d=new RegExp(d,_$_b591[404]);for(var k=0;k<this.rows.length;k++){f=!1;if(!e||0<=e.indexOf(k))for(var l=0;l<this.options.columns.length;l++){var n=_$_b591[3]+O.call(this,l,k),q=_$_b591[3]+this.getLabelFromCoords(l,k);if(n.match(d)||q.match(d))f=!0}1==f&&b.call(this,
g,k)}}catch(p){}else g=e;if(g.length){for(k=0;k<this.rows.length;k++)!0===this.rows[k].results&&g.push(k);g.sort(function(p,v){return p-v})}return g};a.update=function(d){ya.reset.call(this);this.resetSelection();this.resetBorders();var e=a.execute.call(this,d);if(typeof this.parent.config.onbeforesearch==_$_b591[98]){var g=G.call(this.parent,_$_b591[423],this,d,e);if(g)e=g;else if(!1===g)return!1}this.pageNumber=0;e&&e.length<this.rows.length&&ya[_$_b591[11]].call(this,e);ba.refresh.call(this);I.call(this,
!0);G.call(this.parent,_$_b591[424],this,d,e)};a.refresh=function(){I.update.call(this);ba.refresh.call(this)};a.reset=function(){this.searchInput.value=_$_b591[3];ya.reset.call(this);I.update.call(this);ba.refresh.call(this)};a.show=function(){this.options.search=!0;this.searchContainer.style.display=_$_b591[3]};a.hide=function(){this.options.search=!1;this.searchContainer.style.display=_$_b591[48]};a.build=function(){this.searchContainer=document.createElement(_$_b591[28]);this.searchContainer.classList.add(_$_b591[425]);
this.searchContainer.appendChild(h(this));this.searchContainer.appendChild(c(this));0==this.options.search&&(this.searchContainer.style.display=_$_b591[48]);this.element.insertBefore(this.searchContainer,this.element.firstChild)};return a}(),Sa=function(){var h=function(c){c.contextmenu=document.createElement(_$_b591[28]);c.contextmenu.className=_$_b591[426];jSuites.contextmenu(c.contextmenu,{onclick:function(b,a,d){b.close()}});return c.contextmenu};h.open=function(c,b){if(b[0]===_$_b591[427])var a=
b[1],d=b[2];else b[0]===_$_b591[428]?(a=null,d=b[1]):b[0]===_$_b591[429]&&(a=b[1],d=null);var e=h[_$_b591[54]](this,a,d,c,b[0],b[1],b[2]);if(typeof this.parent.config.contextMenu==_$_b591[98]){var g=this.parent.config.contextMenu(this,a,d,c,e,b[0],b[1],b[2]);if(g)e=g;else if(!1===g)return!1}c.preventDefault();g=ta.execute.call(this.parent,_$_b591[99],[this,a,d,c,e,b[0],b[1],b[2]]);e=g[4];this.parent.contextmenu.contextmenu.open(c,e)};h.isOpened=function(){return this.parent.contextmenu.contextmenu.isOpened()};
h[_$_b591[54]]=function(c,b,a,d,e,g,f){var k=[],l=c.parent.config,n=-1!=navigator.userAgent.indexOf(_$_b591[430])?_$_b591[431]:_$_b591[432];e==_$_b591[433]&&(1==l.allowRenameWorksheet&&k.push({title:E(_$_b591[434]),onclick:function(){var p=prompt(E(_$_b591[434]),d.target.innerText);p&&c.parent.renameWorksheet(g,p)}}),1==l.allowDeleteWorksheet&&k.push({title:E(_$_b591[435]),onclick:function(){confirm(E(_$_b591[436]),d.target.innerText)&&c.parent.deleteWorksheet(g)}}),k.push({type:_$_b591[437]}));e==
_$_b591[438]&&(k.push({title:E(_$_b591[439]),onclick:function(){var p=prompt(E(_$_b591[439]),d.target.innerText);c.setNestedCell(g,f,{title:p})}}),k.push({type:_$_b591[437]}));if(e==_$_b591[429]||e==_$_b591[428]||e==_$_b591[427]||e==_$_b591[438])k.push({title:E(_$_b591[440]),icon:_$_b591[441],shortcut:n+_$_b591[442],onclick:function(){c.cut()}}),k.push({title:E(_$_b591[443]),icon:_$_b591[444],shortcut:n+_$_b591[445],onclick:function(){c.copy()}}),navigator&&navigator.clipboard&&navigator.clipboard.readText&&
k.push({title:E(_$_b591[446]),icon:_$_b591[447],shortcut:n+_$_b591[448],onclick:function(){c.selectedCell&&navigator.clipboard.readText().then(function(p){p&&c.paste(c.selectedCell[0],c.selectedCell[1],p)})}}),k.push({type:_$_b591[437]});e==_$_b591[429]&&(1==c.options.allowInsertColumn&&k.push({title:E(_$_b591[449]),onclick:function(){c.insertColumn(1,parseInt(g),1)}}),1==c.options.allowInsertColumn&&k.push({title:E(_$_b591[450]),onclick:function(){c.insertColumn(1,parseInt(g),0)}}),1==c.options.allowDeleteColumn&&
k.push({title:E(_$_b591[451]),onclick:function(){c.deleteColumn(c.getSelectedColumns().length?void 0:parseInt(b))}}),1==c.options.allowRenameColumn&&k.push({title:E(_$_b591[452]),onclick:function(){c.setHeader(g)}}),c.options.data.length||(k.push({type:_$_b591[437]}),k.push({title:E(_$_b591[453]),onclick:function(){c.insertRow(0)}})),1==c.options.columnSorting&&(k.push({type:_$_b591[437]}),k.push({title:E(_$_b591[454]),onclick:function(){c.orderBy(g,0)}}),k.push({title:E(_$_b591[455]),onclick:function(){c.orderBy(g,
1)}}),k.push({type:_$_b591[437]})));if(e==_$_b591[427]||e==_$_b591[428])1==c.options.allowInsertRow&&(k.push({title:E(_$_b591[456]),onclick:function(){c.insertRow(1,parseInt(a),1)}}),k.push({title:E(_$_b591[457]),onclick:function(){c.insertRow(1,parseInt(a))}})),1==c.options.allowDeleteRow&&k.push({title:E(_$_b591[458]),onclick:function(){c.deleteRow(c.getSelectedRows().length?void 0:parseInt(a))}}),k.push({type:_$_b591[437]});if(e==_$_b591[427]&&1==c.options.allowComments){var q=c.records[f][g].element.getAttribute(_$_b591[292])||
_$_b591[3];k.push({title:q?E(_$_b591[459]):E(_$_b591[460]),icon:_$_b591[461],onclick:function(){var p=F.getColumnNameFromCoords(g,f),v=prompt(E(_$_b591[462]),q);v&&c.setComments(p,v)}});q&&k.push({title:E(_$_b591[463]),onclick:function(){var p=F.getColumnNameFromCoords(g,f);c.setComments(p,_$_b591[3])}});k.push({type:_$_b591[437]})}l.allowExport&&k.push({title:E(_$_b591[464]),icon:_$_b591[465],shortcut:n+_$_b591[466],onclick:function(){c.download()}});l.about&&k.push({title:E(_$_b591[467]),icon:_$_b591[468],
onclick:function(){!0===l.about?alert(M().print()):alert(l.about)}});return k};return h}(),ia=function(){var h=function(c){c.showToolbar=function(){h.show.call(c.parent)};c.hideToolbar=function(){h.hide.call(c.parent)};c.refreshToolbar=function(){h.update.call(c.parent,c)}};h[_$_b591[11]]=function(c){this.toolbar.innerHTML=_$_b591[3];this.config.toolbar=h[_$_b591[54]].call(this,c);h.show.call(this)};h[_$_b591[54]]=function(c){c||(c=this.config.toolbar);var b=h.getDefault(c);c?Array.isArray(c)?c={items:c}:
typeof c===_$_b591[98]&&(c=c({items:b})):c={};typeof c!==_$_b591[97]&&(c={});c.items||(c.items=b);typeof c.responsive==_$_b591[21]&&(c.responsive=!0,c.bottom=!1,c.maxWidth=this.element.offsetWidth);return c};h.show=function(){this.toolbar.innerHTML||h.build.call(this);this.toolbar.style.display=_$_b591[3];this.element.classList.add(_$_b591[469])};h.hide=function(){this.toolbar.style.display=_$_b591[48];this.element.classList.remove(_$_b591[469])};h.update=function(c,b){var a=this.toolbarInstance;
a&&(a.options.responsive&&(b=this.config.fullscreen?c.element.offsetWidth:c.options.tableWidth?parseInt(c.options.tableWidth):null,a.options.maxWidth=b,a.refresh()),a.update(c))};h.build=function(){for(var c=h[_$_b591[54]].call(this),b=0;b<c.items.length;b++)if(c.items[b].type==_$_b591[417]){if(!c.items[b].options&&c.items[b].v){c.items[b].options=[];for(var a=0;a<c.items[b].v.length;a++)c.items[b].options.push(c.items[b].v[a]);c.items[b].k&&(c.items[b].onchange=function(d,e,g,f){u.current.setStyle(u.current.getSelected(!1,
!0),g.k,f)})}}else c.items[b].type==_$_b591[282]?(c.items[b].type=_$_b591[470],c.items[b].onclick=function(d,e,g){if(!g.color){var f=null;jSuites.color(g,{onchange:function(k,l){(f=u.current.getSelected(!1,!0))&&u.current.setStyle(f,g.k,l)},onopen:function(k){var l;u.current.cursor?(l=u.current.cursor.style[g.k])?k.color.select(k.color.toHex(l)):k.color.select(_$_b591[3]):k.color.select(_$_b591[3])}});g.color.open()}}):!c.items[b].onclick&&c.items[b].k&&(c.items[b].onclick=function(){u.current.setStyle(u.current.getSelected(!1,
!0),this.k,this.v)});(b=ta.execute.call(this,_$_b591[100],[c]))&&(c=b[0]);this.toolbarInstance=jSuites.toolbar(this.toolbar,c);this.toolbarInstance.application=this;c=this.element.tabs.getActive();this.toolbarInstance.update(this.worksheets[c])};h.getDefault=function(c){var b=[];b.push({content:_$_b591[471],onclick:function(){u.current&&u.current.undo()}});b.push({content:_$_b591[472],onclick:function(){u.current&&u.current.redo()}});b.push({content:_$_b591[465],onclick:function(){u.current&&u.current.download()}});
b.push({type:_$_b591[473]});b.push({type:_$_b591[417],width:_$_b591[474],options:[_$_b591[475],_$_b591[476],_$_b591[477]],render:function(d){return _$_b591[478]+d+_$_b591[252]+d+_$_b591[479]},onchange:function(d,e,g,f){u.current&&u.current.setStyle(u.current.getSelected(!1,!0),_$_b591[480],f)}});b.push({type:_$_b591[417],width:_$_b591[481],content:_$_b591[482],options:[_$_b591[483],_$_b591[484],_$_b591[485],_$_b591[486],_$_b591[487]],render:function(d){return _$_b591[488]+d+_$_b591[252]+d+_$_b591[479]},
onchange:function(d,e,g,f){u.current&&u.current.setStyle(u.current.getSelected(!1,!0),_$_b591[489],f)}});b.push({type:_$_b591[417],options:[_$_b591[490],_$_b591[491],_$_b591[492],_$_b591[493]],render:function(d){return _$_b591[494]+d+_$_b591[495]},onchange:function(d,e,g,f){u.current&&u.current.setStyle(u.current.getSelected(!1,!0),_$_b591[496],f.split(_$_b591[497])[2])},updateState:function(d,e,g,f){(d=f.selectedCell)&&d.length&&f.records[d[1]][d[0]].element&&(f=this.picker.options.data.indexOf(_$_b591[498]+
(f.records[d[1]][d[0]].element.style.textAlign||f.options.defaultColAlign||_$_b591[203])),g.picker.setValue(f))}});b.push({type:_$_b591[470],content:_$_b591[499],k:_$_b591[500],v:_$_b591[501]});b.push({type:_$_b591[282],content:_$_b591[502],k:_$_b591[282]});b.push({type:_$_b591[282],content:_$_b591[503],k:_$_b591[504]});if(c===_$_b591[505]||typeof c===_$_b591[98]){var a=[_$_b591[506],_$_b591[507],_$_b591[383]];b.push({type:_$_b591[417],options:[_$_b591[508],_$_b591[509],_$_b591[510]],render:function(d){return _$_b591[494]+
d+_$_b591[495]},value:1,onchange:function(d,e,g,f,k){u.current&&u.current.setStyle(u.current.getSelected(!1,!0),_$_b591[511],a[k])},updateState:function(d,e,g,f){(d=f.selectedCell)&&d.length&&f.records[d[1]][d[0]].element&&(f=a.indexOf(f.records[d[1]][d[0]].element.style.verticalAlign||_$_b591[507]),g.picker.setValue(f))}});b.push({content:_$_b591[512],onclick:function(d,e,g){u.current&&(d=u.current.getHighlighted())&&d.length&&(e=u.helpers.getColumnNameFromCoords(d[0],d[1]),u.current.records[d[1]][d[0]].merged?
u.current.removeMerge(e):u.current.setMerge(e,d[2]-d[0]+1,d[3]-d[1]+1))},tooltip:E(_$_b591[513])})}b.push({type:_$_b591[417],data:[_$_b591[514],_$_b591[515],_$_b591[516],_$_b591[517],_$_b591[518],_$_b591[519],_$_b591[520],_$_b591[521],_$_b591[522],_$_b591[523]],columns:5,render:function(d){return _$_b591[494]+d+_$_b591[495]},right:!0,onchange:function(d,e,g,f,k){if(d=u.current.getHighlighted()){g=e.thickness||1;e=e.color||_$_b591[524];k={};for(var l=d[0],n=d[1],q=d[2],p=d[3],v=d[1];v<=d[3];v++)for(var x=
d[0];x<=d[2];x++){var w=F.getColumnNameFromCoords(x,v);k[w]||(k[w]=_$_b591[3]);k[w]=f!=_$_b591[519]&&f!=_$_b591[515]||x!=l?(f==_$_b591[516]||f==_$_b591[518])&&x>l?k[w]+(_$_b591[525]+g+_$_b591[526]+e+_$_b591[323]):f==_$_b591[514]?k[w]+(_$_b591[525]+g+_$_b591[526]+e+_$_b591[323]):k[w]+_$_b591[527]:k[w]+(_$_b591[525]+g+_$_b591[526]+e+_$_b591[323]);k[w]=f!=_$_b591[514]&&f!=_$_b591[521]&&f!=_$_b591[515]||x!=q?k[w]+_$_b591[529]:k[w]+(_$_b591[528]+g+_$_b591[526]+e+_$_b591[323]);k[w]=f!=_$_b591[520]&&f!=
_$_b591[515]||v!=n?(f==_$_b591[516]||f==_$_b591[517])&&v>n?k[w]+(_$_b591[530]+g+_$_b591[526]+e+_$_b591[323]):f==_$_b591[514]?k[w]+(_$_b591[530]+g+_$_b591[526]+e+_$_b591[323]):k[w]+_$_b591[531]:k[w]+(_$_b591[530]+g+_$_b591[526]+e+_$_b591[323]);k[w]=f!=_$_b591[514]&&f!=_$_b591[522]&&f!=_$_b591[515]||v!=p?k[w]+_$_b591[533]:k[w]+(_$_b591[532]+g+_$_b591[526]+e+_$_b591[323])}Object.keys(k)&&u.current.setStyle(k,null,null,!0)}},onload:function(d,e){var g=document.createElement(_$_b591[28]),f=document.createElement(_$_b591[28]);
g.appendChild(f);var k=jSuites.color(f,{closeOnChange:!1,onchange:function(l,n){l.parentNode.children[1].style.color=n;e.color=n}});f=document.createElement(_$_b591[470]);f.classList.add(_$_b591[534]);f.innerHTML=_$_b591[535];f.onclick=function(){k.open()};g.appendChild(f);d.children[1].appendChild(g);f=document.createElement(_$_b591[28]);jSuites.picker(f,{type:_$_b591[417],data:[1,2,3,4,5],render:function(l){return _$_b591[536]+l+_$_b591[537]},onchange:function(l,n,q,p){e.thickness=p},width:_$_b591[538]});
d.children[1].appendChild(f);f=document.createElement(_$_b591[28]);f.style.flex=_$_b591[539];d.children[1].appendChild(f)}});b.push({type:_$_b591[473]});b.push({content:_$_b591[23],onclick:function(d,e,g){g.children[0].innerText==_$_b591[23]?(u.current.fullscreen(!0),g.children[0].innerText=_$_b591[540]):(u.current.fullscreen(!1),g.children[0].innerText=_$_b591[23])},tooltip:_$_b591[541],updateState:function(d,e,g,f){g.children[0].innerText=1==f.parent.config.fullscreen?_$_b591[540]:_$_b591[23]}});
b.push({content:_$_b591[542],onclick:function(d,e,g){g.children[0].innerText==_$_b591[542]?(ua.show.call(u.current),g.children[0].innerText=_$_b591[543]):(ua.hide.call(u.current),g.children[0].innerText=_$_b591[542])},tooltip:_$_b591[544],updateState:function(d,e,g,f){g.children[0].innerText=1==f.options.search?_$_b591[543]:_$_b591[542]}});return b};return h}(),la=function(){var h=function(c){c.createWorksheet=function(b){return c.parent.createWorksheet(b)};c.deleteWorksheet=function(b){return c.parent.deleteWorksheet(b)};
c.renameWorksheet=function(b,a){return c.parent.renameWorksheet(b,a)};c.moveWorksheet=function(b,a){return c.parent.moveWorksheet(b,a)};c.openWorksheet=function(){return c.parent.openWorksheet(c.parent.getWorksheet(c))};c.getWorksheet=function(b){return c.parent.getWorksheet(b)};c.getWorksheetActive=function(){return c.parent.getWorksheetActive()};c.getWorksheetName=function(){return c.options.worksheetName.toUpperCase()}};h.nextName=function(){var c=1,b,a=u.spreadsheet;if(a.length)for(var d=0;d<
a.length;d++){var e=a[d].worksheets;if(e.length)for(var g=0;g<e.length;g++)e[g].options.worksheetName&&(b=e[g].options.worksheetName.match(/(\d+)/))&&(b=parseInt(b[0])+1,b>c&&(c=b))}return c};h.createWorksheet=function(c){if(!Q.call(this))return!1;c||(c={});var b=this.worksheets.length,a=G.call(this,_$_b591[545],c,b);if(typeof a===_$_b591[97])c=a;else if(!1===a)return!1;c.data||c.minDimensions||(c.minDimensions=[8,8]);c.worksheetId||(c.worksheetId=jSuites.guid().substring(0,8));c.worksheetName||(c.worksheetName=
_$_b591[385]+h.nextName());if(H(c.worksheetName))jSuites.notification({error:_$_b591[539],message:_$_b591[546]});else return a=ra.worksheet(this,c),a.onload(),u.current&&u.current.resetSelection(),u.current=a,K.call(a,_$_b591[547],[c]),ia.update.call(this,u.current),G.call(this,_$_b591[548],a,c,b),a};h.deleteWorksheet=function(c){var b=this.worksheets[c];if(!Q.call(this,b))return!1;H(b.options.worksheetName,null);this.element.tabs.deleteElement(c);this.worksheets.splice(c,1);K.call(b,_$_b591[549],
[c]);G.call(this,_$_b591[550],b,c)};h.renameWorksheet=function(c,b){var a=this.worksheets[c];if(!Q.call(this,a))return!1;var d=a.options.worksheetName;if(d.toLowerCase()==b.toLowerCase())return!1;b=b.replace(/[^0-9A-Za-z_\s^]+/gi,_$_b591[3]);Number(b)==b&&(b=_$_b591[385]+Number(b));H(b)?alert(_$_b591[551]):(H(d,null),this.element.tabs.rename(c,b),a.options.worksheetName=b,H(b,a),V.call(this,{worksheet:a,action:_$_b591[92],index:c,oldValue:d,newValue:b}),K.call(a,_$_b591[92],{worksheet:c,newValue:b}),
Ha.updateWorksheetName.call(a,d,b),X.updateWorksheetNames.call(a,d,b),G.call(this,_$_b591[552],a,c,b,d))};h.updateWorksheet=function(c,b){var a=this.worksheets;if(!Q.call(this))return!1;this.worksheets.splice(b,0,a.splice(c,1)[0]);V.call(this,{worksheet:a[b],action:_$_b591[93],f:c,t:b});K.call(a[b],_$_b591[93],{f:c,t:b});G.call(this,_$_b591[553],a[b],c,b)};h.moveWorksheet=function(c,b){this.element.tabs.move(c,b)};h.openWorksheet=function(c){var b=this.worksheets[c];!b||u.current&&u.current==b||(this.element.tabs.getActive()!=
c?this.element.tabs.open(c):this.element.tabs.setBorder(c),u.current&&u.current.resetSelection(),u.current=b,u.current.refreshBorders(),h.state.call(this,c),ia.update.call(this,u.current),G.call(this,_$_b591[554],b,c))};h.getWorksheet=function(c){if(c&&typeof c==_$_b591[97]){if(c=this.worksheets.indexOf(c),0<=c)return c}else for(var b=0;b<this.worksheets.length;b++)if(c===this.worksheets[b].options.worksheetId)return b;return!1};h.getWorksheetActive=function(){return this.element.tabs.getActive()};
h.getWorksheetInstance=function(c){return c===_$_b591[3]||typeof c==_$_b591[25]?(c=h.getWorksheet.call(this,c),!1===c?!1:this.worksheets[c]):this.worksheets[c]};h.state=function(c){try{if(typeof localStorage!==_$_b591[21]){var b=this.config.cloud?this.config.cloud:this.element.id;if(b)if(typeof c!==_$_b591[21])localStorage.setItem(_$_b591[363]+b,c);else{var a=parseInt(localStorage.getItem(_$_b591[363]+b));h.openWorksheet.call(this,a)}}}catch(d){}};return h}(),F=function(){var h={getCaretIndex:function(c){var b=
0,a=(this.config.root?this.config.root:window).getSelection();a&&0!==a.rangeCount&&(b=a.getRangeAt(0),a=b.cloneRange(),a.selectNodeContents(c),a.setEnd(b.endContainer,b.endOffset),b=a.toString().length);return b},invert:function(c){for(var b=[],a=Object.keys(c),d=0;d<a.length;d++)b[c[a[d]]]=a[d];return b},getColumnName:function(c){var b=_$_b591[3];701<c?(b+=String.fromCharCode(64+parseInt(c/676)),b+=String.fromCharCode(64+parseInt(c%676/26))):25<c&&(b+=String.fromCharCode(64+parseInt(c/26)));return b+=
String.fromCharCode(65+c%26)},getColumnNameFromCoords:function(c,b){return h.getColumnName(parseInt(c))+(parseInt(b)+1)},getCoordsFromColumnName:function(c){c=c.replace(new RegExp(/\$/),_$_b591[3]);var b=/^[a-zA-Z]+/.exec(c);if(b){for(var a=0,d=0;d<b[0].length;d++)a+=parseInt(b[0].charCodeAt(d)-64)*Math.pow(26,b[0].length-1-d);a--;0>a&&(a=0);c=parseInt(/[0-9]+$/.exec(c))||null;0<c&&c--;return[a,c]}}};h.shiftFormula=X.shiftFormula;h.updateWorksheetName=X.updateWorksheetName;h.createFromTable=function(c,
b){if(c.tagName!=_$_b591[555])console.log(_$_b591[556]);else{b||(b={});b.columns=[];b.data=[];var a=c.querySelectorAll(_$_b591[557]);if(a.length)for(var d=0;d<a.length;d++){var e=a[d].style.width;e||(e=a[d].getAttribute(_$_b591[172]));e&&(b.columns[d]||(b.columns[d]={}),b.columns[d].width=e)}e=function(y){var C=y.getBoundingClientRect();C=50<C.width?C.width:50;b.columns[d]||(b.columns[d]={});y.getAttribute(_$_b591[558])?b.columns[d].type=y.getAttribute(_$_b591[558]):b.columns[d].type=_$_b591[67];
b.columns[d].width=C+_$_b591[55];b.columns[d].title=y.innerHTML;y.style.textAlign&&(b.columns[d].align=y.style.textAlign);y.classList.contains(_$_b591[559])&&(b.columns[d].readOnly=!0);if(C=y.getAttribute(_$_b591[560]))b.columns[d].name=C;if(C=y.getAttribute(_$_b591[561]))b.columns[d].id=C};var g=[],f=c.querySelectorAll(_$_b591[562]);if(f.length){for(a=0;a<f.length-1;a++){var k=[];for(d=0;d<f[a].children.length;d++){var l={title:f[a].children[d].innerText,colspan:f[a].children[d].getAttribute(_$_b591[184])||
1};k.push(l)}g.push(k)}f=f[f.length-1].children;for(d=0;d<f.length;d++)e(f[d])}l=0;var n={},q={},p={},v={},x=null;k=c.querySelectorAll(_$_b591[563]);for(a=0;a<k.length;a++)if(b.data[l]=[],1!=b.parseTableFirstRowAsHeader||f.length||0!=a){for(d=0;d<k[a].children.length;d++){var w=k[a].children[d].getAttribute(_$_b591[564]);w?w.substr(0,1)!=_$_b591[18]&&(w=_$_b591[18]+w):w=k[a].children[d].innerHTML;b.data[l].push(w);w=F.getColumnNameFromCoords(d,a);(x=k[a].children[d].getAttribute(_$_b591[565]))&&(v[w]=
x);x=parseInt(k[a].children[d].getAttribute(_$_b591[184]))||0;var z=parseInt(k[a].children[d].getAttribute(_$_b591[185]))||0;if(x||z)n[w]=[x||1,z||1];if(x=k[a].children[d].style&&k[a].children[d].style.display==_$_b591[48])k[a].children[d].style.display=_$_b591[3];(x=k[a].children[d].getAttribute(_$_b591[113]))&&(p[w]=x);k[a].children[d].classList.contains(_$_b591[566])&&(p[w]=p[w]?p[w]+_$_b591[567]:_$_b591[568])}k[a].style&&k[a].style.height&&(q[a]={height:k[a].style.height});l++}else for(d=0;d<
k[a].children.length;d++)e(k[a].children[d]);0<Object.keys(g).length&&(b.nestedHeaders=g);0<Object.keys(p).length&&(b.style=p);0<Object.keys(n).length&&(b.mergeCells=n);0<Object.keys(q).length&&(b.rows=q);0<Object.keys(v).length&&(b.classes=v);k=c.querySelectorAll(_$_b591[569]);if(k.length){c=[];for(a=0;a<k.length;a++){e=[];for(d=0;d<k[a].children.length;d++)e.push(k[a].children[d].innerText);c.push(e)}0<Object.keys(c).length&&(b.footers=c)}if(1==b.parseTableAutoCellType)for(c=[],d=0;d<b.columns.length;d++){g=
e=!0;c[d]=[];for(a=0;a<b.data.length;a++)if(w=b.data[a][d],c[d][w]||(c[d][w]=0),c[d][w]++,25<w.length&&(e=!1),10==w.length){if(w.substr(4,1)!=_$_b591[208]||w.substr(7,1)!=_$_b591[208])g=!1}else g=!1;a=Object.keys(c[d]).length;g?b.columns[d].type=_$_b591[207]:1==e&&1<a&&a<=parseInt(.1*b.data.length)&&(b.columns[d].type=_$_b591[69],b.columns[d].source=Object.keys(c[d]))}return b}};h.injectArray=function(c,b,a){return c.slice(0,b).concat(a).concat(c.slice(b))};h.parseCSV=function(c,b){b=b||_$_b591[33];
for(var a=0,d=0,e=[[]],g=0,f=null,k=!1,l=!1,n=0;n<c.length;n++)if(e[d]||(e[d]=[]),e[d][a]||(e[d][a]=_$_b591[3]),c[n]!=_$_b591[570])if(c[n]!=_$_b591[571]&&c[n]!=b||0!=k&&1!=l&&f){c[n]==_$_b591[20]&&(k=!k);if(null===f){if(f=k,1==f)continue}else if(!0===f&&!l&&c[n]==_$_b591[20]){c[n+1]==_$_b591[20]?(k=!0,e[d][a]+=c[n],n++):l=!0;continue}e[d][a]+=c[n]}else{f=null;l=k=!1;if(e[d][a][0]==_$_b591[20]){var q=e[d][a].trim();q[q.length-1]==_$_b591[20]&&(e[d][a]=q.substr(1,q.length-2))}c[n]==_$_b591[571]?(a=
0,d++):(a++,a>g&&(g=a))}for(c=0;c<e.length;c++)for(n=0;n<=g;n++)void 0===e[c][n]&&(e[c][n]=_$_b591[3]);return e};h.getTokensFromRange=X.getTokensFromRange;h.getRangeFromTokens=X.getRangeFromTokens;h.getCoordsFromRange=function(c){-1!==c.indexOf(_$_b591[19])&&(c=c.split(_$_b591[19]),c=c[1]);c=c.split(_$_b591[150]);c[1]||(c[1]=c[0]);var b=F.getCoordsFromColumnName(c[0]);c=F.getCoordsFromColumnName(c[1]);return[b[0],b[1],c[0],c[1]]};return h}(),Ca=function(){var h={},c=null,b=null,a=null,d=null,e=!1,
g=null,f=null,k=null,l=function(r){function A(P){P.className&&(P.classList.contains(_$_b591[376])&&(J=P),P.classList.contains(_$_b591[388])&&(L=P),P.classList.contains(_$_b591[572])&&(T=P));P.tagName==_$_b591[573]?B=1:P.tagName==_$_b591[574]?B=2:P.tagName==_$_b591[575]&&(B=3);P.parentNode&&!J&&A(P.parentNode)}var B=null,D=null,J=null,L=null,T=null,N=null,U=null,Y=null;A(r.target);if(null!==T)return!1;if(J)if(r.target.classList.contains(_$_b591[357]))D=_$_b591[576];else if(r.target.classList.contains(_$_b591[366]))D=
_$_b591[152];else if(r.target.classList.contains(_$_b591[295]))D=_$_b591[428],N=parseInt(r.target.getAttribute(_$_b591[53]));else if(r.target.parentNode&&r.target.parentNode.classList&&r.target.parentNode.classList.contains(_$_b591[199]))N=r.target.getAttribute(_$_b591[204]),U=r.target.getAttribute(_$_b591[205]),null===N?D=_$_b591[576]:(D=_$_b591[438],N=parseInt(N),U=parseInt(U));else if(r.target.parentNode&&r.target.parentNode.classList&&r.target.parentNode.classList.contains(_$_b591[166]))D=_$_b591[577];
else if(r.target.classList.contains(_$_b591[170]))D=_$_b591[577];else if(r.target.parentNode&&r.target.parentNode.classList&&r.target.parentNode.classList.contains(_$_b591[578]))D=_$_b591[433],N=Array.prototype.indexOf.call(r.target.parentNode.children,r.target);else if(1==B)D=_$_b591[429],N=r.target.clientWidth-r.offsetX,r.target.classList.contains(_$_b591[189])&&3<N&&20>N&&(D=_$_b591[579]),N=r.target.getAttribute(_$_b591[52]);else if(2==B){if(r=n(r,J))D=_$_b591[427],N=r[0],U=r[1],Y=r[2]}else if(3==
B){if(N=r.target.getAttribute(_$_b591[52]),U=r.target.getAttribute(_$_b591[53]),N||U)D=_$_b591[580]}else B||jSuites.findElement(r.target,_$_b591[581])&&(D=_$_b591[100]);return[J,L,B,D,N,U,Y]},n=function(r,A){if(r.changedTouches&&r.changedTouches[0]){var B=r.changedTouches[0].clientX;r=r.changedTouches[0].clientY}else B=r.clientX,r=r.clientY;A=A.spreadsheet.config.root?A.spreadsheet.config.root:document;if(A.elementsFromPoint)var D=A.elementsFromPoint(B,r);else A.msElementsFromPoint&&(D=A.msElementsFromPoint(B,
r));for(A=0;A<D.length;A++)if(B=D[A].getAttribute(_$_b591[52]),r=D[A].getAttribute(_$_b591[53]),null!=B&&null!=r)return B=parseInt(B),r=parseInt(r),[B,r,D[A]];return!1},q=function(r){var A=l(r);if(!1===A)return!1;A[0]?A[1]?u.current&&document.activeElement.classList.contains(_$_b591[107])?document.activeElement.worksheet||(document.activeElement.worksheet=A[1].jexcel):u.current!=A[1].jexcel&&(u.current&&u.current.resetSelection(),u.current=A[1].jexcel):u.current||(r=A[0].tabs.getActive(),0<=r&&(u.current=
A[0].spreadsheet.worksheets[r])):u.current&&!jSuites.findElement(r.target,_$_b591[246])&&(u.current.resetSelection(!0),u.current=null);return A},p=function(r){I.limited.call(u.current)&&(f||(f=setTimeout(function(){var A=u.current.content.getBoundingClientRect();if(r.changedTouches&&r.changedTouches[0])var B=r.changedTouches[0].clientX,D=r.changedTouches[0].clientY;else B=r.clientX,D=r.clientY;50>A.height-(D-A.top)?I.down.call(u.current):80>D-A.top&&I.up.call(u.current);50>A.width-(B-A.left)?I.right.call(u.current):
80>B-A.left&&I.left.call(u.current);f=null},50)))};h.input=function(r){if(r.target.tagName==_$_b591[582]&&r.target.classList.contains(_$_b591[107])){var A=null;r.target.worksheet?A=r.target.worksheet:u.current&&(A=u.current);A&&oa.parse.call(A,r.target)}};h.keydown=function(r){if(u.current){r.target.tagName==_$_b591[582]&&r.target.classList.contains(_$_b591[107])&&oa.onkeydown.call(u.current,r);if(27==r.which){if(u.current.edition)return u.current.closeEditor(u.current.edition,!1),r.preventDefault(),
!1;if(va.event)return va.cancel.call(u.current,r),r.preventDefault(),!1;if(ea.event)return ea.cancel.call(u.current,r),!1;if(1==ha.isVisible())return ha.close.call(u.current,!1),r.preventDefault(),!1}if(r.target.classList.contains(_$_b591[408])){var A=r.target;g&&clearTimeout(g);g=setTimeout(function(){ha.search.call(u.current,A.value);g=null},500)}else if(r.target.classList.contains(_$_b591[422]))A=r.target,g&&clearTimeout(g),g=setTimeout(function(){u.current.search(A.value);g=null},400);else if(!r.target.classList.contains(_$_b591[246]))if(u.current.edition){var B=
u.current.edition.getAttribute(_$_b591[52]);13==r.which?u.current.options.columns[B].type==_$_b591[207]?u.current.closeEditor(u.current.edition,!0):u.current.options.columns[B].type!=_$_b591[69]&&u.current.options.columns[B].type!=_$_b591[583]&&u.current.options.columns[B].type!=_$_b591[461]&&(r.altKey?u.current.parent.input.classList.contains(_$_b591[584])||document.execCommand(_$_b591[585],!1,_$_b591[586]):(u.current.closeEditor(u.current.edition,!0),u.current.parent.config.moveDownOnEnter&&u.current.down(),
r.preventDefault())):9==r.which?(u.current.closeEditor(u.current.edition,!0),u.current.right(),r.preventDefault()):39!=r.which&&37!=r.which&&38!=r.which&&40!=r.which||u.current.parent.input.selected||(u.current.closeEditor(u.current.edition,!0),37==r.which?u.current.left(r.shiftKey,r.ctrlKey):39==r.which?u.current.right(r.shiftKey,r.ctrlKey):38==r.which?u.current.up(r.shiftKey,r.ctrlKey):40==r.which&&u.current.down(r.shiftKey,r.ctrlKey),r.preventDefault())}else if(u.current.selectedCell)if(33==r.which)0<
u.current.options.pagination?Ba.pageUp.call(u.current):r.altKey?I.pageLeft.call(u.current):I.pageUp.call(u.current);else if(34==r.which)0<u.current.options.pagination?Ba.pageDown.call(u.current):r.altKey?I.pageRight.call(u.current):I.pageDown.call(u.current);else if(37==r.which)u.current.left(r.shiftKey,r.ctrlKey),r.preventDefault();else if(39==r.which)u.current.right(r.shiftKey,r.ctrlKey),r.preventDefault();else if(38==r.which)u.current.up(r.shiftKey,r.ctrlKey),r.preventDefault();else if(40==r.which)u.current.down(r.shiftKey,
r.ctrlKey),r.preventDefault();else if(36==r.which)u.current.first(r.shiftKey,r.ctrlKey),r.preventDefault();else if(35==r.which)u.current.last(r.shiftKey,r.ctrlKey),r.preventDefault();else if(32==r.which)u.current.setCheckRadioValue(),r.preventDefault();else if(46==r.which||8==r.which)u.current.isEditable()&&u.current.setValue(u.current.getSelected(!1,!0),_$_b591[3]);else if(13==r.which)r.shiftKey?u.current.up():(1==u.current.options.allowManualInsertRow&&u.current.selectedCell[1]==(u.current.results?
u.current.results[u.current.results.length-1]:u.current.rows.length-1)&&u.current.insertRow(null,null,null,null,r),u.current.selectedCell&&u.current.down()),r.preventDefault();else if(9==r.which)r.shiftKey?u.current.left():(B=u.current.selectedCell[0],u.current.right(),1==u.current.options.allowInsertColumn&&1==u.current.options.allowManualInsertColumn&&u.current.selectedCell[0]==B&&(u.current.insertColumn(null,null,null,null,null,null,r),u.current.right())),r.preventDefault();else if((r.ctrlKey||
r.metaKey)&&!r.shiftKey)65==r.which?(u.current.selectAll(),r.preventDefault()):83==r.which?(u.current.download(),r.preventDefault()):89==r.which?(u.current.parent.redo(),r.preventDefault()):90==r.which?(u.current.parent.undo(),r.preventDefault()):67==r.which?(u.current.copy(),r.preventDefault()):88==r.which?(u.current.cut(),r.preventDefault()):86==r.which?r.target.classList.contains(_$_b591[246])||h.paste(r):189==r.which&&(1==u.current.options.allowDeleteRow&&k[3]==_$_b591[428]?(fa.isValid.call(u.current,
u.current.selectedCell)&&u.current.deleteRow(),r.preventDefault()):1==u.current.options.allowDeleteColumn&&k[3]==_$_b591[429]&&(fa.isValid.call(u.current,u.current.selectedCell)&&u.current.deleteColumn(),r.preventDefault()));else if(u.current.selectedCell&&u.current.isEditable()){B=u.current.selectedCell[1];var D=u.current.selectedCell[0];u.current.options.columns[D].type!=_$_b591[26]&&(32==r.keyCode?u.current.options.columns[D].type==_$_b591[277]||u.current.options.columns[D].type==_$_b591[279]?
r.preventDefault():u.current.openEditor(u.current.records[B][D].element,!0,r):113==r.keyCode?u.current.openEditor(u.current.records[B][D].element,!1,r):1!=r.key.length&&r.key!=_$_b591[587]||r.altKey||r.ctrlKey||u.current.records[B]&&u.current.openEditor(u.current.records[B][D].element,!0,r))}}};var v=function(r,A,B,D,J,L,T){if(document.activeElement.classList.contains(_$_b591[107])&&oa.update.call(u.current,r,A,B,D,J,document.activeElement,T))return!1;if(u.current.edition)u.current.closeEditor(u.current.edition,
!0);else if(d&&d!==L)return!1;u.current!==T&&(u.current.resetSelection(),u.current=T);oa.current?oa.range.call(u.current,r,A,B,D,J):fa[_$_b591[11]].call(u.current,r,A,B,D,J)};h.mousedown=function(r){r=r||window.event;var A=r.buttons?r.buttons:r.button?r.button:r.which;if(u.current)if(1==ha.isVisible()&&(jSuites.findElement(r.target,_$_b591[412])||ha.close.call(u.current,!1)),u.current.edition){if(jSuites.findElement(r.target,_$_b591[114]))return!1}else if(jSuites.findElement(r.target,_$_b591[246]))return!1;
var B=q(r);if(!1===B)return!1;k=B;if(1<A)if(B[3]==_$_b591[427]){if(u.current.isSelected(B[4],B[5]))return!1}else if(B[3]==_$_b591[428]){if(u.current.isSelected(0,B[4]))return!1}else if(B[3]==_$_b591[429]&&u.current.isSelected(B[4],0))return!1;if(u.current){if(B[3]==_$_b591[152])u.current.isEditable()&&(ea.event=!0);else if(B[3]==_$_b591[579])ha.open.call(u.current,B[4]);else{if(1==B[2])if(1==u.current.options.columnDrag&&6>r.target.offsetHeight-r.offsetY)va.start.call(u.current,r);else if(1==u.current.options.columnResize&&
6>r.target.offsetWidth-r.offsetX)Aa.start.call(u.current,r);else{A=u.current.options.columns.length-1;var D=u.current.options.data.length-1;if(B[3]==_$_b591[576])v(0,0,A,D,r,B[3],B[1].jexcel),a=b=0;else if(B[3]==_$_b591[438]){var J=xa.range.call(u.current,B[5])[B[4]];J[1]>A&&(J[1]=A);v(J[0],0,J[1],D,r,B[3],B[1].jexcel);b=J[0];a=0}else B[4]&&((r.shiftKey||r.ctrlKey)&&null!=b&&null!=a?v(b,0,B[4],D,r,B[3],B[1].jexcel):(B[3]==_$_b591[429]&&b==B[4]&&1==u.current.options.allowRenameColumn&&(f=setTimeout(function(){u.current.setHeader(B[4])},
800)),v(B[4],0,B[4],D,r,B[3],B[1].jexcel),b=B[4],a=0))}if(2==B[2])if(B[3]==_$_b591[428])1==u.current.options.rowDrag&&6>r.target.offsetWidth-r.offsetX?va.start.call(u.current,r):1==u.current.options.rowResize&&6>r.target.offsetHeight-r.offsetY?Aa.start.call(u.current,r):(A=u.current.options.columns.length-1,D=parseInt(B[4]),(r.shiftKey||r.ctrlKey)&&null!=b&&null!=a?v(0,a,A,D,r,B[3],B[1].jexcel):(v(0,D,A,D,r,B[3],B[1].jexcel),b=0,a=D));else if(B[3]==_$_b591[427]){A=parseInt(B[4]);D=parseInt(B[5]);
if(!u.current.edition&&(J=u.current.options.columns[B[4]].type,r.target.tagName==_$_b591[588]&&(J==_$_b591[280]||J==_$_b591[281])&&r.target.parentNode.classList.contains(_$_b591[140]))){var L=r.target.innerText;J==_$_b591[280]&&(L=_$_b591[589]+L);window.open(L,_$_b591[590])}(r.shiftKey||r.ctrlKey)&&u.current.selectedCell?v(u.current.selectedCell[0],u.current.selectedCell[1],A,D,r,B[3],B[1].jexcel):(v(A,D,A,D,r,B[3],B[1].jexcel),b=A,a=D)}}d=B[3];typeof B[3]!==_$_b591[21]&&G.call(u.current.parent,_$_b591[591],
u.current,B[3],B[4],B[5]);e=!0}else e=!1};h.mouseup=function(r){u.current&&(va.event?va.end.call(u.current,r):Aa.event?Aa.end.call(u.current,r):ea.event?ea.end.call(u.current,r):r.target.classList.contains(_$_b591[411])?ha.close.call(u.current,!0):u.current.edition&&r.target.classList.contains(_$_b591[592])&&50>r.target.clientWidth-r.offsetX&&50>r.offsetY?ja.close.call(u.current,null,!0):r.target.classList.contains(_$_b591[346])&&(r=r.target.innerText==_$_b591[15]?0:r.target.innerText==_$_b591[17]?
r.target.getAttribute(_$_b591[292])-1:r.target.innerText-1,Ba[_$_b591[11]].call(u.current,parseInt(r))));f&&(clearTimeout(f),f=null);e=d=!1;oa.current&&oa.close.call(u.current)};h.mousemove=function(r){r=r||window.event;if(u.current){var A=r.target.getAttribute(_$_b591[52]),B=r.target.getAttribute(_$_b591[53]);if(1==e)va.event?va.update.call(u.current,r):Aa.event?Aa.update.call(u.current,r):Qa.event?Qa.update.call(u.current,r):u.current.options.tableOverflow&&(r=u.current.content,(r.w&&r.w!==r.offsetWidth||
r.h&&r.h!==r.offsetHeight)&&u.current.setViewport(r.offsetWidth,r.offsetHeight),r.w=r.offsetWidth,r.h=r.offsetHeight);else{var D=r.target.getBoundingClientRect();c&&(c.style.cursor=_$_b591[3],c=null);1==u.current.options.editable&&(A||B)&&(1==u.current.options.rowResize&&r.target&&A&&!B&&5>D.width-(r.clientX-D.left)?(c=r.target,c.style.cursor=_$_b591[593]):1==u.current.options.columnResize&&r.target&&!A&&B&&5>D.height-(r.clientY-D.top)?(c=r.target,c.style.cursor=_$_b591[594]):1==u.current.options.rowDrag&&
r.target&&!A&&B&&5>D.width-(r.clientX-D.left)?(c=r.target,c.style.cursor=_$_b591[595]):1==u.current.options.columnDrag&&r.target&&A&&!B&&5>D.height-(r.clientY-D.top)&&(c=r.target,c.style.cursor=_$_b591[595]))}}};h.mouseover=function(r){r=r||window.event;if(u.current&&1==e){var A=l(r);if(A[0]){if(!document.activeElement.classList.contains(_$_b591[107])&&A[1]&&u.current!=A[1].jexcel&&u.current)return!1;if(!va.event&&!Aa.event)if(ea.event){var B=r.target.getAttribute(_$_b591[52]),D=r.target.getAttribute(_$_b591[53]);
u.current.isSelected(B,D)||null===B||null===D||ea.call(u.current,B,D)}else null!==b&&null!==a&&(1==A[2]&&(B=b,A[3]==_$_b591[429]&&(B=r.target.getAttribute(_$_b591[52])),D=u.current.options.data.length-1,v(b,0,B,D,r,A[3],A[1].jexcel)),2==A[2]&&(A[3]==_$_b591[428]?(B=u.current.options.columns.length-1,D=parseInt(r.target.getAttribute(_$_b591[53])),v(0,a,B,D,r,A[3],A[1].jexcel)):A[3]==_$_b591[427]&&(B=A[4],D=A[5],v(b,a,B,D,r,A[3],A[1].jexcel))))}}};h.dblclick=function(r){if(u.current)if(r.target.classList.contains(_$_b591[366]))ea.execute.call(u.current,
!1);else{var A=l(r);1==A[2]?1==u.current.options.columnSorting&&(r=r.target.getAttribute(_$_b591[52]))&&u.current.orderBy(r):2==A[2]&&u.current.isEditable()&&!u.current.edition&&A[6]&&u.current.openEditor(A[6],null,r)}};h.paste=function(r){if(!r.target.classList.contains(_$_b591[246])&&u.current&&u.current.selectedCell&&!u.current.edition){var A=r.clipboardData||window.clipboardData;A&&(u.current.paste(u.current.selectedCell[0],u.current.selectedCell[1],A.getData(_$_b591[67])),r&&r.preventDefault())}};
h.contextmenu=function(r){var A=q(r);!1!==A&&(A[1]||(A=k),u.current&&!u.current.edition&&(A=Array.prototype.slice.call(A,3),Sa.open.call(u.current,r,A)))};var x=null,w=null,z=null,y=null,C=null;h.touchstart=function(r){var A=l(r);A[0]?A[1]&&u.current!=A[1].jexcel&&(u.current&&u.current.resetSelection(),u.current=A[1].jexcel):u.current&&(u.current.resetSelection(),u.current=null);u.current&&!u.current.edition?A[3]==_$_b591[152]?u.current.isEditable()&&(ea.event=!0):r.target&&r.target.classList.contains(_$_b591[155])?
C=parseInt(r.target.getAttribute(_$_b591[156])):A[3]==_$_b591[427]?(y=A,x===r.target&&w?u.current.openEditor(r.target,!1,r):(w=setTimeout(function(){x=w=y=null},400),z=setTimeout(function(){h.contextmenu(r);z=null},800)),x=r.target):y=null:y=null};h.touchmove=function(r){if(u.current){var A=null,B=null,D=null,J=null;if(r.changedTouches&&r.changedTouches[0]){var L=r.changedTouches[0].clientX;var T=r.changedTouches[0].clientY}else L=r.clientX,T=r.clientY;if(T=document.elementFromPoint(L,T))if(L=T.getAttribute(_$_b591[52]),
T=T.getAttribute(_$_b591[53]),null!==L&&null!==T&&ea.event)u.current.isSelected(L,T)||(ea.call(u.current,L,T),p(r)),r.preventDefault();else if(null!==C){L=parseInt(L);T=parseInt(T);var N=u.current.selectedCell;0==C?L<=N[2]&&(A=L,D=N[2],B=N[1],J=N[3]):2==C?L>=N[0]&&(A=N[0],B=N[1],D=L,J=N[3]):1==C?T<=N[3]&&(A=N[0],B=T,D=N[2],J=N[3]):3==C&&T>=N[1]&&(A=N[0],B=N[1],D=N[2],J=T);null!==A&&u.current.updateSelectionFromCoords(A,B,D,J);r.preventDefault()}else y=null;z&&clearInterval(z)}};h.touchend=function(r){if(ea.event)ea.end.call(u.current,
r);else if(null!==C)C=null;else if(y){r=null;if(y[3]===_$_b591[427]){var A=y[4];var B=y[5];var D=A;r=B}else y[3]===_$_b591[428]?(A=0,B=y[4],D=u.current.options.columns.length-1,r=B):y[3]===_$_b591[429]&&(A=y[4],B=0,D=A,r=u.current.rows.length-1);null!=A&&u.current.updateSelectionFromCoords(A,B,D,r)}z&&clearInterval(z)};h.resize=function(){u.current&&1==u.current.parent.config.fullscreen&&I.call(u.current,!0)};return h}(),u=function(h,c,b){if(h)if(c||(c={}),c.cloud&&!b)typeof u.cloud==_$_b591[98]?
u.cloud.load(c,function(d){u(h,d,!0)}):console.error(_$_b591[597]);else{if(h.spreadsheet)a=h.spreadsheet,Ea[_$_b591[11]].call(a,c);else var a=ra.spreadsheet(h,c);a.processing=!0;1==a.config.loadingSpin&&jSuites.loading.show();jSuites.ajax.oncomplete[a.name]=function(){for(var d=0;d<a.worksheets.length;d++)typeof a.worksheets[d].onload==_$_b591[98]&&(a.worksheets[d].onload(),a.worksheets[d].onload=null);a.processing=!1;if(Array.isArray(a.queue)&&0<a.queue.length)for(;d=a.queue.shift();)d[0].updateCell(d[1],
d[2],O.call(d[0],d[1],d[2]),!0);a.config.toolbar&&ia.show.call(a);for(d=0;d<a.worksheets.length;d++)ba.refresh.call(a.worksheets[d]);G.call(a,_$_b591[598],a);la.state.call(a);for(d=0;d<a.worksheets.length;d++)aa.update.call(a.worksheets[d]);jSuites.loading.hide()};Array.isArray(c.worksheets)&&(c=c.worksheets);if(Array.isArray(c)){for(b=0;b<c.length;b++)ra.worksheet(a,c[b]);c=a.worksheets}else c=ra.worksheet(a,c);jSuites.ajax.pending(a.name)||(jSuites.ajax.oncomplete[a.name](),jSuites.ajax.oncomplete[a.name]=
null);return c}else console.error(_$_b591[596])};u.license=null;u.setLicense=function(h){u.license=h};u.spreadsheet=[];u.picker=oa;u.setDictionary=function(h){jSuites.setDictionary(h)};u.extensions={};u.setExtensions=function(h){for(var c=Object.keys(h),b=0;b<c.length;b++)typeof h[c[b]]===_$_b591[98]&&(u[c[b]]=h[c[b]],u.extensions[c[b]]=h[c[b]],u.license&&typeof u[c[b]].license==_$_b591[98]&&u[c[b]].license.call(u,u.license))};u.destroy=function(h,c){if(h.spreadsheet){c&&ra.unbind(h);c=u.spreadsheet.indexOf(h.spreadsheet);
u.spreadsheet.splice(c,1);for(c=0;c<h.spreadsheet.worksheets.length;c++)H(h.spreadsheet.worksheets[c].options.worksheetName,null);h.spreadsheet=null;h.jexcel=null;h.innerHTML=_$_b591[3];h.classList.remove(_$_b591[599]);h.classList.remove(_$_b591[376])}};u.version=M;u.helpers=F;u.events=Ca;typeof formula!==_$_b591[21]&&(u.formula=formula);u.editors=function(){var h={},c=function(b,a){return 1==b[a]||b.options&&1==b.options[a]?!0:b[a]==_$_b591[255]||b.options&&b.options[a]==_$_b591[255]?!0:!1};h.createEditor=
function(b,a,d,e){e.parent.input.setAttribute(_$_b591[115],!1);b==_$_b591[245]?(b=document.createElement(_$_b591[245]),b.type=_$_b591[67],b.value=d):b=document.createElement(_$_b591[28]);b.style.width=a.offsetWidth-2+_$_b591[55];b.style.height=a.offsetHeight-1+_$_b591[55];e.parent.input.appendChild(b);return b};h.createDialog=function(b,a,d,e,g,f){b=h.createEditor(_$_b591[28],b,a,g);b.classList.add(_$_b591[600]);b.classList.add(_$_b591[592]);800>window.innerWidth?(g.parent.input.style.top=_$_b591[159],
g.parent.input.style.left=_$_b591[159]):(a=g.parent.input.getBoundingClientRect(),window.innerHeight<a.bottom&&(g.parent.input.style.marginTop=-g.parent.input.offsetHeight));return b};h.general=function(){var b={},a=function(e){return(_$_b591[3]+e)[0]==_$_b591[18]?!0:!1},d=function(e){if(e.format||e.mask||e.locale){var g={};e.mask?g.mask=e.mask:e.format?g.mask=e.format:g.locale=e.locale;e.options&&(g.options=e.options);e.decimal&&(g.options||(g.options={}),g.options={decimal:e.decimal});return g}return null};
b.createCell=function(e,g,f,k,l,n){return b.updateCell(e,g,f,k,l,n)};b.updateCell=function(e,g,f,k,l,n){f=parseInt(f);k=parseInt(k);if(e){var q=d(n),p=null;g===_$_b591[3]||a(g)||typeof g===_$_b591[22]||(q?(q=jSuites.mask.extract(g,q,!0))&&q.value!==_$_b591[3]&&(p=q.value):1==(!1===l.parent.config.autoCasting||!1===n.autoCasting?!1:!0)&&(n.type==_$_b591[22]||n.type==_$_b591[335]||n.type==_$_b591[334]?(q=jSuites.mask.extract(g,n,!0))&&q.value!==_$_b591[3]&&(p=q.value):jSuites.isNumeric(Number(g))&&
(p=Number(g))));null!==p&&(g=p);g=b.parseValue(f,k,g,l,n,e);g instanceof Element||g instanceof HTMLDocument?(e.innerHTML=_$_b591[3],e.appendChild(g)):1==l.parent.config.stripHTML?e.innerText=g:e.innerHTML=g;if(null!==p)return p}};b.openEditor=function(e,g,f,k,l,n){var q=l.parent.input;q.onblur=function(){q.classList.contains(_$_b591[107])||l.closeEditor(e,!0)};if(n.type==_$_b591[22]||n.type==_$_b591[335]||n.type==_$_b591[334])q.classList.add(_$_b591[584]),a(g)||n.inputmode||(n.inputmode=_$_b591[601]);
f=null;a(g)||(n.inputmode&&q.setAttribute(_$_b591[111],n.inputmode),(f=d(n))?n.disabledMaskOnEdition||(n.mask?(k=n.mask.split(_$_b591[238]),q.setAttribute(_$_b591[109],k[0])):n.locale&&q.setAttribute(_$_b591[602],n.locale),f.input=q,q.mask=f,jSuites.mask.render(g,f,!1)):g&&n.type==_$_b591[334]&&(g*=100));if(!f||n.disabledMaskOnEdition)l.parent.config.stripHTML?q.innerText=g:q.innerHTML=g,jSuites.focus(q)};b.closeEditor=function(e,g,f,k,l,n){e=l.parent.input;g=g&&e.innerText.trim().length?e.innerText:
_$_b591[3];a(g)?g=g.replace(/(\r\n|\n|\r)/gm,_$_b591[3]):n.type==_$_b591[334]&&(g+=_$_b591[603],e.classList.remove(_$_b591[604]));return g};b.parseValue=function(e,g,f,k,l,n){1==k.parent.config.parseFormulas&&(k.resetArray(e,g),a(f)&&(f=k.executeFormula(f,e,g)));f instanceof Element||f instanceof HTMLDocument||(n&&(jSuites.isNumeric(f)?n.classList.add(_$_b591[273]):n.classList.remove(_$_b591[273])),l&&!a(f)&&(e=d(l))&&(e.mask?(g=e.mask.split(_$_b591[238]),0>f&&g[1]?(n&&-1!==g[1].indexOf(_$_b591[605])&&
n.classList.add(_$_b591[606]),n=-1===g[1].indexOf(_$_b591[208])?jSuites.mask.render(-1*f,e,!0):jSuites.mask.render(f,e,!0)):(e.mask=g[0],n&&n.classList.remove(_$_b591[606]),n=jSuites.mask.render(f,e,!0))):n=jSuites.mask.render(f,e,!0),n&&(f=n)));return f};b[_$_b591[54]]=function(e,g){var f;return(f=d(e))?jSuites.mask.render(g,f,!0):e.type==_$_b591[334]?100*parseFloat(g):g};b.destroyCell=function(e){e.classList.remove(_$_b591[273])};return b}();h.text=h.general;h.number=h.general;h.numeric=h.general;
h.percent=h.general;h.notes=function(){var b={},a=null;b.updateCell=function(d,e,g,f,k,l){d&&(g=document.createElement(_$_b591[28]),g.classList.add(_$_b591[607]),1==k.parent.config.stripHTML?g.innerText=e:g.innerHTML=e,d.innerHTML=_$_b591[3],d.appendChild(g))};b.createCell=b.updateCell;b.openEditor=function(d,e,g,f,k,l){var n=l&&l.options?l.options:{};n.focus=!0;n.value=e;n.border=!1;n.height=_$_b591[608];n.toolbar=!1;a=h.createDialog(d,e,g,f,k,l);a=jSuites.editor(a,n)};b.closeEditor=function(d,e,
g,f,k,l){return e?a.getData():_$_b591[3]};return b}();h.dropdown=function(){var b={createCell:function(a,d,e,g,f,k){k.render==_$_b591[609]?a.classList.add(_$_b591[610]):a.classList.add(_$_b591[611]);if(a=b.updateCell(a,d,e,g,f,k))return a},destroyCell:function(a){a.classList.remove(_$_b591[611])},updateCell:function(a,d,e,g,f,k){if(a){var l=b.getItem(a,d,e,g,f,k);l?a.innerHTML=l:d?(d=b.fromLabel(a,d,e,g,f,k),d.length?(l=b.getItem(a,d,e,g,f,k),a.innerHTML=l):a.innerHTML=_$_b591[3]):a.innerHTML=_$_b591[3];
return d}},openEditor:function(a,d,e,g,f,k){var l=h.createEditor(_$_b591[28],a,d,f),n=k.delimiter||_$_b591[238];k=Object.create(k);k.options||(k.options={});typeof k.filter==_$_b591[98]&&(k.source=k.filter(f.el,a,e,g,k.source));typeof k.filterOptions==_$_b591[98]&&(k=k.filterOptions(f,a,e,g,d,k));e=k.options;k.source&&(e.data=JSON.parse(JSON.stringify(k.source)));c(k,_$_b591[612])&&(e.multiple=!0);c(k,_$_b591[68])&&(e.autocomplete=!0);e.format=!0;e.opened=!0;e.width=a.offsetWidth-2;e.onclose=function(){f.closeEditor(a,
!0)};c(k,_$_b591[612])?d&&(e.value=(_$_b591[3]+d).split(n)):e.value=d;jSuites.dropdown(l,e)},closeEditor:function(a,d,e,g,f,k){for(var l=f.parent.input.children[0],n=k.delimiter||_$_b591[238],q=l.dropdown.getText(!0),p=l.dropdown.getValue(!0),v=0;v<p.length;v++)!1===b.getItem(a,p[v],e,g,f,k)&&k.source.push({id:p[v],name:q[v]});l.dropdown.close(!0);if(d)return p.join(n)},fromLabel:function(a,d,e,g,f,k){a=k.delimiter||_$_b591[238];e=[];g=[];Array.isArray(d)||(d=(_$_b591[3]+d).split(a));for(f=0;f<d.length;f++)g[d[f].trim()]=
!0;d=Object.keys(g);!c(k,_$_b591[612])&&1<Object.keys(d).length&&(g=[],g[d[0]]=!0);for(d=0;d<k.source.length;d++)g[k.source[d].name]&&e.push(k.source[d].id);return e.join(a)},getItem:function(a,d,e,g,f,k){g=k.delimiter||_$_b591[238];a=[];e=[];Array.isArray(d)||(d=(_$_b591[3]+d).split(g));for(g=0;g<d.length;g++)e[d[g].trim()]=!0;g=Object.keys(e);!c(k,_$_b591[612])&&1<Object.keys(g).length&&(d=[],d[g[0]]=!0,e=d);if(k.source&&typeof k.source[0]!==_$_b591[97])for(d=0;d<k.source.length;d++)g=k.source[d],
k.source[d]={id:g,name:g};for(d=0;d<k.source.length;d++)typeof e[k.source[d].id]!==_$_b591[21]&&a.push(k.render==_$_b591[282]?k.source[d].color:k.render==_$_b591[613]?k.source[d].image:k.source[d].name);if(a.length){if(typeof k.render!==_$_b591[21]){for(d=0;d<a.length;d++)e=d,g=a[d],g=k.render==_$_b591[282]?_$_b591[614]+g+_$_b591[615]:k.render==_$_b591[613]?_$_b591[614]+g+_$_b591[615]:k.render==_$_b591[609]?_$_b591[617]+(k.source[d].color||_$_b591[616])+_$_b591[618]+g+_$_b591[619]:void 0,a[e]=g;return a.join(_$_b591[3])}for(d=
0;d<a.length;d++)a[d]=(_$_b591[3]+a[d]).replace(_$_b591[15],_$_b591[13]);return a.join(_$_b591[323])}return!1}};b[_$_b591[54]]=function(a,d){for(var e=0;e<a.source.length;e++)if(a.source[e].id==d)return a.render==_$_b591[282]?a.source[e].color:a.render==_$_b591[613]?a.source[e].image:a.source[e].name};return b}();h.autocomplete=h.dropdown;h.calendar=function(){var b={},a=null;b.updateCell=function(d,e,g,f,k,l){if(d){g=e;l=b.getFormat(l);0<e&&Number(e)==e&&(g=jSuites.calendar.numToDate(e));f=_$_b591[3]+
e;f.substr(4,1)==_$_b591[208]&&f.substr(7,1)==_$_b591[208]?f=!0:(f=f.split(_$_b591[208]),f=4==f[0].length&&f[0]==Number(f[0])&&2==f[1].length&&f[1]==Number(f[1])?!0:!1);f||(f=jSuites.calendar.extractDateFromString(e,l))&&(g=f);if(g=jSuites.calendar.getDateString(g,l))return d.innerText=g,e;d.innerText=_$_b591[3];return _$_b591[3]}};b.createCell=b.updateCell;b.openEditor=function(d,e,g,f,k,l){l=Object.create(l);typeof l.filterOptions==_$_b591[98]&&(l=l.filterOptions(k,d,g,f,e,l));g=l.options||{};g.opened=
!0;g.onclose=function(n,q){k.closeEditor(d,!0)};typeof l.timepicker!==_$_b591[21]&&(g.time=c(l,_$_b591[620])?!0:!1);typeof g.readonly!==_$_b591[21]&&(g.readonly=g.readonly);g.value=e||null;g.placeholder=g.format;a=h.createEditor(_$_b591[245],d,e,k);jSuites.calendar(a,g);!1===a.calendar.options.readonly&&a.focus()};b.closeEditor=function(d,e,g,f,k){d=a.calendar.close(!0,a.value?!0:!1);d=a.value?d:_$_b591[3];if(e)return d};b.getFormat=function(d){return d&&d.format?d.format:d&&d.options&&d.options.format?
d.options.format:_$_b591[621]};b[_$_b591[54]]=function(d,e){d=b.getFormat(d);return jSuites.calendar.getDateString(e,d)};return b}();h.color=function(){var b={},a=null;b.updateCell=function(d,e,g,f,k,l){d&&(l.render==_$_b591[622]?(g=document.createElement(_$_b591[28]),g.className=_$_b591[282],g.style.backgroundColor=e,d.innerText=_$_b591[3],d.appendChild(g)):(d.style.color=e,d.innerText=e))};b.createCell=b.updateCell;b.openEditor=function(d,e,g,f,k,l){l=Object.create(l);typeof l.filterOptions==_$_b591[98]&&
(l=l.filterOptions(k,d,g,f,e,l));l.value=e;l.onclose=function(n,q){k.closeEditor(d,!0)};a=h.createEditor(_$_b591[245],d,e,k);a=jSuites.color(a,l);a.open()};b.closeEditor=function(d,e,g,f,k,l){d=a.close(!0);if(e)return d};b[_$_b591[54]]=function(d,e){d=document.createElement(_$_b591[28]);d.style.width=_$_b591[623];d.style.height=_$_b591[30];d.style.backgroundColor=e;return d.outerHTML};return b}();h.checkbox=function(){var b={createCell:function(a,d,e,g,f,k){d=d&&d!=_$_b591[624]&&d!=_$_b591[625]?!0:
!1;e=document.createElement(_$_b591[245]);e.type=_$_b591[277];e.checked=d;e.onclick=function(){f.setValue(a,this.checked)};(k&&1==k.readOnly||!f.isEditable())&&e.setAttribute(_$_b591[626],_$_b591[626]);a.innerHTML=_$_b591[3];a.appendChild(e);return d},updateCell:function(a,d){d=d&&d!=_$_b591[624]&&d!=_$_b591[625]?!0:!1;a&&(a.children[0].checked=d);return d},openEditor:function(a,d,e,g,f){d=a.children[0].checked?!1:!0;f.setValue(a,d);return!1},closeEditor:function(a,d){return!1}};b[_$_b591[54]]=function(a,
d){return 1==d||1==d||d==_$_b591[255]?jSuites.translate(_$_b591[255]):jSuites.translate(_$_b591[624])};return b}();h.radio=function(){var b={createCell:function(a,d,e,g,f,k){a.getAttribute(_$_b591[52]);e=document.createElement(_$_b591[245]);e.type=_$_b591[279];e.checked=1==d||1==d||d==_$_b591[255]?!0:!1;e.onclick=function(){f.setValue(a,!0)};(k&&1==k.readOnly||!f.isEditable())&&e.setAttribute(_$_b591[626],_$_b591[626]);a.innerHTML=_$_b591[3];a.appendChild(e)},updateCell:function(a,d,e,g,f){d=1==d||
1==d||d==_$_b591[255]||d==_$_b591[627]?!0:!1;a&&(a.children[0].checked=d);if(1==d){a=[];for(var k=0;k<f.options.data.length;k++)g!=k&&f.options.data[k][e]&&a.push({x:e,y:k,value:0});a.length&&f.setValue(a)}return d},openEditor:function(a,d,e,g,f){return!1},closeEditor:function(a,d){return!1}};b[_$_b591[54]]=function(a,d){return 1==d||1==d||d==_$_b591[255]?_$_b591[255]:_$_b591[624]};return b}();h.autonumber=function(){var b={},a=null;b.createCell=function(d,e,g,f,k,l){(e=parseInt(e))||0<parseInt(d.innerText)&&
(e=parseInt(d.innerText));l.sequence||(l.sequence=0);e?b.isValid(e,g,f,k)||(e=_$_b591[269]):e=l.sequence+1;e>l.sequence&&(l.sequence=e);return d.innerText=e};b.updateCell=b.createCell;b.openEditor=function(d,e,g,f,k,l){a=h.createEditor(_$_b591[245],d,e,k);a.onblur=function(){k.closeEditor(d,!0)};a.focus();a.value=e};b.closeEditor=function(d,e,g,f,k){return e?a.value:_$_b591[3]};b.isValid=function(d,e,g,f){for(var k,l=0;l<f.options.data.length;l++)if(k=f.value(e,l),k==d&&l!=g)return!1;return!0};return b}();
h.progressbar=function(){var b={},a=null;b.createCell=function(d,e){e=parseInt(e);if(100<e)e=100;else if(!e||0>e)e=0;if(d.children[0]&&d.children[0].tagName==_$_b591[582])var g=d.children[0];else g=document.createElement(_$_b591[28]),g.classList.add(_$_b591[283]),d.innerText=_$_b591[3],d.classList.add(_$_b591[628]),d.appendChild(g);g.style.width=parseInt(e)+_$_b591[603];g.setAttribute(_$_b591[292],parseInt(e)+_$_b591[603])};b.destroyCell=function(d){d.classList.remove(_$_b591[628])};b.updateCell=
b.createCell;b.openEditor=function(d,e,g,f,k,l){a=h.createEditor(_$_b591[245],d,e,k);a.type=_$_b591[22];a.setAttribute(_$_b591[629],0);a.setAttribute(_$_b591[630],100);a.onblur=function(){k.closeEditor(d,!0)};a.focus();a.value=e};b.closeEditor=function(d,e,g,f,k){return e?a.value:_$_b591[3]};return b}();h.rating=function(){var b={},a=null;b.createCell=function(d,e,g,f,k,l){return b.setCell(d,e,l)};b.destroyCell=function(d){d.classList.remove(_$_b591[631])};b.updateCell=b.createCell;b.openEditor=function(d,
e,g,f,k,l){a=h.createEditor(_$_b591[245],d,e,k);a.type=_$_b591[22];a.setAttribute(_$_b591[629],0);a.setAttribute(_$_b591[630],5);a.onblur=function(){k.closeEditor(d,!0)};a.focus();a.value=e};b.closeEditor=function(d,e,g,f,k,l){return e?a.value:_$_b591[3]};b.setCell=function(d,e,g){e=parseInt(e);if(5<e)e=5;else if(!e||0>e)e=0;if(d){g=g&&g.color?g.color:_$_b591[606];var f=document.createElement(_$_b591[28]);f.setAttribute(_$_b591[292],parseInt(e)+_$_b591[632]);f.classList.add(_$_b591[284]);for(var k=
0;k<e;k++){var l=document.createElement(_$_b591[470]);l.className=_$_b591[534];l.style.color=g;l.innerHTML=_$_b591[633];f.appendChild(l)}d.innerHTML=_$_b591[3];d.className=_$_b591[631];d.appendChild(f)}return e};return b}();h.email=function(){var b={createCell:function(a,d,e,g,f,k){a&&(a.children&&a.children[0]&&a.children[0].tagName==_$_b591[588]?e=a.children[0]:(e=document.createElement(_$_b591[222]),a.innerText=_$_b591[3],a.appendChild(e),k.options&&k.options.url&&e.setAttribute(_$_b591[634],k.options.url)),
e.innerText=d)}};b.updateCell=b.createCell;b.openEditor=function(a,d,e,g,f,k){f.parent.input.classList.add(_$_b591[584]);f.parent.input.onblur=function(){f.closeEditor(a,!0)};f.parent.input.innerText=d;jSuites.focus(f.parent.input)};b.closeEditor=function(a,d,e,g,f){f.parent.input.classList.remove(_$_b591[584]);return d?f.parent.input.innerText.replace(new RegExp(/\n/,_$_b591[14]),_$_b591[3]):_$_b591[3]};return b}();h.url=h.email;h.image=function(){var b={},a=null;b.createCell=function(d,e,g,f,k,
l){if(d)if(e)if(d.children&&d.children[0]&&d.children[0].tagName==_$_b591[635])d.children[0].src=e;else{var n=document.createElement(_$_b591[45]);l.render==_$_b591[636]&&n.classList.add(_$_b591[636]);l.options&&(n.style.maxWidth=_$_b591[637],l.options.absolute&&(d.classList.add(_$_b591[638]),n.setAttribute(_$_b591[639],-1),n.classList.add(_$_b591[246]),n.classList.add(_$_b591[640]),n.settings=function(){k.openEditor(d,e,g,f,k,l)},n.dblclick=function(){k.openEditor(d,!0)},n[_$_b591[641]]=function(){k.setValueFromCoords(g,
f,_$_b591[3])}),l.options.width&&(n.style.width=parseInt(l.options.width)+_$_b591[55]),l.options.height&&(n.style.height=parseInt(l.options.height)+_$_b591[55]));n.src=e;d.innerHTML=_$_b591[3];d.appendChild(n)}else d.innerHTML=_$_b591[3]};b.updateCell=b.createCell;b.openEditor=function(d,e,g,f,k,l){(l&&l.options?l.options:{}).value=e;a=h.createDialog(d,e,g,f,k,l);e&&(d=document.createElement(_$_b591[45]),d.src=e,d.classList.add(_$_b591[642]),d.style.width=_$_b591[637],a.appendChild(d));jSuites.image(a,
l)};b.closeEditor=function(d,e,g,f,k,l){if(e&&(d=a.children[0]))return d.tagName==_$_b591[635]?d.src:_$_b591[3]};b[_$_b591[54]]=function(d,e){return _$_b591[643]+e+_$_b591[644]};return b}();h.html=function(){var b={},a=null;b.createCell=function(d,e){d.classList.add(_$_b591[645]);var g=document.createElement(_$_b591[28]);g.innerHTML=e;d.appendChild(g)};b.updateCell=function(d,e){d&&(d.firstChild.innerHTML=e)};b.destroyCell=function(d){d.classList.remove(_$_b591[645])};b.openEditor=function(d,e,g,
f,k,l){var n=l&&l.options?l.options:{};n.focus=!0;n.value=e;n.border=!1;n.height=_$_b591[608];e=h.createDialog(d,e,g,f,k,l);a=jSuites.editor(e,n);a.close=function(){k.closeEditor(d,!0)};jSuites.tracking(a,!0)};b.closeEditor=function(d,e,g,f,k,l){jSuites.tracking(a,!1);d=a.getData();if(e)return d};return b}();h.hidden=function(){return{createCell:function(b,a,d,e,g){b.classList.contains(_$_b591[61]);b.innerText=a},updateCell:function(b,a,d,e,g){b&&(b.innerText=a)},openEditor:function(b,a,d,e,g){return!1},
closeEditor:function(b,a){return!1}}}();h.tags=function(){var b={},a=null;b.createCell=function(d,e){d.classList.add(_$_b591[646]);b.updateCell(d,e)};b.updateCell=function(d,e){d&&(d.innerHTML=e)};b.destroyCell=function(d){d.classList.remove(_$_b591[646])};b.openEditor=function(d,e,g,f,k,l){var n=l&&l.options?l.options:{};n.value=e;a=h.createDialog(d,e,g,f,k,l);d=document.createElement(_$_b591[28]);d.style.margin=_$_b591[30];d.style.marginRight=_$_b591[647];a.appendChild(d);a=jSuites.tags(d,n);d.focus();
jSuites.focus(d)};b.closeEditor=function(d,e,g,f,k,l){d=a.getValue();if(e)return d};return b}();h.record=function(){var b={},a=null;b.createCell=function(d,e,g,f,k,l){d.classList.add(_$_b591[611]);var n;(n=k.parent.getWorksheetInstance(l.worksheetId))?n.rows?b.updateCell(d,e,g,f,k,l):(d.innerText=_$_b591[269],k.parent.queue.push([k,g,f])):(d.innerText=_$_b591[269],k.parent.queue.push([k,g,f]))};b.destroyCell=function(d){d.classList.remove(_$_b591[611])};b.updateCell=function(d,e,g,f,k,l){d&&(typeof l.worksheetId==
_$_b591[21]?d.innerText=_$_b591[269]:d.innerHTML=b.getValue(d,e,g,f,k,l))};b.openEditor=function(d,e,g,f,k,l){var n=l.delimiter||_$_b591[238];l=Object.create(l);l.options||(l.options={});typeof l.filter==_$_b591[98]&&(l.source=l.filter(k.el,d,g,f,l.source));typeof l.filterOptions==_$_b591[98]&&(l=l.filterOptions(k,d,g,f,e,l));g=l.options;g.data=b.getSource(k,l);c(l,_$_b591[612])&&(g.multiple=!0);c(l,_$_b591[68])&&(g.autocomplete=!0);g.format=!0;g.opened=!0;g.width=d.offsetWidth-2;g.onclose=function(){k.closeEditor(d,
!0)};c(l,_$_b591[612])?e&&(g.value=(_$_b591[3]+e).split(n)):g.value=e;a=h.createEditor(_$_b591[28],d,e,k);a=jSuites.dropdown(a,g)};b.closeEditor=function(d,e,g,f,k,l){d=l.delimiter||_$_b591[238];g=a.getValue(!0);a.close(!0);if(e)return g.join(d)};b.getValue=function(d,e,g,f,k,l){d=[];if(typeof l.worksheetId==_$_b591[25]&&(k=k.parent.getWorksheetInstance(l.worksheetId))){g=l.worksheetColumn?l.worksheetColumn:0;0<=l.worksheetImage&&(g=l.worksheetImage);if(e==_$_b591[3]||0==e||null==e||void 0==e)return _$_b591[3];
e=(_$_b591[3]+e).split(_$_b591[238]);for(f=0;f<e.length;f++){var n=e[f].trim();var q=k.name(g);n=k.getRowById(n);q=!1===n?_$_b591[648]:n[q];0<=l.worksheetImage&&(q=_$_b591[649]+q+_$_b591[650]);d.push(q)}return 0<=l.worksheetImage?d.join(_$_b591[3]):d.join(_$_b591[323])}return _$_b591[269]};b.getSource=function(d,e){var g=e.worksheetColumn?e.worksheetColumn:0,f=null;typeof e.worksheetId==_$_b591[25]&&(f=d.parent.getWorksheetInstance(e.worksheetId));if(f){var k,l=[];for(d=0;d<f.rows.length;d++)if(k=
f.value(g,d))k={id:f.getRowId(d),name:k},void 0!=e.worksheetImage&&(k.image=f.value(e.worksheetImage,d)),l.push(k)}else console.error(_$_b591[651]+e.worksheetId);return l};b[_$_b591[54]]=function(d,e){for(var g=0;g<d.source.length;g++)if(d.source[g].id==e)return d.render==_$_b591[282]?d.source[g].color:d.render==_$_b591[613]?d.source[g].image:d.source[g].name};return b}();return h}();typeof jQuery!==_$_b591[21]&&function(h){h.fn.jspreadsheet=h.fn.jexcel=function(c){var b=h(this)[_$_b591[54]](0);if(b.jspreadsheet){if(typeof arguments[0]==
_$_b591[22])var a=arguments[0],d=2;else a=0,d=1;return b.jspreadsheet[a][c].apply(b.jspreadsheet[a],Array.prototype.slice.call(arguments,d))}return u(h(this)[_$_b591[54]](0),arguments[0])}}(jQuery);return u});

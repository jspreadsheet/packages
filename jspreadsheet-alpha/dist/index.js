/**
 * Jspreadsheet v9.0.28
 *
 * Website: https://jspreadsheet.com
 * Description: Create amazing web based spreadsheets.
 *
 * This software requires a license. Visit: https://jspreadsheet.com/v9
 */

if (! formula && typeof(require) === 'function') {
    var formula = require('@jspreadsheet/formula');
}

if (! jSuites && typeof(require) === 'function') {
    var jSuites = require('jsuites');
}

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(E){var J=0;return function(){return J<E.length?{done:!1,value:E[J++]}:{done:!0}}};$jscomp.arrayIterator=function(E){return{next:$jscomp.arrayIteratorImpl(E)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(E,J,N){if(E==Array.prototype||E==Object.prototype)return E;E[J]=N.value;return E};$jscomp.getGlobal=function(E){E=["object"==typeof globalThis&&globalThis,E,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var J=0;J<E.length;++J){var N=E[J];if(N&&N.Math==Math)return N}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(E,J){var N=$jscomp.propertyToPolyfillSymbol[J];if(null==N)return E[J];N=E[N];return void 0!==N?N:E[J]};
$jscomp.polyfill=function(E,J,N,W){J&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(E,J,N,W):$jscomp.polyfillUnisolated(E,J,N,W))};$jscomp.polyfillUnisolated=function(E,J,N,W){N=$jscomp.global;E=E.split(".");for(W=0;W<E.length-1;W++){var S=E[W];if(!(S in N))return;N=N[S]}E=E[E.length-1];W=N[E];J=J(W);J!=W&&null!=J&&$jscomp.defineProperty(N,E,{configurable:!0,writable:!0,value:J})};
$jscomp.polyfillIsolated=function(E,J,N,W){var S=E.split(".");E=1===S.length;W=S[0];W=!E&&W in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var aa=0;aa<S.length-1;aa++){var qa=S[aa];if(!(qa in W))return;W=W[qa]}S=S[S.length-1];N=$jscomp.IS_SYMBOL_NATIVE&&"es6"===N?W[S]:null;J=J(N);null!=J&&(E?$jscomp.defineProperty($jscomp.polyfills,S,{configurable:!0,writable:!0,value:J}):J!==N&&(void 0===$jscomp.propertyToPolyfillSymbol[S]&&(N=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[S]=
$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(S):$jscomp.POLYFILL_PREFIX+N+"$"+S),$jscomp.defineProperty(W,$jscomp.propertyToPolyfillSymbol[S],{configurable:!0,writable:!0,value:J})))};$jscomp.initSymbol=function(){};$jscomp.iteratorPrototype=function(E){E={next:E};E[Symbol.iterator]=function(){return this};return E};
$jscomp.iteratorFromArray=function(E,J){E instanceof String&&(E+="");var N=0,W=!1,S={next:function(){if(!W&&N<E.length){var aa=N++;return{value:J(aa,E[aa]),done:!1}}W=!0;return{done:!0,value:void 0}}};S[Symbol.iterator]=function(){return S};return S};$jscomp.polyfill("Array.prototype.values",function(E){return E?E:function(){return $jscomp.iteratorFromArray(this,function(J,N){return N})}},"es8","es3");
var _$_af97=["use strict","{","}","","9.0.28","Base","https://jspreadsheet.com","Unlicensed","Jspreadsheet Pro\r\n"," edition ","\r\n","set","&","&lt;","g","<","&gt;",">","=","!",'"',"undefined","number","fullscreen","block","string","readonly","jss_rotate","span","rotate(","deg)","jss_hidden_index","div","right","10px","pointer","/v8",",","localhost",".","v8"," (Expired)","Licensed to: ","Premium","License required","A valid license is required","This version is not included on the scope of this license",
"Your license is expired. Please renew your certificate.","jspreadsheet","img","/jspreadsheet/","logo.png","none","status","edition","scope","data-x","data-y","get","px","jss_frozen","0px","scroll","wheel","goto","jss_scroll","jss_hidden","jss_content_overflow","onresize","300px","Jspreadsheet Pro","text","autocomplete","dropdown","GET","json","Jspreadsheet Alert: secureFormulas is set to false.","setConfig","insertRow","deleteRow","insertColumn","deleteColumn","moveRow","moveColumn","setMerge","removeMerge",
"setStyle","resetStyle","setWidth","setHeight","setHeader","setComments","setFreezeColumns","setFreezeRows","orderBy","setValue","setProperty","updateProperty","renameWorksheet","moveWorksheet","setDefinedNames","onundo","onredo","object","function","contextMenu","toolbar","onevent","Jspreadsheet: cursor not in the viewport","keydown","oneditionstart","oncreateeditor","hidden","jss_focus","jss_formula","oneditionend","data-mask","data-value","inputmode","0","style","jss_input","contentEditable","oninput",
"setRowId","onchangerowid","setBorder","resetBorders","updateCells","setFormula","updateData","onbeforesave","POST","Authorization","Bearer ","onbeforesend","disconected",": ","Sorry, something went wrong, refreshing your spreadsheet...","_top","onsave","persistence","?","?worksheet=","&worksheet=","add","remove","jss_cursor","selected","main","copying","onblur","onfocus","onselection"," ","'","'!",":","jss_border","cloning","jss_border_","15","jss_resize_corner","data-action","ontouchstart","moveLeft",
"-6px","moveTop","moveRight","moveDown","-2000px","tr","jss_group_container","td","&nbsp;",".jss_group","jss_group","+","width","Jspreadsheet: This column is part of a merged cell.","jss_dragging","1px","jss_helper_col","Jspreadsheet: This row is part of a merged cell","Jspreadsheet: Please clear your search before perform this action","51px","jss_helper_row","No cell selected","Invalid merged properties","onmerge","colspan","rowspan","Column name","data-title","onchangeheader","jss_header","col",
"oncreatecolumn","jss_filters_icon","setFooter","onchangefooter","setFooterValue","onchangefootervalue","resetFooter","setNestedHeaders","onchangenested","jss_nested","resetNestedHeaders","setNestedCell","onchangenestedcell","center","data-nested-x","data-nested-y","align",'""',"\t","oncopy","copy","color: initial","onbeforepaste","JSS: For better results, please allow pagination or tableOverflow.","onpaste","Export not allowed","\ufeff","text/csv;charset=utf-8;",".csv","a","download","Defined names are only available on the Premium edition.",
"onchangedefinednames","#REF!","#1a237e","#b71c1c","#880e4f","#1b5e20","#ff6f00","-","/","*","^","(","[","|",";","data-token","picker","jss_picker","click","active","focus","input","jss_object","contenteditable","blur","last",'<b class="','" data-token="','">',"</b>","data-single","true","b",")","]","var "," = {};"," = ",";\n","; return ","onbeforeformula","#LOOP","Reference loop detected","#SELF","Self Reference detected","#ERROR","Table does not exist or is not loaded yet","CHART(","#SPILL!","jss_number",
"$","Something went wrong","onafterchanges","checkbox","autonumber","radio","email","url","color","progressbar","rating","onformulachain","onbeforechange","onchange","oncreatecell","values","mergeCells","title","jss_comments","jss_unlocked","jss_zebra","jss_wrap","onchangeproperty","jss_row","oncreaterow","Jspreadsheet: Invalid origin or destination","onmoverow","Jspreadsheet: Insert row is not enabled in the table configuration","onbeforeinsertrow","onbeforeinsertrow returned false","oninsertrow",
"Jspreadsheet: Delete row is not enabled in the table configuration","onbeforedeleterow","onbeforedeleterow returned false","meta","cells","comments","ondeleterow","Jspreadsheet: Invalid origin","Jspreadsheet: Invalid destination","onmovecolumn","Jspreadsheet: Insert column is not enabled in the table configuration","onbeforeinsertcolumn","onbeforeinsertcolumn returned false","record","col_","oninsertcolumn","Jspreadsheet: Delete column is not enabled in the table configuration","Jspreadsheet: it is not possible to delete the last column",
"onbeforedeletecolumn","onbeforedeletecolumn returned false","ondeletecolumn","; ","onchangestyle","No cell provided","onresetstyle","onbeforecomments","oncomments","setMeta","onchangemeta","resetMeta","onresetmeta","arrow-down","percent","numeric","onbeforesort","This action will destroy any existing merged cells. Are you sure?","onsort","arrow-up","jss_pagination","Jspreadsheet: No pagination defined","Jspreadsheet: pagination not defined","onbeforechangepage","onchangepage","No records found",
"jss_page","jss_page_selected","Showing page {0} of {1} entries","jss_frozen_row","jss_freeze_control_row","jss_freeze_control_col","jss_content","selectstart","table","thead","tbody","tfoot","colgroup","50","jss_selectall","JSS: Freeze controls are only available on the Premium edition.","jss","cellpadding","cellspacing","unselectable","yes","jss_","jss_overflow","jss_locked","jss_corner","on","onselectstart","return false","X","Y","jss_content_pagination","Frozen columns cannot be greater than the number of available columns",
"rows","onbeforechangereferences","onchangereferences","jss_container","jss_toolbar","jss_helper","jss_loading","textarea","jss_textarea","-1","bottom","beforeinit","Sheet","Worksheet clash name: ",". It is highly recommended to define a unique worksheetName on the initialization.","jss_worksheet","init","To improve the performance, use tableOverflow or pagination.","resize","touchstart","touchmove","touchend","onresizecolumn","onresizerow","label","jss_filters_active","Jspreadsheet: the filter is not enabled.",
"onopenfilter","Blanks","onbeforefilter","onfilter","gi","jss_filters_options","INPUT","Search","jss_filters_search","button","Ok","jss_filters_apply","jss_filters",'<input type="checkbox"> ',"Add current selection to filter",'<input type="checkbox"> (',"Select all","select","jss_pagination_dropdown","option","Show","entries","jss_search","jss_searching","onbeforesearch","onsearch","jss_search_container","jss_contextmenu","cell","row","header","Mac","&#8984;","Ctrl","tabs","Rename this worksheet",
"Delete this worksheet","Are you sure?","line","nested","Rename this cell","Cut","content_cut"," + X","Copy","content_copy"," + C","Paste","content_paste"," + V","Insert a new column before","Insert a new column after","Delete selected columns","Rename this column","Create a new row","Order ascending","Order descending","Insert a new row before","Insert a new row after","Delete selected rows","Edit notes","Add notes","notes","Notes","Clear notes","Save as","save"," + S","About","info","with-toolbar",
"i","undo","redo","divisor","120px","Verdana","Arial","Courier New",'<span style="font-family:',"</span>","font-family","48px","format_size","x-small","small","medium","large","x-large",'<span style="font-size:',"font-size","format_align_left","format_align_center","format_align_right","format_align_justify",'<i class="material-icons">',"</i>","text-align","_","format_align_","format_bold","font-weight","bold","format_color_text","format_color_fill","background-color","extended","top","middle","vertical_align_top",
"vertical_align_center","vertical_align_bottom","vertical-align","web","Merge the selected cells","border_all","border_outer","border_inner","border_horizontal","border_vertical","border_left","border_top","border_right","border_bottom","border_clear","black","border-left: ","px solid ","border-left: ; ","border-right: ","border-right: ; ","border-top: ","border-top: ; ","border-bottom: ","border-bottom: ; ","material-icons","color_lens",'<div style="height: ','px; width: 50px; background-color: black;"></div>',
"80px","1","fullscreen_exit","Toggle Fullscreen","search","search_off","Toggle Search","onbeforecreateworksheet","There is one existing worksheet with the same name.","createWorksheet","oncreateworksheet","deleteWorksheet","ondeleteworksheet","It was not possible to rename worksheet due conflict name","onrenameworksheet","onmoveworksheet","onopenworksheet","TABLE","Element is not a table","colgroup > col","data-celltype","readOnly","name","id",":scope > thead > tr",":scope > tr, :scope > tbody > tr",
"data-formula","class","styleBold","; font-weight:bold;","font-weight:bold;","tfoot tr","calendar","\r","\n","jss_ignore","THEAD","TBODY","TFOOT","selectall","header-group","jtabs-headers","filters","footer","jtoolbar","DIV","html","jss_nowrap","insertHTML","<br/>\n","Process","move","col-resize","grab","row-resize","A","mailto:","_blank","onclick","jclose","DOM el not found",'<table class="jss"><tbody><tr><td>A</td></tr></tbody></table>',"Cloud extension not loaded.","onload","jtabs","jss_dialog",
"decimal","data-locale","%","jss_percent","[Red]","red","jss_notes","145px","tag","jss_dropdown_tags","jss_dropdown","multiple","image","<div class='jss_dropdown_icon' style='background-color: ","'></div>","orange","<div class='jss_dropdown_tag' style='background-color: ","'>","</div>","timepicker","YYYY-MM-DD","square","100px","false","FALSE","disabled","TRUE","jss_progressbar","min","max","jss_rating"," stars","star","href","IMG","round","100%","jss_image","tabindex","jpanel","delete","jfile",'<img src="',
'" alt="">',"jss_richtext","jss_tags","40px","#NOTFOUND","<img src='","' class='round small' />","Jspreadsheet: worksheet not found "];
(function(E,J){typeof exports===_$_af97[103]&&typeof module!==_$_af97[21]?module.exports=J():typeof define===_$_af97[104]&&define.amd?define(J):E.jspreadsheet=E.jexcel=J()})(this,function(){_$_af97[0];var E=function(h,c){h=jSuites.translate(h);if(c&&c.length)for(var b=0;b<c.length;b++)h=h.replace(_$_af97[1]+b+_$_af97[2],c[b]);return h},J=function(h,c){Array.isArray(h)&&(h=h[0]);h=h.replace(new RegExp(/'/g),_$_af97[3]).toUpperCase();if(void 0===c)return window[h]?window[h]:null;window[h]=c},N=function(){var h=
{version:_$_af97[4],edition:_$_af97[5],host:_$_af97[6],license:_$_af97[7],print:function(){return[_$_af97[8]+this.edition+_$_af97[9]+this.version+_$_af97[10]+this.host+_$_af97[10]+this.license]}};return function(){return h}}(),W=function(h){var c=parseInt(h.y);if(h.id)var b=parseInt(h.id);else h.value&&(b=parseInt(h.value));0<b&&(this.rows[c].id=b,xa[_$_af97[11]].call(this,b))},S=function(h,c){var b=_$_af97[3],a=0;-1!==h.indexOf(_$_af97[12])&&(h=h.replace(new RegExp(_$_af97[13],_$_af97[14]),_$_af97[15]),
h=h.replace(new RegExp(_$_af97[16],_$_af97[14]),_$_af97[17]));for(var d=[_$_af97[18],_$_af97[19],_$_af97[17],_$_af97[15]],e=0;e<h.length;e++)h[e]==_$_af97[20]&&(a=0==a?1:0),1==a?b+=h[e]:(b+=h[e].toUpperCase(),1==c&&0<e&&h[e]==_$_af97[18]&&-1==d.indexOf(h[e-1])&&-1==d.indexOf(h[e+1])&&(b+=_$_af97[18]));return b},aa=function(h){return(_$_af97[3]+h).substr(0,1)===_$_af97[18]},qa=function(h){var c=this.options.columns;return c[h]&&c[h].name?c[h].name:h},O=function(h,c,b){var a;if(a=this.options.data[c]){var d=
0<=h?qa.call(this,h):h;typeof b===_$_af97[21]?b=typeof d===_$_af97[22]?a[h]:jSuites.path.call(a,_$_af97[3]+d):(typeof d===_$_af97[22]?a[h]=b:jSuites.path.call(a,_$_af97[3]+d,b),!aa(b)&&this.records[c][h]&&(this.records[c][h].v=b))}else b=null;return b},P=function(h){return 0==this.config.editable||h&&0==h.options.editable?!1:(h=Ma.call(this))?7<=h?!0:!1:!0},Na=function(h){var c=_$_af97[23];if(this.parent)var b=this.parent.config,a=this.parent.element,d=this;else b=this.config,a=this.element,d=u.current?
u.current:null;typeof h===_$_af97[21]&&(h=!a.classList.contains(c));h?(a.classList.add(c),b.fullscreen=!0):(a.classList.remove(c),b.fullscreen=!1);d&&(H.call(d,!0),ma.update.call(d.parent,d))},Oa=function(h){var c=this.loading;null===h&&(h=c.style.display==_$_af97[24]?!0:!1);c.style.display=h?_$_af97[24]:_$_af97[3];setTimeout(function(){c.style.display=_$_af97[3]},1E3)},Ja=function(h,c){if(typeof h===_$_af97[25]){var b=F.getCoordsFromColumnName(h);b=this.records[b[1]][b[0]];if(b.element)h=b.element;
else return typeof c===_$_af97[21]?b.readonly:b.readonly=c?!0:!1}b=_$_af97[26];h=h.classList;if(typeof c===_$_af97[21])return h.contains(b)?!0:!1;c?h.add(b):h.remove(b)},Ta=function(h,c){var b,a=[];if(typeof h===_$_af97[25]){var d=F.getCoordsFromColumnName(h);a.push({x:d[0],y:d[1],value:{rotate:c}})}else if(Array.isArray(h))for(b=0;b<h.length;b++)d=F.getCoordsFromColumnName(h[b]),a.push({x:d[0],y:d[1],value:{rotate:c}});for(b=0;b<a.length;b++)(d=this.records[a[b].y][a[b].x])&&d.element&&(h=d.element.firstChild,
c?(h&&h.classList&&h.classList.contains(_$_af97[27])||(h=document.createElement(_$_af97[28]),h.classList.add(_$_af97[27]),h.innerHTML=d.element.innerHTML,d.element.innerHTML=_$_af97[3],d.element.appendChild(rotate)),h.style.transform=_$_af97[29]+parseInt(270-c)+_$_af97[30]):h&&h.classList&&h.classList.contains(_$_af97[27])&&(h.classList.remove(_$_af97[27]),h.style.transform=_$_af97[3]));this.updateProperty(a)},Aa=function(h){var c=_$_af97[31],b=this.table.classList;if(typeof h==_$_af97[21])return b.contains(c)?
!1:!0;h?b.remove(c):b.add(c);H.call(this,!0)},Ma=function(h){if(void 0===h)return this.status;var c=document.createElement(_$_af97[32]);c.style.textAlign=_$_af97[33];c.style.fontSize=_$_af97[34];c.style.cursor=_$_af97[35];c.onclick=function(){window.location.href=N().host+_$_af97[36]};var b=null,a=[],d=[74,50,48,50,48,33].join(_$_af97[3]);(function(g){b=1;try{if(g){var f=window.atob(g);f=f.split(_$_af97[37]);if(f[1]){f[1]=window.atob(f[1]);var k=f[0];g=d;var l=f[1],n=jSuites.sha512,q=_$_af97[3],p=
_$_af97[3];128<g.length&&(g=n(g));for(var v=0;128>v;v++){var w=g[v]?g[v].charCodeAt(0):0;q+=String.fromCharCode(54^w);p+=String.fromCharCode(92^w)}var x=n(p+n(q+l));if(k!=x)b=3;else if(f[1]=JSON.parse(f[1]),f[1].date){var y=window.location.hostname||_$_af97[38];k=!1;for(x=0;x<f[1].domain.length;x++)-1===f[1].domain[x].indexOf(_$_af97[39])?y===f[1].domain[x]&&(k=!0):y.substr(y.indexOf(f[1].domain[x]))==f[1].domain[x]&&(k=!0);!1===k?b=4:f[1].scope&&0<=f[1].scope.indexOf(_$_af97[40])?(y=new Date,k=parseInt(y.getTime()/
1E3),x=N(),f[1].date<k?(b=f[1].demo||!f[1].plan||f[1].date+2592E3<k?6:7,x.license=f[1].name+_$_af97[41]):(b=8,x.license=_$_af97[42]+f[1].name,x.edition=3==f[1].plan||6==f[1].plan||31==f[1].plan||33==f[1].plan?_$_af97[43]:_$_af97[5],a=f[1].scope)):b=5}else b=4}else b=2}}catch(A){}})(h);h=_$_af97[3];if(1==b)h=_$_af97[44];else if(2==b||3==b||4==b)h=_$_af97[45];else if(5==b)h=_$_af97[46];else if(6==b||7==b)h=_$_af97[47];c.appendChild(document.createTextNode(h));if(8>b)try{if(typeof sessionStorage!==_$_af97[21]&&
!sessionStorage.getItem(_$_af97[48])){sessionStorage.setItem(_$_af97[48],!0);var e=document.createElement(_$_af97[49]);e.src=N().host+_$_af97[50]+_$_af97[51];e.style.display=_$_af97[52];c.appendChild(e)}}catch(g){}Object.defineProperty(this,_$_af97[53],{value:b,writable:!1,configurable:!1,enumerable:!1,extensible:!1});Object.defineProperty(this,_$_af97[54],{value:N().edition===_$_af97[43]?1:0,writable:!1,configurable:!1,enumerable:!1,extensible:!1});Object.defineProperty(this,_$_af97[55],{get:function(){return a},
configurable:!1,enumerable:!1,extensible:!1});return c},H=function(){var h=function(l){-1==this.indexOf(l)&&this.push(l)},c=function(l,n){if(!l||!n)return!1;var q=l.length;if(q!=n.length)return!1;for(;q--;)if(l[q]!==n[q])return!1;return!0},b=function(l){var n=null,q,p,v=0,w={},x=!1;for(q=0;q<this.options.columns.length;q++)if(-1===l.indexOf(q)){if(ia.attached.call(this,q)){this.headers[q].parentNode.removeChild(this.headers[q]);this.colgroup[q].parentNode.removeChild(this.colgroup[q]);if(this.options.footers)for(p=
0;p<this.options.footers.length;p++)this.footers.content[p][q].element&&this.footers.content[p][q].element.parentNode&&this.footers.content[p][q].element.parentNode.removeChild(this.footers.content[p][q].element);x=!0}for(p=0;p<this.visibleRows.length;p++){var y=this.records[this.visibleRows[p]][q];y.element&&y.element.parentNode&&y.element.parentNode.removeChild(y.element)}}if(this.options.nestedHeaders)for(p=0;p<this.thead.children.length-1;p++)v+=this.thead.children[p].offsetHeight;for(q=0;q<l.length;q++){var A=
l[q];var z=Da.create.call(this,A);if(n){if(!z.parentNode){this.headerContainer.insertBefore(z,this.headerContainer.children[n].nextSibling);this.colgroupContainer.insertBefore(this.colgroup[A],this.colgroupContainer.children[n].nextSibling);if(this.options.footers)for(p=0;p<this.options.footers.length;p++)this.tfoot.children[p].insertBefore(fa.create.call(this,A,p),this.tfoot.children[p].children[n].nextSibling);v&&(z.style.top+=v);x=!0}for(p=0;p<this.visibleRows.length;p++)y=this.visibleRows[p],
y=Q[_$_af97[58]].call(this,A,y),y.parentNode||this.tbody.children[p].insertBefore(y,this.tbody.children[p].children[n].nextSibling)}else{if(!z.parentNode){this.headerContainer.insertBefore(z,this.headerContainer.children[1]);this.colgroupContainer.insertBefore(this.colgroup[A],this.colgroupContainer.children[1]);if(this.options.footers)for(p=0;p<this.options.footers.length;p++)this.tfoot.children[p].insertBefore(fa.create.call(this,A,p),this.tfoot.children[p].children[1]);v&&(z.style.top+=v);x=!0}for(p=
0;p<this.visibleRows.length;p++)y=this.visibleRows[p],y=Q[_$_af97[58]].call(this,A,y),y.parentNode||this.tbody.children[p].insertBefore(y,this.tbody.children[p].children[1])}if(this.options.mergeCells)for(p=0;p<this.visibleRows.length;p++)y=this.visibleRows[p],n=F.getColumnNameFromCoords(A,y),this.options.mergeCells[n]&&(this.records[y][A].merged||(w[n]=!1));n=Array.prototype.indexOf.call(this.headerContainer.children,z)}v=0;if(this.options.nestedHeaders)for(p=0;p<this.options.nestedHeaders.length;p++){n=
null;A=[];y=ya.getColumns.call(this,p);for(q=0;q<l.length;q++)void 0!==y[l[q]]&&-1==A.indexOf(y[l[q]])&&A.push(y[l[q]]);for(q=0;q<this.options.nestedHeaders[p].length;q++)-1==A.indexOf(q)&&this.nested.content[p][q]&&this.nested.content[p][q].element.offsetHeight&&this.nested.content[p][q].element.remove();for(q=y=0;q<A.length;q++)z=ya.create.call(this,A[q],p),z.parentNode||(n?this.thead.children[p].children[n]?this.thead.children[p].insertBefore(z,this.thead.children[p].children[n].nextSibling):this.thead.children[p].appendChild(z):
this.thead.children[p].insertBefore(z,this.thead.children[p].children[1]),z.style.top=v+_$_af97[59],this.options.freezeColumns&&this.options.nestedHeaders[p][A[q]].frozen&&(z.style.left=y+(Aa.call(this)?50:0)+_$_af97[59],z.classList.add(_$_af97[60]))),y+=z.offsetWidth,n=Array.prototype.indexOf.call(this.thead.children[p].children,z);v+=this.thead.children[p].offsetHeight}1==x?this.table.style.left=g.width.call(this,l[this.options.freezeColumns||0])+_$_af97[59]:this.width<parseInt(this.table.style.left)&&
(this.table.style.left=_$_af97[61]);sa.batch.call(this,w);this.visibleCols=l},a=function(l){var n=[],q=null,p,v=!1;for(p=0;p<this.tbody.children.length;p++)n.push(this.tbody.children[p]);for(p=0;p<n.length;p++){var w=parseInt(n[p].getAttribute(_$_af97[57]));-1===l.indexOf(w)&&(n[p].parentNode.removeChild(n[p]),v=!0)}for(p=0;p<l.length;p++)n=ca.create.call(this,l[p]),n.parentNode||(q?this.tbody.insertBefore(n,q.nextSibling):this.tbody.insertBefore(n,this.tbody.firstChild),this.rows[l[p]].height=n.offsetHeight,
v=!0),q=n;v?(this.table.style.top=g.height.call(this,l[this.options.freezeRows||0])+_$_af97[59],this.visibleCols=null):this.height<parseInt(this.table.style.top)&&(this.table.style.top=_$_af97[61]);this.visibleRows=l},d=function(){var l=[],n=0,q=null;if(H.limited.call(this)){var p=q=0;p=this.content.scrollLeft;var v=p+this.content.offsetWidth;q=this.options.columns;var w=null,x=this.options.freezeColumns||0,y=0;x&&(p+=ba.getWidth.call(this,!0));for(n=0;n<q.length;n++)w=ia.isVisible.call(this,n)?parseInt(q[n].width):
0,(y+w>p&&y<=v||n<x)&&h.call(l,n),y+=w;for(n=0;n<l.length;n++)if(p=sa.getAffected.call(this.merged.cols,l[n]))for(q=0;q<p.length;q++)h.call(l,p[q]);for(n=0;n<l.length;n++)if(p=ya.getAffected.call(this,l[n]))for(q=0;q<p.length;q++)this.options.columns[p[q]]&&h.call(l,p[q]);l.sort(function(A,z){return A-z})}else for(q=this.options.columns,n=0;n<q.length;n++)l.push(n);c(l,this.visibleCols)||b.call(this,l)},e=function(){var l=[],n=null,q=0,p=0;q=null;var v=0;if(H.limited.call(this)&&!this.options.pagination){var w=
this.content.scrollTop,x=w+this.content.offsetHeight,y=0,A=this.options.freezeRows||0,z=0;n=this.results?this.results:this.rows;A&&(w+=ja.getHeight.call(this,!0));for(p=0;p<n.length;p++)q=this.results?n[p]:p,y=ca.height.call(this,q),(z+y>w&&z<x||p<A)&&l.push(q),z+=y}else for(n=this.results?this.results:this.rows,this.options.pagination?(q=parseInt(this.options.pagination)*this.pageNumber,v=q+parseInt(this.options.pagination),v>n.length&&(v=n.length)):(q=0,v=n.length),p=q;p<v;p++)q=this.results?n[p]:
p,l.push(q);if(this.options.mergeCells){for(p=0;p<l.length;p++)if(this.merged.rows[l[p]]&&(v=sa.getAffected.call(this.merged.rows,l[p])))for(q=0;q<v.length;q++)-1===l.indexOf(v[q])&&l.push(v[q]);l.sort(function(I,r){return I-r})}c(l,this.visibleRows)||a.call(this,l)},g=function(l,n){n&&(this.visibleCols=this.visibleRows=null);g.calculate.call(this);g.update.call(this);if(!0!==l){var q=this;this.content.addEventListener(_$_af97[62],function(){g.ignore||g.update.call(q)});this.content.addEventListener(_$_af97[63],
function(p){if(H.limited.call(q)&&!q.options.pagination){var v=Math.abs(p.deltaX),w=Math.abs(p.deltaY);p.shiftKey||v>w?0>p.deltaX||0>p.deltaY?g.left.call(q):g.right.call(q):0>p.deltaY?g.up.call(q):g.down.call(q);p.preventDefault()}})}};g.calculate=function(){if(H.limited.call(this)){var l=ba.getWidth.call(this),n=ja.getHeight.call(this);this.width=g.width.call(this)+(l?l:1);this.height=g.height.call(this)+(n?n:1);this.scrollX.style.width=this.width+100+_$_af97[59];this.scrollY.style.height=this.height+
100+_$_af97[59]}};g.update=function(){e.call(this);d.call(this);Ca.update.call(this);ba.refresh.call(this);ja.refresh.call(this);da.refresh.call(this)};g[_$_af97[64]]=function(l,n){null!==l&&(l=g.height.call(this,l),this.content.scrollTop=l);void 0!==n&&null!==n&&(n=g.width.call(this,n),this.content.scrollLeft=n)};g.up=function(l){if(l)this.content.scrollTop=0;else if(this.tbody.firstChild){l=this.tbody.lastChild.getAttribute(_$_af97[57]);l=parseInt(l);var n=l;for(this.results&&(l=this.results.indexOf(l));0<
l;){l--;var q=this.results?this.results[l]:l;if(!this.rows[q]||!1!==this.rows[q].visible){n=q;break}}q=ca.height.call(this,n);l=this.tbody.firstChild.getAttribute(_$_af97[57]);ca.attached.call(this,l)||(q+=this.content.scrollTop-this.table.offsetTop);this.content.scrollTop-=q}};g.down=function(l){if(l)this.content.scrollTop=this.content.scrollHeight;else if(this.tbody.firstChild){l=this.tbody.firstChild.getAttribute(_$_af97[57]);l=parseInt(l);var n=l;for(this.results&&(l=this.results.indexOf(l));l<
this.rows.length-1;){var q=this.results?this.results[l]:l;if(!this.rows[q]||!1!==this.rows[q].visible){n=q;break}l++}l=ca.height.call(this,n);this.content.scrollTop+=l}};g.left=function(l){var n=this.options.freezeColumns||0;if(l)this.content.scrollLeft=0;else{for(n=l=this.thead.lastChild.children[1+n].getAttribute(_$_af97[56]);0<l;)if(l--,ia.isVisible.call(this,l)){n=l;break}l=n;n=parseInt(this.options.columns[l].width);this.headers[l]&&this.headers[l].parentNode||(n+=this.content.scrollLeft-this.table.offsetLeft);
this.content.scrollLeft-=n}};g.right=function(l){var n=this.options.freezeColumns||0;this.content.scrollLeft=l?this.content.scrollWidth:this.content.scrollLeft+this.thead.lastChild.children[1+n].offsetWidth};var f=function(){for(var l,n=this.content.offsetHeight-this.thead.offsetHeight-ja.getHeight.call(this),q=0,p=0;p<this.tbody.children.length;p++)l=this.tbody.children[p].offsetHeight,n>l&&(q+=l,n-=l);return q},k=function(){for(var l,n=this.content.offsetWidth-ba.getWidth.call(this),q=0,p=0;p<this.thead.lastChild.children.length;p++)l=
this.thead.lastChild.children[p].offsetWidth,n>l&&(q+=l,n-=l);return q};g.pageUp=function(){this.content.scrollTop-=f.call(this)};g.pageDown=function(){this.content.scrollTop+=f.call(this)};g.pageLeft=function(){this.content.scrollLeft-=k.call(this)};g.pageRight=function(){this.content.scrollLeft+=k.call(this)};g.build=function(l){var n=document.createElement(_$_af97[32]);n.className=_$_af97[65]+l;return n};g.width=function(l,n){for(var q=this.options.columns,p=0,v=this.options.freezeColumns||0;v<
this.options.columns.length;v++){if(l===v)return p;ia.isVisible.call(this,v)&&(p+=parseInt(q[v].width));if(p>=n)return v}return n?v:p};g.height=function(l,n){for(var q=0,p=0,v=this.results?this.results:this.rows,w=this.options.freezeRows||0;w<v.length;w++){p=w;this.results&&(p=v[w]);if(l===p)return q;this.rows[p]&&!1!==this.rows[p].visible&&(q+=ca.height.call(this,p));if(q>=n)return p}return n?p:q};g.adjust=function(l,n,q){var p=this.records[n][l].element;if(p){if(!this.records[n][l].merged)if(0==
q||2==q){var v=0,w=Aa.call(this)?50:0;this.options.freezeColumns&&(v=ba.getWidth.call(this,!0));n=this.content.scrollLeft+v;v=this.content.scrollLeft+(this.content.offsetWidth-w);w=this.table.offsetLeft+p.offsetLeft-w;var x=p.offsetWidth;0==q?w+x<v&&l>this.options.freezeColumns-1&&w<n&&(p.offsetHeight?(q=this.content.scrollLeft+(w-n),g.setX.call(this,q)):g[_$_af97[64]].call(this,null,l)):l>this.options.freezeColumns-1&&(w>n?w+x>v&&(p.parentNode?(q=this.content.scrollLeft+(w+x-v+16),g.setX.call(this,
q)):g[_$_af97[64]].call(this,null,l)):g[_$_af97[64]].call(this,null,l))}else v=0,this.options.freezeRows&&(v=ja.getHeight.call(this,!0)),l=this.content.scrollTop+v,v=this.content.scrollTop+this.content.offsetHeight-this.thead.offsetHeight-16,w=this.table.offsetTop+p.offsetTop-this.thead.offsetHeight,x=p.offsetHeight,1==q?w+x<v&&n>this.options.freezeRows-1&&(w<l?p.parentNode?0<l-w&&(q=this.content.scrollTop+(w-l),g.setY.call(this,q)):g[_$_af97[64]].call(this,n):p.offsetHeight||g[_$_af97[64]].call(this,
n)):n>this.options.freezeRows-1&&(w>l?w+x>v&&(p.parentNode?(q=this.content.scrollTop+(w+x-v),g.setY.call(this,q)):g[_$_af97[64]].call(this,n)):p.offsetHeight||g[_$_af97[64]].call(this,n))}else 0==q||2==q?g[_$_af97[64]].call(this,null,l):g[_$_af97[64]].call(this,n)};g.setX=function(l){g.ignore=!0;this.content.scrollLeft=l;g.ignore=!1};g.setY=function(l){g.ignore=!0;this.content.scrollTop=l;g.ignore=!1};g.limited=function(){return 1==this.options.tableOverflow||1==this.parent.config.fullscreen};return g}(),
Pa=function(h,c,b,a){var d=c,e=null;if(this.results&&(c=this.results.indexOf(c),-1==c))return d;for(;0<c;){c--;var g=this.results?this.results[c]:c;if(!1!==this.rows[g].visible){var f=this.records[g][h].v===_$_af97[3]?!1:!0;null===e&&(e=f);if(this.records[g][h].element&&this.records[g][h].element.classList.contains(_$_af97[66])){if(this.records[g][h].merged){d=g-this.records[g][h].merged[1];if(!b)break;f=!0}}else{if(b&&f!==e&&!a)break;if(b)d=this.records[g][h].merged?g-this.records[g][h].merged[1]:
g;else return g}e=f}}return d},Qa=function(h,c,b,a){for(var d=h,e,g=null;0<h;)if(h--,ia.isVisible.call(this,h)){e=!1;this.records[c]&&(e=this.records[c][h].merged?this.records[c-this.records[c][h].merged[1]][h-this.records[c][h].merged[0]].v?!0:!1:this.records[c][h].v?!0:!1);null===g&&(g=e);if(this.records[c]&&this.records[c][h].element&&this.records[c][h].element.classList.contains(_$_af97[66])){if(this.records[c][h].merged&&(d=h-this.records[c][h].merged[0],!b))break}else{if(b&&e!==g&&!a)break;
if(b)d=h;else return h}g=e}return d},Ua=function(){var h=function(b,a,d,e){1==b||3==b?ca.attached.call(this,d)||(0<this.options.pagination?this.page(this.whichPage(d)):1==b?H.up.call(this,e):H.down.call(this,e)):Q.attached.call(this,a,d)||(0==b?H.left.call(this,e):H.right.call(this,e))},c=function(b){b.up=c.up;b.down=c.down;b.right=c.right;b.left=c.left;b.last=c.last;b.first=c.first};c.up=function(b,a,d){if(Array.isArray(this.selectedCell)){if(b)var e=parseInt(this.selectedCell[2]),g=parseInt(this.selectedCell[3]);
else e=parseInt(this.selectedCell[0]),g=parseInt(this.selectedCell[1]);d=Pa.call(this,e,g,a,d);d!=g&&(g=d,b?(b=this.selectedCell[0],d=this.selectedCell[1]):(b=e,d=g,e=b,g=d),h.call(this,1,e,g,a),ka[_$_af97[11]].call(this,b,d,e,g),H.adjust.call(this,e,g,1))}};c.down=function(b,a,d){if(Array.isArray(this.selectedCell)){if(b)var e=parseInt(this.selectedCell[2]),g=parseInt(this.selectedCell[3]);else e=parseInt(this.selectedCell[0]),g=parseInt(this.selectedCell[1]);a:{var f=e,k=g,l=k,n=null;if(this.results){k=
this.results.indexOf(k);if(-1==k){d=l;break a}var q=this.results.length-1}else q=this.rows.length-1;for(;k<q;){k++;var p=this.results?this.results[k]:k;if(!1!==this.rows[p].visible){var v=this.records[p][f].v===_$_af97[3]?!1:!0;null===n&&(n=v);if(this.records[p][f].element&&this.records[p][f].element.classList.contains(_$_af97[66])){if(this.records[p][f].merged){if(!this.records[p][f].merged[1]&&(l=p,!a))break;v=!0}}else if(a&&v!==n&&!d){d=l;break a}else if(a)l=p;else{d=p;break a}n=v}}d=l}d!=g&&(g=
d,b?(b=this.selectedCell[0],d=this.selectedCell[1]):(b=e,d=g,e=b,g=d),h.call(this,3,e,g,a),ka[_$_af97[11]].call(this,b,d,e,g),H.adjust.call(this,e,g,3))}};c.right=function(b,a,d){if(Array.isArray(this.selectedCell)){if(b)var e=parseInt(this.selectedCell[2]),g=parseInt(this.selectedCell[3]);else e=parseInt(this.selectedCell[0]),g=parseInt(this.selectedCell[1]);a:{for(var f=e,k=g,l=this.options.columns,n=f,q,p=null;f<l.length-1;)if(f++,ia.isVisible.call(this,f)){q=!1;this.records[k]&&(q=this.records[k][f].merged?
this.records[k-this.records[k][f].merged[1]][f-this.records[k][f].merged[0]].v?!0:!1:this.records[k][f].v?!0:!1);null===p&&(p=q);if(this.records[k]&&this.records[k][f].element&&this.records[k][f].element.classList.contains(_$_af97[66])){if(this.records[k][f].merged&&f==f+this.records[k][f].merged[0]&&(n=f,!a))break}else if(a&&q!==p&&!d){d=n;break a}else if(a)n=f;else{d=f;break a}p=q}d=n}d!=e&&(e=d,b?(b=this.selectedCell[0],d=this.selectedCell[1]):(b=e,d=g,e=b,g=d),h.call(this,2,e,g,a),ka[_$_af97[11]].call(this,
b,d,e,g),H.adjust.call(this,e,g,2))}};c.left=function(b,a,d){if(Array.isArray(this.selectedCell)){if(b)var e=parseInt(this.selectedCell[2]),g=parseInt(this.selectedCell[3]);else e=parseInt(this.selectedCell[0]),g=parseInt(this.selectedCell[1]);d=Qa.call(this,e,g,a,d);d!=e&&(e=d,b?(b=this.selectedCell[0],d=this.selectedCell[1]):(b=e,d=g,e=b,g=d),h.call(this,0,e,g,a),ka[_$_af97[11]].call(this,b,d,e,g),H.adjust.call(this,e,g,0))}};c.first=function(b,a){Array.isArray(this.selectedCell)&&(a?c.up.call(this,
b,!0,!0):c.left.call(this,b,!0,!0))};c.last=function(b,a){Array.isArray(this.selectedCell)&&(a?c.down.call(this,b,!0,!0):c.right.call(this,b,!0,!0))};return c}(),Va=function(){return function(h){h.save=Ra;h.fullscreen=Na;h.setReadOnly=Ja;h.getReadOnly=Ja;h.isReadOnly=Ja;h.rotate=Ta;h.setPlugins=function(c){ua.call(this.parent,c)};h.showIndex=function(){Aa.call(this,!0)};h.hideIndex=function(){Aa.call(this,!1)};h[_$_af97[64]]=H[_$_af97[64]];h.undo=function(){R.undo.call(h.parent)};h.redo=function(){R.redo.call(h.parent)};
h.isEditable=function(){return P.call(h.parent,h)};h.dispatch=function(){return G.apply(this.parent,arguments)};h.persistence=L;h.setViewport=function(c,b){this.options.tableOverflow=!0;c=parseInt(c);b=parseInt(b);this.content.classList.add(_$_af97[67]);150<c&&(this.options.tableWidth=c+_$_af97[59],this.content.style.width=this.options.tableWidth);150<b&&!this.options.pagination&&(this.options.tableHeight=parseInt(b)+_$_af97[59],this.content.style.height=this.options.tableHeight);H.call(this,!0);
ma.update.call(this.parent,this);G.call(this.parent,_$_af97[68],c,b)};h.helpers=F}}(),Fa=function(){var h={logo:null,url:null,persistence:!1,sequence:!0,data:null,json:null,rows:[],columns:[],cells:{},role:null,nestedHeaders:null,defaultColWidth:100,defaultRowHeight:0,defaultColAlign:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],csv:null,csvFileName:_$_af97[48],csvHeaders:!0,csvDelimiter:_$_af97[37],columnSorting:!0,columnDrag:!0,columnResize:!0,rowResize:!0,rowDrag:!0,editable:!0,allowInsertRow:!0,
allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!0,selectionCopy:!0,mergeCells:{},search:!1,pagination:!1,paginationOptions:null,textOverflow:!1,tableOverflow:!1,tableHeight:_$_af97[69],tableWidth:null,resize:null,comments:null,meta:null,style:{},freezeColumns:0,freezeRows:0,freezeColumnControl:!1,freezeRowControl:!1,orderBy:null,worksheetId:_$_af97[3],worksheetName:null,worksheetState:null,
filters:!1,footers:null,formify:null,applyMaskOnFooters:!1,pluginOptions:null,locked:!1,selectUnLockedCells:!0,selectLockedCells:!0,wrap:!1},c={application:_$_af97[70],cloud:null,root:null,definedNames:{},sorting:null,server:null,toolbar:null,editable:!0,allowExport:!0,includeHeadersOnDownload:!1,forceUpdateOnPaste:!1,loadingSpin:!1,fullscreen:!1,secureFormulas:!0,parseFormulas:!0,debugFormulas:!1,editorFormulas:!0,autoIncrement:!0,autoCasting:!0,stripHTML:!1,tabs:!1,allowDeleteWorksheet:!0,allowRenameWorksheet:!0,
allowMoveWorksheet:!0,moveDownOnEnter:!0,onevent:null,onclick:null,onload:null,onundo:null,onredo:null,onbeforesave:null,onsave:null,onbeforechange:null,onchange:null,onafterchanges:null,oncopy:null,onbeforepaste:null,onpaste:null,onbeforeinsertrow:null,oninsertrow:null,onbeforedeleterow:null,ondeleterow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresize:null,onresizerow:null,onresizecolumn:null,onselection:null,
onbeforecomments:null,oncomments:null,onbeforesort:null,onsort:null,onfocus:null,onblur:null,onmerge:null,onchangeheader:null,onchangefooter:null,onchangefootervalue:null,onchangenested:null,onchangenestedcell:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onbeforechangepage:null,onchangepage:null,onbeforecreateworksheet:null,oncreateworksheet:null,onrenameworksheet:null,ondeleteworksheet:null,onmoveworksheet:null,onopenworksheet:null,onchangerowid:null,
onbeforesearch:null,onsearch:null,onbeforefilter:null,onfilter:null,onopenfilter:null,oncreatecell:null,oncreaterow:null,oncreatecolumn:null,onbeforeformula:null,onformulachain:null,onchangereferences:null,onbeforechangereferences:null,onbeforesend:null,onchangedefinednames:null,oninput:null,updateTable:null,contextMenu:null,parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,plugins:null,about:!0,license:null,worksheets:null,validations:null},b=function(e,g){g=JSON.parse(JSON.stringify(g));var f=
{},k;for(k in g)e&&e.hasOwnProperty(k)?f[k]=e[k]:f[k]=g[k];return f},a=function(e){e&&(typeof e==_$_af97[25]&&(e=JSON.parse(e)),this.options.data=e);this.options.json&&(this.options.data=this.options.json);this.options.data||(this.options.data=[]);e=this.options.columns.length;if(this.options.data&&typeof this.options.data[0]!==_$_af97[21]){var g=this.options.data[0].data&&0<Object.keys(this.options.data[0].data).length?Object.keys(this.options.data[0].data):Object.keys(this.options.data[0]);g.length>
e&&(e=g.length)}this.options.minDimensions[0]>e&&(e=this.options.minDimensions[0]);e||(e=8);for(var f=0;f<e;f++)this.options.columns[f]?this.options.columns[f].type||(this.options.columns[f].type=_$_af97[71]):this.options.columns[f]={type:_$_af97[71]},this.options.columns[f].type==_$_af97[72]&&(this.options.columns[f].type=_$_af97[73],this.options.columns[f].autocomplete=!0),!this.options.columns[f].name&&g&&g[f]&&Number(g[f])!=g[f]&&(this.options.columns[f].name=g[f]),this.options.columns[f].width||
(this.options.columns[f].width=parseInt(this.options.defaultColWidth)+_$_af97[59]),this.options.columns[f].type!=_$_af97[73]||this.options.columns[f].source||(this.options.columns[f].source=[]),this.options.columns[f].type==_$_af97[73]&&this.options.columns[f].url&&jSuites.ajax({url:this.options.columns[f].url,index:f,method:_$_af97[74],dataType:_$_af97[75],worksheet:this,group:this.parent.name,success:function(k){this.worksheet.options.columns[this.index].source=k}})},d=function(e){e.getConfig=d[_$_af97[58]];
e.setConfig=d[_$_af97[11]]};d.spreadsheet=function(e){this.config=b(e,c);1!=this.config.secureFormulas&&console.log(_$_af97[76])};d.worksheet=function(e){var g=this;g.options=b(e,h);g.options.csv?jSuites.ajax({url:g.options.csv,method:_$_af97[74],dataType:_$_af97[71],group:g.parent.name,success:function(f){f=F.parseCSV(f,g.options.csvDelimiter);if(1==g.options.csvHeaders&&0<f.length)for(var k=f.shift(),l=0;l<k.length;l++)g.options.columns[l]||(g.options.columns[l]={type:_$_af97[71],width:g.options.defaultColWidth}),
typeof g.options.columns[l].title===_$_af97[21]&&(g.options.columns[l].title=k[l]);a.call(g,f)}}):g.options.url?jSuites.ajax({url:g.options.url,method:_$_af97[74],dataType:_$_af97[75],group:g.parent.name,success:function(f){a.call(g,f)}}):a.call(g)};d[_$_af97[58]]=function(){return this.options};d[_$_af97[11]]=function(e){typeof e==_$_af97[25]&&(e=JSON.parse(e));if(this.parent){g=Object.keys(e);for(f=0;f<g.length;f++)typeof h[g[f]]!==_$_af97[21]&&(this.options[g[f]]=e[g[f]]);this.content.style.resize=
e.resize?e.resize:_$_af97[3];!0===e.filters?la.show.call(this):!1===e.filters&&la.hide.call(this);!0===e.search?va.show.call(this):!1===e.search&&va.hide.call(this);!0===e.toolbar?ma.show.call(this.parent):!1===e.toolbar&&ma.hide.call(this.parent);e.minDimensions&&e.minDimensions[0]&&(g=parseInt(e.minDimensions[0])-this.headers.length,0<g&&this.insertColumn(g),g=parseInt(e.minDimensions[1])-this.rows.length,0<g&&this.insertRow(g));L.call(this,_$_af97[77],{data:JSON.stringify(e)})}else for(var g=Object.keys(e),
f=0;f<g.length;f++)typeof c[g[f]]!==_$_af97[21]&&(this.config[g[f]]=e[g[f]])};return d}(),R=function(h){h=function(a){if(1!=this.ignoreHistory)if(this.historyCascade)this.history[this.historyIndex].cascade||(this.history[this.historyIndex].cascade=[]),this.history[this.historyIndex].cascade.push(a);else{var d=++this.historyIndex;this.history=this.history.slice(0,d+1);this.history[d]=a}};var c=function(a){var d=a.worksheet;if(a.action==_$_af97[78])d.deleteRow(a.insertBefore?a.rowNumber:a.rowNumber+
1,a.numOfRows);else if(a.action==_$_af97[79])d.insertRow(a.numOfRows,a.rowNumber,1,a.data),Q.setAttributes.call(d,a.attributes);else if(a.action==_$_af97[80])d.deleteColumn(a.insertBefore?a.columnNumber:a.columnNumber+1,a.numOfColumns);else if(a.action==_$_af97[81])d.insertColumn(a.numOfColumns,a.columnNumber,1,a.properties,a.data,a.extra),Q.setAttributes.call(d,a.attributes);else if(a.action==_$_af97[82])d.moveRow(a.newValue,a.oldValue);else if(a.action==_$_af97[83])d.moveColumn(a.newValue,a.oldValue);
else if(a.action==_$_af97[84])d.removeMerge(a.newValue,!0),d.setMerge(a.oldValue);else if(a.action==_$_af97[85])d.setMerge(a.oldValue);else if(a.action==_$_af97[86])d.setStyle(a.oldValue,null,null,1);else if(a.action==_$_af97[87])d.setStyle(a.oldValue);else if(a.action==_$_af97[88])d.setWidth(a.column,a.oldValue);else if(a.action==_$_af97[89])d.setHeight(a.row,a.oldValue);else if(a.action==_$_af97[90])d.setHeader(a.column,a.oldValue);else if(a.action==_$_af97[91]||a.action==_$_af97[92]||a.action==
_$_af97[93])d[a.action](a.oldValue);else if(a.action==_$_af97[94])d.orderBy(a.column,a.direction?0:1,a.oldValue,a.previousState);else if(a.action==_$_af97[95]||a.action==_$_af97[96]||a.action==_$_af97[97]){var e=[];for(var g=0;g<a.records.length;g++){var f={x:a.records[g].x,value:a.records[g].oldValue};void 0!==a.records[g].y&&(f.y=a.records[g].y);a.records[g].oldStyle&&(f.style=a.records[g].oldStyle);e.push(f)}a.action==_$_af97[95]?d.setValue(e):d.setProperty(e)}else if(a.action==_$_af97[98])d.renameWorksheet(a.index,
a.oldValue);else if(a.action==_$_af97[99])d.moveWorksheet(a.t,a.f);else if(a.action==_$_af97[100]){e=[];for(g=0;g<a.records.length;g++)e.push({index:a.records[g].index,value:a.records[g].oldValue});d.setDefinedNames(e)}G.call(this,_$_af97[101],d,a)};h.undo=function(){if(0<=this.historyIndex)var a=this.history[this.historyIndex--];if(a){this.ignoreHistory=!0;var d=a.worksheet;d.openWorksheet();c.call(this,a);if(a.cascade&&a.cascade.length)for(var e=0;e<a.cascade.length;e++)c.call(this,a.cascade[e]);
a.selection&&d.updateSelectionFromCoords(a.selection);this.ignoreHistory=!1}};var b=function(a){var d=a.worksheet;if(a.action==_$_af97[78])d.insertRow(a.numOfRows,a.rowNumber,a.insertBefore,a.data);else if(a.action==_$_af97[79])d.deleteRow(a.rowNumber,a.numOfRows);else if(a.action==_$_af97[80])d.insertColumn(a.numOfColumns,a.columnNumber,a.insertBefore,a.properties,a.data);else if(a.action==_$_af97[81])d.deleteColumn(a.columnNumber,a.numOfColumns);else if(a.action==_$_af97[82])d.moveRow(a.oldValue,
a.newValue);else if(a.action==_$_af97[83])d.moveColumn(a.oldValue,a.newValue);else if(a.action==_$_af97[84])d.setMerge(a.newValue);else if(a.action==_$_af97[85])d.removeMerge(a.newValue);else if(a.action==_$_af97[86])d.setStyle(a.newValue,null,null,1);else if(a.action==_$_af97[87])d.resetStyle(a.cells);else if(a.action==_$_af97[88])d.setWidth(a.column,a.newValue);else if(a.action==_$_af97[89])d.setHeight(a.row,a.newValue);else if(a.action==_$_af97[90])d.setHeader(a.column,a.newValue);else if(a.action==
_$_af97[91]||a.action==_$_af97[92]||a.action==_$_af97[93])d[a.action](a.newValue);else if(a.action==_$_af97[94])d.orderBy(a.column,a.direction,a.newValue);else if(a.action==_$_af97[95]||a.action==_$_af97[96]||a.action==_$_af97[97])d[a.action](a.records);else a.action==_$_af97[98]?d.renameWorksheet(a.index,a.newValue):a.action==_$_af97[99]?d.moveWorksheet(a.f,a.t):a.action==_$_af97[100]&&d.setDefinedNames(a.records);G.call(this,_$_af97[102],d,a)};h.redo=function(){if(this.historyIndex<this.history.length-
1)var a=this.history[++this.historyIndex];if(a){this.ignoreHistory=!0;var d=a.worksheet;d.openWorksheet();b.call(this,a);if(a.cascade&&a.cascade.length)for(var e=0;e<a.cascade.length;e++)b.call(this,a.cascade[e]);a.selection&&d.updateSelectionFromCoords(a.selection);this.ignoreHistory=!1}};h.reset=function(){this.historyIndex=-1;this.history=[]};return h}(),ua=function(){var h=function(c){var b=null;if(Array.isArray(c))b=c;else if(typeof c==_$_af97[103]){b=[];var a=Object.keys(c);for(var d=0;d<a.length;d++)b.push({name:a[d],
plugin:c[a[d]],options:{}})}if(b&&b.length)for(d=0;d<b.length;d++){if(b[d].name&&b[d].plugin){var e=b[d].name;var g=b[d].plugin;var f=b[d].options}typeof g===_$_af97[104]&&(this.plugins[e]=g.call(u,this,f,this.config),typeof g.license==_$_af97[104]&&u.license&&g.license(u.license))}};h.execute=function(c,b){if(this.plugins){var a=Object.keys(this.plugins);if(a.length)for(var d=0;d<a.length;d++)if(typeof this.plugins[a[d]][c]==_$_af97[104]){var e=this.plugins[a[d]][c].apply(this.plugins[a[d]],b);e&&
(c==_$_af97[105]&&(b[4]=e),c==_$_af97[106]&&(b[0]=e))}return b}};h.onevent=function(c){return function(){var b,a,d=this.plugins;if(d){var e=Object.keys(d);if(e.length)for(a=0;a<e.length;a++)if(typeof d[e[a]][c]==_$_af97[104]){var g=d[e[a]][c].apply(d[e[a]],arguments);typeof g!==_$_af97[21]&&(b=g)}}return b}}(_$_af97[107]);return h}(),na=function(){var h=function(c){c.getEditor=h[_$_af97[58]];c.openEditor=h.open;c.closeEditor=h.close};h[_$_af97[58]]=function(c,b){c=Ka[_$_af97[58]].call(this,c,b);return[c.type&&
typeof c.type==_$_af97[103]?c.type:u.editors[c.type],c]};h.open=function(c,b,a){if(!P.call(this.parent,this))return!1;if(1!=c.classList.contains(_$_af97[26])){var d=parseInt(c.getAttribute(_$_af97[56])),e=parseInt(c.getAttribute(_$_af97[57]));if(!0===this.options.locked){var g=F.getColumnNameFromCoords(d,e);if(!this.options.cells||!this.options.cells[g]||!1!==this.options.cells[g].locked)return!1}if(g=this.records[e][d].merged)d-=g[0],e-=g[1],c=this.records[e][d].element;if(!Q.attached.call(this,
d,e)){if(this.results&&0<this.results.length)return console.error(_$_af97[108]),!1;var f=g=null;ia.attached.call(this,d)||(g=d);ca.attached.call(this,e)||(f=e);H[_$_af97[64]].call(this,f,g)}h.position.call(this,d,e);g=this.parent.input;if(113===a.keyCode||a.type!==_$_af97[109])g.selected=!0;g.innerText=_$_af97[3];G.call(this.parent,_$_af97[110],this,c,d,e);b=1==b?_$_af97[3]:O.call(this,d,e);f=h[_$_af97[58]].call(this,d,e);var k=!0;typeof f[0].openEditor==_$_af97[104]&&(!1===f[0].openEditor(c,b,d,
e,this,f[1],a)?k=!1:G.call(this.parent,_$_af97[111],this,c,d,e,g,f[1]));k&&(1==this.options.textOverflow&&(this.records[e][d].element.style.overflow=_$_af97[112],0<d&&this.records[e][d-1].element&&(this.records[e][d-1].element.style.overflow=_$_af97[112])),this.edition=c,g.classList.add(_$_af97[113]),1==this.parent.config.editorFormulas&&aa(b)&&(g.classList.add(_$_af97[114]),ra.parse.call(this,g),c=document.createTextNode(_$_af97[3]),g.appendChild(c),jSuites.focus(g)))}};h.close=function(c,b){null===
c&&(c=this.edition);this.parent.input.classList.contains(_$_af97[114])&&ra.close.call(this,this.parent.input);var a,d=parseInt(c.getAttribute(_$_af97[56])),e=parseInt(c.getAttribute(_$_af97[57]));1==this.options.textOverflow&&(a=this.records[e][d+1])&&a.element&&a.element.innerText==_$_af97[3]&&(this.records[e][d].element.style.overflow=_$_af97[3]);a=h[_$_af97[58]].call(this,d,e);if(1==b){var g=null;typeof a[0].closeEditor==_$_af97[104]&&(a=a[0].closeEditor(c,!0,d,e,this,a[1]),void 0!==a&&(g=a));
null!==g&&O.call(this,d,e)!=g&&this.setValue(c,g)}else a[0].closeEditor(c,!1,d,e,this,a[1]);G.call(this.parent,_$_af97[115],this,c,d,e,g,b);a=this.parent.input;a.selected=!1;a.onblur&&(a.onblur=null);a.children[0]&&a.children[0].onblur&&(a.children[0].onblur=null);a.update&&(a.update=null);na.build(this.parent);a.removeAttribute(_$_af97[116]);a.removeAttribute(_$_af97[117]);a.removeAttribute(_$_af97[118]);this.edition=a.mask=null;this.refreshBorders()};h.position=function(c,b){var a=null;if(a=this.records[b][c].element){var d=
this.parent.element.getBoundingClientRect();a=a.getBoundingClientRect();var e=this.parent.input;e.x=c;e.y=b;0==a.width&&0==a.height?e.style.opacity=_$_af97[119]:(e.setAttribute(_$_af97[120],_$_af97[3]),c=a.top-d.top+1,b=a.left-d.left+1,e.style.top=c+_$_af97[59],e.style.left=b+_$_af97[59],e.style.minWidth=a.width-1+_$_af97[59],e.style.minHeight=a.height-1+_$_af97[59],setTimeout(function(){e.focus()},0))}};h.build=function(c){c.input||(c.input=document.createElement(_$_af97[32]));c.input.className=
_$_af97[121];c.input.setAttribute(_$_af97[122],!0);c.input.innerText=_$_af97[3];c.input.oninput=function(b){u.current&&(1==u.current.parent.config.editorFormulas&&(aa(b.target.innerText)?(b.target.classList.add(_$_af97[114]),b.target.selected=!0):b.target.classList.contains(_$_af97[114])&&ra.close.call(u.current,this)),G.call(u.current.parent,_$_af97[123],u.current,b))};c.input.onclick=function(){this.selected=!0};return c.input};return h}(),G=function(h){var c;if(!this.ignoreEvents){if(typeof this.config.onevent==
_$_af97[104]){var b=this.config.onevent.apply(this,arguments);typeof b!==_$_af97[21]&&(c=b)}typeof this.config[h]==_$_af97[104]&&(b=this.config[h].apply(this,Array.prototype.slice.call(arguments,1)),typeof b!==_$_af97[21]&&(c=b));b=ua.onevent.apply(this,arguments);typeof b!==_$_af97[21]&&(c=b)}return c},xa=function(){var h=function(c){c.sequence=0;c.getNextSequence=h.next;c.getRowId=h.getId;c.setRowId=h.setId;c.getRowById=h.getRowById};h[_$_af97[58]]=function(){return this.sequence};h[_$_af97[11]]=
function(c,b){if(c>this.sequence||b)this.sequence=c};h.next=function(){return 1==this.options.sequence?++this.sequence:null};h.reset=function(){this.sequence=0};h.getId=function(c){if(this.rows[c]&&this.rows[c].id)return this.rows[c].id;var b=this.getPrimaryKey();if(!1!==b)return O.call(this,b,c)};h.setId=function(c,b){if(void 0!==b&&0<=parseInt(c)){var a={};a[c]=b}else a=c;c=Object.keys(a);if(c.length){for(var d=0;d<c.length;d++)b=a[c[d]],this.rows[c[d]].id=b,h[_$_af97[11]].call(this,b);L.call(this,
_$_af97[124],[a]);G.call(this.parent,_$_af97[125],this,a)}};h.getRowById=function(c,b){for(var a=0;a<this.rows.length;a++)if(h.getId.call(this,a)==c)return!0===b?this.rows[a]:this.options.data[a];return!1};return h}(),Ra=function(){var h=function(b){for(var a=[],d={},e=0;e<b.length;e++){var g=b[e].x,f=b[e].y,k=xa.getId.call(this,f);if(!k)if(d[f])k=d[f];else if(k=xa.next.call(this))d[f]=k;a[f]||(a[f]={id:k,row:f,data:{}});g=qa.call(this,g);a[f].data[g]=b[e].value}xa.setId.call(this,d);return a.filter(function(l){return null!=
l})},c=function(b){var a=b[0];if(0<=[_$_af97[126],_$_af97[127],_$_af97[124],_$_af97[128]].indexOf(a))return!1;var d={};a==_$_af97[95]||a==_$_af97[129]?(a=_$_af97[130],d[a]=h.call(this,b[1].data)):Array.isArray(b[1])&&1==b[1].length?d[a]=b[1][0]:d[a]=b[1];return d};return function(b,a,d,e){var g=this.parent,f=this,k=c.call(this,a);if(k)a=k;else if(!1===k)return!1;if(k=G.call(g,_$_af97[131],g,f,a))a=k;else if(!1===k)return!1;Oa.call(g,!0);jSuites.ajax({url:b,method:_$_af97[132],dataType:_$_af97[75],
data:{data:JSON.stringify(a)},queue:!0,beforeSend:function(l){d&&l.setRequestHeader(_$_af97[133],_$_af97[134]+d);G.call(g,_$_af97[135],f,l)},success:function(l){g.element.classList.contains(_$_af97[136])&&g.element.classList.remove(_$_af97[136]);l&&(l.message&&(l.name=g.config.application,jSuites.notification.isVisible()?console.log(l.name+_$_af97[137]+l.message):jSuites.notification(l)),l.success?typeof e===_$_af97[104]?e(l):l.data&&Array.isArray(l.data)&&Q.updateAll.call(f,l.data):l.error&&(alert(_$_af97[138]),
window.open(window.location.href,_$_af97[139])));G.call(g,_$_af97[140],g,f,a,l)},error:function(){g.element.classList.add(_$_af97[136])}})}}(),L=function(){return function(){ua.execute.call(this.parent,_$_af97[141],[this,arguments[0],arguments[1]]);if(!this.parent.ignorePersistence){var h=null;if(this.parent.config.server){var c=this.parent.worksheets.indexOf(this);h=this.parent.config.server;h=-1==h.indexOf(_$_af97[142])?h+(_$_af97[143]+c):h+(_$_af97[144]+c)}else this.options.persistence&&(h=typeof this.options.persistence==
_$_af97[25]?this.options.persistence:this.options.url);h&&Ra.call(this,h,arguments)}}}(),Ga=function(h){if(this.selectedCell){var c=this.selectedCell[0],b=this.selectedCell[1];this.records&&this.records[b]&&this.records[b][c]&&this.records[b][c].element||(this.selectedCell=this.getHighlighted(),c=this.selectedCell[0],b=this.selectedCell[1]);var a=this.getHighlighted(),d=a[0],e=a[1],g=a[2];a=a[3];var f=h?_$_af97[145]:_$_af97[146];this.records[b]&&this.records[b][c]&&this.records[b][c].element&&(this.records[b][c].element.classList[f](_$_af97[147]),
this.cursor=h?this.records[b][c].element:null);for(h=d;h<=g;h++)if(this.headers[h])this.headers[h].classList[f](_$_af97[148]);for(;e<=a;e++)if(this.rows[e]&&this.rows[e].element)this.rows[e].element.classList[f](_$_af97[148])}},ka=function(){var h=function(c){c.resetSelection=h.reset;c.updateSelection=h.fromElements;c.updateSelectionFromCoords=h[_$_af97[11]];c.selectAll=h.all;c.isSelected=h.isSelected;c.getHighlighted=h.getHighlighted;c.getRange=h.getRange};h.getHighlighted=function(){var c=this.borders;
return(c=c.main)?[c.x1,c.y1,c.x2,c.y2]:null};h.isSelected=function(c,b,a){if(!a&&(a=this.getHighlighted(),!a||null===a[0]))return!1;var d=a[0],e=a[1],g=a[2];a=a[3];g||(g=d);a||(a=e);return null==c?b>=e&&b<=a:null==b?c>=d&&c<=g:c>=d&&c<=g&&b>=e&&b<=a};h.reset=function(){if(this.selectedCell)c=1,this.edition&&na.close.call(this,this.edition,!0),this.resetBorders(_$_af97[149],!0),this.resetBorders(_$_af97[150],!0),this.selectedCell=null,1==c&&G.call(this.parent,_$_af97[151],this);else var c=0;return c};
h.refresh=function(){this.selectedCell&&h[_$_af97[11]].call(this,this.selectedCell)};h.isValid=function(c,b,a,d){if(!this)return!1;Array.isArray(c)&&(d=c[3],a=c[2],b=c[1],c=c[0]);return!(c>=this.options.columns.length||b>=this.rows.length||a>=this.options.columns.length||d>=this.rows.length)};h[_$_af97[11]]=function(c,b,a,d,e,g,f){g||(g=_$_af97[149]);Array.isArray(c)&&(d=c[3],a=c[2],b=c[1],c=c[0]);null==a&&(a=c);null==d&&(d=b);if(!h.isValid.call(this,c,b,a,d))return!1;if(null!=c){if(parseInt(c)<parseInt(a))var k=
parseInt(c),l=parseInt(a);else k=parseInt(a),l=parseInt(c);if(parseInt(b)<parseInt(d))var n=parseInt(b),q=parseInt(d);else n=parseInt(d),q=parseInt(b);var p;var v={};if(this.options.mergeCells){for(var w=n;w<=q;w++)for(var x=k;x<=l;x++)if(p=this.records[w][x].merged)p=F.getColumnNameFromCoords(x-p[0],w-p[1]),v[p]=!0;w=Object.keys(v);if(w.length)for(x=0;x<w.length;x++)p=F.getCoordsFromColumnName(w[x]),v=this.options.mergeCells[w[x]],p[0]<k&&(k=p[0]),p[0]+v[0]-1>l&&(l=p[0]+v[0]-1),p[1]<n&&(n=p[1]),
p[1]+v[1]-1>q&&(q=p[1]+v[1]-1)}}g==_$_af97[149]&&(this.selectedCell?(Ga.call(this,!1),p=1):p=0,this.selectedCell=[c,b,a,d],this.records[d][a].element&&e&&(x=e.target.getAttribute(_$_af97[56]),v=e.target.getAttribute(_$_af97[57]),null!==x&&null!==v&&(H.adjust.call(this,a,d,3),H.adjust.call(this,a,d,2),H.adjust.call(this,a,d,1),H.adjust.call(this,a,d,0))),na.position.call(this,c,b),0==p&&G.call(this.parent,_$_af97[152],this));da[_$_af97[11]].call(this,k,n,l,q,g,f);g==_$_af97[149]&&(G.call(this.parent,
_$_af97[153],this,k,n,l,q,e),ma.update.call(this.parent,this,this.selectedCell))};h.fromElements=function(c,b,a){var d=c.getAttribute(_$_af97[56]);c=c.getAttribute(_$_af97[57]);if(b){var e=b.getAttribute(_$_af97[56]);b=b.getAttribute(_$_af97[57])}else e=d,b=c;h[_$_af97[11]].call(this,d,c,e,b,a)};h.all=function(){h[_$_af97[11]].call(this,0,0,this.options.columns.length-1,this.records.length-1)};h.getRange=function(){var c=this.selectedCell;if(!c)return _$_af97[3];var b=F.getColumnNameFromCoords(c[0],
c[1]);c=F.getColumnNameFromCoords(c[2],c[3]);var a=this.options.worksheetName;a=-1!=a.indexOf(_$_af97[154])?_$_af97[155]+a+_$_af97[156]:a+_$_af97[19];return b==c?a+b:a+F.getRangeFromTokens(u.helpers.getTokensFromRange(b+_$_af97[157]+c))};return h}(),da=function(){var h=function(a){a.borders=[];a.setBorder=h[_$_af97[11]];a.getBorder=h[_$_af97[58]];a.resetBorders=h.reset;a.refreshBorders=h.refresh};h[_$_af97[58]]=function(a){return this.borders[a]};var c=function(a,d,e,g,f,k){if(!ka.isValid.call(this,
a,d,e,g))return!1;var l=!1,n=null,q=null,p=null,v=null,w=null,x=this.options.freezeColumns||0;f||(f=0);this.borders[f]?n=this.borders[f]:(n={},n.element=document.createElement(_$_af97[32]),n.element.classList.add(_$_af97[158]),f==_$_af97[150]||f==_$_af97[159]||f==_$_af97[149]?n.element.classList.add(_$_af97[160]+f):(k=k?k:jSuites.randomColor(!0),n.color=k,n.element.style.backgroundColor=k+_$_af97[161],n.element.style.borderColor=k),f==_$_af97[149]&&(k=function(I,r){n[I]=document.createElement(_$_af97[32]);
n[I].classList.add(_$_af97[162]);n[I].setAttribute(_$_af97[163],r);n.element.appendChild(n[I]);!1===_$_af97[164]in document.documentElement&&(n[I].style.display=_$_af97[52])},k(_$_af97[165],0),n.moveLeft.style.left=_$_af97[61],n.moveLeft.style.marginTop=_$_af97[166],n.moveLeft.style.marginLeft=_$_af97[166],k(_$_af97[167],1),n.moveTop.style.left=_$_af97[61],n.moveTop.style.marginTop=_$_af97[166],n.moveTop.style.marginLeft=_$_af97[166],k(_$_af97[168],2),n.moveRight.style.right=_$_af97[61],n.moveRight.style.marginTop=
_$_af97[166],n.moveRight.style.marginRight=_$_af97[166],k(_$_af97[169],3),n.moveDown.style.bottom=_$_af97[61],n.moveDown.style.marginLeft=_$_af97[166],n.moveDown.style.marginBottom=_$_af97[166]),this.content.appendChild(n.element));n.x1=a;n.y1=d;n.x2=e;n.y2=g;n.element.style.top=_$_af97[170];n.element.style.left=_$_af97[170];n.active=0;k=[];for(x=a;x<=e;x++)k.push(x);x=this.options.freezeColumns||0;k=this.options.freezeRows||0;var y=this.visibleRows[k],A=this.visibleRows[this.visibleRows.length-1],
z=this.visibleCols[x];a>this.visibleCols[this.visibleCols.length-1]||d>A||e<z&&a>=x||g<y&&d>=k?l=!0:(q=this.headers[a]&&this.headers[a].parentNode?this.headers[a].offsetLeft:0,this.headers[e]&&this.headers[e].parentNode?(ia.isVisible.call(this,e)||(e=Qa.call(this,e,null)),p=this.headers[e].offsetLeft):(p=this.thead.lastChild.lastChild.getAttribute(_$_af97[56]),p=x&&e<p?this.thead.lastChild.children[x].offsetLeft:this.thead.lastChild.lastChild.offsetLeft),p=p-q+parseInt(this.options.columns[e].width)-
1,q+=this.table.offsetLeft,v=this.rows[d].element&&this.rows[d].element.parentNode?this.rows[d].element.firstChild.offsetTop:0,this.rows[g].element&&this.rows[g].element.parentNode?(!1===this.rows[g].visible&&(g=Pa.call(this,null,g)),w=this.rows[g].element.firstChild.offsetTop+this.rows[g].element.firstChild.offsetHeight,n.element.style.borderBottomWidth=_$_af97[3]):(this.tbody.lastChild?(l=this.tbody.lastChild.getAttribute(_$_af97[57]),w=k&&g<l?this.tbody.children[k].offsetTop:this.tbody.lastChild.offsetTop+
this.tbody.lastChild.offsetHeight):w=0,l=!0,n.element.style.borderBottomWidth=_$_af97[61]),w=w-v-1,v+=this.table.offsetTop,this.options.freezeColumns&&(n.element.style.borderLeftWidth=_$_af97[3],n.element.style.borderRightWidth=_$_af97[3],x=ba.getWidth.call(this),a=a<this.options.freezeColumns,e=e<this.options.freezeColumns,a&&e||(a&&!e?(e=this.content.scrollLeft+x,e>q+p&&(p+=e-(q+p),n.element.style.borderRightWidth=_$_af97[61],l=!0)):(e=this.content.scrollLeft+x,e>q&&(e-=q,e>p?q=v=-2E3:(q=q+e+1,
p-=e,n.element.style.borderLeftWidth=_$_af97[61]))))),this.options.freezeRows&&(n.element.style.borderTopWidth=_$_af97[3],n.element.style.borderBottomWidth=_$_af97[3],x=ja.getHeight.call(this),a=d<k,e=g<k,a&&e||(a&&!e?(d=this.content.scrollTop+x,d>v+w&&(w+=d-(v+w),n.element.style.borderBottomWidth=_$_af97[61])):(d=this.content.scrollTop+x,d>v&&(e=d-v,e>w?q=v=-2E3:(v=v+e+1,w-=e,n.element.style.borderTopWidth=_$_af97[61]))))),n.element.style.top=v+_$_af97[59],n.element.style.left=q+_$_af97[59],n.element.style.width=
p+_$_af97[59],n.element.style.height=w+_$_af97[59],n.t=v,n.l=q,n.w=p,n.h=w,f==_$_af97[149]&&(n.moveLeft.style.top=n.h/2+_$_af97[59],n.moveRight.style.top=n.h/2+_$_af97[59],n.moveTop.style.left=n.w/2+_$_af97[59],n.moveDown.style.left=n.w/2+_$_af97[59]),n.active=1);f==_$_af97[149]&&(l?(this.corner.style.top=_$_af97[170],this.corner.style.left=_$_af97[170]):(this.corner.style.top=v+w-2+_$_af97[59],this.corner.style.left=q+p-2+_$_af97[59]));this.borders[f]=n},b=function(a,d){a.element.style.top=_$_af97[170];
a.element.style.left=_$_af97[170];a.active=0;d&&(a.x1=null,a.y1=null,a.x2=null,a.y2=null)};h[_$_af97[11]]=function(a,d,e,g,f,k){c.call(this,a,d,e,g,f,k);f==_$_af97[149]&&(Ga.call(this,!0),L.call(this,_$_af97[126],{x1:a,y1:d,x2:e,y2:g}))};h.reset=function(a,d){a&&a!=_$_af97[149]||(this.corner.style.top=_$_af97[170],this.corner.style.left=_$_af97[170],Ga.call(this,!1));if(a)this.borders[a]&&b(this.borders[a],d);else for(var e=Object.keys(this.borders),g=0;g<e.length;g++)b(this.borders[e[g]],d);a&&a!=
_$_af97[149]||L.call(this,_$_af97[127])};h.refresh=function(a){var d=this.borders;if(a)d[a]&&null!=d[a].x1&&c.call(this,d[a].x1,d[a].y1,d[a].x2,d[a].y2,a);else{a=Object.keys(d);for(var e=0;e<a.length;e++)d[a[e]]&&null!=d[a[e]].x1&&c.call(this,d[a[e]].x1,d[a[e]].y1,d[a[e]].x2,d[a[e]].y2,a[e])}this.edition&&(d=this.parent.input,na.position.call(this,d.x,d.y))};h.destroy=function(a){var d;this&&(d=this.borders[a])&&(d.element.remove(),delete this.borders[a])};return h}(),Wa=function(){var h=function(c){c.setGroup=
h[_$_af97[11]];c.unsetGroup=h.unset};h[_$_af97[11]]=function(c,b,a){0==c&&(a=document.createElement(_$_af97[171]),a.classList.add(_$_af97[172]),this.thead.insertBefore(a,this.thead.firstChild),c=document.createElement(_$_af97[173]),c.innerHTML=_$_af97[174],a.appendChild(c),c=document.createElement(_$_af97[173]),a.appendChild(c),b=this.headers[b])&&(b=b.querySelector(_$_af97[175]),b||(b=document.createElement(_$_af97[32]),b.classList.add(_$_af97[176]),b.innerText=_$_af97[177],c.appendChild(b)))};h.unset=
function(c,b){};return h}(),Ba=function(){var h={start:function(c){if(!P.call(this.parent,this))return!1;if(null!==c.target.getAttribute(_$_af97[57])){var b=c.target.getAttribute(_$_af97[57]);h.event={y:parseInt(b),h:c.target.offsetHeight,p:c.pageY}}else null!==c.target.getAttribute(_$_af97[56])&&(b=c.target.getAttribute(_$_af97[56]),h.event={x:parseInt(b),w:c.target.offsetWidth,p:c.pageX})},end:function(c){var b=[];if(null!=h.event.y){var a=parseInt(this.rows[h.event.y].element.offsetHeight);var d=
this.getSelectedRows(!0);c=d.indexOf(parseInt(h.event.y));if(d.length&&-1<c)for(var e=0;e<d.length;e++)b.push(parseInt(this.rows[d[e]].element.offsetHeight));else d=[];-1==c?(d.push(h.event.y),b.push(h.event.h)):b[c]=h.event.h;this.setHeight(d,a,b)}else if(null!=h.event.x){a=parseInt(this.colgroup[h.event.x].getAttribute(_$_af97[178]));d=this.getSelectedColumns();c=d.indexOf(parseInt(h.event.x));if(d.length&&-1<c)for(e=0;e<d.length;e++)b.push(parseInt(this.options.columns[d[e]].width));else d=[];
-1==c?(d.push(h.event.x),b.push(h.event.w)):b[c]=h.event.w;this.setWidth(d,a,b)}h.event=null},update:function(c){null!=h.event.y?(c=c.pageY-h.event.p,0<h.event.h+c&&(this.rows[h.event.y].element.style.height=h.event.h+c+_$_af97[59],this.refreshBorders())):null!=h.event.x&&(c=c.pageX-h.event.p,0<h.event.w+c&&(this.colgroup[h.event.x].setAttribute(_$_af97[178],h.event.w+c),this.options.columns[h.event.x].width=h.event.w+c),0<this.options.freezeColumns&&ba.refresh.call(this),this.refreshBorders())},
cancel:function(){h.end.call(this)}};return h}();(function(){var h={start:function(c){var b=this.parent.helper;c=parseInt(c.target.getAttribute(_$_af97[56]));if(this.merged.cols[c])console.error(_$_af97[179]);else{h.event={x:c,d:c};this.headers[c].classList.add(_$_af97[180]);for(var a=0;a<this.tbody.children.length;a++){var d=this.tbody.children[a].getAttribute(_$_af97[57]);this.records[d][c].element.classList.add(_$_af97[180])}a=this.parent.element.getBoundingClientRect();c=this.headers[c].getBoundingClientRect();
d=this.content.getBoundingClientRect();b.style.display=_$_af97[24];b.style.top=d.top-a.top+_$_af97[59];b.style.left=c.left-d.left+_$_af97[59];b.style.width=_$_af97[181];b.style.height=d.height+_$_af97[59];b.classList.add(_$_af97[182])}},end:function(){this.headers[h.event.x].classList.remove(_$_af97[180]);for(var c=0;c<this.tbody.children.length;c++){var b=this.tbody.children[c].getAttribute(_$_af97[57]);this.records[b][h.event.x].element.classList.remove(_$_af97[180])}null!=h.event.d&&h.event.x!=
h.event.d&&(this.moveColumn(h.event.x,h.event.d),this.refreshBorders());this.parent.helper.classList.remove(_$_af97[182]);this.parent.helper.style.display=_$_af97[3];h.event=null},cancel:function(){h.event.d=null;h.end.call(this)},update:function(c){var b=c.target.getAttribute(_$_af97[56]);if(null!=b)if(b=parseInt(b),this.merged.cols[b])console.error(_$_af97[179]);else{c=c.target.clientWidth/2>c.offsetX;h.event.d=c?h.event.x<b?parseInt(b)-1:parseInt(b):h.event.x>b?parseInt(b)+1:parseInt(b);b=this.headers[b].getBoundingClientRect();
var a=this.content.getBoundingClientRect();this.parent.helper.style.left=(c?b.left:b.right)-a.left+_$_af97[59]}}};return h})();var wa=function(){var h={start:function(c){if(P.call(this.parent,this)){this.resetSelection();var b=this.parent.helper;if(null!==c.target.getAttribute(_$_af97[57])){var a=parseInt(c.target.getAttribute(_$_af97[57]));this.merged.rows[a]?console.error(_$_af97[183]):this.results?console.error(_$_af97[184]):(h.event={y:a,d:a},this.rows[a].element.classList.add(_$_af97[180]),c=
this.parent.element.getBoundingClientRect(),a=this.rows[a].element.getBoundingClientRect(),b.style.display=_$_af97[24],b.style.top=a.top-c.top+_$_af97[59],b.style.left=_$_af97[185],b.style.width=this.content.offsetWidth-50+_$_af97[59],b.style.height=_$_af97[181],b.classList.add(_$_af97[186]))}else if(null!==c.target.getAttribute(_$_af97[56]))if(a=parseInt(c.target.getAttribute(_$_af97[56])),this.merged.cols[a])console.error(_$_af97[179]);else{h.event={x:a,d:a};this.headers[a].classList.add(_$_af97[180]);
for(c=0;c<this.tbody.children.length;c++){var d=this.tbody.children[c].getAttribute(_$_af97[57]);this.records[d][a].element.classList.add(_$_af97[180])}c=this.parent.element.getBoundingClientRect();a=this.headers[a].getBoundingClientRect();d=this.content.getBoundingClientRect();b.style.display=_$_af97[24];b.style.top=d.top-c.top+_$_af97[59];b.style.left=a.left-d.left+_$_af97[59];b.style.width=_$_af97[181];b.style.height=d.height+_$_af97[59];b.classList.add(_$_af97[182])}}else return!1},end:function(){if(null!=
h.event.y)this.rows[h.event.y].element.classList.remove(_$_af97[180]),null!=h.event.d&&h.event.y!=h.event.d&&(this.moveRow(h.event.y,h.event.d),this.updateSelectionFromCoords(0,h.event.d,this.options.columns.length-1,h.event.d)),this.parent.helper.classList.remove(_$_af97[186]);else if(null!=h.event.x){this.headers[h.event.x].classList.remove(_$_af97[180]);for(var c=0;c<this.tbody.children.length;c++){var b=this.tbody.children[c].getAttribute(_$_af97[57]);this.records[b][h.event.x].element.classList.remove(_$_af97[180])}null!=
h.event.d&&h.event.x!=h.event.d&&(this.moveColumn(h.event.x,h.event.d),this.refreshBorders());this.parent.helper.classList.remove(_$_af97[182])}this.parent.helper.style.display=_$_af97[3];h.event=null},cancel:function(){h.event.d=null;h.end.call(this)},update:function(c){if(null!=h.event.y){var b=c.target.getAttribute(_$_af97[57]);if(null!=b){var a=b=parseInt(b),d=c.target.clientHeight/2>c.offsetY;d?h.event.y<b&&(a=b-1):h.event.y>b&&(a=b+1);c=!1;this.merged.rows[a]&&(h.event.y>a?this.merged.rows[a-
1]&&(c=!0):this.merged.rows[a+1]&&(c=!0));c||(h.event.d=a,a=this.parent.element.getBoundingClientRect(),b=this.rows[b].element.getBoundingClientRect(),this.parent.helper.style.top=(d?b.top:b.bottom)-a.top+_$_af97[59])}}else d=c.target.getAttribute(_$_af97[56]),null!=d&&(a=d=parseInt(d),(b=c.target.clientWidth/2>c.offsetX)?h.event.x<d&&(a=d-1):h.event.x>d&&(a=d+1),c=!1,this.merged.cols[a]&&(h.event.x>a?this.merged.cols[a-1]&&(c=!0):this.merged.cols[a+1]&&(c=!0)),c||(h.event.d=a,a=this.headers[d].getBoundingClientRect(),
d=this.content.getBoundingClientRect(),this.parent.helper.style.left=(b?a.left:a.right)-d.left+_$_af97[59]))}};return h}(),sa=function(){var h=function(c){c.getMerge=h[_$_af97[58]];c.setMerge=h[_$_af97[11]];c.updateMerge=h.update;c.removeMerge=h.remove;c.destroyMerged=c.destroyMerge=h.destroy};h.isMerged=function(c,b){var a=F.getColumnNameFromCoords(c,b);if(a=this.merged.cells[a])if(i=this.options.mergeCells[a])m&&void 0!==m[a]||(i[1]>t&&(t=i[1]),m&&(m[a]=this.records[b][c].element&&!this.records[b][c].merged?
!0:!1))};h.getAffected=function(c){if(void 0!==this[c]){for(var b=c,a=this[c],d=[];this[b]==a;)d.push(b),b--;for(b=c+1;this[b]==a;)d.push(b),b++;d.sort(function(e,g){return e-g});return d}return!1};h[_$_af97[58]]=function(c){return c?this.options.mergeCells[c]:this.options.mergeCells};h[_$_af97[11]]=function(c,b,a){if(!P.call(this.parent,this))return!1;this.options.mergeCells||(this.options.mergeCells={});var d,e=null,g={},f={},k={},l=!1;typeof c==_$_af97[25]?k[c]=[b,a]:typeof c==_$_af97[103]?k=c:
((e=this.getHighlighted())?e=[F.getColumnNameFromCoords(e[0],e[1]),e[2]-e[0]+1,e[3]-e[1]+1]:(jSuites.notification({message:E(_$_af97[187])}),e=!1),e&&(k[e[0]]=[e[1],e[2]]));b=Object.keys(k);if(b.length){for(a=0;a<b.length;a++){var n=b[a],q=k[b[a]][0],p=k[b[a]][1];q=parseInt(q);p=parseInt(p);if((!q||2>q)&&(!p||2>p))console.log(E(_$_af97[188])+_$_af97[157]+n);else if(this.options.mergeCells[n])f[n]=[q,p],g[n]=this.options.mergeCells[n],h.update.call(this,n,q,p);else{e=F.getCoordsFromColumnName(n);for(var v=
e[1];v<e[1]+p;v++)for(var w=e[0];w<e[0]+q;w++)c=F.getColumnNameFromCoords(w,v),(d=this.merged.cells[c])&&this.options.mergeCells[d]&&(g[d]=this.options.mergeCells[d],h.applyDestroy.call(this,d));f[n]=this.options.mergeCells[n]=[q,p];h.applyCreate.call(this,n);Q.attached.call(this,e[0],e[1])||(l=e)}}Object.keys(f).length&&(l&&H[_$_af97[64]].call(this,e[1],e[0]),R.call(this.parent,{worksheet:this,action:_$_af97[84],newValue:f,oldValue:g}),L.call(this,_$_af97[84],[f]),h.build.call(this),ka.refresh.call(this),
da.refresh.call(this),G.call(this.parent,_$_af97[189],this,f,g))}};h.update=function(c,b,a){var d=this.options.mergeCells;if(d[c]){var e=d[c][1];if(b!==d[c][0]||e!==a)h.applyDestroy.call(this,c),b&&a&&(d[c]=[b,a],h.applyCreate.call(this,c));h.build.call(this)}};h.remove=function(c,b){if(!P.call(this.parent,this))return!1;b={};var a={},d={};typeof c==_$_af97[25]?d[c]=!0:typeof c==_$_af97[103]&&(d=c);c=Object.keys(d);for(d=0;d<c.length;d++)this.options.mergeCells[c[d]]&&(b[c[d]]=this.options.mergeCells[c[d]],
a[c[d]]=!0,h.applyDestroy.call(this,c[d],!0));h.build.call(this);R.call(this.parent,{worksheet:this,action:_$_af97[85],newValue:a,oldValue:b});L.call(this,_$_af97[85],{data:a})};h.destroy=function(){h.remove.call(this,this.options.mergeCells,!0)};h.applyCreate=function(c,b){var a=this.options.mergeCells;if(a[c]){var d=a[c][0]||1,e=a[c][1]||1;c=F.getCoordsFromColumnName(c);if(!this.records[c[1]][c[0]].merged||1==b)if(a=Q[_$_af97[58]].call(this,c[0],c[1])){a.classList.remove(_$_af97[66]);a.style.display=
_$_af97[3];1<d?a.setAttribute(_$_af97[190],d):a.removeAttribute(_$_af97[190]);1<e?a.setAttribute(_$_af97[191],e):a.removeAttribute(_$_af97[191]);1==this.options.textOverflow&&(a.style.overflow=_$_af97[112]);for(var g=0;g<e;g++)for(var f=0;f<d;f++){b=c[0]+f;var k=c[1]+g;if(a=this.records[k][b])if(a.merged=[f,g,a.v,d,e],0!=f||0!=g)a.element||Q[_$_af97[58]].call(this,b,k),a.element.classList.add(_$_af97[66]),a.merged[3]=a.element.innerText,a.element.innerText=_$_af97[3],O.call(this,b,k,_$_af97[3])}}}};
h.applyDestroy=function(c,b){var a=this.options.mergeCells;if(a[c]){var d=F.getCoordsFromColumnName(c),e=d[0];d=d[1];var g=a[c][0],f=a[c][1];delete this.options.mergeCells[c];for(c=0;c<f;c++)for(var k=0;k<g;k++)if(a=this.records[d+c][e+k])a.element&&(0==k&&0==c?(a.element.removeAttribute(_$_af97[190]),a.element.removeAttribute(_$_af97[191])):(a.element.classList.remove(_$_af97[66]),1==b&&(O.call(this,e+k,d+c,a.merged[2]),a.element.innerHTML=a.merged[3]))),a.merged&&delete a.merged}};h.updateConfig=
function(c,b,a,d){if(1==b)var e=[a];else{e=[];for(var g=a;g<a+d;g++)e.push(g)}var f=this.options.mergeCells,k=Object.keys(f),l={};for(g=0;g<k.length;g++){a=F.getCoordsFromColumnName(k[g]);for(var n=a[c];n<a[c]+f[k[g]][c];n++)-1!==e.indexOf(n)&&(l[k[g]]||(l[k[g]]=[f[k[g]][0],f[k[g]][1]],1==b&&(l[k[g]][c]+=d)),0==b&&l[k[g]][c]--)}k=Object.keys(l);for(g=0;g<k.length;g++)h.update.call(this,k[g],l[k[g]][0],l[k[g]][1]);h.build.call(this)};h.build=function(){var c=this.options.mergeCells;this.merged={cols:[],
rows:[],cells:[]};if(c)for(var b=Object.keys(c),a=0;a<b.length;a++){for(var d=F.getCoordsFromColumnName(b[a]),e=parseInt(c[b[a]][0]),g=parseInt(c[b[a]][1]),f=0;f<e;f++)this.merged.cols[d[0]+f]=!0;for(var k=0;k<g;k++)this.merged.rows[d[1]+k]=!0;for(k=0;k<g;k++)for(f=0;f<e;f++){var l=F.getColumnNameFromCoords(d[0]+f,d[1]+k);this.merged.cells[l]=b[a]}}};h.batch=function(c){var b=Object.keys(c);if(b.length)for(var a=0;a<b.length;a++)!1===c[b[a]]&&h.applyCreate.call(this,b[a])};return h}(),Da=function(){var h=
function(c){c.getHeader=h[_$_af97[58]];c.setHeader=h[_$_af97[11]];c.getHeaders=h.all};h[_$_af97[58]]=function(c){var b;if(b=this.options.columns)return b[c].title||F.getColumnName(c)};h.all=function(c){for(var b=[],a=0;a<this.options.columns.length;a++)b.push(h[_$_af97[58]].call(this,a));return c?b:b.join(this.options.csvDelimiter)};h[_$_af97[11]]=function(c,b){if(!P.call(this.parent,this))return!1;var a;if(a=this.options.columns[c]){var d=h[_$_af97[58]].call(this,c);if(void 0===b&&(b=prompt(E(_$_af97[192]),
d),!b))return!1;a.title=b;if(a=this.headers[c])b?(a.innerHTML=b,a.setAttribute(_$_af97[193],b)):(a.innerHTML=F.getColumnName(c),a.removeAttribute(_$_af97[193]));R.call(this.parent,{worksheet:this,action:_$_af97[90],column:c,oldValue:d,newValue:b});L.call(this,_$_af97[90],{column:c,title:b});G.call(this.parent,_$_af97[194],this,c,b,d)}};h.create=function(c){if(this.headers[c])return this.headers[c];var b=document.createElement(_$_af97[173]);b.classList.add(_$_af97[195]);b.setAttribute(_$_af97[56],
c);var a=document.createElement(_$_af97[196]);this.headers[c]=b;this.colgroup[c]=a;h.applyProperties.call(this,c);G.call(this.parent,_$_af97[197],this,c,b,this.options.columns[c]);return b};h.applyProperties=function(c){var b=this.options.columns[c],a=b.width||this.options.defaultColWidth,d=this.headers[c];b.align&&(d.style.textAlign=b.align);b.title?(d.innerText=b.title,d.setAttribute(_$_af97[193],b.title)):(d.innerText=F.getColumnName(c),d.removeAttribute(_$_af97[193]));b.tooltip&&(d.title=b.tooltip);
var e=this.options.filters;!0===b.filter&&(e=!0);!1===b.filter&&(e=!1);!0===e&&d.classList.add(_$_af97[198]);if(!1===b.visible||b.type==_$_af97[112])a=_$_af97[119],b.visible=!1;this.colgroup[c].setAttribute(_$_af97[178],a)};return h}(),fa=function(){var h=function(b,a,d){var e=this.footers.content,g;e&&e[a]&&e[a][b]&&(g=e[a][b].element)&&(void 0===d&&(e=this.options.footers,d=e[a]&&e[a][b]?e[a][b]:_$_af97[3]),aa(d)&&1==this.parent.config.parseFormulas&&(d=Z.execute.call(this,d,b,null,!1)),this.options.applyMaskOnFooters&&
(e=na[_$_af97[58]].call(this,b),d=u.editors.general.parseValue(b,a,d,this,e[1],g)),d instanceof Element||d instanceof HTMLDocument?(g.innerHTML=_$_af97[3],g.appendChild(d)):1==this.parent.config.stripHTML?g.innerText=d:g.innerHTML=d)},c=function(b){b.getFooter=c[_$_af97[58]];b.setFooter=c[_$_af97[11]];b.resetFooter=c.reset;b.refreshFooter=c.refresh;b.getFooterValue=c.value;b.setFooterValue=c.value};c[_$_af97[58]]=function(){return this.options.footers};c[_$_af97[11]]=function(b){if(b){var a=this.options.footers;
this.options.footers=b}this.options.footers!=a&&(fa.build.call(this),c.render.call(this),L.call(this,_$_af97[199],{data:this.options.footers}),G.call(this.parent,_$_af97[200],this,this.options.footers,a))};c.refresh=function(){var b=this.options.footers;if(b&&b.length)for(var a=0;a<b.length;a++)for(var d=0;d<b[a].length;d++)h.call(this,d,a,b[a][d])};c.value=function(b,a,d){if(void 0===d)return this.options.footers[a][b];h.call(this,b,a,d);L.call(this,_$_af97[201],{x:b,y:a,value:d});G.call(this.parent,
_$_af97[202],this,b,a,d)};c.reset=function(){var b=this.options.footers;this.options.footers=null;this.footers.content=null;this.tfoot.innerHTML=_$_af97[3];L.call(this,_$_af97[203],{});G.call(this.parent,_$_af97[200],this,null,b)};c.create=function(b,a){var d=this.footers.content[a][b];if(d&&d.element)return d.element;d=this.footers.content[a][b]={};var e=this.options.columns[b].align;d.element=document.createElement(_$_af97[173]);d.element.setAttribute(_$_af97[56],b);d.element.setAttribute(_$_af97[57],
a);e&&(d.element.style.textAlign=e);h.call(this,b,a);return d.element};c.build=function(){this.footers={element:this.tfoot,content:[]};if(this.options.footers){this.tfoot.innerHTML=_$_af97[3];for(var b=0;b<this.options.footers.length;b++){if(!this.footers.content[b]){this.footers.content[b]=[];var a=document.createElement(_$_af97[171]),d=document.createElement(_$_af97[173]);d.innerHTML=_$_af97[174];a.appendChild(d);this.footers.element.appendChild(a)}for(a=0;a<this.options.columns.length;a++)this.options.footers[b][a]||
(this.options.footers[b][a]=_$_af97[3]),this.footers.content[b][a]||(this.footers.content[b][a]={})}}};c.render=function(){for(var b=this.options.footers,a=0;a<b.length;a++)for(var d=0;d<b[a].length;d++){var e=fa.create.call(this,d,a);this.tfoot.children[a].appendChild(e)}};c.adjust=function(b,a,d){var e=[],g=this.options.footers,f=this.footers.content;if(g)if(1==d){if(this.headers[b]&&this.headers[b].parentNode)var k=this.headers[b]==this.thead.lastChild.lastChild?!0:!1,l=!0;for(d=0;d<g.length;d++){for(var n=
g[d].splice(b),q=b;q<b+a;q++)g[d][q]=_$_af97[3];g[d]=g[d].concat(n);n=f[d].splice(b);for(q=b;q<b+a;q++)f[d][q]={element:c.create.call(this,q,d)},l&&(1==k?this.tfoot.children[d].appendChild(f[d][q].element):this.tfoot.children[d].insertBefore(f[d][q].element,this.tfoot.children[d].children[b].nextSibling));f[d]=f[d].concat(n)}}else for(d=0;d<g.length;d++){for(q=b;q<b+a;q++)(k=this.footers.content[d][q].element)&&k.parentNode&&k.parentNode.removeChild(k);f[d].splice(b,a);e[d]=g[d].splice(b,a)}return e};
return c}(),ya=function(){var h=function(c){c.setNestedCell=h.cell;c.getNestedCell=h.cell;c.setNestedHeaders=h[_$_af97[11]];c.getNestedHeaders=h[_$_af97[58]];c.resetNestedHeaders=h.reset};h[_$_af97[58]]=function(){return this.options.nestedHeaders};h[_$_af97[11]]=function(c){h.reset.call(this);this.options.nestedHeaders=c;h.build.call(this);H.call(this,!0,!0);da.refresh.call(this);L.call(this,_$_af97[204],{data:c});G.call(this.parent,_$_af97[205],this,c)};h.reset=function(){var c=[],b=this.thead.children;
this.options.nestedHeaders=null;for(var a=0;a<b.length;a++)b[a].classList.contains(_$_af97[206])&&c.push(b[a]);if(c.length)for(;b=c.shift();)b.remove();this.nested=null;H.call(this,!0,!0);da.refresh.call(this);L.call(this,_$_af97[207]);G.call(this.parent,_$_af97[205],this,[])};h.cell=function(c,b,a){if(a){if(!P.call(this.parent,this))return!1;var d=this.options.nestedHeaders[b][c],e=this.nested.content[b][c].element;void 0!==a.title&&(e.innerText=a.title);void 0!==a.tooltip&&(e.title=a.tooltip);void 0!==
a.colspan&&(d.colspan=a.colspan,e.setAttribute(_$_af97[190],a.colspan),e.style.display=0==d.colspan?_$_af97[52]:_$_af97[3]);L.call(this,_$_af97[208],{x:c,y:b,properties:a});G.call(this.parent,_$_af97[209],this,c,b,a)}else return this.nested.content[b][c].element};h.range=function(c){c=this.options.nestedHeaders[c];for(var b=[],a=0,d=0;d<c.length;d++){var e=parseInt(c[d].colspan);b[d]=[a,a+e-1];a+=e}return b};h.getColumns=function(c){c=this.options.nestedHeaders[c];for(var b=[],a=0;a<c.length;a++)for(var d=
c[a].colspan,e=0;e<d;e++)b.push(a);return b};h.getAffected=function(c){var b=[],a=this.options.nestedHeaders;if(a){var d,e,g;for(e=0;e<a.length;e++)if((d=h.getColumns.call(this,e))&&void 0!==d[c]){var f=h.range.call(this,e);for(g=f[d[c]][0];g<=f[d[c]][1];g++)b.push(g)}}return b};h.create=function(c,b){if(this.nested.content[b][c])return this.nested.content[b][c].element;var a=this.options.nestedHeaders[b][c]||{},d=this.nested.content[b][c]={};a.colspan||(a.colspan=1);a.align||(a.align=_$_af97[210]);
a.title||(a.title=_$_af97[3]);var e=document.createElement(_$_af97[173]);e.setAttribute(_$_af97[211],c);e.setAttribute(_$_af97[212],b);e.setAttribute(_$_af97[190],a.colspan);e.setAttribute(_$_af97[213],a.align);e.innerHTML=a.title;a.tooltip&&(e.title=a.tooltip);return d.element=e};h.build=function(){this.nested||(this.nested={content:[]});var c,b,a=0;if(c=this.options.nestedHeaders){for(b=0;b<c.length;b++){this.nested.content[b]=[];var d=document.createElement(_$_af97[173]);d.innerHTML=_$_af97[174];
var e=document.createElement(_$_af97[171]);e.classList.add(_$_af97[206]);e.appendChild(d);this.thead.insertBefore(e,this.thead.lastChild)}for(b=0;b<this.thead.children.length;b++)this.thead.children[b].firstChild.style.top=a+_$_af97[59],a+=this.thead.children[b].offsetHeight}};h.adjust=function(c,b,a,d){var e=this.options.nestedHeaders;if(e)if(1==a)if(d&&d.nested)for(a=0;a<e.length;a++)for(var g=0;g<e[a].length;g++)h.cell.call(this,g,a,{colspan:d.nested[a][g]});else for(a=0;a<e.length;a++){if((g=
h.getColumns.call(this,a))&&e[a][g]){g=g[c];var f=parseInt(e[a][g].colspan)+b;h.cell.call(this,g,a,{colspan:f})}}else{d=[];for(a=0;a<e.length;a++)if(f=h.getColumns.call(this,a)){d[a]=[];for(g=0;g<b;g++){var k=f[c+g];void 0!==k&&(typeof d[a][k]==_$_af97[21]&&(d[a][k]=e[a][k].colspan),e[a][k].colspan--)}f=Object.keys(d[a]);for(g=0;g<f.length;g++)h.cell.call(this,f[g],a,{colspan:e[a][f[g]].colspan})}return d}};return h}(),ha=function(){var h=function(d,e,g){return aa(d)?Z.shiftFormula(d,e,g):d},c=function(d,
e,g){if(1===d.length){if(1<e||typeof u.formula.TREND!==_$_af97[104])g?d[0]--:d[0]++;return d}e=1;g=[];for(var f=[],k=0;k<d.length;k++)f.push(e++);for(k=0;k<d.length;k++)g.push(e++);return typeof u.formula.TREND==_$_af97[104]?u.formula.TREND(d,f,g):d},b=function(d,e,g,f){var k=null,l=[],n=null,q=[];for(k=0;k<d.length;k++){if(jSuites.isNumeric(d[k])&&(l.push(d[k]),jSuites.isNumeric(d[k+1])))continue;l.length?n=c(l,d.length,f):(f&&(e*=-1,g*=-1),n=h(d[k],e*d.length,g*d.length));Array.isArray(n)?(n.forEach(function(p){q.push(p)}),
l=[]):q.push(n)}return q},a=function(d,e){var g=function(w){var x;(x=this.results)?w=x.indexOf(w):x=this.rows;w--;for(var y=w;0<=y;y--)if(w=this.results?x[y]:y,this.rows[w]&&this.rows[w].element)return w;return 0},f=function(w){var x;(x=this.results)?w=x.indexOf(w):x=this.rows;w++;for(var y=w;y<x.length;y++)if(w=this.results?x[y]:y,this.rows[w]&&this.rows[w].element)return w;return x[x.length-1]},k=function(w,x){for(;0<=w;w--)if(this.records[x][w].element&&!this.records[x][w].element.classList.contains(_$_af97[66]))return w;
return 0},l=function(w,x){for(;w<this.options.columns.length;w++)if(this.records[x][w].element&&!this.records[x][w].element.classList.contains(_$_af97[66]))return w;return this.options.columns-1},n=this.getHighlighted(),q=n[0],p=n[1],v=n[2];n=n[3];d=parseInt(d);e=parseInt(e);null!=d&&null!=e&&(0<d-v?(l=l.call(this,parseInt(v)+1,e),d=parseInt(d)):(l=parseInt(d),d=k.call(this,parseInt(q)-1,e)),0<e-n?(f=f.call(this,parseInt(n)),e=parseInt(e)):(f=parseInt(e),e=g.call(this,parseInt(p))),d-l<e-f?(l=parseInt(q),
d=parseInt(v)):(f=parseInt(p),e=parseInt(n)),this.setBorder(l,f,d,e,_$_af97[159]))};a.execute=function(d){if(!P.call(this.parent,this))return!1;var e=this.getHighlighted(),g=Ha[_$_af97[58]].call(this,e,!1,!1),f=!0,k=!1,l=!1,n=this.borders.cloning;if(d)if(n&&n.active){d=n.x1;var q=n.y1,p=n.x2;n=n.y2;e[0]==d?(k=!0,e[1]>q&&(l=!0)):e[0]>d&&(l=!0)}else return!1;else if(n=this.getSelected(),n.length)for(k=!0,d=n[0].x,p=n[n.length-1].x,q=parseInt(n[n.length-1].y)+1,n=parseInt(n[n.length-1].y);1==f;){if(this.options.data[n+
1]){this.options.data[n+1][d-1]||this.options.data[n+1][p+1]||(f=!1);for(var v=d;v<=p;v++)this.options.data[n+1][v]&&(f=!1)}else f=!1;f&&n++}else return!1;var w=La.getFromSelection.call(this,e),x=v=0,y=0,A=0,z=[],I=[];if(k)for(f=function(){I.push({x:v,y:x,value:z[A],style:w[A][y]});A++;void 0==g[A]&&(A=0,z=b(z,0,1,l))},v=d;v<=p;v++){A=0;z=[];for(x=0;x<g.length;x++)z.push(g[x][y]);l&&z.reverse();z=b(z,0,1,l);if(l)for(x=n;x>=q;x--)f();else for(x=q;x<=n;x++)f();y++}else for(f=function(){I.push({x:v,
y:x,value:z[y],style:w[A][y]});y++;void 0==g[A][y]&&(y=0,z=b(z,1,0,l))},x=q;x<=n;x++){y=0;z=[];for(v=0;v<g[A].length;v++)z.push(g[A][v]);l&&z.reverse();z=b(z,1,0,l);if(l)for(v=p;v>=d;v--)f();else for(v=d;v<=p;v++)f();A++}I.length&&this.setValue(I);e[0]<d&&(d=e[0]);e[1]<q&&(q=e[1]);e[2]>p&&(p=e[2]);e[3]>n&&(n=e[3]);this.resetBorders(_$_af97[159],!0);this.updateSelectionFromCoords(d,q,p,n)};a.end=function(d){ha.event=!1;ha.execute.call(this,!0);ba.refresh.call(this)};a.cancel=function(d){ha.event=!1;
this.resetBorders(_$_af97[159],!0)};return a}(),Ha=function(){var h=function(c){c.getData=h[_$_af97[58]];c.getJson=h[_$_af97[58]];c.setData=h[_$_af97[11]];c.loadData=h.load;c.getRowData=h.getRowData;c.setRowData=h.setRowData;c.getColumnData=h.getColumnData;c.setColumnData=h.setColumnData;c.updateData=h.update;c.refresh=h.refresh;c.data=h[_$_af97[58]];c.download=h.download;c.copy=h.copy;c.paste=h.paste;c.cut=function(){return c.copy(!0)}};h[_$_af97[58]]=function(c,b,a,d){!0===c&&(c=this.getHighlighted());
var e=c?!0:!1,g=[],f=this.options.columns.length,k=this.options.data.length;void 0===d&&(d=this.dataType&&typeof a==_$_af97[21]?1:0);for(var l=0;l<k;l++){var n=null;var q=d?{}:[];for(var p=0;p<f;p++){var v;if(!(v=!e)){v=c[1];var w=c[2],x=c[3];v=p>=c[0]&&p<=w&&l>=v&&l<=x?!0:!1}if(v&&(!e||!this.results||-1!=this.results.indexOf(l))){v=O.call(this,p,l);if(b){if(e&&!1===this.rows[l].visible)continue;n=oa.processed.call(this,p,l);void 0!==n&&(v=n)}a&&v.match&&(v.match(a)||v.match(/\n/)||v.match(/"/))&&
(v=v.replace(new RegExp(_$_af97[20],_$_af97[14]),_$_af97[214]),v=_$_af97[20]+v+_$_af97[20]);d?jSuites.path.call(q,_$_af97[3]+qa.call(this,p),v):q.push(v);n=!0}}n&&(a?g.push(q.join(a)):g.push(q))}return a?g.join(_$_af97[10])+_$_af97[10]:g};h.parse=function(){for(var c,b={},a=0,d,e=[],g=this.options.data,f=0;f<g.length;f++)c=null,d=f,g[f].data&&(Array.isArray(g[f].data)||typeof g[f].data==_$_af97[103])&&(typeof g[f].id!==_$_af97[21]&&(c=parseInt(g[f].id)),typeof g[f].row!==_$_af97[21]&&(d=g[f].row),
e[d]=g[f].data,g[f]=[]),d>a&&(a=d),c&&(b[d]=c);if(Object.keys(e).length)for(f=0;f<=a;f++)e[f]&&(g[f]=e[f]);a=this.getPrimaryKey();if(!1!==a)for(a=qa.call(this,a),f=0;f<g.length;f++)b[f]||!1===a||(c=parseInt(g[f][a]),0<c&&(b[f]=c));return b};h.type=function(){for(var c=this.dataType=0;c<this.options.columns.length;c++)typeof this.options.columns[c].name!==_$_af97[21]&&(this.dataType=1)};h[_$_af97[11]]=function(c){c=h.standardize(c);var b={},a=[],d={};var e=Object.keys(c[0]).length-this.options.columns.length;
0<e&&this.insertRow(e);var g=c.length-this.options.data.length;0<g&&this.insertRow(g);for(var f=0;f<this.options.data.length;f++){void 0===c[f]&&(c[f]={row:f,data:[]});for(var k=0;k<this.options.columns.length;k++)c[f].data[k]||(c[f].data[k]=_$_af97[3])}for(k=0;k<this.options.columns.length;k++){var l=qa.call(this,k);d[l]=k}for(f=0;f<c.length;f++){g=c[f].row;l=Object.keys(c[f].data);for(k=0;k<l.length;k++)e=null,void 0!==d[l[k]]?e=d[l[k]]:-1<l[k]&&(e=parseInt(l[k])),null!==e&&a.push({x:e,y:g,value:c[f].data[l[k]]});
c[f].id&&(b[g]=c[f].id)}xa.setId.call(this,b);oa[_$_af97[11]].call(this,a,null,!0)};h.build=function(){this.results=null;this.rows=[];this.records=[];this.sequence=0;h.type.call(this);if(this.options.data){var c=h.parse.call(this),b=this.options.data.length;this.options.minDimensions[1]>b&&(b=this.options.minDimensions[1]);for(var a=0;a<b;a++){var d=c[a]?c[a]:null;ta.row.call(this,a,d)}}};h.load=function(c){this.resetBorders();this.resetSelection();this.tbody.innerText=_$_af97[3];this.options.data=
c;h.build.call(this);H.call(this,!0,!0);ea.update.call(this)};h.refresh=function(c){if(typeof c!==_$_af97[21])for(var b=0;b<this.options.columns.length;b++){var a=this.records[c]&&this.records[c][b].element?this.records[c][b].element:null,d=na[_$_af97[58]].call(this,b,c);typeof d[0].updateCell==_$_af97[104]&&d[0].updateCell(a,O.call(this,b,c),b,c,this,d[1]);a&&Q.applyOverflow.call(this,a,b,c)}else if(this.options.url){var e=this;1==this.parent.config.loadingSpin&&jSuites.loading.show();jSuites.ajax({url:this.options.url,
method:_$_af97[74],dataType:_$_af97[75],success:function(g){e.setData(g);jSuites.loading.hide()}})}};h.getRowData=function(c,b){if(typeof this.options.data[c]===_$_af97[21])return!1;if(b){if(this.dataType){b={};for(var a=0;a<this.options.columns.length;a++){var d=_$_af97[3]+qa.call(this,a),e=_$_af97[3]+oa.processed.call(this,a,c,!0);jSuites.path.call(b,d,e)}}else for(b=[],a=0;a<this.options.columns.length;a++)b.push(oa.processed.call(this,a,c,!0));return b}return JSON.parse(JSON.stringify(this.options.data[c]))};
h.setRowData=function(c,b,a){for(var d=[],e=0;e<this.options.columns.length;e++)typeof b[e]===_$_af97[21]&&(b[e]=_$_af97[3]),d.push({x:e,y:c,value:b[e]});d.length&&this.setValue(d,null,a)};h.getColumnData=function(c,b){if(typeof this.options.columns[c]===_$_af97[21])return!1;for(var a=[],d=0;d<this.options.data.length;d++){var e=b?oa.processed.call(this,c,d,!0):O.call(this,c,d);a.push(e)}return a};h.setColumnData=function(c,b,a){for(var d=[],e=0;e<this.rows.length;e++)typeof b[e]===_$_af97[21]&&(b[e]=
_$_af97[3]),d.push({x:c,y:e,value:b[e]});d.length&&this.setValue(d,null,a)};h.copy=function(c){var b=this,a=this.getHighlighted(),d=function(){b.setBorder(a[0],a[1],a[2],a[3],_$_af97[150]);b.borders.copying.clear=1==c?!0:!1},e=h[_$_af97[58]].call(this,a,!0,_$_af97[215]),g=G.call(this.parent,_$_af97[216],this,a,e);if(g)e=g;else if(!1===g)return!1;navigator.clipboard?navigator.clipboard.writeText(e).then(d):(this.parent.textarea.value=e,this.parent.textarea.select(),document.execCommand(_$_af97[217]),
d());return e};h.paste=function(c,b,a){if(!P.call(this.parent,this))return!1;var d=this,e=function(){d.borders.copying&&(d.resetBorders(_$_af97[150],!0),d.borders.copying.clear=!1)},g=null,f=this.options.style,k=null,l=null,n=[];if(this.borders.copying){var q=[this.borders.copying.x1,this.borders.copying.y1,this.borders.copying.x2,this.borders.copying.y2];k=q[0];l=q[1];var p=jSuites.hash(a),v=jSuites.hash(h[_$_af97[58]].call(this,q,!0,_$_af97[215]));if(p!=v)e();else{var w=0,x=0;a=h[_$_af97[58]].call(this,
q,!1,!1);for(p=q[1];p<=q[3];p++)if(!this.results||-1!=this.results.indexOf(p)){n[x]=[];w=0;for(v=q[0];v<=q[2];v++)g=F.getColumnNameFromCoords(v,p),n[x][w]=f&&f[g]?f[g]:_$_af97[218],w++;x++}}}c=parseInt(c);b=parseInt(b);if(a){Array.isArray(a)||(a=F.parseCSV(a,_$_af97[215]));if(p=G.call(this.parent,_$_af97[219],this,a,c,b,n))a=p;else if(!1===p)return!1;100<a.length&&!this.options.pagination&&!H.limited.call(this)&&console.log(_$_af97[220]);if(g=this.getHighlighted()){w=[];x=[];var y=[];f=[];var A=0,
z=0;for(p=g[1];p<=g[3];p++)if(!this.results||-1!=this.results.indexOf(p)){w=[];x=[];for(v=g[0];v<=g[2];v++)w.push(a[z][A]),n&&n[z]&&n[z][A]?x.push(n[z][A]):x.push(_$_af97[3]),A++,A>=a[0].length&&(A=0);y.push(w);f.push(x);z++;z>=a.length&&(z=0)}0==y.length%a.length&&0==y[0].length%a[0].length&&(a=y,n=f)}f=null;g=[];if(this.borders.copying&&!0===this.borders.copying.clear){for(p=q[1];p<=q[3];p++)for(v=q[0];v<=q[2];v++)(!this.results||this.results&&0<=this.results.indexOf(p))&&g.push({x:v,y:p,value:_$_af97[3],
style:_$_af97[3]});e()}p=c+a[0].length-this.options.columns.length;0<p&&this.insertColumn(p);p=b+a.length-this.rows.length;0<p&&this.insertRow(p);x=w=c;A=y=b;z=null;this.results&&(f=this.results.indexOf(b));for(p=0;p<a.length;p++)for(v=0;v<a[p].length;v++){null!==k&&null!==l&&a[p][v][0]==_$_af97[18]&&(a[p][v]=Z.shiftFormula(a[p][v],c-k,b-l));x=c+v;A=b+p;this.results&&(A=this.results[f+p]);var I={x,y:A,value:a[p][v]};n&&n[p]&&n[p][v]&&(I.style=n[p][v]);g.push(I);null===z&&ka.isSelected.call(this,x,
A,q)&&(z=!0)}z&&e();g.length&&(oa[_$_af97[11]].call(this,g,null,this.parent.config.forceUpdateOnPaste?!0:!1),G.call(this.parent,_$_af97[221],this,g),this.updateSelectionFromCoords(w,y,x,A))}};h.download=function(c,b){if(this.parent.config.allowExport)if(u.render)u.render(this.parent);else{void 0===b&&(b=!0);var a=_$_af97[3];if(1==c||1==this.parent.config.includeHeadersOnDownload)a+=this.getHeaders().replace(/\s+/gm,_$_af97[154])+_$_af97[10];a+=h[_$_af97[58]].call(this,null,b,this.options.csvDelimiter);
b=new Blob([_$_af97[223]+a],{type:_$_af97[224]});window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(b,this.options.csvFileName+_$_af97[225]):(c=document.createElement(_$_af97[226]),b=URL.createObjectURL(b),c.href=b,c.setAttribute(_$_af97[227],this.options.csvFileName+_$_af97[225]),document.body.appendChild(c),c.click(),c.parentNode.removeChild(c))}else console.error(_$_af97[222])};h.standardize=function(c){c||(c=[]);Array.isArray(c)||(c=[c]);void 0==c[0]||Array.isArray(c[0])||
typeof c[0]==_$_af97[103]||(c=[c]);for(var b=[],a=0;a<c.length;a++){var d={};Array.isArray(c[a])||void 0==c[a].data?d.data=c[a]:d=c[a];d.row=void 0==c[a].row?a:c[a].row;b[d.row]=d}for(a=0;a<b.length;a++)c[a]=b[a]||{row:a,data:[]};return c};return h}(),Xa=function(){var h=function(c){c.getLabel=h[_$_af97[58]];c.getLabelFromCoords=h[_$_af97[58]]};h[_$_af97[58]]=function(c,b,a){if(typeof c==_$_af97[25]){c=F.getCoordsFromColumnName(c);var d=c[0];b=c[1]}else d=c;return this.getProcessed(d,b,a)};return h}(),
Ia=function(){var h=function(c){c.getDefinedNames=h[_$_af97[58]];c.setDefinedNames=h[_$_af97[11]]};h[_$_af97[11]]=function(c){if(c.length)if(1!==this.parent.edition)console.log(_$_af97[228]);else{for(var b=this.parent.config.definedNames,a,d=[],e=0;e<c.length;e++){var g=c[e].index.toUpperCase();a=b[g]?b[g]:null;c[e].value?(c[e].value=S(c[e].value),this.parent.config.definedNames[g]=c[e].value):b[g]&&delete this.parent.config.definedNames[g];d.push({index:g,value:c[e].value,oldValue:a})}R.call(this.parent,
{worksheet:this,action:_$_af97[100],records:d});L.call(this,_$_af97[100],{data:d});G.call(this.parent,_$_af97[229],this,d)}};h[_$_af97[58]]=function(c){var b=this.parent.config.definedNames;return c?b[c]:b};h.updateAll=function(c,b){if(!this.parent.ignoreHistory){this.parent.historyCascade=!0;var a,d=this.getWorksheetName();if(a=this.parent.config.definedNames){var e=[],g=Object.keys(a);if(g.length){for(var f=0;f<g.length;f++){var k=Z.update.call(this,a[g[f]],c,b,d);k!==a[g[f]]&&(-1!==k.indexOf(_$_af97[230])&&
(k=null),e.push({index:g[f],value:k}))}e.length&&h[_$_af97[11]].call(this,e)}}this.parent.historyCascade=!1}};h.updateWorksheetName=function(c,b){if(!this.parent.ignoreHistory){this.parent.historyCascade=!0;var a;if(a=this.parent.config.definedNames){var d=[],e=Object.keys(a);if(e.length){for(var g=0;g<e.length;g++){var f=Z.updateWorksheetName(a[e[g]],c,b);f!==a[e[g]]&&d.push({index:e[g],value:f})}d.length&&h[_$_af97[11]].call(this,d)}}this.parent.historyCascade=!1}};h.build=function(){var c=Object.keys(this.config.definedNames);
if(c&&c.length)if(1!==this.edition)this.config.definedNames={},console.log(_$_af97[228]);else for(var b=0;b<c.length;b++){var a=(_$_af97[3]+c[b]).toUpperCase();this.config.definedNames[a]=S(this.config.definedNames[c[b]])}};return h}(),ra=function(){var h=[_$_af97[231],_$_af97[232],_$_af97[233],_$_af97[234],_$_af97[235]],c=[_$_af97[236],_$_af97[177],_$_af97[237],_$_af97[238],_$_af97[239],_$_af97[240],_$_af97[1],_$_af97[241],_$_af97[37],_$_af97[242],_$_af97[18],_$_af97[15],_$_af97[17],_$_af97[243]],
b=[],a=function(){if(0<b.length){for(var f,k=0;k<b.length;k++)f=-1===b[k].indexOf(_$_af97[19])?this:J(b[k].split(_$_af97[19])[0]),da.destroy.call(f,b[k]);b=[]}},d=function(f){a.call(this);for(var k=0,l=[],n,q,p,v=0;v<f.children.length;v++)if(n=f.children[v].getAttribute(_$_af97[244])){l[n]||(l[n]=h[k++],4<k&&(k=0));f.children[v].style.color=l[n];-1===n.indexOf(_$_af97[19])?(q=this,p=n):(q=n.split(_$_af97[19]),p=q[1],q=J(q[0]));if(0<=p.indexOf(_$_af97[157])){var w=p.split(_$_af97[157]);p=F.getCoordsFromColumnName(w[0]);
w=F.getCoordsFromColumnName(w[1])}else w=p=F.getCoordsFromColumnName(p);ka[_$_af97[11]].call(q,p[0],p[1],w[0],w[1],null,n,l[n]);b.push(n)}},e=function(f){this.worksheet&&(a.call(this.worksheet),typeof this.onchange==_$_af97[104]&&this.onchange.call(this,this.innerText,f),this.worksheet=null)},g=function(f,k){k&&typeof k!=_$_af97[104]||(k={type:_$_af97[245],onchange:k});k.type===_$_af97[245]?(f.classList.add(_$_af97[246]),f.addEventListener(_$_af97[247],function(l){l=l.changedTouches&&l.changedTouches[0]?
l.changedTouches[0].clientX:l.clientX;var n=this.getBoundingClientRect();24>n.width-(l-n.left)&&(g.current=f,f.classList.add(_$_af97[248]),f.classList.add(_$_af97[114]))})):(f.addEventListener(_$_af97[249],function(l){aa(f.innerText)&&(f.classList.add(_$_af97[114]),u.current&&setTimeout(function(){f.worksheet=u.current;g.parse.call(u.current,f);var n=document.createTextNode(_$_af97[3]);f.appendChild(n);jSuites.focus(f)}))}),f.addEventListener(_$_af97[250],function(l){aa(f.innerText)?f.classList.add(_$_af97[114]):
f.classList.contains(_$_af97[114])&&(f.classList.remove(_$_af97[114]),f.worksheet&&a.call(f.worksheet));l.preventDefault()}),f.addEventListener(_$_af97[109],function(l){27==l.which&&(f.innerText=_$_af97[3],e.call(f,!1))}));f.classList.add(_$_af97[251]);f.classList.add(_$_af97[250]);f.setAttribute(_$_af97[252],!0);f.addEventListener(_$_af97[253],function(l){e.call(f,!0)});f.val=function(l){if(void 0===l)return f.innerText;f.innerText=l};k.onchange&&(f.onchange=k.onchange);k.onupdate&&(f.onupdate=k.onupdate)};
g.current=null;g.parse=function(f){for(var k=_$_af97[3],l=_$_af97[3],n=window.getSelection(),q=document.createRange(),p=F.getCaretIndex.call(this.parent,f),v=Z.tokenize(f.innerText.replace(/(\r\n|\n|\r)/gm,_$_af97[3])),w=0;w<v.length;w++)v[w]&&Z.tokenIdentifier.test(v[w].trim())?(w==v.length-1&&(l=_$_af97[254]),k+=_$_af97[255]+l+_$_af97[256]+v[w].trim().replace(/\$/g,_$_af97[3])+_$_af97[257]+v[w]+_$_af97[258]):k+=v[w];f.innerHTML=k;k=null;for(w=0;w<f.childNodes.length&&!(k=f.childNodes[w],l=k.tagName?
k.innerText.length:k.length,0>=p-l);w++)p-=l;k&&(k.tagName?q.setStart(k.firstChild,p):(p>k.length&&(p=k.length),q.setStart(k,p)),n.removeAllRanges(),n.addRange(q));d.call(this,f)};g.close=function(f){a.call(this);f?f.classList.remove(_$_af97[114]):g.current&&(typeof g.current.onchange==_$_af97[104]&&g.current.onchange.call(g.current),g.current.classList.remove(_$_af97[248]),g.current.classList.remove(_$_af97[114]),g.current.worksheet=null,g.current=null)};g.getName=function(f,k,l,n,q){f=F.getColumnNameFromCoords(f,
k);l=F.getColumnNameFromCoords(l,n);q.ctrlKey&&(f=l);return f!==l?(q=f+_$_af97[157]+l,q=Z.getTokensFromRange.call(this,q),Z.getRangeFromTokens.call(this,q)):f};g.range=function(f,k,l,n,q){g.current.getAttribute(_$_af97[259])==_$_af97[260]&&(f=l,k=n);f=g.getName.call(this,f,k,l,n,q);k=document.createElement(_$_af97[261]);k.innerText=f;k.setAttribute(_$_af97[244],f);g.current.innerText=_$_af97[3];g.current.appendChild(k);d.call(this,g.current);jSuites.focus(k);q.preventDefault()};g.update=function(f,
k,l,n,q,p,v){p.getAttribute(_$_af97[259])==_$_af97[260]&&(f=l,k=n);var w=jSuites.getNode();if(w){var x=g.getName.call(this,f,k,l,n,q);this!==v&&(x=v.getWorksheetName()+_$_af97[19]+x);f=function(y){var A=document.createElement(_$_af97[261]);A.innerText=x;A.setAttribute(_$_af97[244],x);w.parentNode===p&&!1===y?w.parentNode.insertBefore(A,w.nextSibling):p.appendChild(A);w=A};if(w.getAttribute(_$_af97[244]))q.ctrlKey?(p.appendChild(document.createTextNode(_$_af97[37])),f(!0)):(w.innerText=x,w.setAttribute(_$_af97[244],
x));else{if(!w.innerText||w.innerText!==_$_af97[3]&&-1==c.indexOf(w.innerText.slice(-1))||w.nextElementSibling&&w.nextElementSibling.getAttribute(_$_af97[244]))return!1;f(!1)}jSuites.focus(w);d.call(this,p);q.preventDefault();typeof p.onupdate==_$_af97[104]&&p.onupdate.call(p,p.innerText);return!0}return!1};g.onkeydown=function(f){f.target.worksheet=this;if(f.ctrlKey){if(67==f.which||88==f.which)f=window.getSelection().toString().replace(/(\r\n|\n|\r)/gm,_$_af97[3]),navigator.clipboard?navigator.clipboard.writeText(f):
(this.parent.textarea.value=f,this.parent.textarea.select(),document.execCommand(_$_af97[217]))}else if(36==f.which){var k=window.getSelection(),l=document.createRange();l.setStart(f.target,0);k.removeAllRanges();k.addRange(l)}else 35==f.which?jSuites.focus(f.target):187==f.which?!f.target.innerText.replace(/(\r\n|\n|\r)/gm,_$_af97[3])&&f.target.getAttribute(_$_af97[116])&&f.target.removeAttribute(_$_af97[116]):13==f.which&&f.target.blur()};g.palette=function(f){h=f};return g}(),Z=function(){var h=
new RegExp(/^(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]+)(:\$?[A-Z]+\$?[0-9]+)?$/i),c=function(f){f=S(f);for(var k=_$_af97[3],l=[],n=0,q=0;q<f.length;q++){if(f[q]==_$_af97[20]||f[q]==_$_af97[155])n=0==n?1:0;var p;if(p=0==n)p=f[q],(p=p==_$_af97[236]||p==_$_af97[177]||p==_$_af97[237]||p==_$_af97[238]||p==_$_af97[239]||p==_$_af97[12])||(p=f[q],p=p==_$_af97[240]||p==_$_af97[262]||p==_$_af97[1]||p==_$_af97[2]||p==_$_af97[241]||p==_$_af97[263]||p==_$_af97[37]||p==_$_af97[242]||p==_$_af97[18]||p==_$_af97[15]||
p==_$_af97[17]||p==_$_af97[243]);p?(k&&(l.push(k),k=_$_af97[3]),l.push(f[q])):k+=f[q]}k&&l.push(k);for(q=0;q<l.length;q++)0==n&&(l[q]=l[q].trim());return l},b=function(f){f.setFormula=b[_$_af97[11]];f.updateFormula=b.update;f.executeFormula=b.execute;f.resetArray=b.resetArray;f.formula=[]};b.run=function(f,k){var l=_$_af97[3],n=Object.keys(k);if(n.length){for(var q={},p=0;p<n.length;p++){var v=n[p].replace(/!/g,_$_af97[39]);0<v.indexOf(_$_af97[39])&&(v=v.split(_$_af97[39]),q[v[0]]=!0)}v=Object.keys(q);
for(p=0;p<v.length;p++)l+=_$_af97[264]+v[p]+_$_af97[265];for(p=0;p<n.length;p++)v=n[p].replace(/!/g,_$_af97[39]),null===k[n[p]]||jSuites.isNumeric(k[n[p]])||(q=k[n[p]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&q.length&&(k[n[p]]=d(q,k[n[p]])),l=0<v.indexOf(_$_af97[39])?l+(v+_$_af97[266]+k[n[p]]+_$_af97[267]):l+(_$_af97[264]+v+_$_af97[266]+k[n[p]]+_$_af97[267])}f=f.replace(/\$/g,_$_af97[3]);(q=f.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&
q.length&&(f=d(q,f));f=f.replace(/!/g,_$_af97[39]);f=(new Function(l+_$_af97[268]+f))();null===f&&(f=0);return f};b[_$_af97[11]]=function(){};var a=function(f){f=S(f,!0);return f.replace(/\$/g,_$_af97[3])},d=function(f,k){for(var l=0;l<f.length;l++){var n=b.getTokensFromRange.call(this,f[l]);k=k.replace(f[l],_$_af97[241]+n.join(_$_af97[37])+_$_af97[263])}return k},e=function(f,k,l){var n=this.config.definedNames;if(n&&0<Object.keys(n).length){for(var q=0;q<f.length;q++)f[q]&&n&&n[f[q]]&&(k=k.replace(f[q],
n[f[q]]),l&&(l[f[q]]=n[f[q]]));return a(k)}return k};b.resetArray=function(f,k){var l;if(l=this.records[k][f].a){for(var n=0;n<l.length;n++)for(var q=0;q<l[n].length;q++)this.options.data[k+n][f+q]||(this.records[k+n][f+q].v=_$_af97[3],this.records[k+n][f+q].element&&(this.records[k+n][f+q].element.innerText=_$_af97[3]));this.records[k][f].a=null}};b.execute=function(f,k,l,n,q){if(1==this.parent.processing)return null!==k&&null!==l&&this.parent.queue.push([this,k,l]),_$_af97[3];if(typeof this.parent.config.onbeforeformula==
_$_af97[104]){var p=G.call(this.parent,_$_af97[269],this,f,k,l);if(!1===p)return f;p&&(f=p)}var v=[],w=function(B,D,M,T){if(void 0!=D&&void 0!=M){var U=F.getColumnNameFromCoords(D,M);D=T.getWorksheetName()+_$_af97[39]+U;v[D]||(v[D]=0);v[D]++;if(3<v[D])throw{error:_$_af97[270],message:_$_af97[271],reference:D};}else D=U=null;q||(B=a(B));var K=B,X=K.match(/[A-Z_]+[A-Z0-9_\.]*/g);X&&X.length&&(K=e.call(T.parent,X,K,x));(X=K.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&X.length&&
(K=d.call(T,X,K));X=[];K=c(K);for(var Y=0;Y<K.length;Y++)K[Y]&&h.test(K[Y])&&X.push(K[Y]);if(X){if(D&&-1<X.indexOf(D.replace(_$_af97[39],_$_af97[19])))throw{error:_$_af97[272],message:_$_af97[273]};for(K=0;K<X.length;K++){D=X[K].split(_$_af97[19]);D[1]?(M=D[1],Y=J(D[0]),D=T.getWorksheetName()+_$_af97[39]+U):(M=D[0],Y=T,D=U);if(typeof Y==_$_af97[21]||typeof Y.formula==_$_af97[21])throw{error:_$_af97[274],message:_$_af97[275]};D&&(Y.formula[M]||(Y.formula[M]=[]),0>Y.formula[M].indexOf(D)&&Y.formula[M].push(D));
if(!x[X[K]]){M=F.getCoordsFromColumnName(M);D=M[0];M=M[1];var V=Y.records[M]&&void 0!==Y.records[M][D].v?Y.records[M][D].v:O.call(Y,D,M);x[X[K]]||(aa(V)?x[X[K]]=w(V,D,M,Y):(V===_$_af97[3]||null===V||void 0===V?V=null:jSuites.isNumeric(V)||(V=_$_af97[20]+V+_$_af97[20]),x[X[K]]=V))}}}return B.substr(1)},x={};try{f=w(f,k,l,this);if(f==_$_af97[3])return _$_af97[3];0==f.indexOf(_$_af97[276])&&(q=!0);var y=q?b.run(f,x):u.formula(f,x,k,l,this);if(!1!==n&&void 0!=k&&void 0!=l)if(y instanceof Date)this.records[l][k].v=
jSuites.calendar.dateToNum(y);else if(Array.isArray(y)){n=[];p=null;for(var A=0;A<y.length;A++)for(var z=0;z<y[A].length;z++){(0<z||0<A)&&this.options.data[l+A][k+z]!==_$_af97[3]&&(p=_$_af97[277]);var I=F.getColumnNameFromCoords(k+z,l+A);n.push(I)}if(!p){I=F.getColumnNameFromCoords(k,l);var r=Object.keys(this.formula);for(A=0;A<r.length;A++){var C=this.formula[r[A]].indexOf(I);if(0<=C)for(z=0;z<n.length;z++)C=this.formula[r[A]].indexOf(n[z]),-1==C&&this.formula[r[A]].push(n[z])}for(A=0;A<y.length;A++)for(z=
0;z<y[A].length;z++)this.records[l+A][k+z].v=y[A][z],this.records[l+A][k+z].element&&(this.records[l+A][k+z].element.innerText=y[A][z],jSuites.isNumeric(y[A][z])?this.records[l+A][k+z].element.classList.add(_$_af97[278]):this.records[l+A][k+z].element.classList.remove(_$_af97[278]));this.records[l][k].a=y;p=y[0][0];this.records[l][k].v=p}y=p}else this.records[l][k].v=y;return y}catch(B){return 1==this.parent.config.debugFormulas&&console.log(f,x,B),B&&B.error?B.error:_$_af97[274]}};b.update=function(f,
k,l,n){var q=null,p=null,v=this.getWorksheetName(),w=function(I){l&&l[I]&&(I=_$_af97[230]);k[I]&&(I=k[I]);return I},x=function(I,r){r=r.split(_$_af97[279]);if(3===r.length){r=_$_af97[279];var C=_$_af97[279]}else r[0]===_$_af97[3]?(r=_$_af97[279],C=_$_af97[3]):(r=_$_af97[3],C=_$_af97[279]);return r+I.match(/[A-Z]+/g)+C+I.match(/[0-9]+/g)};f=S(f,!0);f=c(f);for(var y=0;y<f.length;y++)if(f[y]&&h.test(f[y])){if(-1==f[y].indexOf(_$_af97[19])){if(p=f[y],q=_$_af97[3],n&&n!=v)continue}else if(p=f[y].split(_$_af97[19]),
q=p[0],p=p[1],n&&n!=q)continue;var A=p;if(0<=p.indexOf(_$_af97[157])){p=b.getTokensFromRange.call(this,p);for(var z=0;z<p.length;z++)p[z]=w(p[z]);p=b.getRangeFromTokens.call(this,p);p!==_$_af97[230]&&-1!==A.indexOf(_$_af97[279])&&(A=A.split(_$_af97[157]),p=p.split(_$_af97[157]),p=x(p[0],A[0])+_$_af97[157]+x(p[1],A[1]))}else-1!==A.indexOf(_$_af97[279])?(p=w(p.replace(/\$/g,_$_af97[3])),p=x(p,A)):p=w(p);q&&(p=q+_$_af97[19]+p);f[y]=p}return f.join(_$_af97[3])};b.getChain=function(f){if(void 0===f)return[];
var k=[],l=[],n=[],q=function(w){if(0<=w.indexOf(_$_af97[39])){var x=w.split(_$_af97[39]),y=x.pop(),A=x.join(_$_af97[39]);x=J(A)}else x=this,A=x.getWorksheetName(),y=w;if(x.formula[y]&&!n[w]){var z=!1;n[w]=!0;for(w=0;w<x.formula[y].length;w++){var I=x.formula[y][w];-1==I.indexOf(_$_af97[39])&&(I=A+_$_af97[39]+I);if(!l[I]){var r=x.getValue(I);aa(r)?k.push([I,r,b.getTokens.call(x,r,A)]):(z=!0,x.formula[y][w]=null);q.call(x,I);l[I]=!0}}1==z&&(x.formula[y]=x.formula[y].filter(function(C){return null!=
C}))}},p=Object.keys(f);for(f=0;f<p.length;f++)q.call(this,p[f]);p=0;for(f=k.length-1;0<=f;f--){for(var v=0;v<f;v++)if(0<=k[v][2].indexOf(k[f][0])){k.splice(v,0,k.splice(f,1)[0]);f=k.length;break}p++;if(1E6<p){console.error(_$_af97[280]);break}}l=[];for(f=0;f<k.length;f++)l[k[f][0]]=k[f][1];return l};b.updateAll=function(f,k){var l,n,q,p,v,w={},x=this.getWorksheetName();for(v=0;v<u.spreadsheet.length;v++){var y=u.spreadsheet[v].worksheets;for(q=0;q<y.length;q++){var A=y[q].getWorksheetName();for(n=
0;n<y[q].options.data.length;n++)for(l=0;l<y[q].options.data[n].length;l++)if((p=y[q].options.data[n][l])&&aa(p)){var z=b.update.call(y[q],p,f,k,x);z!=p&&(w[A]||(w[A]=[]),w[A].push({x:l,y:n,value:z,force:!0}))}}}y=Object.keys(w);for(l=0;l<y.length;l++)if(w[y[l]].length){q=J(y[l]);for(n=0;n<w[y[l]].length;n++)O.call(q,w[y[l]][n].x,w[y[l]][n].y,w[y[l]][n].value);L.call(q,_$_af97[129],{data:w[y[l]]})}w=[];l=Object.keys(this.formula);y=[];n=[];for(q=0;q<l.length;q++)if(z=l[q],p=this.formula[z],k&&k[z])for(v=
0;v<p.length;v++)f[p[v]]&&(p[v]=f[p[v]]),n[p[v]]=!0;else{A=[];for(v=0;v<p.length;v++)k&&k[p[v]]||(f[p[v]]&&(p[v]=f[p[v]]),n[p[v]]=!0,A.push(p[v]));A.length&&(f[z]&&(z=f[z]),y[z]=A)}this.formula=y;A=this.getWorksheetName();for(var I=0;I<u.spreadsheet.length;I++)for(var r=u.spreadsheet[I].worksheets,C=0;C<r.length;C++)if(r[C].getWorksheetName()!==A)for(l=Object.keys(r[C].formula),q=0;q<l.length;q++){y=[];p=r[C].formula[l[q]];for(v=0;v<p.length;v++)z=p[v].split(_$_af97[39]),z[0]==A&&z[1]?k&&k[z[1]]||
(f[z[1]]&&(z[1]=f[z[1]]),y.push(z[0]+_$_af97[39]+z[1])):y.push(p[v]);r[C].formula[l[q]]=y}y=Object.keys(n);for(l=0;l<y.length;l++)z=y[l].split(_$_af97[39]),z[1]?(p=z[1],f=J(z[0]),k=z[0]):(p=z[0],f=this,k=x),z=F.getCoordsFromColumnName(p),n=z[0],q=z[1],p=f.options.data[q][n],z=Z.execute.call(f,p,n,q,!1),z!==f.records[q][n].v&&(w[k]||(w[k]=[]),w[k].push({x:n,y:q,value:p,force:!0}));y=Object.keys(w);if(y.length)for(l=0;l<y.length;l++)q=J(y[l]),w[y[l]]=oa.applyValues.call(q,w[y[l]]),oa.setValueChained.call(q,
w[y[l]])};b.updateWorksheetName=function(f,k,l){for(var n=c(f),q=0;q<n.length;q++)f=n[q].split(_$_af97[19]),f[1]&&(f[0]=f[0].replace(new RegExp(_$_af97[155],_$_af97[14]),_$_af97[3]),f[0].toUpperCase()==k.toUpperCase()&&(f[0]=l,0<=f[0].indexOf(_$_af97[154])&&(f[0]=_$_af97[155]+f[0]+_$_af97[155]),n[q]=f.join(_$_af97[19])));return n.join(_$_af97[3])};b.updateWorksheetNames=function(f,k){var l,n;for(n=0;n<u.spreadsheet.length;n++){var q=u.spreadsheet[n].worksheets;for(var p=0;p<q.length;p++){var v=[];
for(var w=0;w<q[p].options.data.length;w++)for(var x=0;x<q[p].options.data[w].length;x++)if((l=q[p].options.data[w][x])&&aa(l)){var y=b.updateWorksheetName(l,f,k);y!=l&&(v.push({x,y:w,value:y,force:!0}),O.call(q[p],x,w,y))}v.length&&L.call(q[p],_$_af97[129],{data:v})}}};var g=function(f,k,l){var n=_$_af97[3],q=_$_af97[3],p=f.split(_$_af97[279]);if(3===p.length)return f;2===p.length&&(p[0]?(l=0,q=_$_af97[279]):(k=0,n=_$_af97[279]),f=p.join(_$_af97[3]));f=F.getCoordsFromColumnName(f);k=f[0]+k;f=f[1]+
l;return f=0>k||0>f?_$_af97[230]:n+F.getColumnName(k)+q+(f+1)};b.shiftFormula=function(f,k,l){f=c(f,!0);for(var n,q,p=0;p<f.length;p++)h.test(f[p])&&(q=-1==f[p].indexOf(_$_af97[19])?[_$_af97[3],f[p]]:f[p].split(_$_af97[19]),-1==q[1].indexOf(_$_af97[157])?q[1]=g(q[1],k,l):(n=q[1].split(_$_af97[157]),q[1]=g(n[0],k,l)+_$_af97[157]+g(n[1],k,l)),f[p]=q[0]?q.join(_$_af97[19]):q[1]);return f.join(_$_af97[3])};b.getTokensFromRange=function(f){var k=this,l=_$_af97[3],n=_$_af97[3];0<=f.indexOf(_$_af97[19])?
n=_$_af97[19]:0<=f.indexOf(_$_af97[39])&&(n=_$_af97[39]);f=f.replace(/\$/g,_$_af97[3]);n&&(l=f.split(n),f=l.pop(),l=l.join(_$_af97[39]),k=J(l),l+=n);if(-1==f.indexOf(_$_af97[157]))return[l+f];n=[];f=f.split(_$_af97[157]);var q=F.getCoordsFromColumnName(f[0]),p=F.getCoordsFromColumnName(f[1]);if(q[0]<=p[0]){f=q[0];var v=p[0]}else f=p[0],v=q[0];if(null===q[1]&&null==p[1]){var w=0;q=0;k.options&&k.options.data&&(q=k.options.data.length-1)}else q[1]<=p[1]?(w=q[1],q=p[1]):(w=p[1],q=q[1]);for(k=w;k<=q;k++)for(w=
f;w<=v;w++)n.push(l+F.getColumnNameFromCoords(w,k));return n};b.getRangeFromTokens=function(f){f=f.filter(function(n){return n!=_$_af97[230]});for(var k=_$_af97[3],l=0;l<f.length;l++)0<=f[l].indexOf(_$_af97[19])?(k=f[l].split(_$_af97[19]),f[l]=k.pop(),k=k[0]+_$_af97[19]):0<=f[l].indexOf(_$_af97[39])&&(k=f[l].split(_$_af97[39]),f[l]=k.pop(),k=k.join(_$_af97[39])+_$_af97[39]);f.sort(function(n,q){n=F.getCoordsFromColumnName(n);q=F.getCoordsFromColumnName(q);return n[1]>q[1]?1:n[1]<q[1]?-1:n[0]>q[0]?
1:n[0]<q[0]?-1:0});return f.length?k+(f[0]+_$_af97[157]+f[f.length-1]):_$_af97[230]};b.getTokens=function(f,k){var l=a(f);f.replace(/!/g,_$_af97[39]);(f=l.match(/[A-Z_]+[A-Z0-9_\.]*/g))&&f.length&&(l=e.call(this.parent,f,l));(f=l.match(/('.*?'?|\w*\.)?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&f.length&&(l=d.call(this,f,l));if(f=l.match(/('.*?'?|\w*\.)?(\$?[A-Z]+\$?[0-9]+)(:\$?[A-Z]+\$?[0-9]+)?/g))for(l=0;l<f.length;l++)-1==f[l].indexOf(_$_af97[39])&&k&&(f[l]=k+_$_af97[39]+f[l]);return f};b.tokenIdentifier=
h;b.tokenize=c;return b}(),oa=function(){var h=function(c){c.name=qa;c.value=O;c.getValue=h[_$_af97[58]];c.getValueFromCoords=h.getFromCoords;c.setValue=h[_$_af97[11]];c.setValueFromCoords=h.setFromCoords;c.setCheckRadioValue=h.setCheckRadio;c.getProcessed=h.processed};h[_$_af97[58]]=function(c,b){var a=this;if(typeof c==_$_af97[103]){var d=c.x;c=c.y}else 0<=c.indexOf(_$_af97[39])&&(a=c.split(_$_af97[39]),c=a.pop(),a=J(a.join(_$_af97[39]))),c=F.getCoordsFromColumnName(c),d=c[0],c=c[1];return h.getFromCoords.call(a,
d,c,b)};h.getFromCoords=function(c,b,a){var d=null;null!=c&&null!=b&&(d=a?h.processed.call(this,c,b):O.call(this,c,b));return d};h[_$_af97[11]]=function(c,b,a){if(!P.call(this.parent,this))return!1;var d=null,e=null,g=null,f=[];a=a?!0:!1;var k=function(q,p){var v=null;typeof q==_$_af97[25]?(g=F.getCoordsFromColumnName(q),d=g[0],e=g[1]):q.tagName?(d=q.getAttribute(_$_af97[56]),e=q.getAttribute(_$_af97[57])):q.element&&q.element.tagName?(d=q.element.getAttribute(_$_af97[56]),e=q.element.getAttribute(_$_af97[57])):
(d=q.x,e=q.y,void 0!==q.value&&(p=q.value),void 0!==q.style&&(v=q.style));q={x:d,y:e,value:p,force:a};null!==v&&(q.style=v);f.push(q)};if(c&&Array.isArray(c))for(var l=0;l<c.length;l++)k(c[l],b);else if(typeof c==_$_af97[103]&&void 0==c.x&&void 0==c.tagName)for(b=Object.keys(c),l=0;l<b.length;l++)k(b[l],c[b[l]]);else k(c,b);if(f.length){f=h.applyValues.call(this,f);this.parent.config.parseFormulas&&h.setValueChained.call(this,f);this.refreshBorders();var n=this;setTimeout(function(){da.refresh.call(n)},
250);if(f.length){R.call(this.parent,{worksheet:n,action:_$_af97[95],records:f,selection:this.selectedCell});c=this.getPrimaryKey();if(!1!==c)for(l=0;l<f.length;l++)f[l].x===c&&f[l].value&&W.call(this,f[l]);L.call(this,_$_af97[95],{data:f});ea.update.call(this,!0);G.call(this.parent,_$_af97[281],this,f)}}};h.setFromCoords=function(c,b,a,d){var e=[];e.push({x:c,y:b,value:a});h[_$_af97[11]].call(this,e,null,d)};h.setCheckRadio=function(){for(var c=[],b=this.getSelected(),a=0;a<b.length;a++){var d=b[a].x,
e=b[a].y;if(!this.options.columns[d].readOnly&&this.options.columns[d].type==_$_af97[282]){var g=O.call(this,d,e)?!1:!0;c.push({x:d,y:e,value:g})}}c.length&&h[_$_af97[11]].call(this,c)};h.applyValues=function(c){for(var b,a,d=this.options.style||{},e=[],g={},f=0;f<c.length;f++)if(b=c[f],a=this.updateCell(b.x,b.y,b.value,b.force),void 0!==a.value){if(void 0!==b.style){var k=F.getColumnNameFromCoords(b.x,b.y);a.style=g[k]=b.style;a.oldStyle=d&&d[k]?d[k]:_$_af97[218]}e.push(a)}0<Object.keys(g).length&&
La.update.call(this,g);return e};h.processed=function(c,b,a){var d=O.call(this,c,b);if(null===d)return null;var e=na[_$_af97[58]].call(this,c,b),g=e[1];g.type!=_$_af97[112]&&g.type!=_$_af97[283]&&g.type!=_$_af97[284]&&g.type!=_$_af97[285]&&g.type!=_$_af97[286]&&0!=g.process&&(!0===a||g.type!=_$_af97[287]&&g.type!=_$_af97[288]&&g.type!=_$_af97[289])&&(g.type==_$_af97[282]?d=e[0][_$_af97[58]](g,d,a):this.records[b][c].element?d=1==this.parent.config.stripHTML?this.records[b][c].element.innerText:this.records[b][c].element.innerHTML:
((_$_af97[3]+d).substr(0,1)==_$_af97[18]&&(d=this.executeFormula(d,c,b,!1)),e[0]&&typeof e[0][_$_af97[58]]==_$_af97[104]&&(d=e[0][_$_af97[58]](g,d,a))));return d};h.setValueChained=function(c){for(var b,a=[],d,e=0;e<c.length;e++)b=c[e],d=F.getColumnNameFromCoords(b.x,b.y),a[d]=b.value;a=Z.getChain.call(this,a);var g=[],f=Object.keys(a);for(e=0;e<f.length;e++)0<=f[e].indexOf(_$_af97[39])?(b=f[e].split(_$_af97[39]),d=b.pop(),b=J(b.join(_$_af97[39]))):(d=f[e],b=this),d=F.getCoordsFromColumnName(d),c=
Q.update.call(b,d[0],d[1],a[f[e]],!0),c.w=b,c.value=c.v=b.records[d[1]][d[0]].v,c.cell=f[e],c.f=a[f[e]],g.push(c);g.length&&G.call(this.parent,_$_af97[290],this,g)};return h}(),Q=function(){var h=function(c){c.getCell=h[_$_af97[58]];c.getCellFromCoords=h[_$_af97[58]];c.updateCell=h.update;c.updateCells=h.updateAll;c.getSelected=h.selected;c.isAttached=h.attached};h.attached=function(c,b){return this.records[b]&&this.records[b][c]&&this.records[b][c].element&&this.records[b][c].element.parentNode&&
this.records[b][c].element.parentNode.parentNode?!0:!1};h[_$_af97[58]]=function(c,b){typeof c==_$_af97[25]&&(b=F.getCoordsFromColumnName(c),c=b[0],b=b[1]);c=parseInt(c);b=parseInt(b);if(this.records[b]&&this.records[b][c]&&this.records[b][c].element)return this.records[b][c].element;var a=O.call(this,c,b);null===a&&(a=_$_af97[3]);return Q.create.call(this,c,b,a)};h.getFromCoords=function(c,b,a){if(!c||null===c[0])return null;var d=[],e=c[0],g=c[1],f=c[2];c=c[3];for(a&&(a=this.results?F.invert(this.results):
null);g<=c;g++)for(var k=e;k<=f;k++)if(!a||a[g])b?d.push(F.getColumnNameFromCoords(k,g)):d.push(this.records[g][k]);return d};h.selected=function(c,b){return h.getFromCoords.call(this,this.getHighlighted(),c,b)};h.getSelectedColumns=function(){var c=[],b=this.getHighlighted();if(b)for(var a=b[0];a<=b[2];a++)c.push(a);return c};h.updateAll=function(c){for(var b=this.getPrimaryKey(),a=[],d=0;d<c.length;d++)void 0!==c[d].id?(W.call(this,c[d]),a.push({id:c[d].id,y:c[d].y}),!1!==b&&h.update.call(this,
b,c[d].y,c[d].id,!0)):a.push(h.update.call(this,c[d].x,c[d].y,c[d].value,c[d].force));L.call(this,_$_af97[128],[a])};h.update=function(c,b,a,d){var e=this.records[b];if(e=e&&e[c]?e[c]:null){e=e.element;var g={x:c,y:b};if(d||!e||1!=e.classList.contains(_$_af97[26])){if(d=G.call(this.parent,_$_af97[291],this,e,c,b,a))a=d;else if(!1===d)return g;d=na[_$_af97[58]].call(this,c,b);if(typeof d[0].updateCell==_$_af97[104]){var f=d[0].updateCell(e,a,c,b,this,d[1]);void 0!==f&&(a=f)}f=O.call(this,c,b);if(f!==
a){var k=O.call(this,c,b,a);g.oldValue=f;g.value=k;e&&h.applyOverflow.call(this,e,c,b);d[1]&&typeof d[1].render==_$_af97[104]&&d[1].render(e,a,c,b,this,d[1]);G.call(this.parent,_$_af97[292],this,e,c,b,g.value,g.oldValue)}}}else return!1;return g};h.create=function(c,b,a){var d=document.createElement(_$_af97[173]);d.setAttribute(_$_af97[56],c);d.setAttribute(_$_af97[57],b);var e=na[_$_af97[58]].call(this,c,b);if(e[0]&&typeof e[0].createCell==_$_af97[104]){var g=e[0].createCell(d,a,c,b,this,e[1]);void 0!==
g&&(a=g)}O.call(this,c,b,a);this.records[b][c]||ta.cell.call(this,c,b,a);this.records[b][c].element=d;!a&&this.records[b][c].v&&(d.innerText=this.records[b][c].v);e[1]&&typeof e[1].render==_$_af97[104]&&e[1].render(d,a,c,b,this,e[1]);h.applyProperties.call(this,d,c,b);h.applyOverflow.call(this,d,c,b);G.call(this.parent,_$_af97[293],this,d,c,b,a);return d};h.getAttributes=function(c,b,a){a[c]||(a[c]={});c==_$_af97[294]?a[c][b]=this.getValue(b):c==_$_af97[295]?this.merged.cells&&(b=this.merged.cells[b])&&
(a[c][b]=this.options.mergeCells[b]):this.options[c]&&this.options[c][b]&&(a[c][b]=this.options[c][b])};h.setAttributes=function(c){c&&c.style&&this.setStyle(c.style);c&&c.comments&&this.setComments(c.comments);c&&c.meta&&this.setMeta(c.meta);c&&c.cells&&this.setProperty(c.cells);c&&c.mergeCells&&this.setMerge(c.mergeCells);c&&c.values&&h.batch.call(this,c.values);c&&c.formulas&&h.batch.call(this,c.formulas,!0)};h.applyProperties=function(c,b,a){var d=F.getColumnNameFromCoords(b,a),e=this.options.columns,
g=this.options.style,f=this.options.comments,k=this.options.cells,l=this.options.rows,n=null,q=!1;e[b]&&(e[b].readonly||e[b].readOnly)&&(q=!0);l&&l[a]&&(l[a].readonly||l[a].readOnly)&&(q=!0);if(g&&g[d]){var p=(p=c.getAttribute(_$_af97[120]))?p+(_$_af97[243]+g[d]):g[d];c.setAttribute(_$_af97[120],p)}f&&f[d]&&(typeof f[d]===_$_af97[25]?c.setAttribute(_$_af97[296],f[d]):c.classList.add(_$_af97[297]));if(k&&k[d])if(!1===k[d].locked&&!0===this.options.selectUnLockedCells?c.classList.add(_$_af97[298]):
c.classList.remove(_$_af97[298]),k[d].zebra?c.classList.add(_$_af97[299]):c.classList.remove(_$_af97[299]),typeof k[d].wrap!==_$_af97[21]&&((n=k[d].wrap)?c.classList.add(_$_af97[300]):c.classList.remove(_$_af97[300])),!0===k[d].readonly||!0===k[d].readOnly)q=!0;else if(!1===k[d].readonly||!1===k[d].readOnly)q=!1;null===n&&(e&&e.wrap?c.classList.add(_$_af97[300]):c.classList.remove(_$_af97[300]));c.style.textAlign||(g=null,k&&k[d]&&k[d].align?g=k[d].align:e.align&&(g=e.align),g&&(c.style.textAlign=
g));q?c.classList.add(_$_af97[26]):c.classList.remove(_$_af97[26]);this.records[a][b].readonly=q};h.applyOverflow=function(c,b,a){1==this.options.textOverflow&&0<b&&(b==this.options.columns.length-1&&(c.style.overflow=_$_af97[112]),this.records[a][b-1]&&this.records[a][b-1].element&&(this.records[a][b-1].element.style.overflow=this.options.data[a][b]==_$_af97[3]&&this.headers[b-1]&&this.headers[b-1].offsetWidth?_$_af97[3]:_$_af97[112]))};h.batch=function(c,b){var a=[],d=Object.keys(c);if(d.length)for(var e=
0;e<d.length;e++){if(0<=d[e].indexOf(_$_af97[39])){var g=d[e].split(_$_af97[39]);var f=J(g[0]);var k=g[1];g=g[0]}else f=this,k=d[e],g=this.getWorksheetName();k=F.getCoordsFromColumnName(k);k=f.updateCell(k[0],k[1],c[d[e]],!0);a[g]||(a[g]=[]);a[g].push(k)}if(1==b&&(d=Object.keys(a),d.length))for(e=0;e<d.length;e++)f=J(d[e]),L.call(f,_$_af97[129],a[d[e]])};return h}(),Ka=function(){var h=function(b){b.getColumnOptions=h[_$_af97[58]];b.setColumnOptions=h[_$_af97[11]];b.getCells=h.getCells;b.setCells=
h.setCells;b.getProperties=h[_$_af97[58]];b.setProperties=h[_$_af97[11]];b.getProperty=h[_$_af97[58]];b.setProperty=h[_$_af97[11]];b.resetProperty=h[_$_af97[11]];b.updateProperty=h.update;b.getOptions=h[_$_af97[58]]};h.getCells=function(b){return b?this.options.cells[b]:this.options.cells};h.setCells=function(b,a){if(!P.call(this.parent,this))return!1;if(typeof b==_$_af97[25])this.options.cells[b]=a;else{a=Object.keys(b);for(var d=0;d<a.length;d++)this.options.cells[a[d]]=b[a[d]]}};h[_$_af97[58]]=
function(b,a){var d=null;void 0!==a&&(a=F.getColumnNameFromCoords(b,a),this.options.cells.hasOwnProperty(a)&&(d=this.options.cells[a]));d||(d=this.options.columns[b]);if(!d)d={type:_$_af97[71]};else if(!d.type||typeof d.type==_$_af97[25]&&!u.editors[d.type])d.type=_$_af97[71];return d};var c=function(b,a,d,e,g){var f=this.records[a][b].element;f&&(e&&typeof e.destroyCell==_$_af97[104]&&e.destroyCell(f,b,a,this),d&&typeof d.createCell==_$_af97[104]&&(e=O.call(this,b,a),e=d.createCell(f,e,b,a,this,
g),void 0!==e&&O.call(this,b,a,e),Q.applyProperties.call(this,f,b,a)))};h[_$_af97[11]]=function(b,a,d){if(!P.call(this.parent,this))return!1;this.edition&&this.closeEditor(this.edition,!1);var e=[];if(Array.isArray(b))e=b;else if(jSuites.isNumeric(b)&&jSuites.isNumeric(a))b={x:b,y:a},typeof d==_$_af97[103]&&(b.value=d),e.push(b);else if(typeof a===_$_af97[103])b={x:b,value:a},e.push(b);else if(typeof b==_$_af97[103]&&void 0===a)for(a=Object.keys(b),d=0;d<a.length;d++){var g=F.getCoordsFromColumnName(a[d]);
e.push({x:g[0],y:g[1],value:b[a[d]]})}if(Array.isArray(e))for(d=0;d<e.length;d++){var f=e[d];b=f.x;var k=f.y,l=h[_$_af97[58]].call(this,b,k);a=f.value;g=u.editors[l.type];var n=null;a&&a.type&&(n=u.editors[a.type]);if(typeof k===_$_af97[21])for(f.oldValue=l,parseInt(a.width)||(a.width=this.options.defaultColWidth||100),a.type&&u.editors[a.type]||(a.type=_$_af97[71]),this.options.columns[b]=a,Da.applyProperties.call(this,b),f=0;f<this.records.length;f++)c.call(this,b,f,n,g,a);else l=F.getColumnNameFromCoords(b,
k),f.oldValue=this.options.cells&&this.options.cells[l]?this.options.cells[l]:_$_af97[3],a?(this.options.cells||(this.options.cells={}),this.options.cells[l]=a):(delete this.options.cells[l],a=h[_$_af97[58]].call(this,b,k),n=u.editors[a.type]),c.call(this,b,k,n,g,a)}else return console.error(_$_af97[280]),!1;this.refreshBorders();R.call(this.parent,{worksheet:this,action:_$_af97[96],records:e});L.call(this,_$_af97[96],{data:e});G.call(this.parent,_$_af97[301],this,e);return!0};h.update=function(b,
a,d,e){a=typeof b==_$_af97[25]||typeof b==_$_af97[22]?[{x:b,y:a,value:d}]:b;d=JSON.parse(JSON.stringify(a));if(Array.isArray(a))for(var g=0;g<a.length;g++){var f=a[g].x,k=a[g].y,l=a[g],n=e,q=F.getColumnNameFromCoords(f,k);(b=this.options.cells[q])?l.oldValue=Object.assign({},b):(l.oldValue=null,b=this.options.cells[q]=Object.assign({},this.options.columns[f]));q=Object.keys(l.value);for(var p=0;p<q.length;p++)b[q[p]]=l.value[q[p]];n||typeof k===_$_af97[21]||(n=h[_$_af97[58]].call(this,f,k),n=u.editors[n.type],
l.value.type?(l=l.value,q=null,l&&l.type&&(q=u.editors[l.type]),c.call(this,f,k,q,n,b)):(l=this.records[k][f].element)&&typeof n.updateCell==_$_af97[104]&&(q=O.call(this,f,k),q=n.updateCell(l,q,f,k,this,b),void 0!==q&&O.call(this,f,k,q),Q.applyProperties.call(this,l,f,k)))}R.call(this.parent,{worksheet:this,action:_$_af97[97],records:a});L.call(this,_$_af97[97],{data:d});G.call(this.parent,_$_af97[301],this,a)};return h}(),ca=function(){var h=function(b,a){Array.isArray(a)||(a=[a]);for(var d,e=b?
_$_af97[3]:_$_af97[52],g=Object.keys(a),f=0;f<g.length;f++)if(d=this.rows[a[g[f]]])d.element&&(d.element.style.display=e),d.visible=b;H.call(this,!0);this.resetBorders()},c=function(b){b.getRow=c[_$_af97[58]];b.moveRow=c.move;b.insertRow=c.add;b.deleteRow=c.del;b.getSelectedRows=c.selected;b.showRow=h.bind(b,!0);b.hideRow=h.bind(b,!1)};c.height=function(b){var a=0,d=this.rows,e=this.options.rows||{};d[b]&&!1!==d[b].visible&&(a=e[b]&&e[b].height?parseInt(e[b].height):d[b].element&&d[b].element.offsetHeight?
d[b].element.offsetHeight:d[b].height?parseInt(d[b].height):this.options.defaultRowHeight||u.defaultRowHeight||24);return a};c[_$_af97[58]]=function(b){return this.rows[b]};c.attached=function(b){return this.rows[b]&&this.rows[b].element&&this.rows[b].element.parentNode?!0:!1};c.selected=function(b){var a=[],d=this.getHighlighted();if(d)for(var e=d[1];e<=d[3];e++)this.rows[e]&&(b?a.push(e):a.push(this.rows[e].element));return a};c.create=function(b,a){if(this.rows[b]&&this.rows[b].element)return this.rows[b].element;
this.rows[b]||ta.row.call(this,b);var d=document.createElement(_$_af97[171]);d.setAttribute(_$_af97[57],b);this.rows[b].element=d;var e=null;this.options.rows[b]&&!a&&(this.options.rows[b].style&&d.setAttribute(_$_af97[120],this.options.rows[b].style),this.options.rows[b].height&&(d.style.height=parseInt(this.options.rows[b].height)+_$_af97[59]),this.options.rows[b].title&&(e=this.options.rows[b].title),0==this.options.rows[b].visible&&(this.rows[b].visible=!1),this.options.rows[b].id&&(this.rows[b].id=
this.options.rows[b].id));0==this.rows[b].visible&&(d.style.display=_$_af97[52]);e||(e=parseInt(b+1));a=document.createElement(_$_af97[173]);a.innerHTML=e;a.setAttribute(_$_af97[57],b);a.className=_$_af97[302];d.appendChild(a);G.call(this.parent,_$_af97[303],this,b,d);return d};c.move=function(b,a){if(!P.call(this.parent,this))return!1;b=parseInt(b);a=parseInt(a);if(!this.rows[a]||!this.rows[b])return console.error(_$_af97[304]),!1;if(0<Object.keys(this.getMerge()).length){var d=null;this.merged.rows[b]?
d=!0:this.merged.rows[a]&&(b>a?this.merged.rows[a-1]&&(d=!0):this.merged.rows[a+1]&&(d=!0));d&&this.destroyMerged()}this.resetBorders();ca.attached.call(this,a)?(d=ca.create.call(this,b),b>a?this.tbody.insertBefore(d,this.rows[a].element):this.tbody.insertBefore(d,this.rows[a].element.nextSibling)):ca.attached.call(this,b)&&this.tbody.removeChild(this.rows[b].element);this.rows.splice(a,0,this.rows.splice(b,1)[0]);this.records.splice(a,0,this.records.splice(b,1)[0]);this.options.data.splice(a,0,this.options.data.splice(b,
1)[0]);L.call(this,_$_af97[82],{f:b,t:a});R.call(this.parent,{worksheet:this,action:_$_af97[82],oldValue:b,newValue:a});ea.references.call(this);H.call(this,!0,!0);ea.update.call(this);G.call(this.parent,_$_af97[305],this,b,a)};c.add=function(b,a,d,e,g){if(!P.call(this.parent,this))return!1;if(!this.options.allowInsertRow)return console.error(_$_af97[306]),!1;var f=[];if(0<b)var k=parseInt(b);else k=1,Array.isArray(b)&&!e&&(Array.isArray(b[0])?e=b:(e=[],e.push(b)));e=Ha.standardize(e);d=d?!0:!1;b=
this.options.data?this.options.data.length-1:0;if(void 0==a||a>b||0>a)a=b,d=!1;k||(k=1);if(!1===G.call(this.parent,_$_af97[307],this,a,k,d))return console.log(_$_af97[308]),!1;da.reset.call(this);b=d?a:a+1;for(var l,n,q=0,p=[],v=[],w=this.rows.splice(b),x=this.options.data?this.options.data.splice(b):[],y=this.records.splice(b),A=b;A<k+b;A++){var z=e[q]&&e[q].id?e[q].id:xa.next.call(this);ta.row.call(this,A,z);n=this.dataType?{}:[];for(var I=0;I<this.options.columns.length;I++)l=qa.call(this,I),n[l]=
_$_af97[3],e&&e[q]&&e[q].data&&(typeof e[q].data[l]!==_$_af97[21]?n[l]=e[q].data[l]:typeof e[q].data[I]!==_$_af97[21]&&(n[l]=e[q].data[I])),f.push({x:I,y:A,value:n[l],force:!0});v.push({id:z,data:n});q++}this.rows=this.rows.concat(w);this.records=this.records.concat(y);Array.prototype.push.apply(this.options.data,x);for(A=b;A<k+b;A++)this.results&&(this.rows[A].results=!0),p.push(this.records[A]);this.merged.rows[b]&&sa.updateConfig.call(this,1,1,b-1,k);L.call(this,_$_af97[78],{numOfRows:k,rowNumber:a,
insertBefore:d?1:0,data:v});this.results&&(this.results=za.refresh.call(this));R.call(this.parent,{worksheet:this,action:_$_af97[78],rowNumber:a,numOfRows:k,insertBefore:d,data:v});ea.references.call(this);g||ka[_$_af97[11]].call(this,0,b,this.options.columns.length-1,k+b-1);H.call(this,!0,!0);f.length&&oa.applyValues.call(this,f);ea.update.call(this);G.call(this.parent,_$_af97[309],this,a,k,p,d)};c.del=function(b,a){if(!P.call(this.parent,this))return!1;if(!this.options.allowDeleteRow)return console.error(_$_af97[310]),
!1;var d={},e=[];void 0==b&&(a=this.getSelectedRows(),a[0]?(b=parseInt(a[0].getAttribute(_$_af97[57])),a=a.length):(b=this.options.data.length-1,a=1));var g=this.options.data.length-1;if(void 0==b||b>g||0>b)b=g;a||(a=1);b+a>=this.options.data.length&&(a=this.options.data.length-b,a>=this.options.data.length&&(a=this.options.data.length,this.resetSelection()));if(!1===G.call(this.parent,_$_af97[311],this,b,a))return console.log(_$_af97[312]),!1;if(-1<parseInt(b)&&0<parseInt(a)){da.reset.call(this);
for(var f=b;f<b+a;f++)for(var k=0;k<this.options.columns.length;k++)g=F.getColumnNameFromCoords(k,f),Q.getAttributes.call(this,_$_af97[313],g,d),Q.getAttributes.call(this,_$_af97[120],g,d),Q.getAttributes.call(this,_$_af97[314],g,d),Q.getAttributes.call(this,_$_af97[315],g,d),Q.getAttributes.call(this,_$_af97[295],g,d),Q.getAttributes.call(this,_$_af97[294],g,d),e[g]=!0;if(g=Z.getChain.call(this,d.values))d.formulas=g;for(f=b;f<b+a;f++)ca.attached.call(this,f)&&this.rows[f].element.remove(),this.options.rows&&
this.options.rows[f]&&(this.options.rows[f]=null);g=[];for(f=b;f<b+a;f++)g.push({id:this.getRowId(f),row:f,data:this.getRowData(f)});this.rows.splice(b,a);f=this.records.splice(b,a);this.options.data.splice(b,a);sa.updateConfig.call(this,1,0,b,a);this.results&&(this.results=za.refresh.call(this));L.call(this,_$_af97[79],{rowNumber:b,numOfRows:a,data:g});R.call(this.parent,{worksheet:this,action:_$_af97[79],rowNumber:b,numOfRows:a,insertBefore:1,data:g,attributes:d});ea.references.call(this,e);H.call(this,
!0,!0);ea.update.call(this,!0);G.call(this.parent,_$_af97[316],this,b,a,f,g,d)}};return c}(),ia=function(){var h=function(b,a){Array.isArray(a)||(a=[a]);for(var d,e,g=Object.keys(a),f=0;f<g.length;f++)if(d=a[g[f]],e=this.options.columns[d])this.colgroup[d]&&(this.colgroup[d].style.width=b?parseInt(e.width||this.options.defaultColWidth)+_$_af97[59]:_$_af97[61]),e.visible=b;H.call(this,!0);this.resetBorders()},c=function(b){b.getColumn=c[_$_af97[58]];b.getColumnIdByName=c.getByName;b.getPrimaryKey=
c.getPrimaryKey;b.getSelectedColumns=c.selected;b.moveColumn=c.move;b.insertColumn=c.add;b.deleteColumn=c.del;b.showColumn=h.bind(b,!0);b.hideColumn=h.bind(b,!1)};c[_$_af97[58]]=function(b){return this.options.columns[b]||!1};c.attached=function(b){return this.headers[b]&&this.headers[b].parentNode?!0:!1};c.getByName=function(b){for(var a=this.options.columns,d=0;d<a.length;d++)if(a[d].name==b)return d;return!1};c.getPrimaryKey=function(){for(var b=0;b<this.options.columns.length;b++)if(1==this.options.columns[b].primaryKey)return b;
return!1};c.selected=function(){var b=[],a=this.getHighlighted();if(a)for(var d=a[0];d<=a[2];d++)b.push(d);return b};c.move=function(b,a){if(!P.call(this.parent,this))return!1;b=parseInt(b);a=parseInt(a);if(!this.options.columns[b])return console.error(_$_af97[317]),!1;if(!this.options.columns[a])return console.error(_$_af97[318]),!1;if(0<Object.keys(this.getMerge()).length){var d=null;this.merged.cols[b]?d=!0:this.merged.cols[a]&&(b>a?this.merged.cols[a-1]&&(d=!0):this.merged.cols[a+1]&&(d=!0));
d&&this.destroyMerged()}da.reset.call(this);this.options.freezeColumns&&ba.applyReset.call(this);if(ia.attached.call(this,a)){Da.create.call(this,b);var e=(b>a?this.headers[a]:this.headers[a].nextSibling)||null;this.headerContainer.insertBefore(this.headers[b],e);e=(b>a?this.colgroup[a]:this.colgroup[a].nextSibling)||null;this.colgroupContainer.insertBefore(this.colgroup[b],e);for(var g=0;g<this.tbody.children.length;g++)d=this.tbody.children[g].getAttribute(_$_af97[57]),e=(b>a?this.records[d][a].element:
this.records[d][a].element.nextSibling)||null,this.tbody.children[g].insertBefore(Q[_$_af97[58]].call(this,b,d),e);if(this.options.footers)for(g=0;g<this.tfoot.children.length;g++)e=(b>a?this.footers.content[g][a].element:this.footers.content[g][a].element.nextSibling)||null,this.tfoot.children[g].insertBefore(fa.create.call(this,b,g),e)}else if(ia.attached.call(this,b)){this.headerContainer.removeChild(this.headers[b]);this.colgroupContainer.removeChild(this.colgroup[b]);for(g=0;g<this.tbody.children.length;g++)d=
parseInt(this.tbody.children[g].getAttribute(_$_af97[57])),this.tbody.children[g].removeChild(this.records[d][b].element);if(this.options.footers)for(g=0;g<this.tfoot.children.length;g++)this.tfoot.children[g].removeChild(this.footers.content[g][b].element)}this.options.columns.splice(a,0,this.options.columns.splice(b,1)[0]);this.headers.splice(a,0,this.headers.splice(b,1)[0]);this.colgroup.splice(a,0,this.colgroup.splice(b,1)[0]);for(g=0;g<this.rows.length;g++)this.dataType||this.options.data[g].splice(a,
0,this.options.data[g].splice(b,1)[0]),this.records[g].splice(a,0,this.records[g].splice(b,1)[0]);if(this.options.footers)for(g=0;g<this.options.footers.length;g++)this.options.footers[g].splice(a,0,this.options.footers[g].splice(b,1)[0]),this.footers.content[g].splice(a,0,this.footers.content[g].splice(b,1)[0]);L.call(this,_$_af97[83],{f:b,t:a});R.call(this.parent,{worksheet:this,action:_$_af97[83],oldValue:b,newValue:a});ea.references.call(this);H.call(this,!0,!0);ea.update.call(this);G.call(this.parent,
_$_af97[319],this,b,a)};c.add=function(b,a,d,e,g,f,k){if(!P.call(this.parent,this))return!1;if(!this.options.allowInsertColumn)return console.error(_$_af97[320]),!1;var l=[];if(0<b)var n=parseInt(b);else if(n=1,Array.isArray(b)&&!g)if(Array.isArray(b[0]))g=b;else{g=[];for(var q=0;q<b.length;q++)g[q]=[b[q]]}g||(g=[]);d=d?!0:!1;b=this.options.columns.length-1;if(void 0==a||a>b||0>a)a=b,d=!1;n||(n=1);if(!1===G.call(this.parent,_$_af97[321],this,a,n,d))return console.log(_$_af97[322]),!1;da.reset.call(this);
this.options.freezeColumns&&ba.applyReset.call(this);if(1==this.dataType)var p=parseInt((_$_af97[3]+Date.now()).substr(-8));e||(e=[]);for(q=0;q<n;q++)e[q]||(e[q]={}),e[q].type||(e[q].type=_$_af97[71]),e[q].width||(e[q].width=this.options.defaultColWidth),e[q].type!=_$_af97[73]&&e[q].type!=_$_af97[323]||e[q].source||(e[q].source=[]),1==this.dataType&&typeof e[q].name==_$_af97[21]&&(e[q].name=_$_af97[324]+(p+q));p=d?a:a+1;this.options.columns=F.injectArray(this.options.columns,p,e);q=this.headers.splice(p);
var v=this.colgroup.splice(p);for(b=p;b<n+p;b++)Da.create.call(this,b);this.headers=this.headers.concat(q);this.colgroup=this.colgroup.concat(v);fa.adjust.call(this,p,n,1);ya.adjust.call(this,a,n,1,f);v=null;for(var w,x=0;x<this.options.data.length;x++){this.dataType||(v=this.options.data[x].splice(p));w=this.records[x].splice(p);f=0;for(b=p;b<n+p;b++)q=g[x]&&g[x][f]?g[x][f]:_$_af97[3],O.call(this,b,x,q),l.push({x:b,y:x,value:q}),ta.cell.call(this,b,x),f++;this.dataType||(this.options.data[x]=this.options.data[x].concat(v));
this.records[x]=this.records[x].concat(w)}this.merged.cols[p]&&sa.updateConfig.call(this,0,1,p-1,n);L.call(this,_$_af97[80],{numOfColumns:n,columnNumber:a,insertBefore:d?1:0,properties:e,data:g});R.call(this.parent,{worksheet:this,action:_$_af97[80],columnNumber:a,numOfColumns:n,insertBefore:d,properties:e,data:g});ea.references.call(this);k||ka[_$_af97[11]].call(this,p,0,n+p-1,this.rows.length-1);H.call(this,!0,!0);l.length&&oa.applyValues.call(this,l);ea.update.call(this);G.call(this.parent,_$_af97[325],
this,a,n,[],d)};c.del=function(b,a){if(!P.call(this.parent,this))return!1;if(!this.options.allowDeleteColumn)return console.error(_$_af97[326]),!1;var d={},e=[];if(1<this.options.columns.length){void 0==b&&(a=this.getSelectedColumns(!0),a.length?(b=parseInt(a[0]),a=parseInt(a.length)):(b=this.options.columns.length-1,a=1));var g=this.options.columns.length-1;if(void 0==b||b>g||0>b)b=g;a||(a=1);b+a>=this.options.columns.length&&(a=this.options.columns.length-b,a>=this.options.columns.length&&(a--,
console.error(_$_af97[327])));if(!1===G.call(this.parent,_$_af97[328],this,b,a))return console.log(_$_af97[329]),!1;if(-1<parseInt(b)&&0<parseInt(a)){da.reset.call(this);g=null;var f=[],k=[],l=[];var n=0;for(var q=b;q<b+a;q++)ia.attached.call(this,q)&&(this.colgroup[q].parentNode.removeChild(this.colgroup[q]),this.headers[q].parentNode.removeChild(this.headers[q])),l[n]=this.options.columns[q],n++;for(var p=0;p<this.options.data.length;p++)for(q=b;q<b+a;q++)n=F.getColumnNameFromCoords(q,p),Q.getAttributes.call(this,
_$_af97[313],n,d),Q.getAttributes.call(this,_$_af97[120],n,d),Q.getAttributes.call(this,_$_af97[314],n,d),Q.getAttributes.call(this,_$_af97[315],n,d),Q.getAttributes.call(this,_$_af97[295],n,d),Q.getAttributes.call(this,_$_af97[294],n,d),e[n]=!0,this.records[p][q].element&&0<=Array.prototype.indexOf.call(this.rows[p].element.children,this.records[p][q].element)&&this.records[p][q].element.parentNode.removeChild(this.records[p][q].element);if(q=Z.getChain.call(this,d.values))d.formulas=q;this.options.columns.splice(b,
a);this.headers.splice(b,a);this.colgroup.splice(b,a);for(p=0;p<this.options.data.length;p++)this.dataType||(k[p]=this.options.data[p].splice(b,a)),f[p]=this.records[p].splice(b,a);fa.adjust.call(this,b,a,0);(q=ya.adjust.call(this,b,a,0))&&(g={nested:q});sa.updateConfig.call(this,0,0,b,a);L.call(this,_$_af97[81],{columnNumber:b,numOfColumns:a});R.call(this.parent,{worksheet:this,action:_$_af97[81],columnNumber:b,numOfColumns:a,insertBefore:1,data:k,properties:l,attributes:d,extra:g});ea.references.call(this,
e);H.call(this,!0,!0);ea.update.call(this,!0);G.call(this.parent,_$_af97[330],this,b,a,f,l,d)}}};c.isVisible=function(b){var a=this.options.columns;return!1===a[b].visible||a[b].type===_$_af97[112]||a[b].width===_$_af97[61]||a[b].width===_$_af97[119]?!1:!0};return c}(),La=function(){var h={},c={},b=function(d){if(typeof d==_$_af97[25]){var e=d;d=F.getCoordsFromColumnName(d);var g=d[0];d=d[1]}else g=d.x,d=d.y,e=F.getColumnNameFromCoords(g,d);if(this.records[d]&&this.records[d][g]&&this.records[d][g].element){c[e]=
this.options.style[e];this.records[d][g].element.setAttribute(_$_af97[120],_$_af97[3]);if(this.options.cells&&this.options.cells[e]&&this.options.cells[e].align)var f=this.options.cells[e].align;else this.options.columns[g].align&&(f=this.options.columns[g].align);f&&(this.records[d][g].element.style.textAlign=f)}this.options.style&&this.options.style[e]&&delete this.options.style[e]},a=function(d){d.getStyle=a[_$_af97[58]];d.setStyle=a[_$_af97[11]];d.resetStyle=a.reset};a[_$_af97[58]]=function(d){var e=
this.options.style;if(!e)return!1;if(d){if(typeof d==_$_af97[25])return e[d];var g=[],f=Object.keys(d);if(0<f.length)for(var k=0;k<f.length;k++){if(typeof d[k]==_$_af97[25])var l=e&&e[d[k]]?e[d[k]]:_$_af97[3];else l=F.getColumnNameFromCoords(d[k].x,d[k].y),l=e&&e[l]?e[l]:_$_af97[3];g.push(l)}return g}return this.options.style};a.getFromSelection=function(d){var e,g,f=this.options.style,k=0,l=[];for(g=d[1];g<=d[3];g++){var n=0;l[k]=[];for(e=d[0];e<=d[2];e++){var q=F.getColumnNameFromCoords(e,g);l[k][n++]=
f&&f[q]?f[q]:_$_af97[3]}k++}return l};a[_$_af97[11]]=function(d,e,g,f){if(!P.call(this.parent,this))return!1;this.options.style||(this.options.style={});var k=this.options.style,l=null,n=[],q=[],p={};q=function(x,y,A){if(!p[x]&&(k[x]?n=k[x].split(_$_af97[243]):(k[x]=_$_af97[3],n=[]),p[x]={},n.length))for(var z=0;z<n.length;z++)n[z]&&n[z].trim()&&(l=n[z].split(_$_af97[157]),p[x][l[0].trim()]=l[1].trim());c[x]||(c[x]=[]);h[x]||(h[x]=[]);p[x][y]||(p[x][y]=_$_af97[3]);c[x].push([y+_$_af97[157]+p[x][y]]);
p[x][y]=p[x][y]&&p[x][y]==A&&!f?_$_af97[3]:A;h[x].push([y+_$_af97[157]+p[x][y]]);A=F.getCoordsFromColumnName(x);this.records[A[1]]&&this.records[A[1]][A[0]]&&this.records[A[1]][A[0]].element&&(this.records[A[1]][A[0]].element.style[y]=p[x][y]);p[x][y]||delete p[x][y]};h={};c={};if(e)if(typeof d==_$_af97[25])q.call(this,d,e,g);else{if(d&&d.length)for(var v=0;v<d.length;v++){var w=F.getColumnNameFromCoords(d[v].x,d[v].y);q.call(this,w,e,g)}}else for(g=Object.keys(d),v=0;v<g.length;v++)if(w=d[g[v]])for(typeof w==
_$_af97[25]&&(w=w.split(_$_af97[243])),e=0;e<w.length;e++)w[e]&&(typeof w[e]==_$_af97[25]&&(w[e]=w[e].split(_$_af97[157])),w[e][0].trim()&&q.call(this,g[v],w[e][0].trim(),w[e][1].trim()));n={};q=Object.keys(p);if(q.length){for(v=0;v<q.length;v++){n[q[v]]||(n[q[v]]=[]);d=Object.keys(p[q[v]]);for(e=0;e<d.length;e++)n[q[v]].push(d[e]+_$_af97[137]+p[q[v]][d[e]]);this.options.style[q[v]]=n[q[v]].join(_$_af97[331])}q=Object.keys(h);for(v=0;v<q.length;v++)h[q[v]]=h[q[v]].join(_$_af97[243]);q=Object.keys(c);
for(v=0;v<q.length;v++)c[q[v]]=c[q[v]].join(_$_af97[243]);this.refreshBorders();R.call(this.parent,{worksheet:this,action:_$_af97[86],oldValue:c,newValue:h});L.call(this,_$_af97[86],[h]);G.call(this.parent,_$_af97[332],this,h,c)}};a.reset=function(d){if(!P.call(this.parent,this))return!1;if(d){c={};if(Array.isArray(d))for(var e=0;e<d.length;e++)b.call(this,d[e]);else b.call(this,d);this.refreshBorders();R.call(this.parent,{worksheet:this,action:_$_af97[87],cells:d,oldValue:c});L.call(this,_$_af97[87],
[d]);G.call(this.parent,_$_af97[334],this,d)}else console.error(_$_af97[333])};a.update=function(d){h={};c={};for(var e=Object.keys(d),g=0;g<e.length;g++){c[e[g]]=this.options.style[e[g]]||_$_af97[3];h[e[g]]=this.options.style[e[g]]=d[e[g]];var f=F.getCoordsFromColumnName(e[g]),k=f[0];f=f[1];if(this.records[f]&&this.records[f][k]&&this.records[f][k].element&&(this.records[f][k].element.setAttribute(_$_af97[120],d[e[g]]),!this.records[f][k].element.style.textAlign)){var l=null;this.options.cells&&
this.options.cells[e[g]]&&this.options.cells[e[g]].align?l=this.options.cells[e[g]].align:this.options.columns[k].align&&(l=this.options.columns[k].align);l&&(this.records[f][k].element.style.textAlign=l)}}L.call(this,_$_af97[87],[e]);L.call(this,_$_af97[86],[h]);G.call(this.parent,_$_af97[332],this,h,c)};return a}(),Ya=function(){var h=function(c){c.getComments=h[_$_af97[58]];c.setComments=h[_$_af97[11]]};h[_$_af97[58]]=function(c){return c&&typeof c==_$_af97[25]?this.options.comments&&this.options.comments[c]?
this.options.comments[c]:!1:this.options.comments};h[_$_af97[11]]=function(c,b){if(!P.call(this.parent,this))return!1;if(typeof c==_$_af97[25]){var a={};a[c]=b}else a=c;if(b=G.call(this.parent,_$_af97[335],this,a))a=b;else if(!1===b)return!1;this.options.comments||(this.options.comments={});c={};var d=Object.keys(a);if(d.length){for(var e=0;e<d.length;e++){var g=F.getCoordsFromColumnName(d[e]);this.records[g[1]]&&this.records[g[1]][g[0]]&&(c[d[e]]=this.options.comments[d[e]]||_$_af97[3],(b=a[d[e]])?
this.options.comments[d[e]]=b:delete this.options.comments[d[e]],this.records[g[1]][g[0]].element&&(b?this.records[g[1]][g[0]].element.setAttribute(_$_af97[296],b):this.records[g[1]][g[0]].element.removeAttribute(_$_af97[296])))}R.call(this.parent,{worksheet:this,action:_$_af97[91],newValue:a,oldValue:c});L.call(this,_$_af97[91],[a]);G.call(this.parent,_$_af97[336],this,a,c)}};return h}(),Za=function(){var h=function(c){c.getMeta=h[_$_af97[58]];c.setMeta=h[_$_af97[11]];c.resetMeta=h.reset};h[_$_af97[58]]=
function(c,b){if(c){if(this.options.meta[c])return b?this.options.meta[c][b]:this.options.meta[c]}else return this.options.meta};h[_$_af97[11]]=function(c,b,a){if(!P.call(this.parent,this))return!1;this.options.meta||(this.options.meta={});if(typeof c==_$_af97[25]&&b){a||(a=_$_af97[3]);var d={};d[c]={};d[c][b]=a;c=d}b=Object.keys(c);if(b.length){a={};for(d=0;d<b.length;d++){this.options.meta[b[d]]||(this.options.meta[b[d]]={});a[b[d]]||(a[b[d]]={});for(var e=Object.keys(c[b[d]]),g=0;g<e.length;g++)this.options.meta[b[d]][e[g]]=
c[b[d]][e[g]],a[b[d]][e[g]]=c[b[d]][e[g]]}Object.keys(a).length&&(L.call(this,_$_af97[337],[a]),G.call(this.parent,_$_af97[338],this,a))}};h.reset=function(c){if(!P.call(this.parent,this))return!1;if(c){if(this.options.meta){typeof c==_$_af97[25]&&(c=[c]);for(var b=0;b<c.length;b++)this.options.meta[c[b]]&&delete this.options.meta[c[b]]}}else c={},this.options.meta=c;L.call(this,_$_af97[339],c);G.call(this.parent,_$_af97[340],this,c)};return h}(),$a=function(){var h=function(c){c.orderBy=h.execute};
h.handler=function(c,b){return function(a,d){a=a[1];d=d[1];return c?a===_$_af97[3]&&d!==_$_af97[3]?1:a!==_$_af97[3]&&d===_$_af97[3]?-1:a>d?-1:a<d?1:0:a===_$_af97[3]&&d!==_$_af97[3]?1:a!==_$_af97[3]&&d===_$_af97[3]?-1:a>d?1:a<d?-1:0}};h.execute=function(c,b,a,d){if(0<=c){b=null==b?this.headers[c].classList.contains(_$_af97[341])?1:0:b?1:0;for(var e,g,f=[],k=0;k<this.options.data.length;k++)e=Ka[_$_af97[58]].call(this,c,k),g=this.records[k][c].v,g=e.type==_$_af97[283]||e.type==_$_af97[288]||e.type==
_$_af97[289]||e.type==_$_af97[342]||e.type==_$_af97[22]||e.type==_$_af97[343]?Number(g):jSuites.isNumeric(g)?Number(g):g.toLowerCase(),f[k]=[k,g];k=typeof this.parent.config.sorting===_$_af97[104]?this.parent.config.sorting(b,c):h.handler(b,c);f.sort(k);e=a?!0:!1;if(!a)for(a=[],k=0;k<f.length;k++)a[k]=f[k][0];if(k=G.call(this.parent,_$_af97[344],this,c,b,a))a=k;else if(!1===k)return!1;if(e)this.destroyMerged();else if(0<Object.keys(this.getMerge()).length)if(confirm(E(_$_af97[345])))this.destroyMerged();
else return!1;if(a.length<f.length)for(k=0;k<f.length;k++)-1==a.indexOf(f[k][0])&&a.push(f[k][0]);f=[];for(k=0;k<a.length;k++)f[a[k]]=k;Ga.call(this,!1);da.reset.call(this);L.call(this,_$_af97[94],{column:c,direction:b,order:a});R.call(this.parent,{worksheet:this,action:_$_af97[94],column:c,newValue:a,oldValue:f,direction:b,previousState:h.getState.call(this)});h.update.call(this,a);h.arrow.call(this,c,b,d);da.refresh.call(this);G.call(this.parent,_$_af97[346],this,c,b,a);return!0}};h.update=function(c){for(var b=
[],a=0;a<c.length;a++)b[a]=this.options.data[c[a]];for(a=0;a<c.length;a++)this.options.data[a]=b[a];b=[];for(a=0;a<c.length;a++)b[a]=this.records[c[a]];this.records=b;b=[];for(a=0;a<c.length;a++)b[a]=this.rows[c[a]];this.rows=b;ea.references.call(this);this.tbody.innerHTML=_$_af97[3];H.call(this,!0,!0);this.searchInput&&this.searchInput.value?va.update.call(this,null):la.update.call(this)};h.arrow=function(c,b,a){for(var d=0;d<this.headers.length;d++)this.headers[d].classList.remove(_$_af97[347]),
this.headers[d].classList.remove(_$_af97[341]);void 0===a?this.headers[c].classList.add(b?_$_af97[347]:_$_af97[341]):Array.isArray(a)&&this.headers[a[0]].classList.add(a[1]?_$_af97[347]:_$_af97[341])};h.getState=function(){for(var c=0;c<this.headers.length;c++){if(this.headers[c].classList.contains(_$_af97[347]))return[c,1];if(this.headers[c].classList.contains(_$_af97[341]))return[c,0]}return null};return h}(),Ca=function(){var h=function(c){c.whichPage=h.whichPage;c.quantityOfPages=h.quantityOfPages;
c.page=h[_$_af97[11]];c.updatePagination=h.update};h.build=function(){this.pageNumber=0;var c=document.createElement(_$_af97[32]),b=document.createElement(_$_af97[32]);this.pagination=document.createElement(_$_af97[32]);this.pagination.classList.add(_$_af97[348]);this.pagination.appendChild(c);this.pagination.appendChild(b);this.options.pagination||(this.pagination.style.display=_$_af97[52]);this.element.appendChild(this.pagination)};h.pageUp=function(){0<this.pageNumber&&(this.pageNumber--,h[_$_af97[11]].call(this,
this.pageNumber))};h.pageDown=function(){this.pageNumber<h.quantityOfPages.call(this)-1&&(this.pageNumber++,h[_$_af97[11]].call(this,this.pageNumber))};h.whichPage=function(c){if(0<this.options.pagination)return this.rows[c]?(this.results&&(c=this.results.indexOf(parseInt(c))),Math.ceil((parseInt(c)+1)/parseInt(this.options.pagination))-1):null;console.log(_$_af97[349]);return!1};h.quantityOfPages=function(){if(0<this.options.pagination)return Math.ceil((this.results?this.results.length:this.rows.length)/
parseInt(this.options.pagination));console.log(_$_af97[349]);return!1};h[_$_af97[11]]=function(c,b){var a=this.pageNumber,d=parseInt(this.options.pagination);if(d){if(null==c||-1==c)c=Math.ceil((this.results?this.results:this.rows).length/d)-1;if(!1===G.call(this.parent,_$_af97[351],this,c,a,d))return!1;this.pageNumber=c;H.update.call(this);fa.refresh.call(this);typeof b==_$_af97[104]&&b.call(this);G.call(this.parent,_$_af97[352],this,c,a,d)}else console.error(_$_af97[350])};h.update=function(){this.pagination.children[0].innerHTML=
_$_af97[3];this.pagination.children[1].innerHTML=_$_af97[3];if(this.options.pagination){var c=this.results?this.results.length:this.rows.length;if(c){c=Math.ceil(c/this.options.pagination);if(6>this.pageNumber)var b=1,a=10>c?c:10;else 5>c-this.pageNumber?(b=c-9,a=c,1>b&&(b=1)):(b=this.pageNumber-4,a=this.pageNumber+5);if(1<b){var d=document.createElement(_$_af97[32]);d.className=_$_af97[354];d.innerHTML=_$_af97[15];d.title=1;this.pagination.children[1].appendChild(d)}for(;b<=a;b++)d=document.createElement(_$_af97[32]),
d.className=_$_af97[354],d.innerHTML=b,this.pagination.children[1].appendChild(d),this.pageNumber==b-1&&d.classList.add(_$_af97[355]);a<c&&(d=document.createElement(_$_af97[32]),d.className=_$_af97[354],d.innerHTML=_$_af97[17],d.title=c,this.pagination.children[1].appendChild(d));this.pagination.children[0].innerHTML=E(_$_af97[356],[this.pageNumber+1,c])}else this.pagination.children[0].innerHTML=E(_$_af97[353]);this.options.tableOverflow&&(this.content.style.height=this.table.offsetHeight+16+_$_af97[59],
this.table.style.top=0)}};return h}(),ja=function(){var h=function(c){c.setFreezeRows=h[_$_af97[11]];c.resetFreezeRows=h.reset};h.update=function(c){var b,a;if(a=this.options.freezeRows)for(var d=this.thead.offsetHeight,e=0;e<a;e++){if(b=this.records[e][c].element)b.classList.add(_$_af97[357]),b.style.top=d+_$_af97[59];d+=parseInt(this.rows[e].element.offsetHeight)}};h.headers=function(){var c=this.thead.offsetHeight,b;if(b=this.options.freezeRows)for(var a=0;a<b;a++)this.rows[a]&&this.rows[a].element&&
(this.rows[a].element.firstChild.classList.add(_$_af97[357]),this.rows[a].element.firstChild.style.top=c+_$_af97[59],c+=parseInt(this.rows[a].element.offsetHeight));else h.reset.call(this)};h.refresh=function(){if(0<this.options.freezeRows){h.headers.call(this);for(var c=0;c<this.visibleCols.length;c++)h.update.call(this,this.visibleCols[c])}};h[_$_af97[11]]=function(c){h.applyReset.call(this);var b=this.options.freezeRows;this.options.freezeRows=c;this.options.freezeRowControl&&!c?this.thead.lastChild.firstChild.classList.add(_$_af97[358]):
this.thead.lastChild.firstChild.classList.remove(_$_af97[358]);h.refresh.call(this);H.call(this,!0);da.refresh.call(this);R.call(this.parent,{worksheet:this,action:_$_af97[93],newValue:c,oldValue:b});L.call(this,_$_af97[93],{row:c})};h.reset=function(){h[_$_af97[11]].call(this,0)};h.getHeight=function(c){c=c?0:this.thead.offsetHeight;if(0<this.options.freezeRows)for(var b=0;b<this.options.freezeRows;b++)c+=parseInt(ca.height.call(this,b));return c};h.applyReset=function(){for(var c,b=0;b<this.options.freezeRows;b++)if(this.rows[b].element){this.rows[b].element.firstChild.classList.remove(_$_af97[357]);
this.rows[b].element.firstChild.style.top=_$_af97[3];for(var a=0;a<this.options.columns.length;a++)if(c=this.records[b][a].element)c.classList.remove(_$_af97[357]),c.style.top=_$_af97[3]}};h.start=function(c,b){c=this.parent.helper;h.event={y:b,d:b};this.content.scrollTop=0;b=this.content.offsetTop+h.getHeight.call(this);c.style.display=_$_af97[24];c.style.top=b+_$_af97[59];c.style.left=_$_af97[61];c.style.width=this.content.offsetWidth+_$_af97[59];c.style.height=_$_af97[181]};h.end=function(c){c=
h.event;null!==c.d&&this.setFreezeRows(c.d);this.parent.helper.style.display=_$_af97[3];h.event=null};h.cancel=function(){h.event.d=null;h.end.call(this,!1)};h.move=function(c){var b=c.target.getAttribute(_$_af97[57]);if(null!=b){b=parseInt(b);var a=(c=c.target.clientHeight/2>c.offsetY)?b:b+1;this.merged.rows[a]&&0<a||(h.event.d=a,a=this.parent.element.getBoundingClientRect(),b=this.rows[b].element.getBoundingClientRect(),this.parent.helper.style.top=(c?b.top:b.bottom)-a.top+_$_af97[59])}};return h}(),
ba=function(){var h=function(c){c.setFreezeColumns=h[_$_af97[11]];c.resetFreezeColumns=h.reset};h.width=function(){if(this.options.freezeColumns){h.headers.call(this);for(var c=0;c<this.rows.length;c++)this.rows[c].element&&h.update.call(this,c)}};h.update=function(c){var b,a;if(a=this.options.freezeColumns){var d=Aa.call(this)?50:0;if(this.rows[c].element)for(var e=0;e<a;e++){if(b=this.records[c][e].element)b.classList.add(_$_af97[60]),b.style.left=d+_$_af97[59];ia.isVisible.call(this,e)&&(d+=parseInt(this.options.columns[e].width))}}};
h.headers=function(){var c=Aa.call(this)?50:0,b;if(b=this.options.freezeColumns)for(var a=0;a<b;a++){if(this.headers[a]){this.headers[a].classList.add(_$_af97[60]);this.headers[a].style.left=c+_$_af97[59];if(this.options.footers)for(var d=0;d<this.options.footers.length;d++)this.footers.content[d][a].element.classList.add(_$_af97[60]),this.footers.content[d][a].element.style.left=c+_$_af97[59];!1!==this.options.columns[a].visible&&(c+=parseInt(this.options.columns[a].width))}}else h.reset.call(this)};
h.refresh=function(){if(0<this.options.freezeColumns){h.headers.call(this);for(var c=0;c<this.visibleRows.length;c++)h.update.call(this,this.visibleRows[c])}};h[_$_af97[11]]=function(c){h.applyReset.call(this);var b=this.options.freezeColumns;this.options.freezeColumns=c;this.options.freezeColumnControl&&!c?this.thead.lastChild.firstChild.classList.add(_$_af97[359]):this.thead.lastChild.firstChild.classList.remove(_$_af97[359]);h.width.call(this);H.call(this,!0);da.refresh.call(this);R.call(this.parent,
{worksheet:this,action:_$_af97[92],newValue:c,oldValue:b});L.call(this,_$_af97[92],{column:c})};h.reset=function(){h[_$_af97[11]].call(this,0)};h.applyReset=function(){for(var c,b=1;b<=this.options.freezeColumns;b++){if(c=this.thead.lastChild)c.children[b].classList.remove(_$_af97[60]),c.children[b].style.left=_$_af97[3];for(var a=0;a<this.rows.length;a++)if(c=this.rows[a].element)c.children[b].classList.remove(_$_af97[60]),c.children[b].style.left=_$_af97[3];if(this.options.footers)for(a=0;a<this.options.footers.length;a++)this.tfoot.children[a].children[b].classList.remove(_$_af97[60]),
this.tfoot.children[a].children[b].style.left=_$_af97[3]}};h.getWidth=function(c){c=c?0:Aa.call(this)?50:0;if(0<this.options.freezeColumns)for(var b=0;b<this.options.freezeColumns;b++)ia.isVisible.call(this,b)&&(c+=parseInt(this.options.columns[b].width));return c};h.start=function(c,b){c=this.parent.helper;h.event={x:b,d:b};this.content.scrollLeft=0;b=h.getWidth.call(this);c.style.display=_$_af97[24];c.style.top=this.content.offsetTop+_$_af97[59];c.style.left=b+_$_af97[59];c.style.width=_$_af97[181];
c.style.height=this.content.offsetHeight+_$_af97[59];this.thead.lastChild.firstChild.classList.remove(_$_af97[359])};h.end=function(c){c=h.event;null!==c.d&&this.setFreezeColumns(c.d);this.parent.helper.style.display=_$_af97[3];h.event=null};h.cancel=function(){h.event.d=null;h.end.call(this,!1)};h.move=function(c){var b=c.target.getAttribute(_$_af97[56]);if(null!=b){b=parseInt(b);var a=(c=c.target.clientWidth/2>c.offsetX)?b:b+1;this.merged.cols[a]&&0<a||(h.event.d=a,b=this.headers[b].getBoundingClientRect(),
a=this.content.getBoundingClientRect(),this.parent.helper.style.left=(c?b.left:b.right)-a.left+_$_af97[59])}};return h}(),ea=function(){var h=function(a,d){if(this.options[a]){for(var e={},g=Object.keys(this.options[a]),f=0;f<g.length;f++)e[d&&void 0!=d[g[f]]?d[g[f]]:g[f]]=this.options[a][g[f]];this.options[a]=e}},c=function(){if(0<this.options.minSpareRows){for(var a=0,d=this.rows.length-1;0<=d;d--){for(var e=!1,g=0;g<this.options.columns.length;g++)O.call(this,g,d)&&(e=!0);if(e)break;else a++}0<
this.options.minSpareRows-a&&this.insertRow(this.options.minSpareRows-a)}if(0<this.options.minSpareCols){a=0;for(g=this.options.columns.length-1;0<=g;g--){e=!1;for(d=0;d<this.rows.length;d++)O.call(this,g,d)&&(e=!0);if(e)break;else a++}0<this.options.minSpareCols-a&&this.insertColumn(this.options.minSpareCols-a)}},b=function(){};b.build=function(){var a=this;this.content=document.createElement(_$_af97[32]);this.content.classList.add(_$_af97[360]);this.content.addEventListener(_$_af97[361],function(e){if(!a.edition)return e.preventDefault(),
!1});this.table=document.createElement(_$_af97[362]);this.thead=document.createElement(_$_af97[363]);this.tbody=document.createElement(_$_af97[364]);this.tfoot=document.createElement(_$_af97[365]);this.headers=[];this.colgroup=[];this.colgroupContainer=document.createElement(_$_af97[366]);var d=document.createElement(_$_af97[196]);d.setAttribute(_$_af97[178],_$_af97[367]);this.colgroupContainer.appendChild(d);this.headerContainer=document.createElement(_$_af97[171]);d=document.createElement(_$_af97[173]);
d.classList.add(_$_af97[368]);if(1==this.parent.edition)this.options.freezeRowControl&&!this.options.freezeRows&&d.classList.add(_$_af97[358]),this.options.freezeColumnControl&&!this.options.freezeColumns&&d.classList.add(_$_af97[359]);else if(this.options.freezeRowControl||this.options.freezeColumnControl)this.options.freezeRowControl=!1,this.options.freezeColumnControl=!1,console.log(_$_af97[369]);this.headerContainer.appendChild(d);this.thead.appendChild(this.headerContainer);this.table.classList.add(_$_af97[370]);
this.table.setAttribute(_$_af97[371],_$_af97[119]);this.table.setAttribute(_$_af97[372],_$_af97[119]);this.table.setAttribute(_$_af97[373],_$_af97[374]);this.table.appendChild(this.colgroupContainer);this.table.appendChild(this.thead);this.table.appendChild(this.tbody);this.table.appendChild(this.tfoot);this.options.defaultColAlign&&this.table.classList.add(_$_af97[375]+this.options.defaultColAlign);this.options.textOverflow||this.table.classList.add(_$_af97[376]);!1===this.options.selectLockedCells&&
this.table.classList.add(_$_af97[377]);this.corner=document.createElement(_$_af97[32]);this.corner.className=_$_af97[378];this.corner.setAttribute(_$_af97[373],_$_af97[379]);this.corner.setAttribute(_$_af97[380],_$_af97[381]);0==this.options.selectionCopy&&(this.corner.style.display=_$_af97[52]);this.scrollX=H.build.call(a,_$_af97[382]);this.scrollY=H.build.call(a,_$_af97[383]);this.content.appendChild(this.scrollX);this.content.appendChild(this.scrollY);this.content.appendChild(this.table);this.content.appendChild(this.corner);
this.element.appendChild(this.content);1==this.options.tableOverflow&&(this.content.classList.add(_$_af97[67]),this.options.tableHeight||(this.options.tableHeight=document.body.offsetHeight-18),this.options.tableWidth||(this.options.tableWidth=document.body.offsetWidth-18),this.content.style.width=parseInt(this.options.tableWidth)+_$_af97[59],this.options.pagination?this.content.classList.add(_$_af97[384]):this.content.style.height=parseInt(this.options.tableHeight)+_$_af97[59]);this.options.resize&&
(this.content.style.resize=this.options.resize);this.options.freezeColumns>this.options.columns.length&&console.error(_$_af97[385]);va.build.call(this);ya.build.call(this);Ca.build.call(this);Ha.build.call(this);sa.build.call(this);fa.build.call(this);la.onload.call(this);c.call(this);H.call(this)};b.references=function(a){var d=[],e=[],g=null,f=null,k=null,l=null;for(g=0;g<this.options.columns.length;g++)if(f=this.headers[g])k=f.getAttribute(_$_af97[56]),k!=g&&(f.setAttribute(_$_af97[56],g),f.getAttribute(_$_af97[193])||
(f.innerHTML=F.getColumnName(g)));for(var n=0;n<this.rows.length;n++)f=this.rows[n],l=f.y,l!=n&&(f.y=n,d[l]=n,f.element&&(f.element.setAttribute(_$_af97[57],n),f.element.children[0].setAttribute(_$_af97[57],n),g=this.options.rows&&this.options.rows[l]&&this.options.rows[l].title?this.options.rows[l].title:n+1,f.element.children[0].innerHTML=g));var q=function(v,w){f=this.records[w][v];k=f.x;l=f.y;k!=v&&(f.x=v,f.element&&f.element.setAttribute(_$_af97[56],v));l!=w&&(f.y=w,f.element&&f.element.setAttribute(_$_af97[57],
w));if(k!=v||l!=w){var x=F.getColumnNameFromCoords(k,l);v=F.getColumnNameFromCoords(v,w);e[x]=v}};if(a){n=function(v,w){v&&v[w]&&delete v[w]};var p=Object.keys(a);for(g=0;g<p.length;g++)n(this,p[g]),n(this.options.meta,p[g]),n(this.options.cells,p[g]),n(this.options.style,p[g]),n(this.options.comments,p[g])}for(n=0;n<this.rows.length;n++)for(g=0;g<this.options.columns.length;g++)q.call(this,g,n);h.call(this,_$_af97[386],d);h.call(this,_$_af97[313],e);h.call(this,_$_af97[314],e);h.call(this,_$_af97[120],
e);h.call(this,_$_af97[315],e);h.call(this,_$_af97[295],e);this.options.mergeCells&&sa.build.call(this);G.call(this.parent,_$_af97[387],this,e,a);Z.updateAll.call(this,e,a);Ia.updateAll.call(this,e,a);G.call(this.parent,_$_af97[388],this,e,a);return e};b.update=function(a){a&&c.call(this);if(typeof this.parent.config.updateTable==_$_af97[104])for(var d=0;d<this.rows.length;d++)for(var e=0;e<this.options.columns.length;e++)a=this.records[d][e],this.parent.config.updateTable.call(this,this,a.element,
e,d,O.call(this,e,d),a.r?a.r:a.v);fa.refresh.call(this)};return b}(),ta=function(){var h={spreadsheet:function(c,b){var a={name:null,config:{},el:c,element:c,plugins:[],worksheets:[],history:[],historyIndex:-1,queue:[],ignoreEvents:!1,ignoreHistory:!1,ignorePersistence:!1};Fa.spreadsheet.call(a,b);a.config.license&&(u.license=a.config.license);c.spreadsheet=a;c.jspreadsheet=c.jexcel=a.worksheets;u.spreadsheet.push(a);a.name||(a.name=jSuites.guid());h.bind(a.config.root?a.config.root:document);var d=
a.config.tabs;typeof d!==_$_af97[103]&&(d={allowCreate:d?!0:!1,hideHeaders:d?!1:!0,allowChangePosition:a.config.allowMoveWorksheet?!0:!1});d.maxWidth||(d.maxWidth=c.offsetWidth-50+_$_af97[59]);d.animation=void 0==d.animation?!0:d.animation;d.onbeforecreate=function(){a.createWorksheet();return!1};d.onclick=function(g,f,k,l,n){0<=k&&a.openWorksheet(k,!0)};d.onchangeposition=function(g,f,k){a.updateWorksheet(f,k)};jSuites.tabs(c,d);c.classList.add(_$_af97[389]);1==b.fullscreen&&c.classList.add(_$_af97[23]);
var e=document.createElement(_$_af97[32]);a.toolbar=document.createElement(_$_af97[32]);a.toolbar.className=_$_af97[390];e.appendChild(a.toolbar);a.filter=la.build.call(a);e.appendChild(a.filter);a.helper=document.createElement(_$_af97[32]);a.helper.className=_$_af97[391];e.appendChild(a.helper);a.loading=document.createElement(_$_af97[32]);a.loading.classList.add(_$_af97[392]);e.appendChild(a.loading);e.appendChild(na.build(a));e.appendChild(Sa(a));a.textarea=document.createElement(_$_af97[393]);
a.textarea.className=_$_af97[394];a.textarea.tabIndex=_$_af97[395];e.appendChild(a.textarea);d.position===_$_af97[396]?c.insertBefore(e,c.children[0]):c.insertBefore(e,c.children[1]);c.appendChild(Ma.call(a,u.license));a.createWorksheet=pa.createWorksheet;a.deleteWorksheet=pa.deleteWorksheet;a.renameWorksheet=pa.renameWorksheet;a.updateWorksheet=pa.updateWorksheet;a.openWorksheet=pa.openWorksheet;a.moveWorksheet=pa.moveWorksheet;a.getWorksheet=pa.getWorksheet;a.getWorksheetActive=pa.getWorksheetActive;
a.getWorksheetInstance=pa.getWorksheetInstance;a.getConfig=function(){var g=a.config;g.worksheets=[];for(var f=0;f<a.worksheets.length;f++)g.worksheets.push(a.worksheets[f].getConfig());return g};a.fullscreen=Na;a.progress=Oa;a.dispatch=G;a.setHistory=R;a.resetHistory=R.reset;a.undo=R.undo;a.redo=R.redo;a.setToolbar=ma[_$_af97[11]];a.getToolbar=ma[_$_af97[58]];a.showToolbar=ma.show;a.hideToolbar=ma.hide;a.tools=e;Ia.build.call(a);b.plugins&&ua.call(a,b.plugins);a.setPlugins=function(g){ua.call(a,
g)};c=Object.keys(u.extensions);if(c.length)for(d=0;d<c.length;d++)if(typeof u.extensions[c[d]].oninit==_$_af97[104])u.extensions[c[d]].oninit(a,b);return a},worksheet:function(c,b){var a={};c.worksheets.push(a);a.parent=c;Fa(a);Ua(a);ka(a);da(a);na(a);Ha(a);Wa(a);sa(a);La(a);Xa(a);oa(a);Z(a);Q(a);ca(a);ia(a);Za(a);Ya(a);Da(a);fa(a);ya(a);va(a);la(a);ma(a);xa(a);ab(a);bb(a);Ca(a);pa(a);ba(a);ja(a);Va(a);$a(a);Ia(a);Ka(a);Fa.worksheet.call(a,b);!u.license&&a.options.license&&(u.license=a.options.license);
c.element.jexcel=c.element.jexcel?c.worksheets:a;ua.execute.call(a.parent,_$_af97[397],[a]);a.onload=function(){this.options.worksheetName||(this.options.worksheetName=_$_af97[398]+pa.nextName());var d=this.options.worksheetName;J(d)&&console.log(_$_af97[399]+d+_$_af97[400]);J(d,a);this.element=c.element.tabs.appendElement(this.options.worksheetName,function(e,g){a.options.worksheetState===_$_af97[112]&&(g.style.display=_$_af97[52])});this.element.classList.add(_$_af97[401]);this.element.jexcel=this;
ea.build.call(this);ua.execute.call(this.parent,_$_af97[402],[this]);this.options.data&&500<this.options.data.length&&!H.limited.call(this)&&!this.options.pagination&&console.error(_$_af97[403])};return a},row:function(c,b){this.rows[c]||(this.rows[c]={element:null,y:c});b&&(this.rows[c].id=b,xa[_$_af97[11]].call(this,b));this.options.rows&&this.options.rows[c]&&this.options.rows[c].height&&(this.rows[c].height=this.options.rows[c].height);this.records[c]||(this.records[c]=[]);this.options.data[c]||
(this.options.data[c]=this.dataType?{}:[]);for(b=0;b<this.options.columns.length;b++)h.cell.call(this,b,c)},cell:function(c,b,a){typeof a==_$_af97[21]&&(a=O.call(this,c,b),null===a||void 0===a)&&(a=_$_af97[3],O.call(this,c,b,a));this.records[b][c]||(this.records[b][c]={element:null,x:c,y:b},aa(a)||(this.records[b][c].v=a))},bind:function(c){for(var b=Object.keys(Ea),a=0;a<b.length;a++)(b[a]==_$_af97[404]?window:c).addEventListener(b[a],Ea[b[a]],b[a]==_$_af97[405]||b[a]==_$_af97[406]||b[a]==_$_af97[407]?
{passive:!1}:{})},unbind:function(c){for(var b=Object.keys(Ea),a=0;a<b.length;a++)(b[a]==_$_af97[404]?window:c).removeEventListener(b[a],Ea[b[a]])}};return h}(),ab=function(){var h=function(c){c.getWidth=h[_$_af97[58]];c.setWidth=h[_$_af97[11]]};h[_$_af97[58]]=function(c){var b=this.options.columns;if(typeof c===_$_af97[21]){c=[];for(var a=0;a<b.length;a++)c.push(b[a].width)}else c=b[c].width;return c};h[_$_af97[11]]=function(c,b,a){if(!P.call(this.parent,this))return!1;if(b){if(Array.isArray(c)){a||
(a=[]);for(var d=0;d<c.length;d++){a[d]||(a[d]=this.options.columns[c[d]].width);var e=Array.isArray(b)&&b[d]?b[d]:b;this.options.columns[c[d]].width=e;this.colgroup[c[d]]&&this.colgroup[c[d]].setAttribute(_$_af97[178],e)}}else a||(a=this.options.columns[c].width),this.options.columns[c].width=b,this.colgroup[c]&&this.colgroup[c].setAttribute(_$_af97[178],b);this.refreshBorders();R.call(this.parent,{worksheet:this,action:_$_af97[88],column:c,oldValue:a,newValue:b});L.call(this,_$_af97[88],{column:c,
width:b,oldWidth:a});G.call(this.parent,_$_af97[408],this,c,b,a);H.call(this,!0)}};return h}(),bb=function(){var h=function(b){b.getHeight=h[_$_af97[58]];b.setHeight=h[_$_af97[11]]};h[_$_af97[58]]=function(b){if(void 0===b){b=[];for(var a=0;a<this.rows.length;a++){var d=ca.height.call(this,a);d&&(b[a]=d)}}else b=ca.height.call(this,b);return b};var c=function(b,a){a=parseInt(a);var d=ca.height.call(this,b);this.rows[b].element&&(this.rows[b].element.style.height=a+_$_af97[59]);this.options.rows[b]||
(this.options.rows[b]={});this.options.rows[b].height=a;this.rows[b].height=a;return d};h[_$_af97[11]]=function(b,a,d){if(!P.call(this.parent,this))return!1;var e,g=typeof d==_$_af97[21]?!0:!1;if(a){if(Array.isArray(b))for(!0===g&&(d=[]),e=0;e<b.length;e++){var f=Array.isArray(a)&&a[e]?a[e]:a;c.call(this,b[e],f);1==g&&d.push(g)}else e=c.call(this,b,a),1==g&&(d=e);this.refreshBorders();R.call(this.parent,{worksheet:this,action:_$_af97[89],row:b,oldValue:d,newValue:a});L.call(this,_$_af97[89],{row:b,
height:a,oldHeight:d});G.call(this.parent,_$_af97[409],this,b,a,d);H.call(this,!0)}};return h}(),la=function(){var h=function(f){var k=e[f];f=a[e[f]];if(!f.element){f.element=document.createElement(_$_af97[410]);f.element.innerHTML=f.value;var l=document.createElement(_$_af97[250]);l.type=_$_af97[282];l.value=k;l.o=f;f.element.insertBefore(l,f.element.firstChild)}f.element.firstChild.checked=f.selected;return f.element},c=null,b=null,a=[],d=0,e=null,g=function(f){f.setFilter=g[_$_af97[11]];f.getFilter=
g[_$_af97[58]];f.openFilter=g.open;f.closeFilter=g.close;f.resetFilters=g.reset;f.showFilter=g.show;f.hideFilter=g.hide};g.isVisible=function(){return b};g[_$_af97[11]]=function(f,k){var l=this.headers[f];f=this.options.columns[f];Array.isArray(k)&&0<k.length?(l&&l.classList.add(_$_af97[411]),f.filters=k):(l&&l.classList.remove(_$_af97[411]),f.filters=null);g.update.call(this)};g[_$_af97[58]]=function(f){if(f)return this.options.columns[f].filters||null;f={};for(var k=0;k<this.options.columns.length;k++)f[k]=
this.options.columns[k].filters||null;return f};g.open=function(f){c=parseInt(f);if(this.headers[c].classList.contains(_$_af97[198])){b=!0;var k=this.parent.element.getBoundingClientRect(),l=this.headers[c].getBoundingClientRect();f=l.left-k.left;var n=l.top-k.top+l.height;l=this.parent.filter;k=k.left+k.width;l.style.display=_$_af97[24];f+l.offsetWidth>k&&(f=k-(l.offsetWidth+18));l.style.top=n+_$_af97[59];l.style.left=f+_$_af97[59];l.children[0].focus();f=l.children[1].selectAll;l.children[1].textContent=
_$_af97[3];l.children[1].appendChild(f);f.children[0].checked=this.options.columns[c].filters?!1:!0;f=va.execute.call(this,null,c);f=F.invert(f);l=[];for(k=0;k<this.rows.length;k++)if(f[k]){n=_$_af97[3]+O.call(this,c,k);var q=_$_af97[3]+oa.processed.call(this,c,k,!0);n.substr(0,1)==_$_af97[18]&&(n=q);l.push([n,q])}l.sort(function(p,v){return p[0]>v[0]?1:p[0]<v[0]?-1:0});a=[];for(k=0;k<l.length;k++)a[l[k][0]]={value:l[k][1],element:null};(f=G.call(this.parent,_$_af97[413],this,c,a))&&(a=f);void 0!==
a[_$_af97[3]]&&(delete a[_$_af97[3]],a[_$_af97[3]]={value:_$_af97[240]+E(_$_af97[414])+_$_af97[262],element:null});g.search.call(this,_$_af97[3])}else console.log(_$_af97[412])};g.close=function(f){if(f){f=this.parent.filter.children[1];if(1==f.selectAll.firstChild.checked&&e.length==Object.keys(a).length)f=null;else{f=1==f.currentSelection.firstChild.checked?this.options.columns[c].filters||[]:[];for(var k=0;k<e.length;k++)a[e[k]].selected&&f.push(e[k])}g[_$_af97[11]].call(this,c,f)}this.parent.filter.style.display=
_$_af97[3];this.parent.filter.children[0].value=_$_af97[3];c=null;b=!1;a=null;d=0;e=null};g.reset=function(f){g.updateDOM.call(this,f,!1);za.reset.call(this);g.update.call(this)};g.execute=function(f){for(var k=this.options.columns,l=[],n=0;n<this.options.data.length;n++){for(var q=!0,p=0;p<k.length;p++)if(k[p].filters&&f!==p){var v=_$_af97[3]+O.call(this,p,n),w=_$_af97[3]+this.getLabelFromCoords(p,n,!0);-1==k[p].filters.indexOf(v)&&-1==k[p].filters.indexOf(w)&&(q=!1)}q&&l.push(n)}return l};g.update=
function(){za.reset.call(this);this.resetSelection();this.resetBorders();var f=va.execute.call(this,null);if(typeof this.parent.config.onbeforefilter==_$_af97[104]){var k=g[_$_af97[58]].call(this),l=G.call(this.parent,_$_af97[415],this,k,f);if(l)f=l;else if(!1===l)return!1}this.pageNumber=0;f&&f.length<this.rows.length&&za[_$_af97[11]].call(this,f);fa.refresh.call(this);H.call(this,!0);G.call(this.parent,_$_af97[416],this,k,f)};g.show=function(f){g.updateDOM.call(this,f,!0)};g.hide=function(f){g.updateDOM.call(this,
f,!1,!0);g.update.call(this)};g.search=function(f){for(var k=this.parent.filter.children[1];k.children[1];)k.removeChild(k.lastChild);k.currentSelection.firstChild.checked=!1;if(f){e=[];f=new RegExp(f,_$_af97[417]);for(var l=Object.keys(a),n=0;n<l.length;n++)a[l[n]]&&(_$_af97[3]+a[l[n]].value).match(f)?(e.push(l[n]),a[l[n]].selected=!0):a[l[n]].selected=!1;e.length&&this.options.columns[c].filters&&(k.firstChild.checked=!0,k.appendChild(k.currentSelection))}else{e=Object.keys(a);if(f=this.options.columns[c].filters)for(n=
0;n<e.length;n++)a[e[n]].selected=!1,0<=f.indexOf(e[n])&&(a[e[n]].selected=!0);else for(n=0;n<e.length;n++)a[e[n]].selected=!0;k.firstChild.checked=f?!1:!0}for(n=d=0;n<e.length;n++)200>n&&(f=d++,k.appendChild(h(f)))};g.build=function(){var f=document.createElement(_$_af97[32]);f.className=_$_af97[418];f.onclick=function(q){q.target.tagName==_$_af97[419]&&q.target.o&&(q.target.o.selected=q.target.checked);q=!0;for(var p=1;p<this.children.length;p++)this.children[p].children[0].checked||(q=!1);this.children[0].children[0].checked=
q};var k=document.createElement(_$_af97[250]);k.type=_$_af97[71];k.placeholder=E(_$_af97[420]);k.classList.add(_$_af97[421]);k.classList.add(_$_af97[251]);var l=document.createElement(_$_af97[250]);l.type=_$_af97[422];l.value=_$_af97[423];l.className=_$_af97[424];var n=document.createElement(_$_af97[32]);n.className=_$_af97[425];n.appendChild(k);n.appendChild(f);n.appendChild(l);f.currentSelection=document.createElement(_$_af97[410]);f.currentSelection.innerHTML=_$_af97[426]+E(_$_af97[427]);f.selectAll=
document.createElement(_$_af97[410]);f.selectAll.innerHTML=_$_af97[428]+E(_$_af97[429])+_$_af97[262];f.selectAll.onclick=function(){for(var q=this.children[0].checked,p=1;p<this.parentNode.children.length;p++)this.parentNode.children[p].children[0].checked=q;if(1==q)for(p=0;p<e.length;p++)a[e[p]].selected=!0;else for(q=Object.keys(a),p=0;p<q.length;p++)a[q[p]].selected=!1};jSuites.lazyLoading(f,{loadDown:function(q){for(q=0;d<e.length-1&&10>q;){var p=d++;f.appendChild(h(p));q++}}});return n};g.updateDOM=
function(f,k,l){var n=this.headers,q=function(p){1==k?n[p].classList.add(_$_af97[198]):(this.options.columns[p].filters=null,n[p].classList.remove(_$_af97[411]),1==l&&n[p].classList.remove(_$_af97[198]))};if(f)q.call(this,f);else for(f=0;f<n.length;f++)q.call(this,f)};g.onload=function(){var f,k=!1;if(f=this.options.columns)for(var l=0;l<f.length;l++)Array.isArray(f[l].filters)&&0<f[l].filters.length&&this.headers[l]&&(this.headers[l].classList.add(_$_af97[411]),k=!0);1==k&&g.update.call(this)};return g}(),
za=function(){var h={};h[_$_af97[11]]=function(c){for(var b=0;b<c.length;b++)this.rows[c[b]].results=!0;this.results=c};h.reset=function(){for(var c=0;c<this.rows.length;c++)!0===this.rows[c].results&&delete this.rows[c].results;this.results=null};h.refresh=function(){for(var c=[],b=0;b<this.rows.length;b++)!0===this.rows[b].results&&c.push(b);return c};return h}(),va=function(){var h=function(d){var e=document.createElement(_$_af97[32]);if(0<d.options.pagination&&d.options.paginationOptions&&0<d.options.paginationOptions.length){d.paginationDropdown=
document.createElement(_$_af97[430]);d.paginationDropdown.classList.add(_$_af97[431]);d.paginationDropdown.onchange=function(){d.options.pagination=parseInt(this.value);d.page(0)};for(var g=0;g<d.options.paginationOptions.length;g++){var f=document.createElement(_$_af97[432]);f.value=d.options.paginationOptions[g];f.innerHTML=d.options.paginationOptions[g];d.paginationDropdown.appendChild(f)}d.paginationDropdown.value=d.options.pagination;e.appendChild(document.createTextNode(E(_$_af97[433])));e.appendChild(d.paginationDropdown);
e.appendChild(document.createTextNode(E(_$_af97[434])))}return e},c=function(d){var e=document.createElement(_$_af97[32]);e.innerHTML=E(_$_af97[420])+_$_af97[137];d.searchInput=document.createElement(_$_af97[250]);d.searchInput.classList.add(_$_af97[435]);d.searchInput.classList.add(_$_af97[251]);d.searchInput.oninput=function(){this.parentNode.classList.add(_$_af97[436])};e.appendChild(d.searchInput);return e},b=function(d,e){var g=this.merged.rows;if(g[e]){for(;0<e&&g[e-1];)e--;for(;g[e];)d.push(e++)}else d.push(e)},
a=function(d){d.search=a.update;d.resetSearch=a.reset;d.updateSearch=a.refresh;d.showSearch=a.show;d.hideSearch=a.hide};a.execute=function(d,e){null===d?d=this.searchInput.value||_$_af97[3]:d!==this.searchInput.value&&(this.searchInput.value=d);this.pageNumber=0;var g=[],f=null,k=null,l=null,n=null,q=null;e=la.execute.call(this,e);if(d)try{d=new RegExp(d,_$_af97[417]);if(e&&e.length){var p={};for(k=0;k<e.length;k++)p[e[k]]=!0}else p=null;for(k=0;k<this.rows.length;k++){q=!1;if(!p||p[k])for(f=0;f<
this.options.columns.length;f++){l=_$_af97[3]+O.call(this,f,k);if(l.match(d)){q=!0;break}n=_$_af97[3]+this.getLabelFromCoords(f,k);if(n.match(d)){q=!0;break}}1==q&&b.call(this,g,k)}}catch(v){}else g=e;if(g.length){for(k=0;k<this.rows.length;k++)!0===this.rows[k].results&&g.push(k);g.sort(function(v,w){return v-w})}return g};a.update=function(d){za.reset.call(this);this.resetSelection();this.resetBorders();var e=a.execute.call(this,d);if(typeof this.parent.config.onbeforesearch==_$_af97[104]){var g=
G.call(this.parent,_$_af97[437],this,d,e);if(g)e=g;else if(!1===g)return!1}this.pageNumber=0;e&&e.length<this.rows.length&&za[_$_af97[11]].call(this,e);fa.refresh.call(this);H.call(this,!0);G.call(this.parent,_$_af97[438],this,d,e);this.searchInput.parentNode.classList.remove(_$_af97[436])};a.refresh=function(){H.update.call(this);fa.refresh.call(this)};a.reset=function(){this.searchInput.value=_$_af97[3];za.reset.call(this);H.update.call(this);fa.refresh.call(this)};a.show=function(){this.options.search=
!0;this.searchContainer.style.display=_$_af97[3]};a.hide=function(){this.options.search=!1;this.searchContainer.style.display=_$_af97[52]};a.build=function(){this.searchContainer=document.createElement(_$_af97[32]);this.searchContainer.classList.add(_$_af97[439]);this.searchContainer.appendChild(h(this));this.searchContainer.appendChild(c(this));0==this.options.search&&(this.searchContainer.style.display=_$_af97[52]);this.element.insertBefore(this.searchContainer,this.element.firstChild)};return a}(),
Sa=function(){var h=function(c){c.contextmenu=document.createElement(_$_af97[32]);c.contextmenu.className=_$_af97[440];jSuites.contextmenu(c.contextmenu,{onclick:function(b,a,d){b.close()}});return c.contextmenu};h.open=function(c,b){if(b[0]===_$_af97[441])var a=b[1],d=b[2];else b[0]===_$_af97[442]?(a=null,d=b[1]):b[0]===_$_af97[443]&&(a=b[1],d=null);var e=h[_$_af97[58]](this,a,d,c,b[0],b[1],b[2]);if(typeof this.parent.config.contextMenu==_$_af97[104]){var g=this.parent.config.contextMenu(this,a,
d,c,e,b[0],b[1],b[2]);if(g)e=g;else if(!1===g)return!1}c.preventDefault();g=ua.execute.call(this.parent,_$_af97[105],[this,a,d,c,e,b[0],b[1],b[2]]);e=g[4];this.parent.contextmenu.contextmenu.open(c,e)};h.isOpened=function(){return this.parent.contextmenu.contextmenu.isOpened()};h[_$_af97[58]]=function(c,b,a,d,e,g,f){var k=[],l=c.parent.config,n=-1!=navigator.userAgent.indexOf(_$_af97[444])?_$_af97[445]:_$_af97[446];e==_$_af97[447]&&(1==l.allowRenameWorksheet&&k.push({title:E(_$_af97[448]),onclick:function(){var p=
prompt(E(_$_af97[448]),d.target.innerText);p&&c.parent.renameWorksheet(g,p)}}),1==l.allowDeleteWorksheet&&k.push({title:E(_$_af97[449]),onclick:function(){confirm(E(_$_af97[450]),d.target.innerText)&&c.parent.deleteWorksheet(g)}}),k.push({type:_$_af97[451]}));e==_$_af97[452]&&(k.push({title:E(_$_af97[453]),onclick:function(){var p=prompt(E(_$_af97[453]),d.target.innerText);c.setNestedCell(g,f,{title:p})}}),k.push({type:_$_af97[451]}));if(e==_$_af97[443]||e==_$_af97[442]||e==_$_af97[441]||e==_$_af97[452])k.push({title:E(_$_af97[454]),
icon:_$_af97[455],shortcut:n+_$_af97[456],onclick:function(){c.cut()}}),k.push({title:E(_$_af97[457]),icon:_$_af97[458],shortcut:n+_$_af97[459],onclick:function(){c.copy()}}),navigator&&navigator.clipboard&&navigator.clipboard.readText&&k.push({title:E(_$_af97[460]),icon:_$_af97[461],shortcut:n+_$_af97[462],onclick:function(){c.selectedCell&&navigator.clipboard.readText().then(function(p){p&&c.paste(c.selectedCell[0],c.selectedCell[1],p)})}}),k.push({type:_$_af97[451]});e==_$_af97[443]&&(1==c.options.allowInsertColumn&&
k.push({title:E(_$_af97[463]),onclick:function(){c.insertColumn(1,parseInt(g),1)}}),1==c.options.allowInsertColumn&&k.push({title:E(_$_af97[464]),onclick:function(){c.insertColumn(1,parseInt(g),0)}}),1==c.options.allowDeleteColumn&&k.push({title:E(_$_af97[465]),onclick:function(){c.deleteColumn(c.getSelectedColumns().length?void 0:parseInt(b))}}),1==c.options.allowRenameColumn&&k.push({title:E(_$_af97[466]),onclick:function(){c.setHeader(g)}}),c.options.data.length||(k.push({type:_$_af97[451]}),k.push({title:E(_$_af97[467]),
onclick:function(){c.insertRow(0)}})),1==c.options.columnSorting&&(k.push({type:_$_af97[451]}),k.push({title:E(_$_af97[468]),onclick:function(){c.orderBy(g,0)}}),k.push({title:E(_$_af97[469]),onclick:function(){c.orderBy(g,1)}}),k.push({type:_$_af97[451]})));if(e==_$_af97[441]||e==_$_af97[442])1==c.options.allowInsertRow&&(k.push({title:E(_$_af97[470]),onclick:function(){c.insertRow(1,parseInt(a),1)}}),k.push({title:E(_$_af97[471]),onclick:function(){c.insertRow(1,parseInt(a))}})),1==c.options.allowDeleteRow&&
k.push({title:E(_$_af97[472]),onclick:function(){c.deleteRow(c.getSelectedRows().length?void 0:parseInt(a))}}),k.push({type:_$_af97[451]});if(e==_$_af97[441]&&1==c.options.allowComments){var q=c.records[f][g].element.getAttribute(_$_af97[296])||_$_af97[3];k.push({title:q?E(_$_af97[473]):E(_$_af97[474]),icon:_$_af97[475],onclick:function(){var p=F.getColumnNameFromCoords(g,f),v=prompt(E(_$_af97[476]),q);v&&c.setComments(p,v)}});q&&k.push({title:E(_$_af97[477]),onclick:function(){var p=F.getColumnNameFromCoords(g,
f);c.setComments(p,_$_af97[3])}});k.push({type:_$_af97[451]})}l.allowExport&&k.push({title:E(_$_af97[478]),icon:_$_af97[479],shortcut:n+_$_af97[480],onclick:function(){c.download()}});l.about&&k.push({title:E(_$_af97[481]),icon:_$_af97[482],onclick:function(){!0===l.about?alert(N().print()):alert(l.about)}});return k};return h}(),ma=function(){var h=function(c){c.showToolbar=function(){h.show.call(c.parent)};c.hideToolbar=function(){h.hide.call(c.parent)};c.refreshToolbar=function(){h.update.call(c.parent,
c)}};h[_$_af97[11]]=function(c){this.toolbar.innerHTML=_$_af97[3];this.config.toolbar=h[_$_af97[58]].call(this,c);h.show.call(this)};h[_$_af97[58]]=function(c){c||(c=this.config.toolbar);var b=h.getDefault(c);c?Array.isArray(c)?c={items:c}:typeof c===_$_af97[104]&&(c=c({items:b})):c={};typeof c!==_$_af97[103]&&(c={});c.items||(c.items=b);typeof c.responsive==_$_af97[21]&&(c.responsive=!0,c.bottom=!1,c.maxWidth=this.element.offsetWidth);return c};h.show=function(){this.toolbar.innerHTML||h.build.call(this);
this.toolbar.style.display=_$_af97[3];this.element.classList.add(_$_af97[483])};h.hide=function(){this.toolbar.style.display=_$_af97[52];this.element.classList.remove(_$_af97[483])};h.update=function(c,b){var a=this.toolbarInstance;a&&(a.options.responsive&&(b=this.config.fullscreen?c.element.offsetWidth:c.options.tableWidth?parseInt(c.options.tableWidth):null,a.options.maxWidth=b,a.refresh()),a.update(c),P.call(this,c)?a.setReadonly(!1):a.setReadonly(!0))};h.build=function(){for(var c=h[_$_af97[58]].call(this),
b=0;b<c.items.length;b++)if(c.items[b].type==_$_af97[430]){if(!c.items[b].options&&c.items[b].v){c.items[b].options=[];for(var a=0;a<c.items[b].v.length;a++)c.items[b].options.push(c.items[b].v[a]);c.items[b].k&&(c.items[b].onchange=function(d,e,g,f){u.current.setStyle(u.current.getSelected(!1,!0),g.k,f)})}}else c.items[b].type==_$_af97[287]?(c.items[b].type=_$_af97[484],c.items[b].onclick=function(d,e,g){if(!g.color){var f=null;jSuites.color(g,{onchange:function(k,l){(f=u.current.getSelected(!1,
!0))&&u.current.setStyle(f,g.k,l)},onopen:function(k){var l;u.current.cursor?(l=u.current.cursor.style[g.k])?k.color.select(k.color.toHex(l)):k.color.select(_$_af97[3]):k.color.select(_$_af97[3])}});g.color.open()}}):!c.items[b].onclick&&c.items[b].k&&(c.items[b].onclick=function(){var d=u.current.getSelected(!1,!0);d&&d.length&&u.current.setStyle(d,this.k,this.v)});(b=ua.execute.call(this,_$_af97[106],[c]))&&(c=b[0]);this.toolbarInstance=jSuites.toolbar(this.toolbar,c);this.toolbarInstance.application=
this;c=this.element.tabs.getActive();this.toolbarInstance.update(this.worksheets[c])};h.getDefault=function(c){var b=[];b.push({content:_$_af97[485],onclick:function(){u.current&&u.current.undo()}});b.push({content:_$_af97[486],onclick:function(){u.current&&u.current.redo()}});b.push({content:_$_af97[479],onclick:function(){u.current&&u.current.download()}});b.push({type:_$_af97[487]});b.push({type:_$_af97[430],width:_$_af97[488],options:[_$_af97[489],_$_af97[490],_$_af97[491]],render:function(d){return _$_af97[492]+
d+_$_af97[257]+d+_$_af97[493]},onchange:function(d,e,g,f){u.current&&u.current.setStyle(u.current.getSelected(!1,!0),_$_af97[494],f)}});b.push({type:_$_af97[430],width:_$_af97[495],content:_$_af97[496],options:[_$_af97[497],_$_af97[498],_$_af97[499],_$_af97[500],_$_af97[501]],render:function(d){return _$_af97[502]+d+_$_af97[257]+d+_$_af97[493]},onchange:function(d,e,g,f){u.current&&u.current.setStyle(u.current.getSelected(!1,!0),_$_af97[503],f)}});b.push({type:_$_af97[430],options:[_$_af97[504],_$_af97[505],
_$_af97[506],_$_af97[507]],render:function(d){return _$_af97[508]+d+_$_af97[509]},onchange:function(d,e,g,f){u.current&&u.current.setStyle(u.current.getSelected(!1,!0),_$_af97[510],f.split(_$_af97[511])[2])},updateState:function(d,e,g,f){(d=f.selectedCell)&&d.length&&f.records[d[1]][d[0]].element&&(f=this.picker.options.data.indexOf(_$_af97[512]+(f.records[d[1]][d[0]].element.style.textAlign||f.options.defaultColAlign||_$_af97[210])),g.picker.setValue(f))}});b.push({type:_$_af97[484],content:_$_af97[513],
k:_$_af97[514],v:_$_af97[515]});b.push({type:_$_af97[287],content:_$_af97[516],k:_$_af97[287]});b.push({type:_$_af97[287],content:_$_af97[517],k:_$_af97[518]});if(c===_$_af97[519]||typeof c===_$_af97[104]){var a=[_$_af97[520],_$_af97[521],_$_af97[396]];b.push({type:_$_af97[430],options:[_$_af97[522],_$_af97[523],_$_af97[524]],render:function(d){return _$_af97[508]+d+_$_af97[509]},value:1,onchange:function(d,e,g,f,k){u.current&&u.current.setStyle(u.current.getSelected(!1,!0),_$_af97[525],a[k])},updateState:function(d,
e,g,f){(d=f.selectedCell)&&d.length&&f.records[d[1]][d[0]].element&&(f=a.indexOf(f.records[d[1]][d[0]].element.style.verticalAlign||_$_af97[521]),g.picker.setValue(f))}});b.push({content:_$_af97[526],onclick:function(d,e,g){u.current&&(d=u.current.getHighlighted())&&d.length&&(e=u.helpers.getColumnNameFromCoords(d[0],d[1]),u.current.records[d[1]][d[0]].merged?u.current.removeMerge(e):u.current.setMerge(e,d[2]-d[0]+1,d[3]-d[1]+1))},tooltip:E(_$_af97[527])})}b.push({type:_$_af97[430],data:[_$_af97[528],
_$_af97[529],_$_af97[530],_$_af97[531],_$_af97[532],_$_af97[533],_$_af97[534],_$_af97[535],_$_af97[536],_$_af97[537]],columns:5,render:function(d){return _$_af97[508]+d+_$_af97[509]},right:!0,onchange:function(d,e,g,f,k){if(d=u.current.getHighlighted()){g=e.thickness||1;e=e.color||_$_af97[538];k={};for(var l=d[0],n=d[1],q=d[2],p=d[3],v=d[1];v<=d[3];v++)for(var w=d[0];w<=d[2];w++){var x=F.getColumnNameFromCoords(w,v);k[x]||(k[x]=_$_af97[3]);k[x]=f!=_$_af97[533]&&f!=_$_af97[529]||w!=l?(f==_$_af97[530]||
f==_$_af97[532])&&w>l?k[x]+(_$_af97[539]+g+_$_af97[540]+e+_$_af97[331]):f==_$_af97[528]?k[x]+(_$_af97[539]+g+_$_af97[540]+e+_$_af97[331]):k[x]+_$_af97[541]:k[x]+(_$_af97[539]+g+_$_af97[540]+e+_$_af97[331]);k[x]=f!=_$_af97[528]&&f!=_$_af97[535]&&f!=_$_af97[529]||w!=q?k[x]+_$_af97[543]:k[x]+(_$_af97[542]+g+_$_af97[540]+e+_$_af97[331]);k[x]=f!=_$_af97[534]&&f!=_$_af97[529]||v!=n?(f==_$_af97[530]||f==_$_af97[531])&&v>n?k[x]+(_$_af97[544]+g+_$_af97[540]+e+_$_af97[331]):f==_$_af97[528]?k[x]+(_$_af97[544]+
g+_$_af97[540]+e+_$_af97[331]):k[x]+_$_af97[545]:k[x]+(_$_af97[544]+g+_$_af97[540]+e+_$_af97[331]);k[x]=f!=_$_af97[528]&&f!=_$_af97[536]&&f!=_$_af97[529]||v!=p?k[x]+_$_af97[547]:k[x]+(_$_af97[546]+g+_$_af97[540]+e+_$_af97[331])}Object.keys(k)&&u.current.setStyle(k,null,null,!0)}},onload:function(d,e){var g=document.createElement(_$_af97[32]),f=document.createElement(_$_af97[32]);g.appendChild(f);var k=jSuites.color(f,{closeOnChange:!1,onchange:function(l,n){l.parentNode.children[1].style.color=n;
e.color=n}});f=document.createElement(_$_af97[484]);f.classList.add(_$_af97[548]);f.innerHTML=_$_af97[549];f.onclick=function(){k.open()};g.appendChild(f);d.children[1].appendChild(g);f=document.createElement(_$_af97[32]);jSuites.picker(f,{type:_$_af97[430],data:[1,2,3,4,5],render:function(l){return _$_af97[550]+l+_$_af97[551]},onchange:function(l,n,q,p){e.thickness=p},width:_$_af97[552]});d.children[1].appendChild(f);f=document.createElement(_$_af97[32]);f.style.flex=_$_af97[553];d.children[1].appendChild(f)}});
b.push({type:_$_af97[487]});b.push({content:_$_af97[23],onclick:function(d,e,g){g.children[0].innerText==_$_af97[23]?(u.current.fullscreen(!0),g.children[0].innerText=_$_af97[554]):(u.current.fullscreen(!1),g.children[0].innerText=_$_af97[23])},tooltip:_$_af97[555],updateState:function(d,e,g,f){g.children[0].innerText=1==f.parent.config.fullscreen?_$_af97[554]:_$_af97[23]}});b.push({content:_$_af97[556],onclick:function(d,e,g){g.children[0].innerText==_$_af97[556]?(va.show.call(u.current),g.children[0].innerText=
_$_af97[557]):(va.hide.call(u.current),g.children[0].innerText=_$_af97[556])},tooltip:_$_af97[558],updateState:function(d,e,g,f){g.children[0].innerText=1==f.options.search?_$_af97[557]:_$_af97[556]}});return b};return h}(),pa=function(){var h=function(c){c.createWorksheet=function(b){return c.parent.createWorksheet(b)};c.deleteWorksheet=function(b){return c.parent.deleteWorksheet(b)};c.renameWorksheet=function(b,a){return c.parent.renameWorksheet(b,a)};c.moveWorksheet=function(b,a){return c.parent.moveWorksheet(b,
a)};c.openWorksheet=function(){return c.parent.openWorksheet(c.parent.getWorksheet(c))};c.getWorksheet=function(b){return c.parent.getWorksheet(b)};c.getWorksheetActive=function(){return c.parent.getWorksheetActive()};c.getWorksheetName=function(){return c.options.worksheetName.toUpperCase()}};h.nextName=function(){var c=1,b,a=u.spreadsheet;if(a.length)for(var d=0;d<a.length;d++){var e=a[d].worksheets;if(e.length)for(var g=0;g<e.length;g++)e[g].options.worksheetName&&(b=e[g].options.worksheetName.match(/(\d+)/))&&
(b=parseInt(b[0])+1,b>c&&(c=b))}return c};h.createWorksheet=function(c){if(!P.call(this))return!1;c||(c={});var b=this.worksheets.length,a=G.call(this,_$_af97[559],c,b);if(typeof a===_$_af97[103])c=a;else if(!1===a)return!1;c.data||c.minDimensions||(c.minDimensions=[8,8]);c.worksheetId||(c.worksheetId=jSuites.guid().substring(0,8));c.worksheetName||(c.worksheetName=_$_af97[398]+h.nextName());if(J(c.worksheetName))jSuites.notification({error:_$_af97[553],message:_$_af97[560]});else return a=ta.worksheet(this,
c),a.onload(),u.current&&u.current.resetSelection(),u.current=a,L.call(a,_$_af97[561],[c]),ma.update.call(this,u.current),G.call(this,_$_af97[562],a,c,b),a};h.deleteWorksheet=function(c){var b=this.worksheets[c];if(!P.call(this,b))return!1;J(b.options.worksheetName,null);this.element.tabs.deleteElement(c);this.worksheets.splice(c,1);L.call(b,_$_af97[563],[c]);G.call(this,_$_af97[564],b,c)};h.renameWorksheet=function(c,b){var a=this.worksheets[c];if(!P.call(this,a))return!1;var d=a.options.worksheetName;
if(d.toLowerCase()==b.toLowerCase())return!1;b=b.replace(/[^0-9A-Za-z_\s^]+/gi,_$_af97[3]);Number(b)==b&&(b=_$_af97[398]+Number(b));J(b)?alert(_$_af97[565]):(J(d,null),this.element.tabs.rename(c,b),a.options.worksheetName=b,J(b,a),R.call(this,{worksheet:a,action:_$_af97[98],index:c,oldValue:d,newValue:b}),L.call(a,_$_af97[98],{worksheet:c,newValue:b}),Ia.updateWorksheetName.call(a,d,b),Z.updateWorksheetNames.call(a,d,b),G.call(this,_$_af97[566],a,c,b,d))};h.updateWorksheet=function(c,b){var a=this.worksheets;
if(!P.call(this))return!1;this.worksheets.splice(b,0,a.splice(c,1)[0]);R.call(this,{worksheet:a[b],action:_$_af97[99],f:c,t:b});L.call(a[b],_$_af97[99],{f:c,t:b});G.call(this,_$_af97[567],a[b],c,b)};h.moveWorksheet=function(c,b){this.element.tabs.move(c,b)};h.openWorksheet=function(c){var b=this.worksheets[c];!b||u.current&&u.current==b||(this.element.tabs.getActive()!=c?this.element.tabs.open(c):this.element.tabs.setBorder(c),u.current&&u.current.resetSelection(),u.current=b,u.current.refreshBorders(),
h.state.call(this,c),ma.update.call(this,u.current),G.call(this,_$_af97[568],b,c))};h.getWorksheet=function(c){if(c&&typeof c==_$_af97[103]){if(c=this.worksheets.indexOf(c),0<=c)return c}else for(var b=0;b<this.worksheets.length;b++)if(c===this.worksheets[b].options.worksheetId)return b;return!1};h.getWorksheetActive=function(){return this.element.tabs.getActive()};h.getWorksheetInstance=function(c){return c===_$_af97[3]||typeof c==_$_af97[25]?(c=h.getWorksheet.call(this,c),!1===c?!1:this.worksheets[c]):
this.worksheets[c]};h.state=function(c){try{if(typeof localStorage!==_$_af97[21]){var b=this.config.cloud?this.config.cloud:this.element.id;if(b)if(typeof c!==_$_af97[21])localStorage.setItem(_$_af97[375]+b,c);else{var a=parseInt(localStorage.getItem(_$_af97[375]+b));h.openWorksheet.call(this,a)}}}catch(d){}};return h}(),F=function(){var h={getCaretIndex:function(c){var b=0,a=(this.config.root?this.config.root:window).getSelection();a&&0!==a.rangeCount&&(b=a.getRangeAt(0),a=b.cloneRange(),a.selectNodeContents(c),
a.setEnd(b.endContainer,b.endOffset),b=a.toString().length);return b},invert:function(c){for(var b=[],a=Object.keys(c),d=0;d<a.length;d++)b[c[a[d]]]=a[d];return b},getColumnName:function(c){var b=_$_af97[3];701<c?(b+=String.fromCharCode(64+parseInt(c/676)),b+=String.fromCharCode(64+parseInt(c%676/26))):25<c&&(b+=String.fromCharCode(64+parseInt(c/26)));return b+=String.fromCharCode(65+c%26)},getColumnNameFromCoords:function(c,b){return h.getColumnName(parseInt(c))+(parseInt(b)+1)},getCoordsFromColumnName:function(c){if(!c)return[];
c=(_$_af97[3]+c).replace(new RegExp(/\$/),_$_af97[3]);var b=/^[a-zA-Z]+/.exec(c);if(b){for(var a=0,d=0;d<b[0].length;d++)a+=parseInt(b[0].charCodeAt(d)-64)*Math.pow(26,b[0].length-1-d);a--;0>a&&(a=0);c=parseInt(/[0-9]+$/.exec(c))||null;0<c&&c--;return[a,c]}}};h.shiftFormula=Z.shiftFormula;h.updateWorksheetName=Z.updateWorksheetName;h.createFromTable=function(c,b){if(c.tagName!=_$_af97[569])console.log(_$_af97[570]);else{b||(b={});b.columns=[];b.data=[];var a=c.querySelectorAll(_$_af97[571]);if(a.length)for(var d=
0;d<a.length;d++){var e=a[d].style.width;e||(e=a[d].getAttribute(_$_af97[178]));e&&(b.columns[d]||(b.columns[d]={}),b.columns[d].width=e)}e=function(A){var z=A.getBoundingClientRect();z=50<z.width?z.width:50;b.columns[d]||(b.columns[d]={});A.getAttribute(_$_af97[572])?b.columns[d].type=A.getAttribute(_$_af97[572]):b.columns[d].type=_$_af97[71];b.columns[d].width=z+_$_af97[59];b.columns[d].title=A.innerHTML;A.style.textAlign&&(b.columns[d].align=A.style.textAlign);A.classList.contains(_$_af97[573])&&
(b.columns[d].readOnly=!0);if(z=A.getAttribute(_$_af97[574]))b.columns[d].name=z;if(z=A.getAttribute(_$_af97[575]))b.columns[d].id=z};var g=[],f=c.querySelectorAll(_$_af97[576]);if(f.length){for(a=0;a<f.length-1;a++){var k=[];for(d=0;d<f[a].children.length;d++){var l={title:f[a].children[d].innerText,colspan:f[a].children[d].getAttribute(_$_af97[190])||1};k.push(l)}g.push(k)}f=f[f.length-1].children;for(d=0;d<f.length;d++)e(f[d])}l=0;var n={},q={},p={},v={},w=null;k=c.querySelectorAll(_$_af97[577]);
for(a=0;a<k.length;a++)if(b.data[l]=[],1!=b.parseTableFirstRowAsHeader||f.length||0!=a){for(d=0;d<k[a].children.length;d++){var x=k[a].children[d].getAttribute(_$_af97[578]);x?x.substr(0,1)!=_$_af97[18]&&(x=_$_af97[18]+x):x=k[a].children[d].innerHTML;b.data[l].push(x);x=F.getColumnNameFromCoords(d,a);(w=k[a].children[d].getAttribute(_$_af97[579]))&&(v[x]=w);w=parseInt(k[a].children[d].getAttribute(_$_af97[190]))||0;var y=parseInt(k[a].children[d].getAttribute(_$_af97[191]))||0;if(w||y)n[x]=[w||1,
y||1];if(w=k[a].children[d].style&&k[a].children[d].style.display==_$_af97[52])k[a].children[d].style.display=_$_af97[3];(w=k[a].children[d].getAttribute(_$_af97[120]))&&(p[x]=w);k[a].children[d].classList.contains(_$_af97[580])&&(p[x]=p[x]?p[x]+_$_af97[581]:_$_af97[582])}k[a].style&&k[a].style.height&&(q[a]={height:k[a].style.height});l++}else for(d=0;d<k[a].children.length;d++)e(k[a].children[d]);0<Object.keys(g).length&&(b.nestedHeaders=g);0<Object.keys(p).length&&(b.style=p);0<Object.keys(n).length&&
(b.mergeCells=n);0<Object.keys(q).length&&(b.rows=q);0<Object.keys(v).length&&(b.classes=v);k=c.querySelectorAll(_$_af97[583]);if(k.length){c=[];for(a=0;a<k.length;a++){e=[];for(d=0;d<k[a].children.length;d++)e.push(k[a].children[d].innerText);c.push(e)}0<Object.keys(c).length&&(b.footers=c)}if(1==b.parseTableAutoCellType)for(c=[],d=0;d<b.columns.length;d++){g=e=!0;c[d]=[];for(a=0;a<b.data.length;a++)if(x=b.data[a][d],c[d][x]||(c[d][x]=0),c[d][x]++,25<x.length&&(e=!1),10==x.length){if(x.substr(4,
1)!=_$_af97[236]||x.substr(7,1)!=_$_af97[236])g=!1}else g=!1;a=Object.keys(c[d]).length;g?b.columns[d].type=_$_af97[584]:1==e&&1<a&&a<=parseInt(.1*b.data.length)&&(b.columns[d].type=_$_af97[73],b.columns[d].source=Object.keys(c[d]))}return b}};h.injectArray=function(c,b,a){return c.slice(0,b).concat(a).concat(c.slice(b))};h.parseCSV=function(c,b){b=b||_$_af97[37];for(var a=0,d=0,e=[[]],g=0,f=null,k=!1,l=!1,n=0;n<c.length;n++)if(e[d]||(e[d]=[]),e[d][a]||(e[d][a]=_$_af97[3]),c[n]!=_$_af97[585])if(c[n]!=
_$_af97[586]&&c[n]!=b||0!=k&&1!=l&&f){c[n]==_$_af97[20]&&(k=!k);if(null===f){if(f=k,1==f)continue}else if(!0===f&&!l&&c[n]==_$_af97[20]){c[n+1]==_$_af97[20]?(k=!0,e[d][a]+=c[n],n++):l=!0;continue}e[d][a]+=c[n]}else{f=null;l=k=!1;if(e[d][a][0]==_$_af97[20]){var q=e[d][a].trim();q[q.length-1]==_$_af97[20]&&(e[d][a]=q.substr(1,q.length-2))}c[n]==_$_af97[586]?(a=0,d++):(a++,a>g&&(g=a))}for(c=0;c<e.length;c++)for(n=0;n<=g;n++)void 0===e[c][n]&&(e[c][n]=_$_af97[3]);return e};h.getTokensFromRange=Z.getTokensFromRange;
h.getRangeFromTokens=Z.getRangeFromTokens;h.getCoordsFromRange=function(c){-1!==c.indexOf(_$_af97[19])&&(c=c.split(_$_af97[19]),c=c[1]);c=c.split(_$_af97[157]);c[1]||(c[1]=c[0]);var b=F.getCoordsFromColumnName(c[0]);c=F.getCoordsFromColumnName(c[1]);return[b[0],b[1],c[0],c[1]]};return h}(),Ea=function(){var h={},c=null,b=null,a=null,d=null,e=!1,g=null,f=null,k=null,l=function(r){function C(V){V.className&&(V.classList.contains(_$_af97[389])&&(M=V),V.classList.contains(_$_af97[401])&&(T=V),V.classList.contains(_$_af97[587])&&
(U=V));V.parentNode&&V.parentNode.classList&&V.parentNode.classList.contains(_$_af97[370])&&(V.tagName==_$_af97[588]?B=1:V.tagName==_$_af97[589]?B=2:V.tagName==_$_af97[590]&&(B=3));V.parentNode&&!M&&C(V.parentNode)}var B=null,D=null,M=null,T=null,U=null,K=null,X=null,Y=null;C(r.target);if(null!==U)return!1;if(M)if(r.target.classList.contains(_$_af97[368]))D=_$_af97[591];else if(r.target.classList.contains(_$_af97[378]))D=_$_af97[159];else if(r.target.classList.contains(_$_af97[302]))D=_$_af97[442],
K=parseInt(r.target.getAttribute(_$_af97[57]));else if(r.target.parentNode&&r.target.parentNode.classList&&r.target.parentNode.classList.contains(_$_af97[206]))K=r.target.getAttribute(_$_af97[211]),X=r.target.getAttribute(_$_af97[212]),null===K?D=_$_af97[591]:(D=_$_af97[452],K=parseInt(K),X=parseInt(X));else if(r.target.parentNode&&r.target.parentNode.classList&&r.target.parentNode.classList.contains(_$_af97[172]))D=_$_af97[592];else if(r.target.classList.contains(_$_af97[176]))D=_$_af97[592];else if(r.target.parentNode&&
r.target.parentNode.classList&&r.target.parentNode.classList.contains(_$_af97[593]))D=_$_af97[447],K=Array.prototype.indexOf.call(r.target.parentNode.children,r.target);else if(1==B)D=_$_af97[443],K=r.target.clientWidth-r.offsetX,r.target.classList.contains(_$_af97[198])&&3<K&&20>K&&(D=_$_af97[594]),K=r.target.getAttribute(_$_af97[56]);else if(2==B){if(r=n(r,M))D=_$_af97[441],K=r[0],X=r[1],Y=r[2]}else if(3==B){if(K=r.target.getAttribute(_$_af97[56]),X=r.target.getAttribute(_$_af97[57]),K||X)D=_$_af97[595]}else B||
jSuites.findElement(r.target,_$_af97[596])&&(D=_$_af97[106]);return[M,T,B,D,K,X,Y]},n=function(r,C){if(r.changedTouches&&r.changedTouches[0]){var B=r.changedTouches[0].clientX;r=r.changedTouches[0].clientY}else B=r.clientX,r=r.clientY;C=C.spreadsheet.config.root?C.spreadsheet.config.root:document;if(C.elementsFromPoint)var D=C.elementsFromPoint(B,r);else C.msElementsFromPoint&&(D=C.msElementsFromPoint(B,r));for(C=0;C<D.length;C++)if(B=D[C].getAttribute(_$_af97[56]),r=D[C].getAttribute(_$_af97[57]),
null!=B&&null!=r)return B=parseInt(B),r=parseInt(r),[B,r,D[C]];return!1},q=function(r){var C=l(r);if(!1===C)return!1;C[0]?C[1]?u.current&&document.activeElement.classList.contains(_$_af97[114])?document.activeElement.worksheet||(document.activeElement.worksheet=C[1].jexcel):u.current!=C[1].jexcel&&(u.current&&u.current.resetSelection(),u.current=C[1].jexcel):u.current||(r=C[0].tabs.getActive(),0<=r&&(u.current=C[0].spreadsheet.worksheets[r])):u.current&&!jSuites.findElement(r.target,_$_af97[251])&&
(u.current.resetSelection(!0),u.current=null);return C};h.input=function(r){if(r.target.tagName==_$_af97[597]&&r.target.classList.contains(_$_af97[114])){var C=null;r.target.worksheet?C=r.target.worksheet:u.current&&(C=u.current);C&&ra.parse.call(C,r.target)}};h.keydown=function(r){if(u.current){r.target.tagName==_$_af97[597]&&r.target.classList.contains(_$_af97[114])&&ra.onkeydown.call(u.current,r);if(27==r.which){if(u.current.edition){u.current.closeEditor(u.current.edition,!1);r.preventDefault();
return}if(wa.event){wa.cancel.call(u.current,r);r.preventDefault();return}if(ha.event){ha.cancel.call(u.current,r);return}if(1==la.isVisible()){la.close.call(u.current,!1);r.preventDefault();return}}if(r.target.classList.contains(_$_af97[421])){var C=r.target;g&&clearTimeout(g);g=setTimeout(function(){la.search.call(u.current,C.value);g=null},500)}else if(r.target.classList.contains(_$_af97[435]))C=r.target,g&&clearTimeout(g),g=setTimeout(function(){u.current.search(C.value);g=null},400);else if(!r.target.classList.contains(_$_af97[251]))if(u.current.edition){var B=
u.current.edition.getAttribute(_$_af97[56]);13==r.which?u.current.options.columns[B].type==_$_af97[584]?u.current.closeEditor(u.current.edition,!0):u.current.options.columns[B].type!=_$_af97[73]&&u.current.options.columns[B].type!=_$_af97[598]&&u.current.options.columns[B].type!=_$_af97[475]&&(r.altKey?u.current.parent.input.classList.contains(_$_af97[599])||document.execCommand(_$_af97[600],!1,_$_af97[601]):(u.current.closeEditor(u.current.edition,!0),u.current.parent.config.moveDownOnEnter&&u.current.down(),
r.preventDefault())):9==r.which?(u.current.closeEditor(u.current.edition,!0),u.current.right(),r.preventDefault()):39!=r.which&&37!=r.which&&38!=r.which&&40!=r.which||u.current.parent.input.selected||(u.current.closeEditor(u.current.edition,!0),37==r.which?u.current.left(r.shiftKey,r.ctrlKey):39==r.which?u.current.right(r.shiftKey,r.ctrlKey):38==r.which?u.current.up(r.shiftKey,r.ctrlKey):40==r.which&&u.current.down(r.shiftKey,r.ctrlKey),r.preventDefault())}else{if((r.ctrlKey||r.metaKey)&&!r.shiftKey){if(65==
r.which){u.current.selectAll();r.preventDefault();return}if(83==r.which){u.current.download();r.preventDefault();return}if(89==r.which){u.current.parent.redo();r.preventDefault();return}if(90==r.which){u.current.parent.undo();r.preventDefault();return}if(70==r.which&&u.search){u.current.parent.tools.search(!0);r.preventDefault();return}}if(u.current.selectedCell)if(33==r.which)0<u.current.options.pagination?Ca.pageUp.call(u.current):r.altKey?H.pageLeft.call(u.current):H.pageUp.call(u.current);else if(34==
r.which)0<u.current.options.pagination?Ca.pageDown.call(u.current):r.altKey?H.pageRight.call(u.current):H.pageDown.call(u.current);else if(37==r.which)u.current.left(r.shiftKey,r.ctrlKey),r.preventDefault();else if(39==r.which)u.current.right(r.shiftKey,r.ctrlKey),r.preventDefault();else if(38==r.which)u.current.up(r.shiftKey,r.ctrlKey),r.preventDefault();else if(40==r.which)u.current.down(r.shiftKey,r.ctrlKey),r.preventDefault();else if(36==r.which)u.current.first(r.shiftKey,r.ctrlKey),r.preventDefault();
else if(35==r.which)u.current.last(r.shiftKey,r.ctrlKey),r.preventDefault();else if(32==r.which)u.current.setCheckRadioValue(),r.preventDefault();else if(46==r.which||8==r.which)u.current.isEditable()&&u.current.setValue(u.current.getSelected(!1,!0),_$_af97[3]);else if(13==r.which)r.shiftKey?u.current.up():(1==u.current.options.allowManualInsertRow&&u.current.selectedCell[1]==(u.current.results?u.current.results[u.current.results.length-1]:u.current.rows.length-1)&&u.current.insertRow(null,null,null,
null,r),u.current.selectedCell&&u.current.down()),r.preventDefault();else if(9==r.which)r.shiftKey?u.current.left():(B=u.current.selectedCell[0],u.current.right(),1==u.current.options.allowInsertColumn&&1==u.current.options.allowManualInsertColumn&&u.current.selectedCell[0]==B&&(u.current.insertColumn(null,null,null,null,null,null,r),u.current.right())),r.preventDefault();else if((r.ctrlKey||r.metaKey)&&!r.shiftKey)67==r.which?(u.current.copy(),r.preventDefault()):88==r.which?(u.current.cut(),r.preventDefault()):
86==r.which?r.target.classList.contains(_$_af97[251])||h.paste(r):189==r.which&&(1==u.current.options.allowDeleteRow&&k[3]==_$_af97[442]?(ka.isValid.call(u.current,u.current.selectedCell)&&u.current.deleteRow(),r.preventDefault()):1==u.current.options.allowDeleteColumn&&k[3]==_$_af97[443]&&(ka.isValid.call(u.current,u.current.selectedCell)&&u.current.deleteColumn(),r.preventDefault()));else if(u.current.isEditable()){B=u.current.selectedCell[1];var D=u.current.selectedCell[0];u.current.options.columns[D].type!=
_$_af97[26]&&(32==r.keyCode?u.current.options.columns[D].type==_$_af97[282]||u.current.options.columns[D].type==_$_af97[284]?r.preventDefault():u.current.openEditor(u.current.records[B][D].element,!0,r):113==r.keyCode?u.current.openEditor(u.current.records[B][D].element,!1,r):1!=r.key.length&&r.key!=_$_af97[602]||r.altKey||r.ctrlKey||u.current.records[B]&&u.current.openEditor(u.current.records[B][D].element,!0,r))}}}};var p=[0,0],v=function(r){e&&H.limited.call(u.current)&&(f&&(clearTimeout(f),f=
null),f=setTimeout(function(){if(e){var C=p[0],B=p[1],D=u.current.content.getBoundingClientRect();50>D.height-(B-D.top)?H.down.call(u.current):80>B-D.top&&H.up.call(u.current);50>D.width-(C-D.left)?H.right.call(u.current):80>C-D.left&&H.left.call(u.current);v(r)}f=null},100))},w=function(r,C,B,D,M,T,U){if(document.activeElement.classList.contains(_$_af97[114])&&ra.update.call(u.current,r,C,B,D,M,document.activeElement,U))return!1;if(u.current.edition)u.current.closeEditor(u.current.edition,!0);else if(d&&
d!==T)return!1;u.current!==U&&(u.current.resetSelection(),u.current=U);ra.current?ra.range.call(u.current,r,C,B,D,M):ka[_$_af97[11]].call(u.current,r,C,B,D,M)};h.mousedown=function(r){r=r||window.event;var C=r.buttons?r.buttons:r.button?r.button:r.which;if(u.current)if(1==la.isVisible()&&(jSuites.findElement(r.target,_$_af97[425])||la.close.call(u.current,!1)),u.current.edition){if(jSuites.findElement(r.target,_$_af97[121]))return!1}else if(jSuites.findElement(r.target,_$_af97[251]))return!1;var B=
q(r);if(!1===B)return!1;k=B;if(1<C)if(B[3]==_$_af97[441]){if(u.current.isSelected(B[4],B[5]))return!1}else if(B[3]==_$_af97[442]){if(u.current.isSelected(0,B[4]))return!1}else if(B[3]==_$_af97[443]&&u.current.isSelected(B[4],0))return!1;if(u.current){if(B[3]==_$_af97[159])u.current.isEditable()&&(ha.event=!0);else if(B[3]==_$_af97[594])la.open.call(u.current,B[4]);else{if(1==B[2])if(c)c.style.cursor==_$_af97[603]?wa.start.call(u.current,r):c.style.cursor==_$_af97[604]?Ba.start.call(u.current,r):c.style.cursor==
_$_af97[605]&&(!0===c.column?ba.start.call(u.current,r,0):!1===c.column?ja.start.call(u.current,r,0):ba.start.call(u.current,r,parseInt(B[4])+1));else{C=u.current.options.columns.length-1;var D=u.current.options.data.length-1;if(B[3]==_$_af97[591])w(0,0,C,D,r,B[3],B[1].jexcel),a=b=0;else if(B[3]==_$_af97[452]){var M=ya.range.call(u.current,B[5])[B[4]];M[1]>C&&(M[1]=C);w(M[0],0,M[1],D,r,B[3],B[1].jexcel);b=M[0];a=0}else B[4]&&((r.shiftKey||r.ctrlKey)&&null!=b&&null!=a?w(b,0,B[4],D,r,B[3],B[1].jexcel):
(B[3]==_$_af97[443]&&b==B[4]&&1==u.current.options.allowRenameColumn&&(f=setTimeout(function(){u.current.setHeader(B[4])},800)),w(B[4],0,B[4],D,r,B[3],B[1].jexcel),b=B[4],a=0))}if(2==B[2])if(B[3]==_$_af97[442])c?c.style.cursor==_$_af97[603]?wa.start.call(u.current,r):c.style.cursor==_$_af97[606]?Ba.start.call(u.current,r):c.style.cursor==_$_af97[605]&&ja.start.call(u.current,r,parseInt(B[4])+1):(C=u.current.options.columns.length-1,D=parseInt(B[4]),(r.shiftKey||r.ctrlKey)&&null!=b&&null!=a?w(0,a,
C,D,r,B[3],B[1].jexcel):(w(0,D,C,D,r,B[3],B[1].jexcel),b=0,a=D));else if(B[3]==_$_af97[441]){C=parseInt(B[4]);D=parseInt(B[5]);if(!u.current.edition&&(M=u.current.options.columns[B[4]].type,r.target.tagName==_$_af97[607]&&(M==_$_af97[285]||M==_$_af97[286])&&r.target.parentNode.classList.contains(_$_af97[147]))){var T=r.target.innerText;M==_$_af97[285]&&(T=_$_af97[608]+T);window.open(T,_$_af97[609])}(r.shiftKey||r.ctrlKey)&&u.current.selectedCell?w(u.current.selectedCell[0],u.current.selectedCell[1],
C,D,r,B[3],B[1].jexcel):(w(C,D,C,D,r,B[3],B[1].jexcel),b=C,a=D)}}d=B[3];typeof B[3]!==_$_af97[21]&&G.call(u.current.parent,_$_af97[610],u.current,B[3],B[4],B[5]);e=!0;B[3]!==_$_af97[441]&&B[3]!==_$_af97[159]||v(r)}else e=!1};h.mouseup=function(r){u.current&&(wa.event?wa.end.call(u.current,r):Ba.event?Ba.end.call(u.current,r):ba.event?ba.end.call(u.current,r):ja.event?ja.end.call(u.current,r):ha.event?ha.end.call(u.current,r):r.target.classList.contains(_$_af97[424])?la.close.call(u.current,!0):u.current.edition&&
r.target.classList.contains(_$_af97[611])&&50>r.target.clientWidth-r.offsetX&&50>r.offsetY?na.close.call(u.current,null,!0):r.target.classList.contains(_$_af97[354])&&(r=r.target.innerText==_$_af97[15]?0:r.target.innerText==_$_af97[17]?r.target.getAttribute(_$_af97[296])-1:r.target.innerText-1,Ca[_$_af97[11]].call(u.current,parseInt(r))));f&&(clearTimeout(f),f=null);e=d=!1;ra.current&&ra.close.call(u.current)};h.mousemove=function(r){r=r||window.event;if(r.changedTouches&&r.changedTouches[0]){var C=
r.changedTouches[0].clientX;var B=r.changedTouches[0].clientY}else C=r.clientX,B=r.clientY;p=[C,B];if(u.current)if(C=r.target.getAttribute(_$_af97[56]),B=r.target.getAttribute(_$_af97[57]),1==e)wa.event?wa.update.call(u.current,r):Ba.event?Ba.update.call(u.current,r):ba.event?ba.move.call(u.current,r):ja.event?ja.move.call(u.current,r):u.current.options.tableOverflow&&(r=u.current.content,(r.w&&r.w!==r.offsetWidth||r.h&&r.h!==r.offsetHeight)&&u.current.setViewport(r.offsetWidth,r.offsetHeight),r.w=
r.offsetWidth,r.h=r.offsetHeight);else{var D=r.target.getBoundingClientRect();c&&(c.style.cursor=_$_af97[3],c=null);1==u.current.options.editable&&r.target&&(r.target.classList.contains(_$_af97[368])?u.current.options.freezeRowControl&&!u.current.options.freezeRows&&5>D.height-(r.clientY-D.top)?(c=r.target,c.style.cursor=_$_af97[605],c.column=!1):u.current.options.freezeColumnControl&&!u.current.options.freezeColumns&&5>D.width-(r.clientX-D.left)&&(c=r.target,c.style.cursor=_$_af97[605],c.column=
!0):r.target.classList.contains(_$_af97[302])?u.current.options.freezeRowControl&&u.current.options.freezeRows==parseInt(B)+1&&5>D.height-(r.clientY-D.top)?(c=r.target,c.style.cursor=_$_af97[605]):6>D.width-(r.clientX-D.left)?(c=r.target,c.style.cursor=_$_af97[603]):6>D.height-(r.clientY-D.top)&&(c=r.target,c.style.cursor=_$_af97[606]):r.target.classList.contains(_$_af97[195])&&(u.current.options.freezeColumnControl&&u.current.options.freezeColumns==parseInt(C)+1&&5>D.width-(r.clientX-D.left)?(c=
r.target,c.style.cursor=_$_af97[605]):1==u.current.options.rowResize&&6>D.width-(r.clientX-D.left)?(c=r.target,c.style.cursor=_$_af97[604]):1==u.current.options.columnDrag&&6>D.height-(r.clientY-D.top)&&(c=r.target,c.style.cursor=_$_af97[603])))}};h.mouseover=function(r){r=r||window.event;if(u.current&&1==e){var C=l(r);if(C[0]){if(!document.activeElement.classList.contains(_$_af97[114])&&C[1]&&u.current!=C[1].jexcel&&u.current)return!1;if(!(wa.event||Ba.event||ba.event||ja.event))if(ha.event){var B=
r.target.getAttribute(_$_af97[56]),D=r.target.getAttribute(_$_af97[57]);u.current.isSelected(B,D)||null===B||null===D||ha.call(u.current,B,D)}else null!==b&&null!==a&&(1==C[2]&&(B=b,C[3]==_$_af97[443]&&(B=r.target.getAttribute(_$_af97[56])),D=u.current.options.data.length-1,w(b,0,B,D,r,C[3],C[1].jexcel)),2==C[2]&&(C[3]==_$_af97[442]?(B=u.current.options.columns.length-1,D=parseInt(r.target.getAttribute(_$_af97[57])),w(0,a,B,D,r,C[3],C[1].jexcel)):C[3]==_$_af97[441]&&(B=C[4],D=C[5],w(b,a,B,D,r,C[3],
C[1].jexcel))))}}};h.dblclick=function(r){if(u.current)if(r.target.classList.contains(_$_af97[378]))ha.execute.call(u.current,!1);else{var C=l(r);1==C[2]?1==u.current.options.columnSorting&&(r=r.target.getAttribute(_$_af97[56]))&&u.current.orderBy(r):2==C[2]&&u.current.isEditable()&&!u.current.edition&&C[6]&&u.current.openEditor(C[6],null,r)}};h.paste=function(r){if(!r.target.classList.contains(_$_af97[251])&&u.current&&u.current.selectedCell&&!u.current.edition){var C=r.clipboardData||window.clipboardData;
C&&(u.current.paste(u.current.selectedCell[0],u.current.selectedCell[1],C.getData(_$_af97[71])),r&&r.preventDefault())}};h.contextmenu=function(r){var C=q(r);!1!==C&&(C[1]||(C=k),u.current&&!u.current.edition&&(C=Array.prototype.slice.call(C,3),Sa.open.call(u.current,r,C)))};var x=null,y=null,A=null,z=null,I=null;h.touchstart=function(r){var C=l(r);C[0]?C[1]&&u.current!=C[1].jexcel&&(u.current&&u.current.resetSelection(),u.current=C[1].jexcel):u.current&&(u.current.resetSelection(),u.current=null);
u.current&&!u.current.edition?C[3]==_$_af97[159]?u.current.isEditable()&&(ha.event=!0):r.target&&r.target.classList.contains(_$_af97[162])?I=parseInt(r.target.getAttribute(_$_af97[163])):C[3]==_$_af97[441]?(z=C,x===r.target&&y?u.current.openEditor(r.target,!1,r):(y=setTimeout(function(){x=y=z=null},400),A=setTimeout(function(){h.contextmenu(r);A=null},800)),x=r.target):z=null:z=null};h.touchmove=function(r){if(u.current){var C=null,B=null,D=null,M=null;if(r.changedTouches&&r.changedTouches[0]){var T=
r.changedTouches[0].clientX;var U=r.changedTouches[0].clientY}else T=r.clientX,U=r.clientY;if(U=document.elementFromPoint(T,U))if(T=U.getAttribute(_$_af97[56]),U=U.getAttribute(_$_af97[57]),null!==T&&null!==U&&ha.event)u.current.isSelected(T,U)||(ha.call(u.current,T,U),v(r)),r.preventDefault();else if(null!==I){T=parseInt(T);U=parseInt(U);var K=u.current.selectedCell;0==I?T<=K[2]&&(C=T,D=K[2],B=K[1],M=K[3]):2==I?T>=K[0]&&(C=K[0],B=K[1],D=T,M=K[3]):1==I?U<=K[3]&&(C=K[0],B=U,D=K[2],M=K[3]):3==I&&U>=
K[1]&&(C=K[0],B=K[1],D=K[2],M=U);null!==C&&u.current.updateSelectionFromCoords(C,B,D,M);r.preventDefault()}else z=null;A&&clearInterval(A)}};h.touchend=function(r){if(ha.event)ha.end.call(u.current,r);else if(null!==I)I=null;else if(z){r=null;if(z[3]===_$_af97[441]){var C=z[4];var B=z[5];var D=C;r=B}else z[3]===_$_af97[442]?(C=0,B=z[4],D=u.current.options.columns.length-1,r=B):z[3]===_$_af97[443]&&(C=z[4],B=0,D=C,r=u.current.rows.length-1);null!=C&&u.current.updateSelectionFromCoords(C,B,D,r)}A&&
clearInterval(A)};h.resize=function(){u.current&&1==u.current.parent.config.fullscreen&&H.call(u.current,!0)};return h}(),u=function(h,c,b){if(h){c||(c={});if(!u.defaultRowHeight){var a=document.createElement(_$_af97[32]);a.innerHTML=_$_af97[613];document.body.appendChild(a);u.defaultRowHeight=a.querySelector(_$_af97[173]).offsetHeight;a.parentNode.removeChild(a)}var d=[];if(c.cloud&&!b)return typeof u.cloud==_$_af97[104]?u.cloud.load(c,function(g){if((g=u(h,g,!0))&&g.length)for(var f=0;f<g.length;f++)d.push(g[f])}):
console.error(_$_af97[614]),d;if(h.spreadsheet)e=h.spreadsheet,Fa[_$_af97[11]].call(e,c);else var e=ta.spreadsheet(h,c);e.processing=!0;1==e.config.loadingSpin&&jSuites.loading.show();jSuites.ajax.oncomplete[e.name]=function(){for(var g=0;g<e.worksheets.length;g++)typeof e.worksheets[g].onload==_$_af97[104]&&(e.worksheets[g].onload(),e.worksheets[g].onload=null);e.processing=!1;if(Array.isArray(e.queue)&&0<e.queue.length)for(;g=e.queue.shift();)g[0].updateCell(g[1],g[2],O.call(g[0],g[1],g[2]),!0);
e.config.toolbar&&ma.show.call(e);for(g=0;g<e.worksheets.length;g++)fa.refresh.call(e.worksheets[g]);G.call(e,_$_af97[615],e);pa.state.call(e);for(g=0;g<e.worksheets.length;g++)ea.update.call(e.worksheets[g]);jSuites.loading.hide()};Array.isArray(c.worksheets)&&(c=c.worksheets);if(Array.isArray(c)){for(b=0;b<c.length;b++)ta.worksheet(e,c[b]);d=e.worksheets}else d=ta.worksheet(e,c);jSuites.ajax.pending(e.name)||(jSuites.ajax.oncomplete[e.name](),jSuites.ajax.oncomplete[e.name]=null);return d}console.error(_$_af97[612])};
u.defaultRowHeight=null;u.license=null;u.setLicense=function(h){u.license=h};u.spreadsheet=[];u.picker=ra;u.setDictionary=function(h){jSuites.setDictionary(h)};u.extensions={};u.setExtensions=function(h){for(var c=Object.keys(h),b=0;b<c.length;b++)typeof h[c[b]]===_$_af97[104]&&(u[c[b]]=h[c[b]],u.extensions[c[b]]=h[c[b]],u.license&&typeof u[c[b]].license==_$_af97[104]&&u[c[b]].license.call(u,u.license))};u.destroy=function(h,c){if(h.spreadsheet){c&&ta.unbind(h);c=u.spreadsheet.indexOf(h.spreadsheet);
u.spreadsheet.splice(c,1);for(c=0;c<h.spreadsheet.worksheets.length;c++)J(h.spreadsheet.worksheets[c].options.worksheetName,null);h.spreadsheet=null;h.jexcel=null;h.innerHTML=_$_af97[3];h.classList.remove(_$_af97[616]);h.classList.remove(_$_af97[389])}};u.version=N;u.helpers=F;u.events=Ea;typeof formula!==_$_af97[21]&&(u.formula=formula);u.editors=function(){var h={},c=function(b,a){return 1==b[a]||b.options&&1==b.options[a]?!0:b[a]==_$_af97[260]||b.options&&b.options[a]==_$_af97[260]?!0:!1};h.createEditor=
function(b,a,d,e){e.parent.input.setAttribute(_$_af97[122],!1);b==_$_af97[250]?(b=document.createElement(_$_af97[250]),b.type=_$_af97[71],b.value=d):b=document.createElement(_$_af97[32]);b.style.width=a.offsetWidth-2+_$_af97[59];b.style.height=a.offsetHeight-1+_$_af97[59];e.parent.input.appendChild(b);return b};h.createDialog=function(b,a,d,e,g,f){b=h.createEditor(_$_af97[32],b,a,g);b.classList.add(_$_af97[617]);b.classList.add(_$_af97[611]);800>window.innerWidth?(g.parent.input.style.top=_$_af97[61],
g.parent.input.style.left=_$_af97[61]):(a=g.parent.input.getBoundingClientRect(),window.innerHeight<a.bottom&&(g.parent.input.style.marginTop=-g.parent.input.offsetHeight));return b};h.general=function(){var b={},a=function(e){return(_$_af97[3]+e)[0]==_$_af97[18]?!0:!1},d=function(e){if(e.format||e.mask||e.locale){var g={};e.mask?g.mask=e.mask:e.format?g.mask=e.format:g.locale=e.locale;e.options&&(g.options=e.options);e.decimal&&(g.options||(g.options={}),g.options={decimal:e.decimal});return g}return null};
b.createCell=function(e,g,f,k,l,n){return b.updateCell(e,g,f,k,l,n)};b.updateCell=function(e,g,f,k,l,n){f=parseInt(f);k=parseInt(k);if(e){var q=d(n),p=null;g===_$_af97[3]||a(g)||typeof g===_$_af97[22]||(q?(q=jSuites.mask.extract(g,q,!0))&&q.value!==_$_af97[3]&&(p=q.value):1==(!1===l.parent.config.autoCasting||!1===n.autoCasting?!1:!0)&&(n.type==_$_af97[22]||n.type==_$_af97[343]||n.type==_$_af97[342]?(q=jSuites.mask.extract(g,n,!0))&&q.value!==_$_af97[3]&&(p=q.value):jSuites.isNumeric(Number(g))&&
(p=Number(g))));null!==p&&(g=p);g=b.parseValue(f,k,g,l,n,e);g instanceof Element||g instanceof HTMLDocument?(e.innerHTML=_$_af97[3],e.appendChild(g)):n.rotate?(e.firstChild&&e.firstChild.classList.contains(_$_af97[27])?l=e.firstChild:(l=document.createElement(_$_af97[28]),l.classList.add(_$_af97[27])),l.style.transform=_$_af97[29]+parseInt(270-n.rotate)+_$_af97[30],l.innerHTML=g,e.appendChild(l)):1==l.parent.config.stripHTML?e.innerText=g:e.innerHTML=g;if(null!==p)return p}};b.openEditor=function(e,
g,f,k,l,n){var q=l.parent.input;q.onblur=function(){q.classList.contains(_$_af97[114])||l.closeEditor(e,!0)};if(n.type==_$_af97[22]||n.type==_$_af97[343]||n.type==_$_af97[342])q.classList.add(_$_af97[599]),a(g)||n.inputmode||(n.inputmode=_$_af97[618]);f=null;a(g)||(n.inputmode&&q.setAttribute(_$_af97[118],n.inputmode),(f=d(n))?n.disabledMaskOnEdition||(n.mask?(k=n.mask.split(_$_af97[243]),q.setAttribute(_$_af97[116],k[0])):n.locale&&q.setAttribute(_$_af97[619],n.locale),f.input=q,q.mask=f,jSuites.mask.render(g,
f,!1)):g&&n.type==_$_af97[342]&&(g*=100));if(!f||n.disabledMaskOnEdition)l.parent.config.stripHTML?q.innerText=g:q.innerHTML=g,jSuites.focus(q)};b.closeEditor=function(e,g,f,k,l,n){e=l.parent.input;g=g&&e.innerText.trim().length?e.innerText:_$_af97[3];a(g)?g=g.replace(/(\r\n|\n|\r)/gm,_$_af97[3]):n.type==_$_af97[342]&&(g+=_$_af97[620],e.classList.remove(_$_af97[621]));return g};b.parseValue=function(e,g,f,k,l,n){1==k.parent.config.parseFormulas&&(k.resetArray(e,g),a(f)&&(f=k.executeFormula(f,e,g)));
f instanceof Element||f instanceof HTMLDocument||(n&&(!l.rotate&&jSuites.isNumeric(f)?n.classList.add(_$_af97[278]):n.classList.remove(_$_af97[278])),l&&!a(f)&&(e=d(l))&&(e.mask?(g=e.mask.split(_$_af97[243]),0>f&&g[1]?(n&&-1!==g[1].indexOf(_$_af97[622])&&n.classList.add(_$_af97[623]),n=-1===g[1].indexOf(_$_af97[236])?jSuites.mask.render(-1*f,e,!0):jSuites.mask.render(f,e,!0)):(e.mask=g[0],n&&n.classList.remove(_$_af97[623]),n=jSuites.mask.render(f,e,!0))):n=jSuites.mask.render(f,e,!0),n&&(f=n)));
return f};b[_$_af97[58]]=function(e,g){var f;return(f=d(e))?jSuites.mask.render(g,f,!0):e.type==_$_af97[342]?100*parseFloat(g):g};b.destroyCell=function(e){e.classList.remove(_$_af97[278])};return b}();h.text=h.general;h.number=h.general;h.numeric=h.general;h.percent=h.general;h.notes=function(){var b={},a=null;b.updateCell=function(d,e,g,f,k,l){d&&(g=document.createElement(_$_af97[32]),g.classList.add(_$_af97[624]),1==k.parent.config.stripHTML?g.innerText=e:g.innerHTML=e,d.innerHTML=_$_af97[3],d.appendChild(g))};
b.createCell=b.updateCell;b.openEditor=function(d,e,g,f,k,l){var n=l&&l.options?l.options:{};n.focus=!0;n.value=e;n.border=!1;n.height=_$_af97[625];n.toolbar=!1;a=h.createDialog(d,e,g,f,k,l);a=jSuites.editor(a,n)};b.closeEditor=function(d,e,g,f,k,l){return e?a.getData():_$_af97[3]};return b}();h.dropdown=function(){var b={createCell:function(a,d,e,g,f,k){k.render==_$_af97[626]?a.classList.add(_$_af97[627]):a.classList.add(_$_af97[628]);if(a=b.updateCell(a,d,e,g,f,k))return a},destroyCell:function(a){a.classList.remove(_$_af97[628])},
updateCell:function(a,d,e,g,f,k){if(a){var l=b.getItem(a,d,e,g,f,k);l?a.innerHTML=l:d?(d=b.fromLabel(a,d,e,g,f,k),d.length?(l=b.getItem(a,d,e,g,f,k),a.innerHTML=l):a.innerHTML=_$_af97[3]):a.innerHTML=_$_af97[3];return d}},openEditor:function(a,d,e,g,f,k){var l=h.createEditor(_$_af97[32],a,d,f),n=k.delimiter||_$_af97[243];k=Object.create(k);k.options||(k.options={});typeof k.filter==_$_af97[104]&&(k.source=k.filter(f.el,a,e,g,k.source));typeof k.filterOptions==_$_af97[104]&&(k=k.filterOptions(f,a,
e,g,d,k));e=k.options;k.source&&(e.data=JSON.parse(JSON.stringify(k.source)));c(k,_$_af97[629])&&(e.multiple=!0);c(k,_$_af97[72])&&(e.autocomplete=!0);e.format=!0;e.opened=!0;e.width=a.offsetWidth-2;e.onclose=function(){f.closeEditor(a,!0)};c(k,_$_af97[629])?d&&(e.value=(_$_af97[3]+d).split(n)):e.value=d;jSuites.dropdown(l,e)},closeEditor:function(a,d,e,g,f,k){for(var l=f.parent.input.children[0],n=k.delimiter||_$_af97[243],q=l.dropdown.getText(!0),p=l.dropdown.getValue(!0),v=0;v<p.length;v++)!1===
b.getItem(a,p[v],e,g,f,k)&&k.source.push({id:p[v],name:q[v]});l.dropdown.close(!0);if(d)return p.join(n)},fromLabel:function(a,d,e,g,f,k){a=k.delimiter||_$_af97[243];e=[];g=[];Array.isArray(d)||(d=(_$_af97[3]+d).split(a));for(f=0;f<d.length;f++)g[d[f].trim()]=!0;d=Object.keys(g);!c(k,_$_af97[629])&&1<Object.keys(d).length&&(g=[],g[d[0]]=!0);for(d=0;d<k.source.length;d++)g[k.source[d].name]&&e.push(k.source[d].id);return e.join(a)},getItem:function(a,d,e,g,f,k){g=k.delimiter||_$_af97[243];a=[];e=[];
Array.isArray(d)||(d=(_$_af97[3]+d).split(g));for(g=0;g<d.length;g++)e[d[g].trim()]=!0;g=Object.keys(e);!c(k,_$_af97[629])&&1<Object.keys(g).length&&(d=[],d[g[0]]=!0,e=d);if(k.source&&typeof k.source[0]!==_$_af97[103])for(d=0;d<k.source.length;d++)g=k.source[d],k.source[d]={id:g,name:g};for(d=0;d<k.source.length;d++)typeof e[k.source[d].id]!==_$_af97[21]&&a.push(k.render==_$_af97[287]?k.source[d].color:k.render==_$_af97[630]?k.source[d].image:k.source[d].name);if(a.length){if(typeof k.render!==_$_af97[21]){for(d=
0;d<a.length;d++)e=d,g=a[d],g=k.render==_$_af97[287]?_$_af97[631]+g+_$_af97[632]:k.render==_$_af97[630]?_$_af97[631]+g+_$_af97[632]:k.render==_$_af97[626]?_$_af97[634]+(k.source[d].color||_$_af97[633])+_$_af97[635]+g+_$_af97[636]:void 0,a[e]=g;return a.join(_$_af97[3])}for(d=0;d<a.length;d++)a[d]=(_$_af97[3]+a[d]).replace(_$_af97[15],_$_af97[13]);return a.join(_$_af97[331])}return!1}};b[_$_af97[58]]=function(a,d){for(var e=0;e<a.source.length;e++)if(a.source[e].id==d)return a.render==_$_af97[287]?
a.source[e].color:a.render==_$_af97[630]?a.source[e].image:a.source[e].name};return b}();h.autocomplete=h.dropdown;h.calendar=function(){var b={},a=null;b.updateCell=function(d,e,g,f,k,l){if(d){g=e;l=b.getFormat(l);0<e&&Number(e)==e&&(g=jSuites.calendar.numToDate(e));f=_$_af97[3]+e;f.substr(4,1)==_$_af97[236]&&f.substr(7,1)==_$_af97[236]?f=!0:(f=f.split(_$_af97[236]),f=4==f[0].length&&f[0]==Number(f[0])&&2==f[1].length&&f[1]==Number(f[1])?!0:!1);f||(f=jSuites.calendar.extractDateFromString(e,l))&&
(g=f);if(g=jSuites.calendar.getDateString(g,l))return d.innerText=g,e;d.innerText=_$_af97[3];return _$_af97[3]}};b.createCell=b.updateCell;b.openEditor=function(d,e,g,f,k,l){l=Object.create(l);typeof l.filterOptions==_$_af97[104]&&(l=l.filterOptions(k,d,g,f,e,l));g=l.options||{};g.opened=!0;g.onclose=function(n,q){k.closeEditor(d,!0)};typeof l.timepicker!==_$_af97[21]&&(g.time=c(l,_$_af97[637])?!0:!1);typeof g.readonly!==_$_af97[21]&&(g.readonly=g.readonly);g.value=e||null;g.placeholder=g.format;
a=h.createEditor(_$_af97[250],d,e,k);jSuites.calendar(a,g);!1===a.calendar.options.readonly&&a.focus()};b.closeEditor=function(d,e,g,f,k){d=a.calendar.close(!0,a.value?!0:!1);d=a.value?d:_$_af97[3];if(e)return d};b.getFormat=function(d){return d&&d.format?d.format:d&&d.options&&d.options.format?d.options.format:_$_af97[638]};b[_$_af97[58]]=function(d,e){d=b.getFormat(d);return jSuites.calendar.getDateString(e,d)};return b}();h.color=function(){var b={},a=null;b.updateCell=function(d,e,g,f,k,l){d&&
(l.render==_$_af97[639]?(g=document.createElement(_$_af97[32]),g.className=_$_af97[287],g.style.backgroundColor=e,d.innerText=_$_af97[3],d.appendChild(g)):(d.style.color=e,d.innerText=e))};b.createCell=b.updateCell;b.openEditor=function(d,e,g,f,k,l){l=Object.create(l);typeof l.filterOptions==_$_af97[104]&&(l=l.filterOptions(k,d,g,f,e,l));l.value=e;l.onclose=function(n,q){k.closeEditor(d,!0)};a=h.createEditor(_$_af97[250],d,e,k);a=jSuites.color(a,l);a.open()};b.closeEditor=function(d,e,g,f,k,l){d=
a.close(!0);if(e)return d};b[_$_af97[58]]=function(d,e){d=document.createElement(_$_af97[32]);d.style.width=_$_af97[640];d.style.height=_$_af97[34];d.style.backgroundColor=e;return d.outerHTML};return b}();h.checkbox=function(){var b={createCell:function(a,d,e,g,f,k){d=d&&d!=_$_af97[641]&&d!=_$_af97[642]?!0:!1;e=document.createElement(_$_af97[250]);e.type=_$_af97[282];e.checked=d;e.onclick=function(){f.setValue(a,this.checked)};(k&&1==k.readOnly||!f.isEditable())&&e.setAttribute(_$_af97[643],_$_af97[643]);
a.innerHTML=_$_af97[3];a.appendChild(e);return d},updateCell:function(a,d){d=d&&d!=_$_af97[641]&&d!=_$_af97[642]?!0:!1;a&&(a.children[0].checked=d);return d},openEditor:function(a,d,e,g,f){d=a.children[0].checked?!1:!0;f.setValue(a,d);return!1},closeEditor:function(a,d){return!1}};b[_$_af97[58]]=function(a,d){return 1==d||1==d||d==_$_af97[260]?jSuites.translate(_$_af97[260]):jSuites.translate(_$_af97[641])};return b}();h.radio=function(){var b={createCell:function(a,d,e,g,f,k){a.getAttribute(_$_af97[56]);
e=document.createElement(_$_af97[250]);e.type=_$_af97[284];e.checked=1==d||1==d||d==_$_af97[260]?!0:!1;e.onclick=function(){f.setValue(a,!0)};(k&&1==k.readOnly||!f.isEditable())&&e.setAttribute(_$_af97[643],_$_af97[643]);a.innerHTML=_$_af97[3];a.appendChild(e)},updateCell:function(a,d,e,g,f){d=1==d||1==d||d==_$_af97[260]||d==_$_af97[644]?!0:!1;a&&(a.children[0].checked=d);if(1==d){a=[];for(var k=0;k<f.options.data.length;k++)g!=k&&f.options.data[k][e]&&a.push({x:e,y:k,value:0});a.length&&f.setValue(a)}return d},
openEditor:function(a,d,e,g,f){return!1},closeEditor:function(a,d){return!1}};b[_$_af97[58]]=function(a,d){return 1==d||1==d||d==_$_af97[260]?_$_af97[260]:_$_af97[641]};return b}();h.autonumber=function(){var b={},a=null;b.createCell=function(d,e,g,f,k,l){(e=parseInt(e))||0<parseInt(d.innerText)&&(e=parseInt(d.innerText));l.sequence||(l.sequence=0);e?b.isValid(e,g,f,k)||(e=_$_af97[274]):e=l.sequence+1;e>l.sequence&&(l.sequence=e);return d.innerText=e};b.updateCell=b.createCell;b.openEditor=function(d,
e,g,f,k,l){a=h.createEditor(_$_af97[250],d,e,k);a.onblur=function(){k.closeEditor(d,!0)};a.focus();a.value=e};b.closeEditor=function(d,e,g,f,k){return e?a.value:_$_af97[3]};b.isValid=function(d,e,g,f){for(var k,l=0;l<f.options.data.length;l++)if(k=f.value(e,l),k==d&&l!=g)return!1;return!0};return b}();h.progressbar=function(){var b={},a=null;b.createCell=function(d,e){e=parseInt(e);if(100<e)e=100;else if(!e||0>e)e=0;if(d.children[0]&&d.children[0].tagName==_$_af97[597])var g=d.children[0];else g=
document.createElement(_$_af97[32]),g.classList.add(_$_af97[288]),d.innerText=_$_af97[3],d.classList.add(_$_af97[645]),d.appendChild(g);g.style.width=parseInt(e)+_$_af97[620];g.setAttribute(_$_af97[296],parseInt(e)+_$_af97[620])};b.destroyCell=function(d){d.classList.remove(_$_af97[645])};b.updateCell=b.createCell;b.openEditor=function(d,e,g,f,k,l){a=h.createEditor(_$_af97[250],d,e,k);a.type=_$_af97[22];a.setAttribute(_$_af97[646],0);a.setAttribute(_$_af97[647],100);a.onblur=function(){k.closeEditor(d,
!0)};a.focus();a.value=e};b.closeEditor=function(d,e,g,f,k){return e?a.value:_$_af97[3]};return b}();h.rating=function(){var b={},a=null;b.createCell=function(d,e,g,f,k,l){return b.setCell(d,e,l)};b.destroyCell=function(d){d.classList.remove(_$_af97[648])};b.updateCell=b.createCell;b.openEditor=function(d,e,g,f,k,l){a=h.createEditor(_$_af97[250],d,e,k);a.type=_$_af97[22];a.setAttribute(_$_af97[646],0);a.setAttribute(_$_af97[647],5);a.onblur=function(){k.closeEditor(d,!0)};a.focus();a.value=e};b.closeEditor=
function(d,e,g,f,k,l){return e?a.value:_$_af97[3]};b.setCell=function(d,e,g){e=parseInt(e);if(5<e)e=5;else if(!e||0>e)e=0;if(d){g=g&&g.color?g.color:_$_af97[623];var f=document.createElement(_$_af97[32]);f.setAttribute(_$_af97[296],parseInt(e)+_$_af97[649]);f.classList.add(_$_af97[289]);for(var k=0;k<e;k++){var l=document.createElement(_$_af97[484]);l.className=_$_af97[548];l.style.color=g;l.innerHTML=_$_af97[650];f.appendChild(l)}d.innerHTML=_$_af97[3];d.className=_$_af97[648];d.appendChild(f)}return e};
return b}();h.email=function(){var b={createCell:function(a,d,e,g,f,k){a&&(a.children&&a.children[0]&&a.children[0].tagName==_$_af97[607]?e=a.children[0]:(e=document.createElement(_$_af97[226]),a.innerText=_$_af97[3],a.appendChild(e),k.options&&k.options.url&&e.setAttribute(_$_af97[651],k.options.url)),e.innerText=d)}};b.updateCell=b.createCell;b.openEditor=function(a,d,e,g,f,k){f.parent.input.classList.add(_$_af97[599]);f.parent.input.onblur=function(){f.closeEditor(a,!0)};f.parent.input.innerText=
d;jSuites.focus(f.parent.input)};b.closeEditor=function(a,d,e,g,f){f.parent.input.classList.remove(_$_af97[599]);return d?f.parent.input.innerText.replace(new RegExp(/\n/,_$_af97[14]),_$_af97[3]):_$_af97[3]};return b}();h.url=h.email;h.image=function(){var b={},a=null;b.createCell=function(d,e,g,f,k,l){if(d)if(e)if(d.children&&d.children[0]&&d.children[0].tagName==_$_af97[652])d.children[0].src=e;else{var n=document.createElement(_$_af97[49]);l.render==_$_af97[653]&&n.classList.add(_$_af97[653]);
l.options&&(n.style.maxWidth=_$_af97[654],l.options.absolute&&(d.classList.add(_$_af97[655]),n.setAttribute(_$_af97[656],-1),n.classList.add(_$_af97[251]),n.classList.add(_$_af97[657]),n.settings=function(){k.openEditor(d,e,g,f,k,l)},n.dblclick=function(){k.openEditor(d,!0)},n[_$_af97[658]]=function(){k.setValueFromCoords(g,f,_$_af97[3])}),l.options.width&&(n.style.width=parseInt(l.options.width)+_$_af97[59]),l.options.height&&(n.style.height=parseInt(l.options.height)+_$_af97[59]));n.src=e;d.innerHTML=
_$_af97[3];d.appendChild(n)}else d.innerHTML=_$_af97[3]};b.updateCell=b.createCell;b.openEditor=function(d,e,g,f,k,l){(l&&l.options?l.options:{}).value=e;a=h.createDialog(d,e,g,f,k,l);e&&(d=document.createElement(_$_af97[49]),d.src=e,d.classList.add(_$_af97[659]),d.style.width=_$_af97[654],a.appendChild(d));jSuites.image(a,l)};b.closeEditor=function(d,e,g,f,k,l){if(e&&(d=a.children[0]))return d.tagName==_$_af97[652]?d.src:_$_af97[3]};b[_$_af97[58]]=function(d,e){return _$_af97[660]+e+_$_af97[661]};
return b}();h.html=function(){var b={},a=null;b.createCell=function(d,e){d.classList.add(_$_af97[662]);var g=document.createElement(_$_af97[32]);g.innerHTML=e;d.appendChild(g)};b.updateCell=function(d,e){d&&(d.firstChild.innerHTML=e)};b.destroyCell=function(d){d.classList.remove(_$_af97[662])};b.openEditor=function(d,e,g,f,k,l){var n=l&&l.options?l.options:{};n.focus=!0;n.value=e;n.border=!1;n.height=_$_af97[625];e=h.createDialog(d,e,g,f,k,l);a=jSuites.editor(e,n);a.close=function(){k.closeEditor(d,
!0)};jSuites.tracking(a,!0)};b.closeEditor=function(d,e,g,f,k,l){jSuites.tracking(a,!1);d=a.getData();if(e)return d};return b}();h.hidden=function(){return{createCell:function(b,a,d,e,g){b.innerText=a},updateCell:function(b,a,d,e,g){b&&(b.innerText=a)},openEditor:function(b,a,d,e,g){return!1},closeEditor:function(b,a){return!1}}}();h.tags=function(){var b={},a=null;b.createCell=function(d,e){d.classList.add(_$_af97[663]);b.updateCell(d,e)};b.updateCell=function(d,e){d&&(d.innerHTML=e)};b.destroyCell=
function(d){d.classList.remove(_$_af97[663])};b.openEditor=function(d,e,g,f,k,l){var n=l&&l.options?l.options:{};n.value=e;a=h.createDialog(d,e,g,f,k,l);d=document.createElement(_$_af97[32]);d.style.margin=_$_af97[34];d.style.marginRight=_$_af97[664];a.appendChild(d);a=jSuites.tags(d,n);d.focus();jSuites.focus(d)};b.closeEditor=function(d,e,g,f,k,l){d=a.getValue();if(e)return d};return b}();h.record=function(){var b={},a=null;b.createCell=function(d,e,g,f,k,l){d.classList.add(_$_af97[628]);var n;
(n=k.parent.getWorksheetInstance(l.worksheetId))?n.rows?b.updateCell(d,e,g,f,k,l):(d.innerText=_$_af97[274],k.parent.queue.push([k,g,f])):(d.innerText=_$_af97[274],k.parent.queue.push([k,g,f]))};b.destroyCell=function(d){d.classList.remove(_$_af97[628])};b.updateCell=function(d,e,g,f,k,l){d&&(typeof l.worksheetId==_$_af97[21]?d.innerText=_$_af97[274]:d.innerHTML=b.getValue(d,e,g,f,k,l))};b.openEditor=function(d,e,g,f,k,l){var n=l.delimiter||_$_af97[243];l=Object.create(l);l.options||(l.options={});
typeof l.filter==_$_af97[104]&&(l.source=l.filter(k.el,d,g,f,l.source));typeof l.filterOptions==_$_af97[104]&&(l=l.filterOptions(k,d,g,f,e,l));g=l.options;g.data=b.getSource(k,l);c(l,_$_af97[629])&&(g.multiple=!0);c(l,_$_af97[72])&&(g.autocomplete=!0);g.format=!0;g.opened=!0;g.width=d.offsetWidth-2;g.onclose=function(){k.closeEditor(d,!0)};c(l,_$_af97[629])?e&&(g.value=(_$_af97[3]+e).split(n)):g.value=e;a=h.createEditor(_$_af97[32],d,e,k);a=jSuites.dropdown(a,g)};b.closeEditor=function(d,e,g,f,k,
l){d=l.delimiter||_$_af97[243];g=a.getValue(!0);a.close(!0);if(e)return g.join(d)};b.getValue=function(d,e,g,f,k,l){d=[];if(typeof l.worksheetId==_$_af97[25]&&(k=k.parent.getWorksheetInstance(l.worksheetId))){g=l.worksheetColumn?l.worksheetColumn:0;0<=l.worksheetImage&&(g=l.worksheetImage);if(e==_$_af97[3]||0==e||null==e||void 0==e)return _$_af97[3];e=(_$_af97[3]+e).split(_$_af97[243]);for(f=0;f<e.length;f++){var n=e[f].trim();var q=k.name(g);n=k.getRowById(n);q=!1===n?_$_af97[665]:n[q];0<=l.worksheetImage&&
(q=_$_af97[666]+q+_$_af97[667]);d.push(q)}return 0<=l.worksheetImage?d.join(_$_af97[3]):d.join(_$_af97[331])}return _$_af97[274]};b.getSource=function(d,e){var g=e.worksheetColumn?e.worksheetColumn:0,f=null;typeof e.worksheetId==_$_af97[25]&&(f=d.parent.getWorksheetInstance(e.worksheetId));if(f){var k,l=[];for(d=0;d<f.rows.length;d++)if(k=f.value(g,d))k={id:f.getRowId(d),name:k},void 0!=e.worksheetImage&&(k.image=f.value(e.worksheetImage,d)),l.push(k)}else console.error(_$_af97[668]+e.worksheetId);
return l};b[_$_af97[58]]=function(d,e){for(var g=0;g<d.source.length;g++)if(d.source[g].id==e)return d.render==_$_af97[287]?d.source[g].color:d.render==_$_af97[630]?d.source[g].image:d.source[g].name};return b}();return h}();typeof jQuery!==_$_af97[21]&&function(h){h.fn.jspreadsheet=h.fn.jexcel=function(c){var b=h(this)[_$_af97[58]](0);if(b.jspreadsheet){if(typeof arguments[0]==_$_af97[22])var a=arguments[0],d=2;else a=0,d=1;return b.jspreadsheet[a][c].apply(b.jspreadsheet[a],Array.prototype.slice.call(arguments,
d))}return u(h(this)[_$_af97[58]](0),arguments[0])}}(jQuery);return u});

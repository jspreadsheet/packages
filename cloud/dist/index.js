/**
 * JSS cloud
 * https://jspreadsheet.com/cloud
 * @License: this plugin requires a license
 */

if (!jSuites && typeof(require) === 'function') {
    var jSuites = require('jsuites');
}

'use strict';var _$_7275="https://jspreadsheet.com/;api/;_self;comments;POST;DELETE;meta;style;value;config;merge;columns;columns/move;columns/delete;rows;rows/move;rows/delete;create;worksheets;worksheets/rename;worksheets/move;width;height;header;properties;properties/update;footers;footers/value;orderby;nested;nested/update;names;validations;createWorksheet;deleteWorksheet;moveWorksheet;;,;/;resetStyle;Authorization;Bearer ;Jspreadsheet;undefined;function;JSS;JSS: socket not loaded;disconnected;Jspreadsheet: jspreadsheet.socket not found;/socket.io/;TODO;connect;There is a connection issue that seems to be fixed. Reconnecting to your table...;disconnect;reload;A recovery is ongoing requested by the author. We are going to reload your spreadsheet.;setBorder;resetBorders;/socket.io/socket.io.js;script;text/javascript;get;GET;json;Jspreadsheet: This spreadsheet is not public and a valid token was not provided.;object".split(";");
(function(d,q){typeof exports===_$_7275[65]&&typeof module!==_$_7275[43]?module.exports=q():typeof define===_$_7275[44]&&define.amd?define(q):d.cloud=q()})(this,function(){var d={url:_$_7275[0],path:_$_7275[1]},q=function(a,g){g={};a.ignoreCloud=!1;var f={setComments:{url:_$_7275[3],method:_$_7275[4]},resetComments:{url:_$_7275[3],method:_$_7275[5]},setMeta:{url:_$_7275[6],method:_$_7275[4]},resetMeta:{url:_$_7275[6],method:_$_7275[5]},setStyle:{url:_$_7275[7],method:_$_7275[4]},resetStyle:{url:_$_7275[7],
method:_$_7275[5]},setValue:{url:_$_7275[8],method:_$_7275[4]},setFormula:{url:_$_7275[8],method:_$_7275[4]},setConfig:{url:_$_7275[9],method:_$_7275[4]},setMerge:{url:_$_7275[10],method:_$_7275[4]},removeMerge:{url:_$_7275[10],method:_$_7275[5]},insertColumn:{url:_$_7275[11],method:_$_7275[4]},moveColumn:{url:_$_7275[12],method:_$_7275[4]},deleteColumn:{url:_$_7275[13],method:_$_7275[4]},insertRow:{url:_$_7275[14],method:_$_7275[4]},moveRow:{url:_$_7275[15],method:_$_7275[4]},deleteRow:{url:_$_7275[16],
method:_$_7275[4]},createWorksheet:{url:_$_7275[17],method:_$_7275[4]},deleteWorksheet:{url:_$_7275[18],method:_$_7275[5]},renameWorksheet:{url:_$_7275[19],method:_$_7275[4]},moveWorksheet:{url:_$_7275[20],method:_$_7275[4]},setWidth:{url:_$_7275[21],method:_$_7275[4]},setHeight:{url:_$_7275[22],method:_$_7275[4]},setHeader:{url:_$_7275[23],method:_$_7275[4]},setProperty:{url:_$_7275[24],method:_$_7275[4]},updateProperty:{url:_$_7275[25],method:_$_7275[4]},setFooter:{url:_$_7275[26],method:_$_7275[4]},
resetFooter:{url:_$_7275[26],method:_$_7275[5]},setFooterValue:{url:_$_7275[27],method:_$_7275[4]},orderBy:{url:_$_7275[28],method:_$_7275[4]},setNestedHeaders:{url:_$_7275[29],method:_$_7275[4]},setNestedCell:{url:_$_7275[30],method:_$_7275[4]},resetNestedHeaders:{url:_$_7275[29],method:_$_7275[5]},setDefinedNames:{url:_$_7275[31],method:_$_7275[4]},setValidations:{url:_$_7275[32],method:_$_7275[4]}},n=[_$_7275[33],_$_7275[34],_$_7275[35]],p=function(b,c,k){if(f[b]){c=c?_$_7275[37]+c:_$_7275[36];
var e=JSON.parse(JSON.stringify(f[b]));e.queue=!0;0<=n.indexOf(b)?e.url=d.url+d.path+a.config.cloud+_$_7275[38]+e.url:e.url=d.url+d.path+a.config.cloud+c+_$_7275[38]+e.url;if(b==_$_7275[39]||b==_$_7275[34])e.url+=_$_7275[38]+k.join(_$_7275[37]);e.beforeSend=function(m){d.token&&m.setRequestHeader(_$_7275[40],_$_7275[41]+d.token);m.setRequestHeader(_$_7275[42],1)};var h=this;e.success=function(m){m.error&&jSuites.notification(m);m.data&&h.updateCells(m.data)};return e}},r=function(b,c){var k=this.parent.worksheets.indexOf(this);
if(b=p.call(this,b,k,c))a.progress(!0),setTimeout(function(){a.progress(!1)},1E3),Array.isArray(c)&&1==c.length?b.data=c[0]:b.data=c;return b};g.persistence=function(b,c,k,e){if(typeof io==_$_7275[43])return!1;if(!a.ignorePersistence){var h=r.call(b,c,k);h&&(typeof e===_$_7275[44]&&(h.success=e),jSuites.ajax(h))}if(!a.ignoreCloud)if(b.socket){c=[c];if(k)for(e=Object.keys(k),h=0;h<e.length;h++)c.push(k[e[h]]);b.socket.emit(_$_7275[45],c)}else console.error(_$_7275[46])};g.init=function(b){if(!b.parent.config.cloud)return!1;
typeof io==_$_7275[43]?(b.parent.element.classList.add(_$_7275[47]),console.error(_$_7275[48])):(b.socket=io(d.url,{path:d.path+_$_7275[49],query:{guid:b.options.worksheetId?b.parent.config.cloud+_$_7275[37]+b.options.worksheetId:b.parent.config.cloud,token:_$_7275[50]}}),b.socket.on(_$_7275[51],function(){b.parent.element.classList.contains(_$_7275[47])&&(alert(_$_7275[52]),window.open(window.location.href,_$_7275[2]))}),b.socket.on(_$_7275[53],function(){b.parent.element.classList.add(_$_7275[47])}),
b.socket.on(_$_7275[54],function(){alert(_$_7275[55]);window.open(window.location.href,_$_7275[2])}),b.socket.on(_$_7275[45],function(c){a.ignoreCloud=!0;a.ignoreHistory=!0;a.ignorePersistence=!0;if(c.a[0]==_$_7275[56])b.setBorder(c.a[1],c.a[2],c.a[3],c.a[4],c.u);else if(c.a[0]==_$_7275[57])b.resetBorders(c.u,!0);else if(typeof b[c.a[0]]==_$_7275[44])b[c.a[0]](c.a[1],c.a[2],c.a[3],c.a[4],c.a[5],c.a[6]);a.ignoreCloud=!1;a.ignoreHistory=!1;a.ignorePersistence=!1}))};return g},l=function(a){a.url&&(d.url=
a.url);a.path&&(d.path=a.path);a.token&&(d.token=a.token);a.onbeforesend&&(d.onbeforeSend=a.onbeforesend);a.onbeforecreate&&(d.onbeforecreate=a.onbeforecreate);return!0};l.oninit=function(a,g){a.setPlugins({cloud:q})};l.load=function(a,g){if(l.requiredLoaded)l.requiredLoaded=!0,l[_$_7275[61]](a,g);else{jSuites.loading.show();var f=d.url+d.path+_$_7275[58],n=document.head,p=document.createElement(_$_7275[59]);p.type=_$_7275[60];p.src=f;p.onload=function(){l[_$_7275[61]](a,g);jSuites.loading.hide()};
n.appendChild(p)}};l[_$_7275[61]]=function(a,g){jSuites.ajax({url:d.url+d.path+a.cloud,method:_$_7275[62],dataType:_$_7275[63],beforeSend:function(f){d.token&&f.setRequestHeader(_$_7275[40],_$_7275[41]+d.token)},success:function(f){if(1==f.privacy)jSuites.notification({message:_$_7275[64]});else if(1==f.error)jSuites.notification(f);else{for(var n in f)a[n]=f[n];typeof a.tabs!==_$_7275[43]&&(a.tabs=!0);typeof a.toolbar!==_$_7275[43]&&(a.toolbar=!0);if(typeof d.onbeforecreate==_$_7275[44])d.onbeforecreate(a);
g(a)}},error:function(){console.log(arguments)}})};return l});

/**
 * JSS cloud
 * https://jspreadsheet.com/cloud
 * @License: this plugin requires a license
 */

if (!jSuites && typeof(require) === 'function') {
    var jSuites = require('jsuites');
}

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(b,d){return Object.prototype.hasOwnProperty.call(b,d)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,c){if(b==Array.prototype||b==Object.prototype)return b;b[d]=c.value;return b};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,b,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var d=0;d<b.length;++d){var c=b[d];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(b,d){var c=$jscomp.propertyToPolyfillSymbol[d];if(null==c)return b[d];c=b[c];return void 0!==c?c:b[d]};
$jscomp.polyfill=function(b,d,c,a){d&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(b,d,c,a):$jscomp.polyfillUnisolated(b,d,c,a))};$jscomp.polyfillUnisolated=function(b,d,c,a){c=$jscomp.global;b=b.split(".");for(a=0;a<b.length-1;a++){var e=b[a];if(!(e in c))return;c=c[e]}b=b[b.length-1];a=c[b];d=d(a);d!=a&&null!=d&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:d})};
$jscomp.polyfillIsolated=function(b,d,c,a){var e=b.split(".");b=1===e.length;a=e[0];a=!b&&a in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var k=0;k<e.length-1;k++){var m=e[k];if(!(m in a))return;a=a[m]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?a[e]:null;d=d(c);null!=d&&(b?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:d}):d!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(c=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+c+"$"+e),$jscomp.defineProperty(a,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:d})))};$jscomp.polyfill("Object.values",function(b){return b?b:function(d){var c=[],a;for(a in d)$jscomp.owns(d,a)&&c.push(d[a]);return c}},"es8","es3");var _$_3cbd="https://jspreadsheet.com/;api/;_self;comments;POST;DELETE;meta;style;value;config;merge;columns;columns/move;columns/delete;rows;rows/move;rows/delete;create;worksheets;worksheets/rename;worksheets/move;width;height;header;properties;properties/update;footers;footers/value;orderby;nested;nested/update;names;validations;freeze/columns;freeze/rows;createWorksheet;deleteWorksheet;moveWorksheet;;,;/;resetStyle;Authorization;Bearer ;Jspreadsheet;undefined;function;JSS;JSS: socket not loaded;disconnected;JSS: socket.io not found;socket.io/;connect;There is a connection issue that seems to be fixed. Reconnecting to your table...;disconnect;title;recovery;A recovery is ongoing requested by the author. We are going to reload your spreadsheet.;delete;This spreadsheet was deleted by the author.;setBorder;resetBorders;socket.io/socket.io.js;script;text/javascript;get;GET;json;Jspreadsheet: This spreadsheet is not public and a valid token was not provided.;object".split(";");
(function(b,d){typeof exports===_$_3cbd[69]&&typeof module!==_$_3cbd[45]?module.exports=d():typeof define===_$_3cbd[46]&&define.amd?define(d):b.cloud=d()})(this,function(){var b={url:_$_3cbd[0],path:_$_3cbd[1]},d=function(a,e){e={};a.ignoreCloud=!1;var k=function(f){alert(f);window.open(window.location.href,_$_3cbd[2])},m={setComments:{url:_$_3cbd[3],method:_$_3cbd[4]},resetComments:{url:_$_3cbd[3],method:_$_3cbd[5]},setMeta:{url:_$_3cbd[6],method:_$_3cbd[4]},resetMeta:{url:_$_3cbd[6],method:_$_3cbd[5]},
setStyle:{url:_$_3cbd[7],method:_$_3cbd[4]},resetStyle:{url:_$_3cbd[7],method:_$_3cbd[5]},setValue:{url:_$_3cbd[8],method:_$_3cbd[4]},setFormula:{url:_$_3cbd[8],method:_$_3cbd[4]},setConfig:{url:_$_3cbd[9],method:_$_3cbd[4]},setMerge:{url:_$_3cbd[10],method:_$_3cbd[4]},removeMerge:{url:_$_3cbd[10],method:_$_3cbd[5]},insertColumn:{url:_$_3cbd[11],method:_$_3cbd[4]},moveColumn:{url:_$_3cbd[12],method:_$_3cbd[4]},deleteColumn:{url:_$_3cbd[13],method:_$_3cbd[4]},insertRow:{url:_$_3cbd[14],method:_$_3cbd[4]},
moveRow:{url:_$_3cbd[15],method:_$_3cbd[4]},deleteRow:{url:_$_3cbd[16],method:_$_3cbd[4]},createWorksheet:{url:_$_3cbd[17],method:_$_3cbd[4]},deleteWorksheet:{url:_$_3cbd[18],method:_$_3cbd[5]},renameWorksheet:{url:_$_3cbd[19],method:_$_3cbd[4]},moveWorksheet:{url:_$_3cbd[20],method:_$_3cbd[4]},setWidth:{url:_$_3cbd[21],method:_$_3cbd[4]},setHeight:{url:_$_3cbd[22],method:_$_3cbd[4]},setHeader:{url:_$_3cbd[23],method:_$_3cbd[4]},setProperty:{url:_$_3cbd[24],method:_$_3cbd[4]},updateProperty:{url:_$_3cbd[25],
method:_$_3cbd[4]},setFooter:{url:_$_3cbd[26],method:_$_3cbd[4]},resetFooter:{url:_$_3cbd[26],method:_$_3cbd[5]},setFooterValue:{url:_$_3cbd[27],method:_$_3cbd[4]},orderBy:{url:_$_3cbd[28],method:_$_3cbd[4]},setNestedHeaders:{url:_$_3cbd[29],method:_$_3cbd[4]},setNestedCell:{url:_$_3cbd[30],method:_$_3cbd[4]},resetNestedHeaders:{url:_$_3cbd[29],method:_$_3cbd[5]},setDefinedNames:{url:_$_3cbd[31],method:_$_3cbd[4]},setValidations:{url:_$_3cbd[32],method:_$_3cbd[4]},setFreezeColumns:{url:_$_3cbd[33],
method:_$_3cbd[4]},setFreezeRows:{url:_$_3cbd[34],method:_$_3cbd[4]}},p=[_$_3cbd[35],_$_3cbd[36],_$_3cbd[37]],r=function(f,g,l){if(m[f]){g=g?_$_3cbd[39]+g:_$_3cbd[38];var h=JSON.parse(JSON.stringify(m[f]));h.queue=!0;0<=p.indexOf(f)?h.url=b.url+b.path+a.config.cloud+_$_3cbd[40]+h.url:h.url=b.url+b.path+a.config.cloud+g+_$_3cbd[40]+h.url;if(f==_$_3cbd[41]||f==_$_3cbd[36])h.url+=_$_3cbd[40]+l.join(_$_3cbd[39]);h.beforeSend=function(n){b.token&&n.setRequestHeader(_$_3cbd[42],_$_3cbd[43]+b.token);n.setRequestHeader(_$_3cbd[44],
1)};var q=this;h.success=function(n){n.error&&jSuites.notification(n);n.data&&q.updateCells(n.data)};return h}},t=function(f,g){var l=this.parent.worksheets.indexOf(this);if(f=r.call(this,f,l,g))a.progress(!0),setTimeout(function(){a.progress(!1)},1E3),Array.isArray(g)&&1==g.length?f.data=g[0]:f.data=g;return f};e.persistence=function(f,g,l,h){if(typeof io==_$_3cbd[45])return!1;if(!a.ignorePersistence){var q=t.call(f,g,l);q&&(typeof h===_$_3cbd[46]&&(q.success=h),jSuites.ajax(q))}a.ignoreCloud||(a.socket?
a.socket.emit(_$_3cbd[47],{worksheet:f.options.worksheetId,method:g,args:l?Object.values(l):[]}):console.error(_$_3cbd[48]))};(function(){if(!a.config.cloud)return!1;typeof io==_$_3cbd[45]?(a.element.classList.add(_$_3cbd[49]),console.error(_$_3cbd[50])):(a.socket=io(b.url,{path:_$_3cbd[40]+b.path+_$_3cbd[51],query:{room:a.config.cloud,token:b.token}}),a.socket.on(_$_3cbd[52],function(){a.element.classList.contains(_$_3cbd[49])&&k(_$_3cbd[53])}),a.socket.on(_$_3cbd[54],function(){a.element.classList.add(_$_3cbd[49])}),
a.socket.on(_$_3cbd[55],function(f){if(typeof b.onchangetitle===_$_3cbd[46])b.onchangetitle(f.args[0])}),a.socket.on(_$_3cbd[56],function(){k(_$_3cbd[57])}),a.socket.on(_$_3cbd[58],function(){k(_$_3cbd[59])}),a.socket.on(_$_3cbd[47],function(f){a.ignoreCloud=!0;a.ignoreHistory=!0;a.ignorePersistence=!0;var g=f.method;a:{var l=f.worksheet;for(var h=0;h<a.worksheets.length;h++)if(l===a.worksheets[h].options.worksheetId||!a.worksheets[h].options.worksheetId&&!l){l=a.worksheets[h];break a}l=!1}if(!l){if(typeof a[g]==
_$_3cbd[46])a[g](...f.args)}else if(g==_$_3cbd[60])l.setBorder(...f.args,f.user);else if(g==_$_3cbd[61])l.resetBorders(f.user,!0);else if(typeof l[g]==_$_3cbd[46])l[g](...f.args);a.ignoreCloud=!1;a.ignoreHistory=!1;a.ignorePersistence=!1}))})();return e},c=function(a){a.url&&(b.url=a.url);a.path&&(b.path=a.path);a.token&&(b.token=a.token);a.onbeforesend&&(b.onbeforesend=a.onbeforesend);a.onchangetitle&&(b.onchangetitle=a.onchangetitle);a.onbeforecreate&&(b.onbeforecreate=a.onbeforecreate);return!0};
c.oninit=function(a,e){a.setPlugins({cloud:d})};c.load=function(a,e){if(c.requiredLoaded)c.requiredLoaded=!0,c[_$_3cbd[65]](a,e);else{jSuites.loading.show();var k=b.url+b.path+_$_3cbd[62],m=document.head,p=document.createElement(_$_3cbd[63]);p.type=_$_3cbd[64];p.src=k;p.onload=function(){c[_$_3cbd[65]](a,e);jSuites.loading.hide()};m.appendChild(p)}};c[_$_3cbd[65]]=function(a,e){jSuites.ajax({url:b.url+b.path+a.cloud,method:_$_3cbd[66],dataType:_$_3cbd[67],beforeSend:function(k){b.token&&k.setRequestHeader(_$_3cbd[42],
_$_3cbd[43]+b.token)},success:function(k){if(1==k.privacy)jSuites.notification({message:_$_3cbd[68]});else if(1==k.error)jSuites.notification(k);else{for(var m in k)a[m]=k[m];typeof a.tabs!==_$_3cbd[45]&&(a.tabs=!0);typeof a.toolbar!==_$_3cbd[45]&&(a.toolbar=!0);if(typeof b.onbeforecreate==_$_3cbd[46])b.onbeforecreate(a);e(a)}},error:function(){console.log(arguments)}})};return c});

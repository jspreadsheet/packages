/**
 * JSS cloud
 * https://jspreadsheet.com/cloud
 * @License: this plugin requires a license
 */

if (!jSuites && typeof(require) === 'function') {
    var jSuites = require('jsuites');
}

var _$_1903=["https://jspreadsheet.com/","api/","_self","comments","POST","DELETE","meta","style","value","config","merge","columns","columns/move","columns/delete","rows","rows/move","rows/delete","create","worksheets","worksheets/rename","worksheets/move","width","height","header","properties","properties/update","footers","footers/value","orderby","nested","nested/update","names","validations","freeze/columns","freeze/rows","createWorksheet","deleteWorksheet","moveWorksheet","",",","/","resetStyle","Authorization","Bearer ","Jspreadsheet","undefined","function","JSS","JSS: socket not loaded","disconnected","JSS: socket.io not found","socket.io/","connect","There is a connection issue that seems to be fixed. Reconnecting to your table...","disconnect","title","recovery","A recovery is ongoing requested by the author. We are going to reload your spreadsheet.","delete","This spreadsheet was deleted by the author.","setBorder","resetBorders","socket.io/socket.io.js","script","text/javascript","get","GET","json","Jspreadsheet: This spreadsheet is not public and a valid token was not provided.","object"];;;(function(global,factory){ typeof exports=== _$_1903[69]&&  typeof module!== _$_1903[45]?module.exports= factory(): typeof define=== _$_1903[46]&& define.amd?define(factory):global.cloud= factory()}(this,(function(){var Config={url:_$_1903[0],path:_$_1903[1]};var Cloud=(function(spreadsheet,options){var plugin={};spreadsheet.ignoreCloud= false;var reload=function(message){alert(message);window.open(window.location.href,_$_1903[2])};var info={'setComments':{url:_$_1903[3],method:_$_1903[4]},'resetComments':{url:_$_1903[3],method:_$_1903[5]},'setMeta':{url:_$_1903[6],method:_$_1903[4]},'resetMeta':{url:_$_1903[6],method:_$_1903[5]},'setStyle':{url:_$_1903[7],method:_$_1903[4]},'resetStyle':{url:_$_1903[7],method:_$_1903[5]},'setValue':{url:_$_1903[8],method:_$_1903[4]},'setFormula':{url:_$_1903[8],method:_$_1903[4]},'setConfig':{url:_$_1903[9],method:_$_1903[4]},'setMerge':{url:_$_1903[10],method:_$_1903[4]},'removeMerge':{url:_$_1903[10],method:_$_1903[5]},'insertColumn':{url:_$_1903[11],method:_$_1903[4]},'moveColumn':{url:_$_1903[12],method:_$_1903[4]},'deleteColumn':{url:_$_1903[13],method:_$_1903[4]},'insertRow':{url:_$_1903[14],method:_$_1903[4]},'moveRow':{url:_$_1903[15],method:_$_1903[4]},'deleteRow':{url:_$_1903[16],method:_$_1903[4]},'createWorksheet':{url:_$_1903[17],method:_$_1903[4]},'deleteWorksheet':{url:_$_1903[18],method:_$_1903[5]},'renameWorksheet':{url:_$_1903[19],method:_$_1903[4]},'moveWorksheet':{url:_$_1903[20],method:_$_1903[4]},'setWidth':{url:_$_1903[21],method:_$_1903[4]},'setHeight':{url:_$_1903[22],method:_$_1903[4]},'setHeader':{url:_$_1903[23],method:_$_1903[4]},'setProperty':{url:_$_1903[24],method:_$_1903[4]},'updateProperty':{url:_$_1903[25],method:_$_1903[4]},'setFooter':{url:_$_1903[26],method:_$_1903[4]},'resetFooter':{url:_$_1903[26],method:_$_1903[5]},'setFooterValue':{url:_$_1903[27],method:_$_1903[4]},'orderBy':{url:_$_1903[28],method:_$_1903[4]},'setNestedHeaders':{url:_$_1903[29],method:_$_1903[4]},'setNestedCell':{url:_$_1903[30],method:_$_1903[4]},'resetNestedHeaders':{url:_$_1903[29],method:_$_1903[5]},'setDefinedNames':{url:_$_1903[31],method:_$_1903[4]},'setValidations':{url:_$_1903[32],method:_$_1903[4]},'setFreezeColumns':{url:_$_1903[33],method:_$_1903[4]},'setFreezeRows':{url:_$_1903[34],method:_$_1903[4]}};var exceptions=[_$_1903[35],_$_1903[36],_$_1903[37]];var Requests=function(method,index,args){if(info[method]){if(!index){index= _$_1903[38]}else {index= _$_1903[39]+ index};var config=JSON.parse(JSON.stringify(info[method]));config.queue= true;if(exceptions.indexOf(method)>= 0){config.url= Config.url+ Config.path+ spreadsheet.config.cloud+ _$_1903[40]+ config.url}else {config.url= Config.url+ Config.path+ spreadsheet.config.cloud+ index+ _$_1903[40]+ config.url};if(method== _$_1903[41]|| method== _$_1903[36]){config.url+= _$_1903[40]+ args.join(_$_1903[39])};config.beforeSend= function(xhr){if(Config.token){xhr.setRequestHeader(_$_1903[42],_$_1903[43]+ Config.token)};xhr.setRequestHeader(_$_1903[44],1)};var worksheet=this;config.success= function(result){if(result.error){jSuites.notification(result)};if(result.data){worksheet.updateCells(result.data)}};return config}};var getRequest=function(method,args){var index=this.parent.worksheets.indexOf(this);var config=Requests.call(this,method,index,args);if(config){spreadsheet.progress(true);setTimeout(function(){spreadsheet.progress(false)},1000);if(Array.isArray(args)&& args.length== 1){config.data= args[0]}else {config.data= args}};return config};var getWorksheet=function(worksheetId){for(var i=0;i< spreadsheet.worksheets.length;i++){if(worksheetId=== spreadsheet.worksheets[i].options.worksheetId|| (!spreadsheet.worksheets[i].options.worksheetId&&  !worksheetId)){return spreadsheet.worksheets[i]}};return false};plugin.persistence= function(worksheet,method,args,callback){if( typeof (io)== _$_1903[45]){return false};if(!spreadsheet.ignorePersistence){var request=getRequest.call(worksheet,method,args);if(request){if( typeof callback=== _$_1903[46]){request.success= callback};jSuites.ajax(request)}};if(!spreadsheet.ignoreCloud){if(spreadsheet.socket){spreadsheet.socket.emit(_$_1903[47],{worksheet:worksheet.options.worksheetId,method:method,args:args?Object.values(args):[]})}else {console.error(_$_1903[48])}}};var init=function(){if(!spreadsheet.config.cloud){return false};if( typeof (io)== _$_1903[45]){spreadsheet.element.classList.add(_$_1903[49]);console.error(_$_1903[50])}else {spreadsheet.socket= io(Config.url,{path:_$_1903[40]+ Config.path+ _$_1903[51],query:{room:spreadsheet.config.cloud,token:Config.token}});spreadsheet.socket.on(_$_1903[52],function(){if(spreadsheet.element.classList.contains(_$_1903[49])){reload(_$_1903[53])}});spreadsheet.socket.on(_$_1903[54],function(){spreadsheet.element.classList.add(_$_1903[49])});spreadsheet.socket.on(_$_1903[55],function(e){if( typeof Config.onchangetitle=== _$_1903[46]){Config.onchangetitle(e.args[0])}});spreadsheet.socket.on(_$_1903[56],function(){reload(_$_1903[57])});spreadsheet.socket.on(_$_1903[58],function(){reload(_$_1903[59])});spreadsheet.socket.on(_$_1903[47],function(e){spreadsheet.ignoreCloud= true;spreadsheet.ignoreHistory= true;spreadsheet.ignorePersistence= true;var method=e.method;var worksheet=getWorksheet(e.worksheet);if(!worksheet){if( typeof (spreadsheet[method])== _$_1903[46]){spreadsheet[method](...e.args)}}else {if(method== _$_1903[60]){worksheet.setBorder(...e.args,e.user)}else {if(method== _$_1903[61]){worksheet.resetBorders(e.user,true)}else {if( typeof (worksheet[method])== _$_1903[46]){worksheet[method](...e.args)}}}};spreadsheet.ignoreCloud= false;spreadsheet.ignoreHistory= false;spreadsheet.ignorePersistence= false})}};init();return plugin});var P=(function(options){if(options.url){Config.url= options.url};if(options.path){Config.path= options.path};if(options.token){Config.token= options.token};if(options.onbeforesend){Config.onbeforeSend= options.onbeforesend};if(options.onchangetitle){Config.onchangetitle= options.onchangetitle};if(options.onbeforecreate){Config.onbeforecreate= options.onbeforecreate};return true});P.oninit= function(spreadsheet,options){spreadsheet.setPlugins({cloud:Cloud})};P.load= function(options,init){if(!P.requiredLoaded){jSuites.loading.show();var URL=Config.url+ Config.path+ _$_1903[62];var head=document.head;var script=document.createElement(_$_1903[63]);script.type= _$_1903[64];script.src= URL;script.onload= function(){P[_$_1903[65]](options,init);jSuites.loading.hide()};head.appendChild(script)}else {P.requiredLoaded= true;P[_$_1903[65]](options,init)}};P[_$_1903[65]]= function(options,init){jSuites.ajax({url:Config.url+ Config.path+ options.cloud,method:_$_1903[66],dataType:_$_1903[67],beforeSend:function(xhr){if(Config.token){xhr.setRequestHeader(_$_1903[42],_$_1903[43]+ Config.token)}},success:function(result){if(result.privacy== true){jSuites.notification({message:_$_1903[68]})}else {if(result.error== 1){jSuites.notification(result)}else {for(var a in result){options[a]= result[a]};if( typeof (options.tabs)!== _$_1903[45]){options.tabs= true};if( typeof (options.toolbar)!== _$_1903[45]){options.toolbar= true};if( typeof (Config.onbeforecreate)== _$_1903[46]){Config.onbeforecreate(options)};init(options)}}},error:function(){console.log(arguments)}})};return P})))